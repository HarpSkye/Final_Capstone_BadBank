var nR=Object.defineProperty;var c=(J,h)=>nR(J,"name",{value:h,configurable:!0});(()=>{var __webpack_modules__={6232:(J,h,U)=>{"use strict";const E=U(8641),N=U(8692),L=U(1474),V=U(5870),K=c((P,w={})=>{let R=[];if(Array.isArray(P))for(let A of P){let S=K.create(A,w);Array.isArray(S)?R.push(...S):R.push(S)}else R=[].concat(K.create(P,w));return w&&w.expand===!0&&w.nodupes===!0&&(R=[...new Set(R)]),R},"braces");K.parse=(P,w={})=>V(P,w),K.stringify=(P,w={})=>E(typeof P=="string"?K.parse(P,w):P,w),K.compile=(P,w={})=>(typeof P=="string"&&(P=K.parse(P,w)),N(P,w)),K.expand=(P,w={})=>{typeof P=="string"&&(P=K.parse(P,w));let R=L(P,w);return w.noempty===!0&&(R=R.filter(Boolean)),w.nodupes===!0&&(R=[...new Set(R)]),R},K.create=(P,w={})=>P===""||P.length<3?[P]:w.expand!==!0?K.compile(P,w):K.expand(P,w),J.exports=K},8692:(J,h,U)=>{"use strict";const E=U(1516),N=U(3596),L=c((V,K={})=>{let P=c((w,R={})=>{let A=N.isInvalidBrace(R),S=w.invalid===!0&&K.escapeInvalid===!0,D=A===!0||S===!0,j=K.escapeInvalid===!0?"\\":"",F="";if(w.isOpen===!0||w.isClose===!0)return j+w.value;if(w.type==="open")return D?j+w.value:"(";if(w.type==="close")return D?j+w.value:")";if(w.type==="comma")return w.prev.type==="comma"?"":D?w.value:"|";if(w.value)return w.value;if(w.nodes&&w.ranges>0){let X=N.reduce(w.nodes),se=E(...X,{...K,wrap:!1,toRegex:!0});if(se.length!==0)return X.length>1&&se.length>1?`(${se})`:se}if(w.nodes)for(let X of w.nodes)F+=P(X,w);return F},"walk");return P(V)},"compile");J.exports=L},7007:J=>{"use strict";J.exports={MAX_LENGTH:1024*64,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}},1474:(J,h,U)=>{"use strict";const E=U(1516),N=U(8641),L=U(3596),V=c((P="",w="",R=!1)=>{let A=[];if(P=[].concat(P),w=[].concat(w),!w.length)return P;if(!P.length)return R?L.flatten(w).map(S=>`{${S}}`):w;for(let S of P)if(Array.isArray(S))for(let D of S)A.push(V(D,w,R));else for(let D of w)R===!0&&typeof D=="string"&&(D=`{${D}}`),A.push(Array.isArray(D)?V(S,D,R):S+D);return L.flatten(A)},"append"),K=c((P,w={})=>{let R=w.rangeLimit===void 0?1e3:w.rangeLimit,A=c((S,D={})=>{S.queue=[];let j=D,F=D.queue;for(;j.type!=="brace"&&j.type!=="root"&&j.parent;)j=j.parent,F=j.queue;if(S.invalid||S.dollar){F.push(V(F.pop(),N(S,w)));return}if(S.type==="brace"&&S.invalid!==!0&&S.nodes.length===2){F.push(V(F.pop(),["{}"]));return}if(S.nodes&&S.ranges>0){let z=L.reduce(S.nodes);if(L.exceedsLimit(...z,w.step,R))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let G=E(...z,w);G.length===0&&(G=N(S,w)),F.push(V(F.pop(),G)),S.nodes=[];return}let X=L.encloseBrace(S),se=S.queue,ye=S;for(;ye.type!=="brace"&&ye.type!=="root"&&ye.parent;)ye=ye.parent,se=ye.queue;for(let z=0;z<S.nodes.length;z++){let G=S.nodes[z];if(G.type==="comma"&&S.type==="brace"){z===1&&se.push(""),se.push("");continue}if(G.type==="close"){F.push(V(F.pop(),se,X));continue}if(G.value&&G.type!=="open"){se.push(V(se.pop(),G.value));continue}G.nodes&&A(G,S)}return se},"walk");return L.flatten(A(P))},"expand");J.exports=K},5870:(J,h,U)=>{"use strict";const E=U(8641),{MAX_LENGTH:N,CHAR_BACKSLASH:L,CHAR_BACKTICK:V,CHAR_COMMA:K,CHAR_DOT:P,CHAR_LEFT_PARENTHESES:w,CHAR_RIGHT_PARENTHESES:R,CHAR_LEFT_CURLY_BRACE:A,CHAR_RIGHT_CURLY_BRACE:S,CHAR_LEFT_SQUARE_BRACKET:D,CHAR_RIGHT_SQUARE_BRACKET:j,CHAR_DOUBLE_QUOTE:F,CHAR_SINGLE_QUOTE:X,CHAR_NO_BREAK_SPACE:se,CHAR_ZERO_WIDTH_NOBREAK_SPACE:ye}=U(7007),z=c((G,re={})=>{if(typeof G!="string")throw new TypeError("Expected a string");let W=re||{},B=typeof W.maxLength=="number"?Math.min(N,W.maxLength):N;if(G.length>B)throw new SyntaxError(`Input length (${G.length}), exceeds max characters (${B})`);let ie={type:"root",input:G,nodes:[]},Q=[ie],de=ie,he=ie,xe=0,Pe=G.length,He=0,q=0,ve,De={};const ot=c(()=>G[He++],"advance"),je=c(Ee=>{if(Ee.type==="text"&&he.type==="dot"&&(he.type="text"),he&&he.type==="text"&&Ee.type==="text"){he.value+=Ee.value;return}return de.nodes.push(Ee),Ee.parent=de,Ee.prev=he,he=Ee,Ee},"push");for(je({type:"bos"});He<Pe;)if(de=Q[Q.length-1],ve=ot(),!(ve===ye||ve===se)){if(ve===L){je({type:"text",value:(re.keepEscaping?ve:"")+ot()});continue}if(ve===j){je({type:"text",value:"\\"+ve});continue}if(ve===D){xe++;let Ee=!0,Je;for(;He<Pe&&(Je=ot());){if(ve+=Je,Je===D){xe++;continue}if(Je===L){ve+=ot();continue}if(Je===j&&(xe--,xe===0))break}je({type:"text",value:ve});continue}if(ve===w){de=je({type:"paren",nodes:[]}),Q.push(de),je({type:"text",value:ve});continue}if(ve===R){if(de.type!=="paren"){je({type:"text",value:ve});continue}de=Q.pop(),je({type:"text",value:ve}),de=Q[Q.length-1];continue}if(ve===F||ve===X||ve===V){let Ee=ve,Je;for(re.keepQuotes!==!0&&(ve="");He<Pe&&(Je=ot());){if(Je===L){ve+=Je+ot();continue}if(Je===Ee){re.keepQuotes===!0&&(ve+=Je);break}ve+=Je}je({type:"text",value:ve});continue}if(ve===A){q++;let Ee=he.value&&he.value.slice(-1)==="$"||de.dollar===!0;de=je({type:"brace",open:!0,close:!1,dollar:Ee,depth:q,commas:0,ranges:0,nodes:[]}),Q.push(de),je({type:"open",value:ve});continue}if(ve===S){if(de.type!=="brace"){je({type:"text",value:ve});continue}let Ee="close";de=Q.pop(),de.close=!0,je({type:Ee,value:ve}),q--,de=Q[Q.length-1];continue}if(ve===K&&q>0){if(de.ranges>0){de.ranges=0;let Ee=de.nodes.shift();de.nodes=[Ee,{type:"text",value:E(de)}]}je({type:"comma",value:ve}),de.commas++;continue}if(ve===P&&q>0&&de.commas===0){let Ee=de.nodes;if(q===0||Ee.length===0){je({type:"text",value:ve});continue}if(he.type==="dot"){if(de.range=[],he.value+=ve,he.type="range",de.nodes.length!==3&&de.nodes.length!==5){de.invalid=!0,de.ranges=0,he.type="text";continue}de.ranges++,de.args=[];continue}if(he.type==="range"){Ee.pop();let Je=Ee[Ee.length-1];Je.value+=he.value+ve,he=Je,de.ranges--;continue}je({type:"dot",value:ve});continue}je({type:"text",value:ve})}do if(de=Q.pop(),de.type!=="root"){de.nodes.forEach(ft=>{ft.nodes||(ft.type==="open"&&(ft.isOpen=!0),ft.type==="close"&&(ft.isClose=!0),ft.nodes||(ft.type="text"),ft.invalid=!0)});let Ee=Q[Q.length-1],Je=Ee.nodes.indexOf(de);Ee.nodes.splice(Je,1,...de.nodes)}while(Q.length>0);return je({type:"eos"}),ie},"parse");J.exports=z},8641:(J,h,U)=>{"use strict";const E=U(3596);J.exports=(N,L={})=>{let V=c((K,P={})=>{let w=L.escapeInvalid&&E.isInvalidBrace(P),R=K.invalid===!0&&L.escapeInvalid===!0,A="";if(K.value)return(w||R)&&E.isOpenOrClose(K)?"\\"+K.value:K.value;if(K.value)return K.value;if(K.nodes)for(let S of K.nodes)A+=V(S);return A},"stringify");return V(N)}},3596:(J,h)=>{"use strict";h.isInteger=U=>typeof U=="number"?Number.isInteger(U):typeof U=="string"&&U.trim()!==""?Number.isInteger(Number(U)):!1,h.find=(U,E)=>U.nodes.find(N=>N.type===E),h.exceedsLimit=(U,E,N=1,L)=>L===!1||!h.isInteger(U)||!h.isInteger(E)?!1:(Number(E)-Number(U))/Number(N)>=L,h.escapeNode=(U,E=0,N)=>{let L=U.nodes[E];!L||(N&&L.type===N||L.type==="open"||L.type==="close")&&L.escaped!==!0&&(L.value="\\"+L.value,L.escaped=!0)},h.encloseBrace=U=>U.type!=="brace"?!1:U.commas>>0+U.ranges>>0==0?(U.invalid=!0,!0):!1,h.isInvalidBrace=U=>U.type!=="brace"?!1:U.invalid===!0||U.dollar?!0:U.commas>>0+U.ranges>>0==0||U.open!==!0||U.close!==!0?(U.invalid=!0,!0):!1,h.isOpenOrClose=U=>U.type==="open"||U.type==="close"?!0:U.open===!0||U.close===!0,h.reduce=U=>U.reduce((E,N)=>(N.type==="text"&&E.push(N.value),N.type==="range"&&(N.type="text"),E),[]),h.flatten=(...U)=>{const E=[],N=c(L=>{for(let V=0;V<L.length;V++){let K=L[V];Array.isArray(K)?N(K,E):K!==void 0&&E.push(K)}return E},"flat");return N(U),E}},1516:(J,h,U)=>{"use strict";/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const E=U(6529),N=U(2999),L=c(W=>W!==null&&typeof W=="object"&&!Array.isArray(W),"isObject"),V=c(W=>B=>W===!0?Number(B):String(B),"transform"),K=c(W=>typeof W=="number"||typeof W=="string"&&W!=="","isValidValue"),P=c(W=>Number.isInteger(+W),"isNumber"),w=c(W=>{let B=`${W}`,ie=-1;if(B[0]==="-"&&(B=B.slice(1)),B==="0")return!1;for(;B[++ie]==="0";);return ie>0},"zeros"),R=c((W,B,ie)=>typeof W=="string"||typeof B=="string"?!0:ie.stringify===!0,"stringify"),A=c((W,B,ie)=>{if(B>0){let Q=W[0]==="-"?"-":"";Q&&(W=W.slice(1)),W=Q+W.padStart(Q?B-1:B,"0")}return ie===!1?String(W):W},"pad"),S=c((W,B)=>{let ie=W[0]==="-"?"-":"";for(ie&&(W=W.slice(1),B--);W.length<B;)W="0"+W;return ie?"-"+W:W},"toMaxLen"),D=c((W,B)=>{W.negatives.sort((xe,Pe)=>xe<Pe?-1:xe>Pe?1:0),W.positives.sort((xe,Pe)=>xe<Pe?-1:xe>Pe?1:0);let ie=B.capture?"":"?:",Q="",de="",he;return W.positives.length&&(Q=W.positives.join("|")),W.negatives.length&&(de=`-(${ie}${W.negatives.join("|")})`),Q&&de?he=`${Q}|${de}`:he=Q||de,B.wrap?`(${ie}${he})`:he},"toSequence"),j=c((W,B,ie,Q)=>{if(ie)return N(W,B,{wrap:!1,...Q});let de=String.fromCharCode(W);if(W===B)return de;let he=String.fromCharCode(B);return`[${de}-${he}]`},"toRange"),F=c((W,B,ie)=>{if(Array.isArray(W)){let Q=ie.wrap===!0,de=ie.capture?"":"?:";return Q?`(${de}${W.join("|")})`:W.join("|")}return N(W,B,ie)},"toRegex"),X=c((...W)=>new RangeError("Invalid range arguments: "+E.inspect(...W)),"rangeError"),se=c((W,B,ie)=>{if(ie.strictRanges===!0)throw X([W,B]);return[]},"invalidRange"),ye=c((W,B)=>{if(B.strictRanges===!0)throw new TypeError(`Expected step "${W}" to be a number`);return[]},"invalidStep"),z=c((W,B,ie=1,Q={})=>{let de=Number(W),he=Number(B);if(!Number.isInteger(de)||!Number.isInteger(he)){if(Q.strictRanges===!0)throw X([W,B]);return[]}de===0&&(de=0),he===0&&(he=0);let xe=de>he,Pe=String(W),He=String(B),q=String(ie);ie=Math.max(Math.abs(ie),1);let ve=w(Pe)||w(He)||w(q),De=ve?Math.max(Pe.length,He.length,q.length):0,ot=ve===!1&&R(W,B,Q)===!1,je=Q.transform||V(ot);if(Q.toRegex&&ie===1)return j(S(W,De),S(B,De),!0,Q);let Ee={negatives:[],positives:[]},Je=c(Z=>Ee[Z<0?"negatives":"positives"].push(Math.abs(Z)),"push"),ft=[],Ve=0;for(;xe?de>=he:de<=he;)Q.toRegex===!0&&ie>1?Je(de):ft.push(A(je(de,Ve),De,ot)),de=xe?de-ie:de+ie,Ve++;return Q.toRegex===!0?ie>1?D(Ee,Q):F(ft,null,{wrap:!1,...Q}):ft},"fillNumbers"),G=c((W,B,ie=1,Q={})=>{if(!P(W)&&W.length>1||!P(B)&&B.length>1)return se(W,B,Q);let de=Q.transform||(ot=>String.fromCharCode(ot)),he=`${W}`.charCodeAt(0),xe=`${B}`.charCodeAt(0),Pe=he>xe,He=Math.min(he,xe),q=Math.max(he,xe);if(Q.toRegex&&ie===1)return j(He,q,!1,Q);let ve=[],De=0;for(;Pe?he>=xe:he<=xe;)ve.push(de(he,De)),he=Pe?he-ie:he+ie,De++;return Q.toRegex===!0?F(ve,null,{wrap:!1,options:Q}):ve},"fillLetters"),re=c((W,B,ie,Q={})=>{if(B==null&&K(W))return[W];if(!K(W)||!K(B))return se(W,B,Q);if(typeof ie=="function")return re(W,B,1,{transform:ie});if(L(ie))return re(W,B,0,ie);let de={...Q};return de.capture===!0&&(de.wrap=!0),ie=ie||de.step||1,P(ie)?P(W)&&P(B)?z(W,B,ie,de):G(W,B,Math.max(Math.abs(ie),1),de):ie!=null&&!L(ie)?ye(ie,de):re(W,B,1,ie)},"fill");J.exports=re},3338:J=>{"use strict";/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */J.exports=function(h){return typeof h=="number"?h-h==0:typeof h=="string"&&h.trim()!==""?Number.isFinite?Number.isFinite(+h):isFinite(+h):!1}},5179:(J,h,U)=>{J=U.nmd(J);var E=200,N="__lodash_hash_undefined__",L=1,V=2,K=9007199254740991,P="[object Arguments]",w="[object Array]",R="[object AsyncFunction]",A="[object Boolean]",S="[object Date]",D="[object Error]",j="[object Function]",F="[object GeneratorFunction]",X="[object Map]",se="[object Number]",ye="[object Null]",z="[object Object]",G="[object Promise]",re="[object Proxy]",W="[object RegExp]",B="[object Set]",ie="[object String]",Q="[object Symbol]",de="[object Undefined]",he="[object WeakMap]",xe="[object ArrayBuffer]",Pe="[object DataView]",He="[object Float32Array]",q="[object Float64Array]",ve="[object Int8Array]",De="[object Int16Array]",ot="[object Int32Array]",je="[object Uint8Array]",Ee="[object Uint8ClampedArray]",Je="[object Uint16Array]",ft="[object Uint32Array]",Ve=/[\\^$.*+?()[\]{}|]/g,Z=/^\[object .+?Constructor\]$/,vt=/^(?:0|[1-9]\d*)$/,Qe={};Qe[He]=Qe[q]=Qe[ve]=Qe[De]=Qe[ot]=Qe[je]=Qe[Ee]=Qe[Je]=Qe[ft]=!0,Qe[P]=Qe[w]=Qe[xe]=Qe[A]=Qe[Pe]=Qe[S]=Qe[D]=Qe[j]=Qe[X]=Qe[se]=Qe[z]=Qe[W]=Qe[B]=Qe[ie]=Qe[he]=!1;var at=typeof U.g=="object"&&U.g&&U.g.Object===Object&&U.g,we=typeof self=="object"&&self&&self.Object===Object&&self,be=at||we||Function("return this")(),Ge=h&&!h.nodeType&&h,Me=Ge&&!0&&J&&!J.nodeType&&J,Xe=Me&&Me.exports===Ge,Xt=Xe&&at.process,_t=function(){try{return Xt&&Xt.binding&&Xt.binding("util")}catch($){}}(),Tt=_t&&_t.isTypedArray;function jr($,oe){for(var ke=-1,Ze=$==null?0:$.length,Mt=0,pt=[];++ke<Ze;){var Kt=$[ke];oe(Kt,ke,$)&&(pt[Mt++]=Kt)}return pt}c(jr,"arrayFilter");function br($,oe){for(var ke=-1,Ze=oe.length,Mt=$.length;++ke<Ze;)$[Mt+ke]=oe[ke];return $}c(br,"arrayPush");function er($,oe){for(var ke=-1,Ze=$==null?0:$.length;++ke<Ze;)if(oe($[ke],ke,$))return!0;return!1}c(er,"arraySome");function rt($,oe){for(var ke=-1,Ze=Array($);++ke<$;)Ze[ke]=oe(ke);return Ze}c(rt,"baseTimes");function Wt($){return function(oe){return $(oe)}}c(Wt,"baseUnary");function yn($,oe){return $.has(oe)}c(yn,"cacheHas");function fe($,oe){return $==null?void 0:$[oe]}c(fe,"getValue");function st($){var oe=-1,ke=Array($.size);return $.forEach(function(Ze,Mt){ke[++oe]=[Mt,Ze]}),ke}c(st,"mapToArray");function Ce($,oe){return function(ke){return $(oe(ke))}}c(Ce,"overArg");function ut($){var oe=-1,ke=Array($.size);return $.forEach(function(Ze){ke[++oe]=Ze}),ke}c(ut,"setToArray");var Dt=Array.prototype,At=Function.prototype,te=Object.prototype,I=be["__core-js_shared__"],m=At.toString,v=te.hasOwnProperty,M=function(){var $=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||"");return $?"Symbol(src)_1."+$:""}(),ee=te.toString,le=RegExp("^"+m.call(v).replace(Ve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Se=Xe?be.Buffer:void 0,dt=be.Symbol,Ot=be.Uint8Array,Et=te.propertyIsEnumerable,Fe=Dt.splice,wt=dt?dt.toStringTag:void 0,nn=Object.getOwnPropertySymbols,Ru=Se?Se.isBuffer:void 0,Au=Ce(Object.keys,Object),Ga=$n(be,"DataView"),jo=$n(be,"Map"),Vo=$n(be,"Promise"),Go=$n(be,"Set"),Ko=$n(be,"WeakMap"),Nn=$n(Object,"create"),gp=Te(Ga),mp=Te(jo),Qo=Te(Vo),Iu=Te(Go),vp=Te(Ko),Ka=dt?dt.prototype:void 0,xc=Ka?Ka.valueOf:void 0;function Mn($){var oe=-1,ke=$==null?0:$.length;for(this.clear();++oe<ke;){var Ze=$[oe];this.set(Ze[0],Ze[1])}}c(Mn,"Hash");function wp(){this.__data__=Nn?Nn(null):{},this.size=0}c(wp,"hashClear");function Zo($){var oe=this.has($)&&delete this.__data__[$];return this.size-=oe?1:0,oe}c(Zo,"hashDelete");function bn($){var oe=this.__data__;if(Nn){var ke=oe[$];return ke===N?void 0:ke}return v.call(oe,$)?oe[$]:void 0}c(bn,"hashGet");function ku($){var oe=this.__data__;return Nn?oe[$]!==void 0:v.call(oe,$)}c(ku,"hashHas");function Tu($,oe){var ke=this.__data__;return this.size+=this.has($)?0:1,ke[$]=Nn&&oe===void 0?N:oe,this}c(Tu,"hashSet"),Mn.prototype.clear=wp,Mn.prototype.delete=Zo,Mn.prototype.get=bn,Mn.prototype.has=ku,Mn.prototype.set=Tu;function _n($){var oe=-1,ke=$==null?0:$.length;for(this.clear();++oe<ke;){var Ze=$[oe];this.set(Ze[0],Ze[1])}}c(_n,"ListCache");function Qa(){this.__data__=[],this.size=0}c(Qa,"listCacheClear");function Du($){var oe=this.__data__,ke=ao(oe,$);if(ke<0)return!1;var Ze=oe.length-1;return ke==Ze?oe.pop():Fe.call(oe,ke,1),--this.size,!0}c(Du,"listCacheDelete");function Fu($){var oe=this.__data__,ke=ao(oe,$);return ke<0?void 0:oe[ke][1]}c(Fu,"listCacheGet");function Pi($){return ao(this.__data__,$)>-1}c(Pi,"listCacheHas");function yp($,oe){var ke=this.__data__,Ze=ao(ke,$);return Ze<0?(++this.size,ke.push([$,oe])):ke[Ze][1]=oe,this}c(yp,"listCacheSet"),_n.prototype.clear=Qa,_n.prototype.delete=Du,_n.prototype.get=Fu,_n.prototype.has=Pi,_n.prototype.set=yp;function xn($){var oe=-1,ke=$==null?0:$.length;for(this.clear();++oe<ke;){var Ze=$[oe];this.set(Ze[0],Ze[1])}}c(xn,"MapCache");function Xo(){this.size=0,this.__data__={hash:new Mn,map:new(jo||_n),string:new Mn}}c(Xo,"mapCacheClear");function bp($){var oe=so(this,$).delete($);return this.size-=oe?1:0,oe}c(bp,"mapCacheDelete");function oo($){return so(this,$).get($)}c(oo,"mapCacheGet");function Pu($){return so(this,$).has($)}c(Pu,"mapCacheHas");function Sc($,oe){var ke=so(this,$),Ze=ke.size;return ke.set($,oe),this.size+=ke.size==Ze?0:1,this}c(Sc,"mapCacheSet"),xn.prototype.clear=Xo,xn.prototype.delete=bp,xn.prototype.get=oo,xn.prototype.has=Pu,xn.prototype.set=Sc;function Za($){var oe=-1,ke=$==null?0:$.length;for(this.__data__=new xn;++oe<ke;)this.add($[oe])}c(Za,"SetCache");function Cc($){return this.__data__.set($,N),this}c(Cc,"setCacheAdd");function Nu($){return this.__data__.has($)}c(Nu,"setCacheHas"),Za.prototype.add=Za.prototype.push=Cc,Za.prototype.has=Nu;function Ln($){var oe=this.__data__=new _n($);this.size=oe.size}c(Ln,"Stack");function Mu(){this.__data__=new _n,this.size=0}c(Mu,"stackClear");function Lu($){var oe=this.__data__,ke=oe.delete($);return this.size=oe.size,ke}c(Lu,"stackDelete");function Xa($){return this.__data__.get($)}c(Xa,"stackGet");function $u($){return this.__data__.has($)}c($u,"stackHas");function _p($,oe){var ke=this.__data__;if(ke instanceof _n){var Ze=ke.__data__;if(!jo||Ze.length<E-1)return Ze.push([$,oe]),this.size=++ke.size,this;ke=this.__data__=new xn(Ze)}return ke.set($,oe),this.size=ke.size,this}c(_p,"stackSet"),Ln.prototype.clear=Mu,Ln.prototype.delete=Lu,Ln.prototype.get=Xa,Ln.prototype.has=$u,Ln.prototype.set=_p;function Ec($,oe){var ke=cr($),Ze=!ke&&Wu($),Mt=!ke&&!Ze&&rs($),pt=!ke&&!Ze&&!Mt&&Jo($),Kt=ke||Ze||Mt||pt,tr=Kt?rt($.length,String):[],rr=tr.length;for(var jt in $)(oe||v.call($,jt))&&!(Kt&&(jt=="length"||Mt&&(jt=="offset"||jt=="parent")||pt&&(jt=="buffer"||jt=="byteLength"||jt=="byteOffset")||kc(jt,rr)))&&tr.push(jt);return tr}c(Ec,"arrayLikeKeys");function ao($,oe){for(var ke=$.length;ke--;)if(Fc($[ke][0],oe))return ke;return-1}c(ao,"assocIndexOf");function Yo($,oe,ke){var Ze=oe($);return cr($)?Ze:br(Ze,ke($))}c(Yo,"baseGetAllKeys");function Ni($){return $==null?$===void 0?de:ye:wt&&wt in Object($)?xp($):Hu($)}c(Ni,"baseGetTag");function Ya($){return lo($)&&Ni($)==P}c(Ya,"baseIsArguments");function Rc($,oe,ke,Ze,Mt){return $===oe?!0:$==null||oe==null||!lo($)&&!lo(oe)?$!==$&&oe!==oe:Bu($,oe,ke,Ze,Rc,Mt)}c(Rc,"baseIsEqual");function Bu($,oe,ke,Ze,Mt,pt){var Kt=cr($),tr=cr(oe),rr=Kt?w:Bn($),jt=tr?w:Bn(oe);rr=rr==P?z:rr,jt=jt==P?z:jt;var Ar=rr==z,_r=jt==z,lr=rr==jt;if(lr&&rs($)){if(!rs(oe))return!1;Kt=!0,Ar=!1}if(lr&&!Ar)return pt||(pt=new Ln),Kt||Jo($)?es($,oe,ke,Ze,Mt,pt):di($,oe,rr,ke,Ze,Mt,pt);if(!(ke&L)){var Vr=Ar&&v.call($,"__wrapped__"),Gr=_r&&v.call(oe,"__wrapped__");if(Vr||Gr){var Br=Vr?$.value():$,on=Gr?oe.value():oe;return pt||(pt=new Ln),Mt(Br,on,ke,Ze,pt)}}return lr?(pt||(pt=new Ln),Ou($,oe,ke,Ze,Mt,pt)):!1}c(Bu,"baseIsEqualDeep");function Ac($){if(!zu($)||Dc($))return!1;var oe=Pc($)?le:Z;return oe.test(Te($))}c(Ac,"baseIsNative");function Ja($){return lo($)&&is($.length)&&!!Qe[Ni($)]}c(Ja,"baseIsTypedArray");function Ic($){if(!Uu($))return Au($);var oe=[];for(var ke in Object($))v.call($,ke)&&ke!="constructor"&&oe.push(ke);return oe}c(Ic,"baseKeys");function es($,oe,ke,Ze,Mt,pt){var Kt=ke&L,tr=$.length,rr=oe.length;if(tr!=rr&&!(Kt&&rr>tr))return!1;var jt=pt.get($);if(jt&&pt.get(oe))return jt==oe;var Ar=-1,_r=!0,lr=ke&V?new Za:void 0;for(pt.set($,oe),pt.set(oe,$);++Ar<tr;){var Vr=$[Ar],Gr=oe[Ar];if(Ze)var Br=Kt?Ze(Gr,Vr,Ar,oe,$,pt):Ze(Vr,Gr,Ar,$,oe,pt);if(Br!==void 0){if(Br)continue;_r=!1;break}if(lr){if(!er(oe,function(on,Sn){if(!yn(lr,Sn)&&(Vr===on||Mt(Vr,on,ke,Ze,pt)))return lr.push(Sn)})){_r=!1;break}}else if(!(Vr===Gr||Mt(Vr,Gr,ke,Ze,pt))){_r=!1;break}}return pt.delete($),pt.delete(oe),_r}c(es,"equalArrays");function di($,oe,ke,Ze,Mt,pt,Kt){switch(ke){case Pe:if($.byteLength!=oe.byteLength||$.byteOffset!=oe.byteOffset)return!1;$=$.buffer,oe=oe.buffer;case xe:return!($.byteLength!=oe.byteLength||!pt(new Ot($),new Ot(oe)));case A:case S:case se:return Fc(+$,+oe);case D:return $.name==oe.name&&$.message==oe.message;case W:case ie:return $==oe+"";case X:var tr=st;case B:var rr=Ze&L;if(tr||(tr=ut),$.size!=oe.size&&!rr)return!1;var jt=Kt.get($);if(jt)return jt==oe;Ze|=V,Kt.set($,oe);var Ar=es(tr($),tr(oe),Ze,Mt,pt,Kt);return Kt.delete($),Ar;case Q:if(xc)return xc.call($)==xc.call(oe)}return!1}c(di,"equalByTag");function Ou($,oe,ke,Ze,Mt,pt){var Kt=ke&L,tr=ts($),rr=tr.length,jt=ts(oe),Ar=jt.length;if(rr!=Ar&&!Kt)return!1;for(var _r=rr;_r--;){var lr=tr[_r];if(!(Kt?lr in oe:v.call(oe,lr)))return!1}var Vr=pt.get($);if(Vr&&pt.get(oe))return Vr==oe;var Gr=!0;pt.set($,oe),pt.set(oe,$);for(var Br=Kt;++_r<rr;){lr=tr[_r];var on=$[lr],Sn=oe[lr];if(Ze)var os=Kt?Ze(Sn,on,lr,oe,$,pt):Ze(on,Sn,lr,$,oe,pt);if(!(os===void 0?on===Sn||Mt(on,Sn,ke,Ze,pt):os)){Gr=!1;break}Br||(Br=lr=="constructor")}if(Gr&&!Br){var uo=$.constructor,ho=oe.constructor;uo!=ho&&"constructor"in $&&"constructor"in oe&&!(typeof uo=="function"&&uo instanceof uo&&typeof ho=="function"&&ho instanceof ho)&&(Gr=!1)}return pt.delete($),pt.delete(oe),Gr}c(Ou,"equalObjects");function ts($){return Yo($,Cp,Sp)}c(ts,"getAllKeys");function so($,oe){var ke=$.__data__;return Tc(oe)?ke[typeof oe=="string"?"string":"hash"]:ke.map}c(so,"getMapData");function $n($,oe){var ke=fe($,oe);return Ac(ke)?ke:void 0}c($n,"getNative");function xp($){var oe=v.call($,wt),ke=$[wt];try{$[wt]=void 0;var Ze=!0}catch(pt){}var Mt=ee.call($);return Ze&&(oe?$[wt]=ke:delete $[wt]),Mt}c(xp,"getRawTag");var Sp=nn?function($){return $==null?[]:($=Object($),jr(nn($),function(oe){return Et.call($,oe)}))}:qu,Bn=Ni;(Ga&&Bn(new Ga(new ArrayBuffer(1)))!=Pe||jo&&Bn(new jo)!=X||Vo&&Bn(Vo.resolve())!=G||Go&&Bn(new Go)!=B||Ko&&Bn(new Ko)!=he)&&(Bn=c(function($){var oe=Ni($),ke=oe==z?$.constructor:void 0,Ze=ke?Te(ke):"";if(Ze)switch(Ze){case gp:return Pe;case mp:return X;case Qo:return G;case Iu:return B;case vp:return he}return oe},"getTag"));function kc($,oe){return oe=oe==null?K:oe,!!oe&&(typeof $=="number"||vt.test($))&&$>-1&&$%1==0&&$<oe}c(kc,"isIndex");function Tc($){var oe=typeof $;return oe=="string"||oe=="number"||oe=="symbol"||oe=="boolean"?$!=="__proto__":$===null}c(Tc,"isKeyable");function Dc($){return!!M&&M in $}c(Dc,"isMasked");function Uu($){var oe=$&&$.constructor,ke=typeof oe=="function"&&oe.prototype||te;return $===ke}c(Uu,"isPrototype");function Hu($){return ee.call($)}c(Hu,"objectToString");function Te($){if($!=null){try{return m.call($)}catch(oe){}try{return $+""}catch(oe){}}return""}c(Te,"toSource");function Fc($,oe){return $===oe||$!==$&&oe!==oe}c(Fc,"eq");var Wu=Ya(function(){return arguments}())?Ya:function($){return lo($)&&v.call($,"callee")&&!Et.call($,"callee")},cr=Array.isArray;function co($){return $!=null&&is($.length)&&!Pc($)}c(co,"isArrayLike");var rs=Ru||Ep;function ns($,oe){return Rc($,oe)}c(ns,"isEqual");function Pc($){if(!zu($))return!1;var oe=Ni($);return oe==j||oe==F||oe==R||oe==re}c(Pc,"isFunction");function is($){return typeof $=="number"&&$>-1&&$%1==0&&$<=K}c(is,"isLength");function zu($){var oe=typeof $;return $!=null&&(oe=="object"||oe=="function")}c(zu,"isObject");function lo($){return $!=null&&typeof $=="object"}c(lo,"isObjectLike");var Jo=Tt?Wt(Tt):Ja;function Cp($){return co($)?Ec($):Ic($)}c(Cp,"keys");function qu(){return[]}c(qu,"stubArray");function Ep(){return!1}c(Ep,"stubFalse"),J.exports=ns},919:(J,h,U)=>{"use strict";const E=U(6391),N=U(6232),L=U(6796),V=U(292),K=c(w=>w===""||w==="./","isEmptyString"),P=c((w,R,A)=>{R=[].concat(R),w=[].concat(w);let S=new Set,D=new Set,j=new Set,F=0,X=c(z=>{j.add(z.output),A&&A.onResult&&A.onResult(z)},"onResult");for(let z=0;z<R.length;z++){let G=L(String(R[z]),{...A,onResult:X},!0),re=G.state.negated||G.state.negatedExtglob;re&&F++;for(let W of w){let B=G(W,!0);!(re?!B.isMatch:B.isMatch)||(re?S.add(B.output):(S.delete(B.output),D.add(B.output)))}}let ye=(F===R.length?[...j]:[...D]).filter(z=>!S.has(z));if(A&&ye.length===0){if(A.failglob===!0)throw new Error(`No matches found for "${R.join(", ")}"`);if(A.nonull===!0||A.nullglob===!0)return A.unescape?R.map(z=>z.replace(/\\/g,"")):R}return ye},"micromatch");P.match=P,P.matcher=(w,R)=>L(w,R),P.isMatch=(w,R,A)=>L(R,A)(w),P.any=P.isMatch,P.not=(w,R,A={})=>{R=[].concat(R).map(String);let S=new Set,D=[],F=P(w,R,{...A,onResult:c(X=>{A.onResult&&A.onResult(X),D.push(X.output)},"onResult")});for(let X of D)F.includes(X)||S.add(X);return[...S]},P.contains=(w,R,A)=>{if(typeof w!="string")throw new TypeError(`Expected a string: "${E.inspect(w)}"`);if(Array.isArray(R))return R.some(S=>P.contains(w,S,A));if(typeof R=="string"){if(K(w)||K(R))return!1;if(w.includes(R)||w.startsWith("./")&&w.slice(2).includes(R))return!0}return P.isMatch(w,R,{...A,contains:!0})},P.matchKeys=(w,R,A)=>{if(!V.isObject(w))throw new TypeError("Expected the first argument to be an object");let S=P(Object.keys(w),R,A),D={};for(let j of S)D[j]=w[j];return D},P.some=(w,R,A)=>{let S=[].concat(w);for(let D of[].concat(R)){let j=L(String(D),A);if(S.some(F=>j(F)))return!0}return!1},P.every=(w,R,A)=>{let S=[].concat(w);for(let D of[].concat(R)){let j=L(String(D),A);if(!S.every(F=>j(F)))return!1}return!0},P.all=(w,R,A)=>{if(typeof w!="string")throw new TypeError(`Expected a string: "${E.inspect(w)}"`);return[].concat(R).every(S=>L(S,A)(w))},P.capture=(w,R,A)=>{let S=V.isWindows(A),j=L.makeRe(String(w),{...A,capture:!0}).exec(S?V.toPosixSlashes(R):R);if(j)return j.slice(1).map(F=>F===void 0?"":F)},P.makeRe=(...w)=>L.makeRe(...w),P.scan=(...w)=>L.scan(...w),P.parse=(w,R)=>{let A=[];for(let S of[].concat(w||[]))for(let D of N(String(S),R))A.push(L.parse(D,R));return A},P.braces=(w,R)=>{if(typeof w!="string")throw new TypeError("Expected a string");return R&&R.nobrace===!0||!/\{.*\}/.test(w)?[w]:N(w,R)},P.braceExpand=(w,R)=>{if(typeof w!="string")throw new TypeError("Expected a string");return P.braces(w,{...R,expand:!0})},J.exports=P},6796:(J,h,U)=>{"use strict";J.exports=U(5761)},3889:(J,h,U)=>{"use strict";const E=U(6470),N="\\\\/",L=`[^${N}]`,V="\\.",K="\\+",P="\\?",w="\\/",R="(?=.)",A="[^/]",S=`(?:${w}|$)`,D=`(?:^|${w})`,j=`${V}{1,2}${S}`,F=`(?!${V})`,X=`(?!${D}${j})`,se=`(?!${V}{0,1}${S})`,ye=`(?!${j})`,z=`[^.${w}]`,G=`${A}*?`,re={DOT_LITERAL:V,PLUS_LITERAL:K,QMARK_LITERAL:P,SLASH_LITERAL:w,ONE_CHAR:R,QMARK:A,END_ANCHOR:S,DOTS_SLASH:j,NO_DOT:F,NO_DOTS:X,NO_DOT_SLASH:se,NO_DOTS_SLASH:ye,QMARK_NO_DOT:z,STAR:G,START_ANCHOR:D},W={...re,SLASH_LITERAL:`[${N}]`,QMARK:L,STAR:`${L}*?`,DOTS_SLASH:`${V}{1,2}(?:[${N}]|$)`,NO_DOT:`(?!${V})`,NO_DOTS:`(?!(?:^|[${N}])${V}{1,2}(?:[${N}]|$))`,NO_DOT_SLASH:`(?!${V}{0,1}(?:[${N}]|$))`,NO_DOTS_SLASH:`(?!${V}{1,2}(?:[${N}]|$))`,QMARK_NO_DOT:`[^.${N}]`,START_ANCHOR:`(?:^|[${N}])`,END_ANCHOR:`(?:[${N}]|$)`},B={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};J.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:B,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:E.sep,extglobChars(ie){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${ie.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(ie){return ie===!0?W:re}}},3969:(J,h,U)=>{"use strict";const E=U(3889),N=U(292),{MAX_LENGTH:L,POSIX_REGEX_SOURCE:V,REGEX_NON_SPECIAL_CHARS:K,REGEX_SPECIAL_CHARS_BACKREF:P,REPLACEMENTS:w}=E,R=c((D,j)=>{if(typeof j.expandRange=="function")return j.expandRange(...D,j);D.sort();const F=`[${D.join("-")}]`;try{new RegExp(F)}catch(X){return D.map(se=>N.escapeRegex(se)).join("..")}return F},"expandRange"),A=c((D,j)=>`Missing ${D}: "${j}" - use "\\\\${j}" to match literal characters`,"syntaxError"),S=c((D,j)=>{if(typeof D!="string")throw new TypeError("Expected a string");D=w[D]||D;const F={...j},X=typeof F.maxLength=="number"?Math.min(L,F.maxLength):L;let se=D.length;if(se>X)throw new SyntaxError(`Input length: ${se}, exceeds maximum allowed length: ${X}`);const ye={type:"bos",value:"",output:F.prepend||""},z=[ye],G=F.capture?"":"?:",re=N.isWindows(j),W=E.globChars(re),B=E.extglobChars(W),{DOT_LITERAL:ie,PLUS_LITERAL:Q,SLASH_LITERAL:de,ONE_CHAR:he,DOTS_SLASH:xe,NO_DOT:Pe,NO_DOT_SLASH:He,NO_DOTS_SLASH:q,QMARK:ve,QMARK_NO_DOT:De,STAR:ot,START_ANCHOR:je}=W,Ee=c(fe=>`(${G}(?:(?!${je}${fe.dot?xe:ie}).)*?)`,"globstar"),Je=F.dot?"":Pe,ft=F.dot?ve:De;let Ve=F.bash===!0?Ee(F):ot;F.capture&&(Ve=`(${Ve})`),typeof F.noext=="boolean"&&(F.noextglob=F.noext);const Z={input:D,index:-1,start:0,dot:F.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:z};D=N.removePrefix(D,Z),se=D.length;const vt=[],Qe=[],at=[];let we=ye,be;const Ge=c(()=>Z.index===se-1,"eos"),Me=Z.peek=(fe=1)=>D[Z.index+fe],Xe=Z.advance=()=>D[++Z.index]||"",Xt=c(()=>D.slice(Z.index+1),"remaining"),_t=c((fe="",st=0)=>{Z.consumed+=fe,Z.index+=st},"consume"),Tt=c(fe=>{Z.output+=fe.output!=null?fe.output:fe.value,_t(fe.value)},"append"),jr=c(()=>{let fe=1;for(;Me()==="!"&&(Me(2)!=="("||Me(3)==="?");)Xe(),Z.start++,fe++;return fe%2==0?!1:(Z.negated=!0,Z.start++,!0)},"negate"),br=c(fe=>{Z[fe]++,at.push(fe)},"increment"),er=c(fe=>{Z[fe]--,at.pop()},"decrement"),rt=c(fe=>{if(we.type==="globstar"){const st=Z.braces>0&&(fe.type==="comma"||fe.type==="brace"),Ce=fe.extglob===!0||vt.length&&(fe.type==="pipe"||fe.type==="paren");fe.type!=="slash"&&fe.type!=="paren"&&!st&&!Ce&&(Z.output=Z.output.slice(0,-we.output.length),we.type="star",we.value="*",we.output=Ve,Z.output+=we.output)}if(vt.length&&fe.type!=="paren"&&(vt[vt.length-1].inner+=fe.value),(fe.value||fe.output)&&Tt(fe),we&&we.type==="text"&&fe.type==="text"){we.value+=fe.value,we.output=(we.output||"")+fe.value;return}fe.prev=we,z.push(fe),we=fe},"push"),Wt=c((fe,st)=>{const Ce={...B[st],conditions:1,inner:""};Ce.prev=we,Ce.parens=Z.parens,Ce.output=Z.output;const ut=(F.capture?"(":"")+Ce.open;br("parens"),rt({type:fe,value:st,output:Z.output?"":he}),rt({type:"paren",extglob:!0,value:Xe(),output:ut}),vt.push(Ce)},"extglobOpen"),yn=c(fe=>{let st=fe.close+(F.capture?")":""),Ce;if(fe.type==="negate"){let ut=Ve;if(fe.inner&&fe.inner.length>1&&fe.inner.includes("/")&&(ut=Ee(F)),(ut!==Ve||Ge()||/^\)+$/.test(Xt()))&&(st=fe.close=`)$))${ut}`),fe.inner.includes("*")&&(Ce=Xt())&&/^\.[^\\/.]+$/.test(Ce)){const Dt=S(Ce,{...j,fastpaths:!1}).output;st=fe.close=`)${Dt})${ut})`}fe.prev.type==="bos"&&(Z.negatedExtglob=!0)}rt({type:"paren",extglob:!0,value:be,output:st}),er("parens")},"extglobClose");if(F.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(D)){let fe=!1,st=D.replace(P,(Ce,ut,Dt,At,te,I)=>At==="\\"?(fe=!0,Ce):At==="?"?ut?ut+At+(te?ve.repeat(te.length):""):I===0?ft+(te?ve.repeat(te.length):""):ve.repeat(Dt.length):At==="."?ie.repeat(Dt.length):At==="*"?ut?ut+At+(te?Ve:""):Ve:ut?Ce:`\\${Ce}`);return fe===!0&&(F.unescape===!0?st=st.replace(/\\/g,""):st=st.replace(/\\+/g,Ce=>Ce.length%2==0?"\\\\":Ce?"\\":"")),st===D&&F.contains===!0?(Z.output=D,Z):(Z.output=N.wrapOutput(st,Z,j),Z)}for(;!Ge();){if(be=Xe(),be==="\0")continue;if(be==="\\"){const Ce=Me();if(Ce==="/"&&F.bash!==!0||Ce==="."||Ce===";")continue;if(!Ce){be+="\\",rt({type:"text",value:be});continue}const ut=/^\\+/.exec(Xt());let Dt=0;if(ut&&ut[0].length>2&&(Dt=ut[0].length,Z.index+=Dt,Dt%2!=0&&(be+="\\")),F.unescape===!0?be=Xe():be+=Xe(),Z.brackets===0){rt({type:"text",value:be});continue}}if(Z.brackets>0&&(be!=="]"||we.value==="["||we.value==="[^")){if(F.posix!==!1&&be===":"){const Ce=we.value.slice(1);if(Ce.includes("[")&&(we.posix=!0,Ce.includes(":"))){const ut=we.value.lastIndexOf("["),Dt=we.value.slice(0,ut),At=we.value.slice(ut+2),te=V[At];if(te){we.value=Dt+te,Z.backtrack=!0,Xe(),!ye.output&&z.indexOf(we)===1&&(ye.output=he);continue}}}(be==="["&&Me()!==":"||be==="-"&&Me()==="]")&&(be=`\\${be}`),be==="]"&&(we.value==="["||we.value==="[^")&&(be=`\\${be}`),F.posix===!0&&be==="!"&&we.value==="["&&(be="^"),we.value+=be,Tt({value:be});continue}if(Z.quotes===1&&be!=='"'){be=N.escapeRegex(be),we.value+=be,Tt({value:be});continue}if(be==='"'){Z.quotes=Z.quotes===1?0:1,F.keepQuotes===!0&&rt({type:"text",value:be});continue}if(be==="("){br("parens"),rt({type:"paren",value:be});continue}if(be===")"){if(Z.parens===0&&F.strictBrackets===!0)throw new SyntaxError(A("opening","("));const Ce=vt[vt.length-1];if(Ce&&Z.parens===Ce.parens+1){yn(vt.pop());continue}rt({type:"paren",value:be,output:Z.parens?")":"\\)"}),er("parens");continue}if(be==="["){if(F.nobracket===!0||!Xt().includes("]")){if(F.nobracket!==!0&&F.strictBrackets===!0)throw new SyntaxError(A("closing","]"));be=`\\${be}`}else br("brackets");rt({type:"bracket",value:be});continue}if(be==="]"){if(F.nobracket===!0||we&&we.type==="bracket"&&we.value.length===1){rt({type:"text",value:be,output:`\\${be}`});continue}if(Z.brackets===0){if(F.strictBrackets===!0)throw new SyntaxError(A("opening","["));rt({type:"text",value:be,output:`\\${be}`});continue}er("brackets");const Ce=we.value.slice(1);if(we.posix!==!0&&Ce[0]==="^"&&!Ce.includes("/")&&(be=`/${be}`),we.value+=be,Tt({value:be}),F.literalBrackets===!1||N.hasRegexChars(Ce))continue;const ut=N.escapeRegex(we.value);if(Z.output=Z.output.slice(0,-we.value.length),F.literalBrackets===!0){Z.output+=ut,we.value=ut;continue}we.value=`(${G}${ut}|${we.value})`,Z.output+=we.value;continue}if(be==="{"&&F.nobrace!==!0){br("braces");const Ce={type:"brace",value:be,output:"(",outputIndex:Z.output.length,tokensIndex:Z.tokens.length};Qe.push(Ce),rt(Ce);continue}if(be==="}"){const Ce=Qe[Qe.length-1];if(F.nobrace===!0||!Ce){rt({type:"text",value:be,output:be});continue}let ut=")";if(Ce.dots===!0){const Dt=z.slice(),At=[];for(let te=Dt.length-1;te>=0&&(z.pop(),Dt[te].type!=="brace");te--)Dt[te].type!=="dots"&&At.unshift(Dt[te].value);ut=R(At,F),Z.backtrack=!0}if(Ce.comma!==!0&&Ce.dots!==!0){const Dt=Z.output.slice(0,Ce.outputIndex),At=Z.tokens.slice(Ce.tokensIndex);Ce.value=Ce.output="\\{",be=ut="\\}",Z.output=Dt;for(const te of At)Z.output+=te.output||te.value}rt({type:"brace",value:be,output:ut}),er("braces"),Qe.pop();continue}if(be==="|"){vt.length>0&&vt[vt.length-1].conditions++,rt({type:"text",value:be});continue}if(be===","){let Ce=be;const ut=Qe[Qe.length-1];ut&&at[at.length-1]==="braces"&&(ut.comma=!0,Ce="|"),rt({type:"comma",value:be,output:Ce});continue}if(be==="/"){if(we.type==="dot"&&Z.index===Z.start+1){Z.start=Z.index+1,Z.consumed="",Z.output="",z.pop(),we=ye;continue}rt({type:"slash",value:be,output:de});continue}if(be==="."){if(Z.braces>0&&we.type==="dot"){we.value==="."&&(we.output=ie);const Ce=Qe[Qe.length-1];we.type="dots",we.output+=be,we.value+=be,Ce.dots=!0;continue}if(Z.braces+Z.parens===0&&we.type!=="bos"&&we.type!=="slash"){rt({type:"text",value:be,output:ie});continue}rt({type:"dot",value:be,output:ie});continue}if(be==="?"){if(!(we&&we.value==="(")&&F.noextglob!==!0&&Me()==="("&&Me(2)!=="?"){Wt("qmark",be);continue}if(we&&we.type==="paren"){const ut=Me();let Dt=be;if(ut==="<"&&!N.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(we.value==="("&&!/[!=<:]/.test(ut)||ut==="<"&&!/<([!=]|\w+>)/.test(Xt()))&&(Dt=`\\${be}`),rt({type:"text",value:be,output:Dt});continue}if(F.dot!==!0&&(we.type==="slash"||we.type==="bos")){rt({type:"qmark",value:be,output:De});continue}rt({type:"qmark",value:be,output:ve});continue}if(be==="!"){if(F.noextglob!==!0&&Me()==="("&&(Me(2)!=="?"||!/[!=<:]/.test(Me(3)))){Wt("negate",be);continue}if(F.nonegate!==!0&&Z.index===0){jr();continue}}if(be==="+"){if(F.noextglob!==!0&&Me()==="("&&Me(2)!=="?"){Wt("plus",be);continue}if(we&&we.value==="("||F.regex===!1){rt({type:"plus",value:be,output:Q});continue}if(we&&(we.type==="bracket"||we.type==="paren"||we.type==="brace")||Z.parens>0){rt({type:"plus",value:be});continue}rt({type:"plus",value:Q});continue}if(be==="@"){if(F.noextglob!==!0&&Me()==="("&&Me(2)!=="?"){rt({type:"at",extglob:!0,value:be,output:""});continue}rt({type:"text",value:be});continue}if(be!=="*"){(be==="$"||be==="^")&&(be=`\\${be}`);const Ce=K.exec(Xt());Ce&&(be+=Ce[0],Z.index+=Ce[0].length),rt({type:"text",value:be});continue}if(we&&(we.type==="globstar"||we.star===!0)){we.type="star",we.star=!0,we.value+=be,we.output=Ve,Z.backtrack=!0,Z.globstar=!0,_t(be);continue}let fe=Xt();if(F.noextglob!==!0&&/^\([^?]/.test(fe)){Wt("star",be);continue}if(we.type==="star"){if(F.noglobstar===!0){_t(be);continue}const Ce=we.prev,ut=Ce.prev,Dt=Ce.type==="slash"||Ce.type==="bos",At=ut&&(ut.type==="star"||ut.type==="globstar");if(F.bash===!0&&(!Dt||fe[0]&&fe[0]!=="/")){rt({type:"star",value:be,output:""});continue}const te=Z.braces>0&&(Ce.type==="comma"||Ce.type==="brace"),I=vt.length&&(Ce.type==="pipe"||Ce.type==="paren");if(!Dt&&Ce.type!=="paren"&&!te&&!I){rt({type:"star",value:be,output:""});continue}for(;fe.slice(0,3)==="/**";){const m=D[Z.index+4];if(m&&m!=="/")break;fe=fe.slice(3),_t("/**",3)}if(Ce.type==="bos"&&Ge()){we.type="globstar",we.value+=be,we.output=Ee(F),Z.output=we.output,Z.globstar=!0,_t(be);continue}if(Ce.type==="slash"&&Ce.prev.type!=="bos"&&!At&&Ge()){Z.output=Z.output.slice(0,-(Ce.output+we.output).length),Ce.output=`(?:${Ce.output}`,we.type="globstar",we.output=Ee(F)+(F.strictSlashes?")":"|$)"),we.value+=be,Z.globstar=!0,Z.output+=Ce.output+we.output,_t(be);continue}if(Ce.type==="slash"&&Ce.prev.type!=="bos"&&fe[0]==="/"){const m=fe[1]!==void 0?"|$":"";Z.output=Z.output.slice(0,-(Ce.output+we.output).length),Ce.output=`(?:${Ce.output}`,we.type="globstar",we.output=`${Ee(F)}${de}|${de}${m})`,we.value+=be,Z.output+=Ce.output+we.output,Z.globstar=!0,_t(be+Xe()),rt({type:"slash",value:"/",output:""});continue}if(Ce.type==="bos"&&fe[0]==="/"){we.type="globstar",we.value+=be,we.output=`(?:^|${de}|${Ee(F)}${de})`,Z.output=we.output,Z.globstar=!0,_t(be+Xe()),rt({type:"slash",value:"/",output:""});continue}Z.output=Z.output.slice(0,-we.output.length),we.type="globstar",we.output=Ee(F),we.value+=be,Z.output+=we.output,Z.globstar=!0,_t(be);continue}const st={type:"star",value:be,output:Ve};if(F.bash===!0){st.output=".*?",(we.type==="bos"||we.type==="slash")&&(st.output=Je+st.output),rt(st);continue}if(we&&(we.type==="bracket"||we.type==="paren")&&F.regex===!0){st.output=be,rt(st);continue}(Z.index===Z.start||we.type==="slash"||we.type==="dot")&&(we.type==="dot"?(Z.output+=He,we.output+=He):F.dot===!0?(Z.output+=q,we.output+=q):(Z.output+=Je,we.output+=Je),Me()!=="*"&&(Z.output+=he,we.output+=he)),rt(st)}for(;Z.brackets>0;){if(F.strictBrackets===!0)throw new SyntaxError(A("closing","]"));Z.output=N.escapeLast(Z.output,"["),er("brackets")}for(;Z.parens>0;){if(F.strictBrackets===!0)throw new SyntaxError(A("closing",")"));Z.output=N.escapeLast(Z.output,"("),er("parens")}for(;Z.braces>0;){if(F.strictBrackets===!0)throw new SyntaxError(A("closing","}"));Z.output=N.escapeLast(Z.output,"{"),er("braces")}if(F.strictSlashes!==!0&&(we.type==="star"||we.type==="bracket")&&rt({type:"maybe_slash",value:"",output:`${de}?`}),Z.backtrack===!0){Z.output="";for(const fe of Z.tokens)Z.output+=fe.output!=null?fe.output:fe.value,fe.suffix&&(Z.output+=fe.suffix)}return Z},"parse");S.fastpaths=(D,j)=>{const F={...j},X=typeof F.maxLength=="number"?Math.min(L,F.maxLength):L,se=D.length;if(se>X)throw new SyntaxError(`Input length: ${se}, exceeds maximum allowed length: ${X}`);D=w[D]||D;const ye=N.isWindows(j),{DOT_LITERAL:z,SLASH_LITERAL:G,ONE_CHAR:re,DOTS_SLASH:W,NO_DOT:B,NO_DOTS:ie,NO_DOTS_SLASH:Q,STAR:de,START_ANCHOR:he}=E.globChars(ye),xe=F.dot?ie:B,Pe=F.dot?Q:B,He=F.capture?"":"?:",q={negated:!1,prefix:""};let ve=F.bash===!0?".*?":de;F.capture&&(ve=`(${ve})`);const De=c(Je=>Je.noglobstar===!0?ve:`(${He}(?:(?!${he}${Je.dot?W:z}).)*?)`,"globstar"),ot=c(Je=>{switch(Je){case"*":return`${xe}${re}${ve}`;case".*":return`${z}${re}${ve}`;case"*.*":return`${xe}${ve}${z}${re}${ve}`;case"*/*":return`${xe}${ve}${G}${re}${Pe}${ve}`;case"**":return xe+De(F);case"**/*":return`(?:${xe}${De(F)}${G})?${Pe}${re}${ve}`;case"**/*.*":return`(?:${xe}${De(F)}${G})?${Pe}${ve}${z}${re}${ve}`;case"**/.*":return`(?:${xe}${De(F)}${G})?${z}${re}${ve}`;default:{const ft=/^(.*?)\.(\w+)$/.exec(Je);if(!ft)return;const Ve=ot(ft[1]);return Ve?Ve+z+ft[2]:void 0}}},"create"),je=N.removePrefix(D,q);let Ee=ot(je);return Ee&&F.strictSlashes!==!0&&(Ee+=`${G}?`),Ee},J.exports=S},5761:(J,h,U)=>{"use strict";const E=U(6470),N=U(9826),L=U(3969),V=U(292),K=U(3889),P=c(R=>R&&typeof R=="object"&&!Array.isArray(R),"isObject"),w=c((R,A,S=!1)=>{if(Array.isArray(R)){const G=R.map(W=>w(W,A,S));return c(W=>{for(const B of G){const ie=B(W);if(ie)return ie}return!1},"arrayMatcher")}const D=P(R)&&R.tokens&&R.input;if(R===""||typeof R!="string"&&!D)throw new TypeError("Expected pattern to be a non-empty string");const j=A||{},F=V.isWindows(A),X=D?w.compileRe(R,A):w.makeRe(R,A,!1,!0),se=X.state;delete X.state;let ye=c(()=>!1,"isIgnored");if(j.ignore){const G={...A,ignore:null,onMatch:null,onResult:null};ye=w(j.ignore,G,S)}const z=c((G,re=!1)=>{const{isMatch:W,match:B,output:ie}=w.test(G,X,A,{glob:R,posix:F}),Q={glob:R,state:se,regex:X,posix:F,input:G,output:ie,match:B,isMatch:W};return typeof j.onResult=="function"&&j.onResult(Q),W===!1?(Q.isMatch=!1,re?Q:!1):ye(G)?(typeof j.onIgnore=="function"&&j.onIgnore(Q),Q.isMatch=!1,re?Q:!1):(typeof j.onMatch=="function"&&j.onMatch(Q),re?Q:!0)},"matcher");return S&&(z.state=se),z},"picomatch");w.test=(R,A,S,{glob:D,posix:j}={})=>{if(typeof R!="string")throw new TypeError("Expected input to be a string");if(R==="")return{isMatch:!1,output:""};const F=S||{},X=F.format||(j?V.toPosixSlashes:null);let se=R===D,ye=se&&X?X(R):R;return se===!1&&(ye=X?X(R):R,se=ye===D),(se===!1||F.capture===!0)&&(F.matchBase===!0||F.basename===!0?se=w.matchBase(R,A,S,j):se=A.exec(ye)),{isMatch:Boolean(se),match:se,output:ye}},w.matchBase=(R,A,S,D=V.isWindows(S))=>(A instanceof RegExp?A:w.makeRe(A,S)).test(E.basename(R)),w.isMatch=(R,A,S)=>w(A,S)(R),w.parse=(R,A)=>Array.isArray(R)?R.map(S=>w.parse(S,A)):L(R,{...A,fastpaths:!1}),w.scan=(R,A)=>N(R,A),w.compileRe=(R,A,S=!1,D=!1)=>{if(S===!0)return R.output;const j=A||{},F=j.contains?"":"^",X=j.contains?"":"$";let se=`${F}(?:${R.output})${X}`;R&&R.negated===!0&&(se=`^(?!${se}).*$`);const ye=w.toRegex(se,A);return D===!0&&(ye.state=R),ye},w.makeRe=(R,A={},S=!1,D=!1)=>{if(!R||typeof R!="string")throw new TypeError("Expected a non-empty string");let j={negated:!1,fastpaths:!0};return A.fastpaths!==!1&&(R[0]==="."||R[0]==="*")&&(j.output=L.fastpaths(R,A)),j.output||(j=L(R,A)),w.compileRe(j,A,S,D)},w.toRegex=(R,A)=>{try{const S=A||{};return new RegExp(R,S.flags||(S.nocase?"i":""))}catch(S){if(A&&A.debug===!0)throw S;return/$^/}},w.constants=K,J.exports=w},9826:(J,h,U)=>{"use strict";const E=U(292),{CHAR_ASTERISK:N,CHAR_AT:L,CHAR_BACKWARD_SLASH:V,CHAR_COMMA:K,CHAR_DOT:P,CHAR_EXCLAMATION_MARK:w,CHAR_FORWARD_SLASH:R,CHAR_LEFT_CURLY_BRACE:A,CHAR_LEFT_PARENTHESES:S,CHAR_LEFT_SQUARE_BRACKET:D,CHAR_PLUS:j,CHAR_QUESTION_MARK:F,CHAR_RIGHT_CURLY_BRACE:X,CHAR_RIGHT_PARENTHESES:se,CHAR_RIGHT_SQUARE_BRACKET:ye}=U(3889),z=c(W=>W===R||W===V,"isPathSeparator"),G=c(W=>{W.isPrefix!==!0&&(W.depth=W.isGlobstar?1/0:1)},"depth"),re=c((W,B)=>{const ie=B||{},Q=W.length-1,de=ie.parts===!0||ie.scanToEnd===!0,he=[],xe=[],Pe=[];let He=W,q=-1,ve=0,De=0,ot=!1,je=!1,Ee=!1,Je=!1,ft=!1,Ve=!1,Z=!1,vt=!1,Qe=!1,at=!1,we=0,be,Ge,Me={value:"",depth:0,isGlob:!1};const Xe=c(()=>q>=Q,"eos"),Xt=c(()=>He.charCodeAt(q+1),"peek"),_t=c(()=>(be=Ge,He.charCodeAt(++q)),"advance");for(;q<Q;){Ge=_t();let rt;if(Ge===V){Z=Me.backslashes=!0,Ge=_t(),Ge===A&&(Ve=!0);continue}if(Ve===!0||Ge===A){for(we++;Xe()!==!0&&(Ge=_t());){if(Ge===V){Z=Me.backslashes=!0,_t();continue}if(Ge===A){we++;continue}if(Ve!==!0&&Ge===P&&(Ge=_t())===P){if(ot=Me.isBrace=!0,Ee=Me.isGlob=!0,at=!0,de===!0)continue;break}if(Ve!==!0&&Ge===K){if(ot=Me.isBrace=!0,Ee=Me.isGlob=!0,at=!0,de===!0)continue;break}if(Ge===X&&(we--,we===0)){Ve=!1,ot=Me.isBrace=!0,at=!0;break}}if(de===!0)continue;break}if(Ge===R){if(he.push(q),xe.push(Me),Me={value:"",depth:0,isGlob:!1},at===!0)continue;if(be===P&&q===ve+1){ve+=2;continue}De=q+1;continue}if(ie.noext!==!0&&(Ge===j||Ge===L||Ge===N||Ge===F||Ge===w)===!0&&Xt()===S){if(Ee=Me.isGlob=!0,Je=Me.isExtglob=!0,at=!0,Ge===w&&q===ve&&(Qe=!0),de===!0){for(;Xe()!==!0&&(Ge=_t());){if(Ge===V){Z=Me.backslashes=!0,Ge=_t();continue}if(Ge===se){Ee=Me.isGlob=!0,at=!0;break}}continue}break}if(Ge===N){if(be===N&&(ft=Me.isGlobstar=!0),Ee=Me.isGlob=!0,at=!0,de===!0)continue;break}if(Ge===F){if(Ee=Me.isGlob=!0,at=!0,de===!0)continue;break}if(Ge===D){for(;Xe()!==!0&&(rt=_t());){if(rt===V){Z=Me.backslashes=!0,_t();continue}if(rt===ye){je=Me.isBracket=!0,Ee=Me.isGlob=!0,at=!0;break}}if(de===!0)continue;break}if(ie.nonegate!==!0&&Ge===w&&q===ve){vt=Me.negated=!0,ve++;continue}if(ie.noparen!==!0&&Ge===S){if(Ee=Me.isGlob=!0,de===!0){for(;Xe()!==!0&&(Ge=_t());){if(Ge===S){Z=Me.backslashes=!0,Ge=_t();continue}if(Ge===se){at=!0;break}}continue}break}if(Ee===!0){if(at=!0,de===!0)continue;break}}ie.noext===!0&&(Je=!1,Ee=!1);let Tt=He,jr="",br="";ve>0&&(jr=He.slice(0,ve),He=He.slice(ve),De-=ve),Tt&&Ee===!0&&De>0?(Tt=He.slice(0,De),br=He.slice(De)):Ee===!0?(Tt="",br=He):Tt=He,Tt&&Tt!==""&&Tt!=="/"&&Tt!==He&&z(Tt.charCodeAt(Tt.length-1))&&(Tt=Tt.slice(0,-1)),ie.unescape===!0&&(br&&(br=E.removeBackslashes(br)),Tt&&Z===!0&&(Tt=E.removeBackslashes(Tt)));const er={prefix:jr,input:W,start:ve,base:Tt,glob:br,isBrace:ot,isBracket:je,isGlob:Ee,isExtglob:Je,isGlobstar:ft,negated:vt,negatedExtglob:Qe};if(ie.tokens===!0&&(er.maxDepth=0,z(Ge)||xe.push(Me),er.tokens=xe),ie.parts===!0||ie.tokens===!0){let rt;for(let Wt=0;Wt<he.length;Wt++){const yn=rt?rt+1:ve,fe=he[Wt],st=W.slice(yn,fe);ie.tokens&&(Wt===0&&ve!==0?(xe[Wt].isPrefix=!0,xe[Wt].value=jr):xe[Wt].value=st,G(xe[Wt]),er.maxDepth+=xe[Wt].depth),(Wt!==0||st!=="")&&Pe.push(st),rt=fe}if(rt&&rt+1<W.length){const Wt=W.slice(rt+1);Pe.push(Wt),ie.tokens&&(xe[xe.length-1].value=Wt,G(xe[xe.length-1]),er.maxDepth+=xe[xe.length-1].depth)}er.slashes=he,er.parts=Pe}return er},"scan");J.exports=re},292:(J,h,U)=>{"use strict";var E=U(6038);const N=U(6470),L=E.platform==="win32",{REGEX_BACKSLASH:V,REGEX_REMOVE_BACKSLASH:K,REGEX_SPECIAL_CHARS:P,REGEX_SPECIAL_CHARS_GLOBAL:w}=U(3889);h.isObject=R=>R!==null&&typeof R=="object"&&!Array.isArray(R),h.hasRegexChars=R=>P.test(R),h.isRegexChar=R=>R.length===1&&h.hasRegexChars(R),h.escapeRegex=R=>R.replace(w,"\\$1"),h.toPosixSlashes=R=>R.replace(V,"/"),h.removeBackslashes=R=>R.replace(K,A=>A==="\\"?"":A),h.supportsLookbehinds=()=>{const R=E.version.slice(1).split(".").map(Number);return R.length===3&&R[0]>=9||R[0]===8&&R[1]>=10},h.isWindows=R=>R&&typeof R.windows=="boolean"?R.windows:L===!0||N.sep==="\\",h.escapeLast=(R,A,S)=>{const D=R.lastIndexOf(A,S);return D===-1?R:R[D-1]==="\\"?h.escapeLast(R,A,D-1):`${R.slice(0,D)}\\${R.slice(D)}`},h.removePrefix=(R,A={})=>{let S=R;return S.startsWith("./")&&(S=S.slice(2),A.prefix="./"),S},h.wrapOutput=(R,A={},S={})=>{const D=S.contains?"":"^",j=S.contains?"":"$";let F=`${D}(?:${R})${j}`;return A.negated===!0&&(F=`(?:^(?!${F}).*$)`),F}},6038:J=>{var h=J.exports={},U,E;function N(){throw new Error("setTimeout has not been defined")}c(N,"defaultSetTimout");function L(){throw new Error("clearTimeout has not been defined")}c(L,"defaultClearTimeout"),function(){try{typeof setTimeout=="function"?U=setTimeout:U=N}catch(X){U=N}try{typeof clearTimeout=="function"?E=clearTimeout:E=L}catch(X){E=L}}();function V(X){if(U===setTimeout)return setTimeout(X,0);if((U===N||!U)&&setTimeout)return U=setTimeout,setTimeout(X,0);try{return U(X,0)}catch(se){try{return U.call(null,X,0)}catch(ye){return U.call(this,X,0)}}}c(V,"runTimeout");function K(X){if(E===clearTimeout)return clearTimeout(X);if((E===L||!E)&&clearTimeout)return E=clearTimeout,clearTimeout(X);try{return E(X)}catch(se){try{return E.call(null,X)}catch(ye){return E.call(this,X)}}}c(K,"runClearTimeout");var P=[],w=!1,R,A=-1;function S(){!w||!R||(w=!1,R.length?P=R.concat(P):A=-1,P.length&&D())}c(S,"cleanUpNextTick");function D(){if(!w){var X=V(S);w=!0;for(var se=P.length;se;){for(R=P,P=[];++A<se;)R&&R[A].run();A=-1,se=P.length}R=null,w=!1,K(X)}}c(D,"drainQueue"),h.nextTick=function(X){var se=new Array(arguments.length-1);if(arguments.length>1)for(var ye=1;ye<arguments.length;ye++)se[ye-1]=arguments[ye];P.push(new j(X,se)),P.length===1&&!w&&V(D)};function j(X,se){this.fun=X,this.array=se}c(j,"Item"),j.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={};function F(){}c(F,"noop"),h.on=F,h.addListener=F,h.once=F,h.off=F,h.removeListener=F,h.removeAllListeners=F,h.emit=F,h.prependListener=F,h.prependOnceListener=F,h.listeners=function(X){return[]},h.binding=function(X){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(X){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},5431:(J,h,U)=>{"use strict";J.exports=U(7905)},7905:(J,h,U)=>{"use strict";var E=U(1417);function N(){return!0}c(N,"_toTrue");function L(){return!1}c(L,"_toFalse");function V(se){return se.then(N,L)}c(V,"pSuccess");function K(se){return se}c(K,"_pass");function P(se){throw se}c(P,"_throw");function w(se){return se.then(K,P)}c(w,"ensurePromise");function R(se,ye){return{result:se,args:ye,expire_id:0,prefetch_id:0,need_prefetch:!1}}c(R,"createCacheObj");function A(se,ye){!se[ye]||(clearTimeout(se[ye].expire_id),clearTimeout(se[ye].prefetch_id),delete se[ye])}c(A,"destroyCacheObj");function S(se,ye){!se[ye]||(se[ye].need_prefetch=!0)}c(S,"askPrefetch");function D(se){var ye=se[0],z=se[1],G=se[2],re=se[3];if(!!z[G]){if(ye){if(!re.maxAge)return;z[G].expire_id=setTimeout(A,re.maxAge,z,G),z[G].prefetch_id=setTimeout(S,re.maxAge*.7,z,G),z[G].expire_id.unref&&z[G].expire_id.unref(),z[G].prefetch_id.unref&&z[G].prefetch_id.unref();return}if(!re.maxErrorAge){A(z,G);return}z[G].expire_id=setTimeout(A,re.maxErrorAge,z,G),z[G].expire_id.unref&&z[G].expire_id.unref()}}c(D,"_track_proceed");function j(se,ye,z){var G=se[ye].result.constructor;G.all([V(se[ye].result),se,ye,z]).then(D)}c(j,"trackCacheObj");function F(se){var ye=se[0],z=se[1],G=se[2],re=se[3],W=se[4][0];!z[G]||!ye||(z[G].result=W,clearTimeout(z[G].expire_id),j(z,G,re))}c(F,"_prefetch_proceed");function X(se,ye,z){var G=w(z.fn.apply(null,se[ye].args)),re=G.constructor;se[ye].need_prefetch=!1,re.all([V(G),se,ye,z,[G]]).then(F)}c(X,"doPrefetch"),J.exports=c(function(ye,z){var G={},re=z||{},W=E(re.resolve),B={fn:ye,maxAge:re.maxAge||0,maxErrorAge:re.maxErrorAge||0};function ie(){for(var Q=new Array(arguments.length),de=0;de<Q.length;de++)Q[de]=arguments[de];var he=W(Q);return G[he]?G[he].need_prefetch&&X(G,he,B):(G[he]=R(w(B.fn.apply(null,Q)),B.maxAge||B.maxErrorAge?Q:null),j(G,he,B)),G[he].result}return c(ie,"memoizedFn"),ie.clear=function(){var Q=Object.keys(G);return Q.forEach(function(de){A(G,de)}),Q.length},ie},"promiseMemoize")},1417:J=>{"use strict";var h={simple:function(E){return E.length?E.join(""):""},json:function(E){if(!E.length)return"";for(var N=[],L=E.length-1;L>=0;L--)N.push(JSON.stringify(E[L]));return N.join("")}};function U(E){return E.forEach(function(N){if(typeof N=="string"&&!h.hasOwnProperty(N))throw new Error('promise-memoize: unknown value "'+N+'" in resolve option')}),function(N){var L=Math.min(E.length,N.length);if(!L)return"";for(var V=[],K=0;K<L;K++)typeof E[K]=="string"?V.push(h[E[K]]([N[K]])):V.push(E[K](N[K]));return V.join("")}}c(U,"createFlexResolver"),J.exports=c(function(N){if(typeof N=="undefined")return h.simple;if(typeof N=="string"&&h.hasOwnProperty(N))return h[N];if(Array.isArray(N))return U(N);if(Object.prototype.toString.call(N)==="[object Function]")return N;throw new Error("promise-memoize: invalid resolve option")},"createResolver")},2999:(J,h,U)=>{"use strict";/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const E=U(3338),N=c((z,G,re)=>{if(E(z)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(G===void 0||z===G)return String(z);if(E(G)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let W={relaxZeros:!0,...re};typeof W.strictZeros=="boolean"&&(W.relaxZeros=W.strictZeros===!1);let B=String(W.relaxZeros),ie=String(W.shorthand),Q=String(W.capture),de=String(W.wrap),he=z+":"+G+"="+B+ie+Q+de;if(N.cache.hasOwnProperty(he))return N.cache[he].result;let xe=Math.min(z,G),Pe=Math.max(z,G);if(Math.abs(xe-Pe)===1){let ot=z+"|"+G;return W.capture?`(${ot})`:W.wrap===!1?ot:`(?:${ot})`}let He=se(z)||se(G),q={min:z,max:G,a:xe,b:Pe},ve=[],De=[];if(He&&(q.isPadded=He,q.maxLen=String(q.max).length),xe<0){let ot=Pe<0?Math.abs(Pe):1;De=P(ot,Math.abs(xe),q,W),xe=q.a=0}return Pe>=0&&(ve=P(xe,Pe,q,W)),q.negatives=De,q.positives=ve,q.result=L(De,ve,W),W.capture===!0?q.result=`(${q.result})`:W.wrap!==!1&&ve.length+De.length>1&&(q.result=`(?:${q.result})`),N.cache[he]=q,q.result},"toRegexRange");function L(z,G,re){let W=w(z,G,"-",!1,re)||[],B=w(G,z,"",!1,re)||[],ie=w(z,G,"-?",!0,re)||[];return W.concat(ie).concat(B).join("|")}c(L,"collatePatterns");function V(z,G){let re=1,W=1,B=D(z,re),ie=new Set([G]);for(;z<=B&&B<=G;)ie.add(B),re+=1,B=D(z,re);for(B=j(G+1,W)-1;z<B&&B<=G;)ie.add(B),W+=1,B=j(G+1,W)-1;return ie=[...ie],ie.sort(A),ie}c(V,"splitToRanges");function K(z,G,re){if(z===G)return{pattern:z,count:[],digits:0};let W=R(z,G),B=W.length,ie="",Q=0;for(let de=0;de<B;de++){let[he,xe]=W[de];he===xe?ie+=he:he!=="0"||xe!=="9"?ie+=X(he,xe,re):Q++}return Q&&(ie+=re.shorthand===!0?"\\d":"[0-9]"),{pattern:ie,count:[Q],digits:B}}c(K,"rangeToPattern");function P(z,G,re,W){let B=V(z,G),ie=[],Q=z,de;for(let he=0;he<B.length;he++){let xe=B[he],Pe=K(String(Q),String(xe),W),He="";if(!re.isPadded&&de&&de.pattern===Pe.pattern){de.count.length>1&&de.count.pop(),de.count.push(Pe.count[0]),de.string=de.pattern+F(de.count),Q=xe+1;continue}re.isPadded&&(He=ye(xe,re,W)),Pe.string=He+Pe.pattern+F(Pe.count),ie.push(Pe),Q=xe+1,de=Pe}return ie}c(P,"splitToPatterns");function w(z,G,re,W,B){let ie=[];for(let Q of z){let{string:de}=Q;!W&&!S(G,"string",de)&&ie.push(re+de),W&&S(G,"string",de)&&ie.push(re+de)}return ie}c(w,"filterPatterns");function R(z,G){let re=[];for(let W=0;W<z.length;W++)re.push([z[W],G[W]]);return re}c(R,"zip");function A(z,G){return z>G?1:G>z?-1:0}c(A,"compare");function S(z,G,re){return z.some(W=>W[G]===re)}c(S,"contains");function D(z,G){return Number(String(z).slice(0,-G)+"9".repeat(G))}c(D,"countNines");function j(z,G){return z-z%Math.pow(10,G)}c(j,"countZeros");function F(z){let[G=0,re=""]=z;return re||G>1?`{${G+(re?","+re:"")}}`:""}c(F,"toQuantifier");function X(z,G,re){return`[${z}${G-z==1?"":"-"}${G}]`}c(X,"toCharacterClass");function se(z){return/^-?(0+)\d/.test(z)}c(se,"hasPadding");function ye(z,G,re){if(!G.isPadded)return z;let W=Math.abs(G.maxLen-String(z).length),B=re.relaxZeros!==!1;switch(W){case 0:return"";case 1:return B?"0?":"0";case 2:return B?"0{0,2}":"00";default:return B?`0{0,${W}}`:`0{${W}}`}}c(ye,"padZeros"),N.cache={},N.clearCache=()=>N.cache={},J.exports=N},9742:(J,h)=>{"use strict";h.byteLength=w,h.toByteArray=A,h.fromByteArray=j;for(var U=[],E=[],N=typeof Uint8Array!="undefined"?Uint8Array:Array,L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",V=0,K=L.length;V<K;++V)U[V]=L[V],E[L.charCodeAt(V)]=V;E["-".charCodeAt(0)]=62,E["_".charCodeAt(0)]=63;function P(F){var X=F.length;if(X%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var se=F.indexOf("=");se===-1&&(se=X);var ye=se===X?0:4-se%4;return[se,ye]}c(P,"getLens");function w(F){var X=P(F),se=X[0],ye=X[1];return(se+ye)*3/4-ye}c(w,"byteLength");function R(F,X,se){return(X+se)*3/4-se}c(R,"_byteLength");function A(F){var X,se=P(F),ye=se[0],z=se[1],G=new N(R(F,ye,z)),re=0,W=z>0?ye-4:ye,B;for(B=0;B<W;B+=4)X=E[F.charCodeAt(B)]<<18|E[F.charCodeAt(B+1)]<<12|E[F.charCodeAt(B+2)]<<6|E[F.charCodeAt(B+3)],G[re++]=X>>16&255,G[re++]=X>>8&255,G[re++]=X&255;return z===2&&(X=E[F.charCodeAt(B)]<<2|E[F.charCodeAt(B+1)]>>4,G[re++]=X&255),z===1&&(X=E[F.charCodeAt(B)]<<10|E[F.charCodeAt(B+1)]<<4|E[F.charCodeAt(B+2)]>>2,G[re++]=X>>8&255,G[re++]=X&255),G}c(A,"toByteArray");function S(F){return U[F>>18&63]+U[F>>12&63]+U[F>>6&63]+U[F&63]}c(S,"tripletToBase64");function D(F,X,se){for(var ye,z=[],G=X;G<se;G+=3)ye=(F[G]<<16&16711680)+(F[G+1]<<8&65280)+(F[G+2]&255),z.push(S(ye));return z.join("")}c(D,"encodeChunk");function j(F){for(var X,se=F.length,ye=se%3,z=[],G=16383,re=0,W=se-ye;re<W;re+=G)z.push(D(F,re,re+G>W?W:re+G));return ye===1?(X=F[se-1],z.push(U[X>>2]+U[X<<4&63]+"==")):ye===2&&(X=(F[se-2]<<8)+F[se-1],z.push(U[X>>10]+U[X>>4&63]+U[X<<2&63]+"=")),z.join("")}c(j,"fromByteArray")},5186:(J,h,U)=>{var E=U(3698),N=U(2505),L=U(6417),V=Function.bind,K=V.bind(V);function P(D,j,F){var X=K(L,null).apply(null,F?[j,F]:[j]);D.api={remove:X},D.remove=X,["before","error","after","wrap"].forEach(function(se){var ye=F?[j,se,F]:[j,se];D[se]=D.api[se]=K(N,null).apply(null,ye)})}c(P,"bindApi");function w(){var D="h",j={registry:{}},F=E.bind(null,j,D);return P(F,j,D),F}c(w,"HookSingular");function R(){var D={registry:{}},j=E.bind(null,D);return P(j,D),j}c(R,"HookCollection");var A=!1;function S(){return A||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),A=!0),R()}c(S,"Hook"),S.Singular=w.bind(),S.Collection=R.bind(),J.exports=S,J.exports.Hook=S,J.exports.Singular=S.Singular,J.exports.Collection=S.Collection},2505:J=>{J.exports=h;function h(U,E,N,L){var V=L;U.registry[N]||(U.registry[N]=[]),E==="before"&&(L=c(function(K,P){return Promise.resolve().then(V.bind(null,P)).then(K.bind(null,P))},"hook")),E==="after"&&(L=c(function(K,P){var w;return Promise.resolve().then(K.bind(null,P)).then(function(R){return w=R,V(w,P)}).then(function(){return w})},"hook")),E==="error"&&(L=c(function(K,P){return Promise.resolve().then(K.bind(null,P)).catch(function(w){return V(w,P)})},"hook")),U.registry[N].push({hook:L,orig:V})}c(h,"addHook")},3698:J=>{J.exports=h;function h(U,E,N,L){if(typeof N!="function")throw new Error("method for before hook must be a function");return L||(L={}),Array.isArray(E)?E.reverse().reduce(function(V,K){return h.bind(null,U,K,V,L)},N)():Promise.resolve().then(function(){return U.registry[E]?U.registry[E].reduce(function(V,K){return K.hook.bind(null,V,L)},N)():N(L)})}c(h,"register")},6417:J=>{J.exports=h;function h(U,E,N){if(!!U.registry[E]){var L=U.registry[E].map(function(V){return V.orig}).indexOf(N);L!==-1&&U.registry[E].splice(L,1)}}c(h,"removeHook")},8764:(J,h,U)=>{"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const E=U(9742),N=U(645),L=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;h.Buffer=w,h.SlowBuffer=G,h.INSPECT_MAX_BYTES=50;const V=2147483647;h.kMaxLength=V,w.TYPED_ARRAY_SUPPORT=K(),!w.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function K(){try{const I=new Uint8Array(1),m={foo:function(){return 42}};return Object.setPrototypeOf(m,Uint8Array.prototype),Object.setPrototypeOf(I,m),I.foo()===42}catch(I){return!1}}c(K,"typedArraySupport"),Object.defineProperty(w.prototype,"parent",{enumerable:!0,get:function(){if(!!w.isBuffer(this))return this.buffer}}),Object.defineProperty(w.prototype,"offset",{enumerable:!0,get:function(){if(!!w.isBuffer(this))return this.byteOffset}});function P(I){if(I>V)throw new RangeError('The value "'+I+'" is invalid for option "size"');const m=new Uint8Array(I);return Object.setPrototypeOf(m,w.prototype),m}c(P,"createBuffer");function w(I,m,v){if(typeof I=="number"){if(typeof m=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return D(I)}return R(I,m,v)}c(w,"Buffer"),w.poolSize=8192;function R(I,m,v){if(typeof I=="string")return j(I,m);if(ArrayBuffer.isView(I))return X(I);if(I==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I);if(Ce(I,ArrayBuffer)||I&&Ce(I.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Ce(I,SharedArrayBuffer)||I&&Ce(I.buffer,SharedArrayBuffer)))return se(I,m,v);if(typeof I=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const M=I.valueOf&&I.valueOf();if(M!=null&&M!==I)return w.from(M,m,v);const ee=ye(I);if(ee)return ee;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof I[Symbol.toPrimitive]=="function")return w.from(I[Symbol.toPrimitive]("string"),m,v);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof I)}c(R,"from"),w.from=function(I,m,v){return R(I,m,v)},Object.setPrototypeOf(w.prototype,Uint8Array.prototype),Object.setPrototypeOf(w,Uint8Array);function A(I){if(typeof I!="number")throw new TypeError('"size" argument must be of type number');if(I<0)throw new RangeError('The value "'+I+'" is invalid for option "size"')}c(A,"assertSize");function S(I,m,v){return A(I),I<=0?P(I):m!==void 0?typeof v=="string"?P(I).fill(m,v):P(I).fill(m):P(I)}c(S,"alloc"),w.alloc=function(I,m,v){return S(I,m,v)};function D(I){return A(I),P(I<0?0:z(I)|0)}c(D,"allocUnsafe"),w.allocUnsafe=function(I){return D(I)},w.allocUnsafeSlow=function(I){return D(I)};function j(I,m){if((typeof m!="string"||m==="")&&(m="utf8"),!w.isEncoding(m))throw new TypeError("Unknown encoding: "+m);const v=re(I,m)|0;let M=P(v);const ee=M.write(I,m);return ee!==v&&(M=M.slice(0,ee)),M}c(j,"fromString");function F(I){const m=I.length<0?0:z(I.length)|0,v=P(m);for(let M=0;M<m;M+=1)v[M]=I[M]&255;return v}c(F,"fromArrayLike");function X(I){if(Ce(I,Uint8Array)){const m=new Uint8Array(I);return se(m.buffer,m.byteOffset,m.byteLength)}return F(I)}c(X,"fromArrayView");function se(I,m,v){if(m<0||I.byteLength<m)throw new RangeError('"offset" is outside of buffer bounds');if(I.byteLength<m+(v||0))throw new RangeError('"length" is outside of buffer bounds');let M;return m===void 0&&v===void 0?M=new Uint8Array(I):v===void 0?M=new Uint8Array(I,m):M=new Uint8Array(I,m,v),Object.setPrototypeOf(M,w.prototype),M}c(se,"fromArrayBuffer");function ye(I){if(w.isBuffer(I)){const m=z(I.length)|0,v=P(m);return v.length===0||I.copy(v,0,0,m),v}if(I.length!==void 0)return typeof I.length!="number"||ut(I.length)?P(0):F(I);if(I.type==="Buffer"&&Array.isArray(I.data))return F(I.data)}c(ye,"fromObject");function z(I){if(I>=V)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+V.toString(16)+" bytes");return I|0}c(z,"checked");function G(I){return+I!=I&&(I=0),w.alloc(+I)}c(G,"SlowBuffer"),w.isBuffer=c(function(m){return m!=null&&m._isBuffer===!0&&m!==w.prototype},"isBuffer"),w.compare=c(function(m,v){if(Ce(m,Uint8Array)&&(m=w.from(m,m.offset,m.byteLength)),Ce(v,Uint8Array)&&(v=w.from(v,v.offset,v.byteLength)),!w.isBuffer(m)||!w.isBuffer(v))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(m===v)return 0;let M=m.length,ee=v.length;for(let le=0,Se=Math.min(M,ee);le<Se;++le)if(m[le]!==v[le]){M=m[le],ee=v[le];break}return M<ee?-1:ee<M?1:0},"compare"),w.isEncoding=c(function(m){switch(String(m).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),w.concat=c(function(m,v){if(!Array.isArray(m))throw new TypeError('"list" argument must be an Array of Buffers');if(m.length===0)return w.alloc(0);let M;if(v===void 0)for(v=0,M=0;M<m.length;++M)v+=m[M].length;const ee=w.allocUnsafe(v);let le=0;for(M=0;M<m.length;++M){let Se=m[M];if(Ce(Se,Uint8Array))le+Se.length>ee.length?(w.isBuffer(Se)||(Se=w.from(Se)),Se.copy(ee,le)):Uint8Array.prototype.set.call(ee,Se,le);else if(w.isBuffer(Se))Se.copy(ee,le);else throw new TypeError('"list" argument must be an Array of Buffers');le+=Se.length}return ee},"concat");function re(I,m){if(w.isBuffer(I))return I.length;if(ArrayBuffer.isView(I)||Ce(I,ArrayBuffer))return I.byteLength;if(typeof I!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof I);const v=I.length,M=arguments.length>2&&arguments[2]===!0;if(!M&&v===0)return 0;let ee=!1;for(;;)switch(m){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":return rt(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v*2;case"hex":return v>>>1;case"base64":return fe(I).length;default:if(ee)return M?-1:rt(I).length;m=(""+m).toLowerCase(),ee=!0}}c(re,"byteLength"),w.byteLength=re;function W(I,m,v){let M=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0,m>>>=0,v<=m))return"";for(I||(I="utf8");;)switch(I){case"hex":return Je(this,m,v);case"utf8":case"utf-8":return ve(this,m,v);case"ascii":return je(this,m,v);case"latin1":case"binary":return Ee(this,m,v);case"base64":return q(this,m,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ft(this,m,v);default:if(M)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),M=!0}}c(W,"slowToString"),w.prototype._isBuffer=!0;function B(I,m,v){const M=I[m];I[m]=I[v],I[v]=M}c(B,"swap"),w.prototype.swap16=c(function(){const m=this.length;if(m%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let v=0;v<m;v+=2)B(this,v,v+1);return this},"swap16"),w.prototype.swap32=c(function(){const m=this.length;if(m%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let v=0;v<m;v+=4)B(this,v,v+3),B(this,v+1,v+2);return this},"swap32"),w.prototype.swap64=c(function(){const m=this.length;if(m%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let v=0;v<m;v+=8)B(this,v,v+7),B(this,v+1,v+6),B(this,v+2,v+5),B(this,v+3,v+4);return this},"swap64"),w.prototype.toString=c(function(){const m=this.length;return m===0?"":arguments.length===0?ve(this,0,m):W.apply(this,arguments)},"toString"),w.prototype.toLocaleString=w.prototype.toString,w.prototype.equals=c(function(m){if(!w.isBuffer(m))throw new TypeError("Argument must be a Buffer");return this===m?!0:w.compare(this,m)===0},"equals"),w.prototype.inspect=c(function(){let m="";const v=h.INSPECT_MAX_BYTES;return m=this.toString("hex",0,v).replace(/(.{2})/g,"$1 ").trim(),this.length>v&&(m+=" ... "),"<Buffer "+m+">"},"inspect"),L&&(w.prototype[L]=w.prototype.inspect),w.prototype.compare=c(function(m,v,M,ee,le){if(Ce(m,Uint8Array)&&(m=w.from(m,m.offset,m.byteLength)),!w.isBuffer(m))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof m);if(v===void 0&&(v=0),M===void 0&&(M=m?m.length:0),ee===void 0&&(ee=0),le===void 0&&(le=this.length),v<0||M>m.length||ee<0||le>this.length)throw new RangeError("out of range index");if(ee>=le&&v>=M)return 0;if(ee>=le)return-1;if(v>=M)return 1;if(v>>>=0,M>>>=0,ee>>>=0,le>>>=0,this===m)return 0;let Se=le-ee,dt=M-v;const Ot=Math.min(Se,dt),Et=this.slice(ee,le),Fe=m.slice(v,M);for(let wt=0;wt<Ot;++wt)if(Et[wt]!==Fe[wt]){Se=Et[wt],dt=Fe[wt];break}return Se<dt?-1:dt<Se?1:0},"compare");function ie(I,m,v,M,ee){if(I.length===0)return-1;if(typeof v=="string"?(M=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),v=+v,ut(v)&&(v=ee?0:I.length-1),v<0&&(v=I.length+v),v>=I.length){if(ee)return-1;v=I.length-1}else if(v<0)if(ee)v=0;else return-1;if(typeof m=="string"&&(m=w.from(m,M)),w.isBuffer(m))return m.length===0?-1:Q(I,m,v,M,ee);if(typeof m=="number")return m=m&255,typeof Uint8Array.prototype.indexOf=="function"?ee?Uint8Array.prototype.indexOf.call(I,m,v):Uint8Array.prototype.lastIndexOf.call(I,m,v):Q(I,[m],v,M,ee);throw new TypeError("val must be string, number or Buffer")}c(ie,"bidirectionalIndexOf");function Q(I,m,v,M,ee){let le=1,Se=I.length,dt=m.length;if(M!==void 0&&(M=String(M).toLowerCase(),M==="ucs2"||M==="ucs-2"||M==="utf16le"||M==="utf-16le")){if(I.length<2||m.length<2)return-1;le=2,Se/=2,dt/=2,v/=2}function Ot(Fe,wt){return le===1?Fe[wt]:Fe.readUInt16BE(wt*le)}c(Ot,"read");let Et;if(ee){let Fe=-1;for(Et=v;Et<Se;Et++)if(Ot(I,Et)===Ot(m,Fe===-1?0:Et-Fe)){if(Fe===-1&&(Fe=Et),Et-Fe+1===dt)return Fe*le}else Fe!==-1&&(Et-=Et-Fe),Fe=-1}else for(v+dt>Se&&(v=Se-dt),Et=v;Et>=0;Et--){let Fe=!0;for(let wt=0;wt<dt;wt++)if(Ot(I,Et+wt)!==Ot(m,wt)){Fe=!1;break}if(Fe)return Et}return-1}c(Q,"arrayIndexOf"),w.prototype.includes=c(function(m,v,M){return this.indexOf(m,v,M)!==-1},"includes"),w.prototype.indexOf=c(function(m,v,M){return ie(this,m,v,M,!0)},"indexOf"),w.prototype.lastIndexOf=c(function(m,v,M){return ie(this,m,v,M,!1)},"lastIndexOf");function de(I,m,v,M){v=Number(v)||0;const ee=I.length-v;M?(M=Number(M),M>ee&&(M=ee)):M=ee;const le=m.length;M>le/2&&(M=le/2);let Se;for(Se=0;Se<M;++Se){const dt=parseInt(m.substr(Se*2,2),16);if(ut(dt))return Se;I[v+Se]=dt}return Se}c(de,"hexWrite");function he(I,m,v,M){return st(rt(m,I.length-v),I,v,M)}c(he,"utf8Write");function xe(I,m,v,M){return st(Wt(m),I,v,M)}c(xe,"asciiWrite");function Pe(I,m,v,M){return st(fe(m),I,v,M)}c(Pe,"base64Write");function He(I,m,v,M){return st(yn(m,I.length-v),I,v,M)}c(He,"ucs2Write"),w.prototype.write=c(function(m,v,M,ee){if(v===void 0)ee="utf8",M=this.length,v=0;else if(M===void 0&&typeof v=="string")ee=v,M=this.length,v=0;else if(isFinite(v))v=v>>>0,isFinite(M)?(M=M>>>0,ee===void 0&&(ee="utf8")):(ee=M,M=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const le=this.length-v;if((M===void 0||M>le)&&(M=le),m.length>0&&(M<0||v<0)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");let Se=!1;for(;;)switch(ee){case"hex":return de(this,m,v,M);case"utf8":case"utf-8":return he(this,m,v,M);case"ascii":case"latin1":case"binary":return xe(this,m,v,M);case"base64":return Pe(this,m,v,M);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return He(this,m,v,M);default:if(Se)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),Se=!0}},"write"),w.prototype.toJSON=c(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function q(I,m,v){return m===0&&v===I.length?E.fromByteArray(I):E.fromByteArray(I.slice(m,v))}c(q,"base64Slice");function ve(I,m,v){v=Math.min(I.length,v);const M=[];let ee=m;for(;ee<v;){const le=I[ee];let Se=null,dt=le>239?4:le>223?3:le>191?2:1;if(ee+dt<=v){let Ot,Et,Fe,wt;switch(dt){case 1:le<128&&(Se=le);break;case 2:Ot=I[ee+1],(Ot&192)==128&&(wt=(le&31)<<6|Ot&63,wt>127&&(Se=wt));break;case 3:Ot=I[ee+1],Et=I[ee+2],(Ot&192)==128&&(Et&192)==128&&(wt=(le&15)<<12|(Ot&63)<<6|Et&63,wt>2047&&(wt<55296||wt>57343)&&(Se=wt));break;case 4:Ot=I[ee+1],Et=I[ee+2],Fe=I[ee+3],(Ot&192)==128&&(Et&192)==128&&(Fe&192)==128&&(wt=(le&15)<<18|(Ot&63)<<12|(Et&63)<<6|Fe&63,wt>65535&&wt<1114112&&(Se=wt))}}Se===null?(Se=65533,dt=1):Se>65535&&(Se-=65536,M.push(Se>>>10&1023|55296),Se=56320|Se&1023),M.push(Se),ee+=dt}return ot(M)}c(ve,"utf8Slice");const De=4096;function ot(I){const m=I.length;if(m<=De)return String.fromCharCode.apply(String,I);let v="",M=0;for(;M<m;)v+=String.fromCharCode.apply(String,I.slice(M,M+=De));return v}c(ot,"decodeCodePointsArray");function je(I,m,v){let M="";v=Math.min(I.length,v);for(let ee=m;ee<v;++ee)M+=String.fromCharCode(I[ee]&127);return M}c(je,"asciiSlice");function Ee(I,m,v){let M="";v=Math.min(I.length,v);for(let ee=m;ee<v;++ee)M+=String.fromCharCode(I[ee]);return M}c(Ee,"latin1Slice");function Je(I,m,v){const M=I.length;(!m||m<0)&&(m=0),(!v||v<0||v>M)&&(v=M);let ee="";for(let le=m;le<v;++le)ee+=Dt[I[le]];return ee}c(Je,"hexSlice");function ft(I,m,v){const M=I.slice(m,v);let ee="";for(let le=0;le<M.length-1;le+=2)ee+=String.fromCharCode(M[le]+M[le+1]*256);return ee}c(ft,"utf16leSlice"),w.prototype.slice=c(function(m,v){const M=this.length;m=~~m,v=v===void 0?M:~~v,m<0?(m+=M,m<0&&(m=0)):m>M&&(m=M),v<0?(v+=M,v<0&&(v=0)):v>M&&(v=M),v<m&&(v=m);const ee=this.subarray(m,v);return Object.setPrototypeOf(ee,w.prototype),ee},"slice");function Ve(I,m,v){if(I%1!=0||I<0)throw new RangeError("offset is not uint");if(I+m>v)throw new RangeError("Trying to access beyond buffer length")}c(Ve,"checkOffset"),w.prototype.readUintLE=w.prototype.readUIntLE=c(function(m,v,M){m=m>>>0,v=v>>>0,M||Ve(m,v,this.length);let ee=this[m],le=1,Se=0;for(;++Se<v&&(le*=256);)ee+=this[m+Se]*le;return ee},"readUIntLE"),w.prototype.readUintBE=w.prototype.readUIntBE=c(function(m,v,M){m=m>>>0,v=v>>>0,M||Ve(m,v,this.length);let ee=this[m+--v],le=1;for(;v>0&&(le*=256);)ee+=this[m+--v]*le;return ee},"readUIntBE"),w.prototype.readUint8=w.prototype.readUInt8=c(function(m,v){return m=m>>>0,v||Ve(m,1,this.length),this[m]},"readUInt8"),w.prototype.readUint16LE=w.prototype.readUInt16LE=c(function(m,v){return m=m>>>0,v||Ve(m,2,this.length),this[m]|this[m+1]<<8},"readUInt16LE"),w.prototype.readUint16BE=w.prototype.readUInt16BE=c(function(m,v){return m=m>>>0,v||Ve(m,2,this.length),this[m]<<8|this[m+1]},"readUInt16BE"),w.prototype.readUint32LE=w.prototype.readUInt32LE=c(function(m,v){return m=m>>>0,v||Ve(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+this[m+3]*16777216},"readUInt32LE"),w.prototype.readUint32BE=w.prototype.readUInt32BE=c(function(m,v){return m=m>>>0,v||Ve(m,4,this.length),this[m]*16777216+(this[m+1]<<16|this[m+2]<<8|this[m+3])},"readUInt32BE"),w.prototype.readBigUInt64LE=At(c(function(m){m=m>>>0,Tt(m,"offset");const v=this[m],M=this[m+7];(v===void 0||M===void 0)&&jr(m,this.length-8);const ee=v+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24,le=this[++m]+this[++m]*2**8+this[++m]*2**16+M*2**24;return BigInt(ee)+(BigInt(le)<<BigInt(32))},"readBigUInt64LE")),w.prototype.readBigUInt64BE=At(c(function(m){m=m>>>0,Tt(m,"offset");const v=this[m],M=this[m+7];(v===void 0||M===void 0)&&jr(m,this.length-8);const ee=v*2**24+this[++m]*2**16+this[++m]*2**8+this[++m],le=this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+M;return(BigInt(ee)<<BigInt(32))+BigInt(le)},"readBigUInt64BE")),w.prototype.readIntLE=c(function(m,v,M){m=m>>>0,v=v>>>0,M||Ve(m,v,this.length);let ee=this[m],le=1,Se=0;for(;++Se<v&&(le*=256);)ee+=this[m+Se]*le;return le*=128,ee>=le&&(ee-=Math.pow(2,8*v)),ee},"readIntLE"),w.prototype.readIntBE=c(function(m,v,M){m=m>>>0,v=v>>>0,M||Ve(m,v,this.length);let ee=v,le=1,Se=this[m+--ee];for(;ee>0&&(le*=256);)Se+=this[m+--ee]*le;return le*=128,Se>=le&&(Se-=Math.pow(2,8*v)),Se},"readIntBE"),w.prototype.readInt8=c(function(m,v){return m=m>>>0,v||Ve(m,1,this.length),this[m]&128?(255-this[m]+1)*-1:this[m]},"readInt8"),w.prototype.readInt16LE=c(function(m,v){m=m>>>0,v||Ve(m,2,this.length);const M=this[m]|this[m+1]<<8;return M&32768?M|4294901760:M},"readInt16LE"),w.prototype.readInt16BE=c(function(m,v){m=m>>>0,v||Ve(m,2,this.length);const M=this[m+1]|this[m]<<8;return M&32768?M|4294901760:M},"readInt16BE"),w.prototype.readInt32LE=c(function(m,v){return m=m>>>0,v||Ve(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},"readInt32LE"),w.prototype.readInt32BE=c(function(m,v){return m=m>>>0,v||Ve(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},"readInt32BE"),w.prototype.readBigInt64LE=At(c(function(m){m=m>>>0,Tt(m,"offset");const v=this[m],M=this[m+7];(v===void 0||M===void 0)&&jr(m,this.length-8);const ee=this[m+4]+this[m+5]*2**8+this[m+6]*2**16+(M<<24);return(BigInt(ee)<<BigInt(32))+BigInt(v+this[++m]*2**8+this[++m]*2**16+this[++m]*2**24)},"readBigInt64LE")),w.prototype.readBigInt64BE=At(c(function(m){m=m>>>0,Tt(m,"offset");const v=this[m],M=this[m+7];(v===void 0||M===void 0)&&jr(m,this.length-8);const ee=(v<<24)+this[++m]*2**16+this[++m]*2**8+this[++m];return(BigInt(ee)<<BigInt(32))+BigInt(this[++m]*2**24+this[++m]*2**16+this[++m]*2**8+M)},"readBigInt64BE")),w.prototype.readFloatLE=c(function(m,v){return m=m>>>0,v||Ve(m,4,this.length),N.read(this,m,!0,23,4)},"readFloatLE"),w.prototype.readFloatBE=c(function(m,v){return m=m>>>0,v||Ve(m,4,this.length),N.read(this,m,!1,23,4)},"readFloatBE"),w.prototype.readDoubleLE=c(function(m,v){return m=m>>>0,v||Ve(m,8,this.length),N.read(this,m,!0,52,8)},"readDoubleLE"),w.prototype.readDoubleBE=c(function(m,v){return m=m>>>0,v||Ve(m,8,this.length),N.read(this,m,!1,52,8)},"readDoubleBE");function Z(I,m,v,M,ee,le){if(!w.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>ee||m<le)throw new RangeError('"value" argument is out of bounds');if(v+M>I.length)throw new RangeError("Index out of range")}c(Z,"checkInt"),w.prototype.writeUintLE=w.prototype.writeUIntLE=c(function(m,v,M,ee){if(m=+m,v=v>>>0,M=M>>>0,!ee){const dt=Math.pow(2,8*M)-1;Z(this,m,v,M,dt,0)}let le=1,Se=0;for(this[v]=m&255;++Se<M&&(le*=256);)this[v+Se]=m/le&255;return v+M},"writeUIntLE"),w.prototype.writeUintBE=w.prototype.writeUIntBE=c(function(m,v,M,ee){if(m=+m,v=v>>>0,M=M>>>0,!ee){const dt=Math.pow(2,8*M)-1;Z(this,m,v,M,dt,0)}let le=M-1,Se=1;for(this[v+le]=m&255;--le>=0&&(Se*=256);)this[v+le]=m/Se&255;return v+M},"writeUIntBE"),w.prototype.writeUint8=w.prototype.writeUInt8=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,1,255,0),this[v]=m&255,v+1},"writeUInt8"),w.prototype.writeUint16LE=w.prototype.writeUInt16LE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,2,65535,0),this[v]=m&255,this[v+1]=m>>>8,v+2},"writeUInt16LE"),w.prototype.writeUint16BE=w.prototype.writeUInt16BE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,2,65535,0),this[v]=m>>>8,this[v+1]=m&255,v+2},"writeUInt16BE"),w.prototype.writeUint32LE=w.prototype.writeUInt32LE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,4,4294967295,0),this[v+3]=m>>>24,this[v+2]=m>>>16,this[v+1]=m>>>8,this[v]=m&255,v+4},"writeUInt32LE"),w.prototype.writeUint32BE=w.prototype.writeUInt32BE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,4,4294967295,0),this[v]=m>>>24,this[v+1]=m>>>16,this[v+2]=m>>>8,this[v+3]=m&255,v+4},"writeUInt32BE");function vt(I,m,v,M,ee){_t(m,M,ee,I,v,7);let le=Number(m&BigInt(4294967295));I[v++]=le,le=le>>8,I[v++]=le,le=le>>8,I[v++]=le,le=le>>8,I[v++]=le;let Se=Number(m>>BigInt(32)&BigInt(4294967295));return I[v++]=Se,Se=Se>>8,I[v++]=Se,Se=Se>>8,I[v++]=Se,Se=Se>>8,I[v++]=Se,v}c(vt,"wrtBigUInt64LE");function Qe(I,m,v,M,ee){_t(m,M,ee,I,v,7);let le=Number(m&BigInt(4294967295));I[v+7]=le,le=le>>8,I[v+6]=le,le=le>>8,I[v+5]=le,le=le>>8,I[v+4]=le;let Se=Number(m>>BigInt(32)&BigInt(4294967295));return I[v+3]=Se,Se=Se>>8,I[v+2]=Se,Se=Se>>8,I[v+1]=Se,Se=Se>>8,I[v]=Se,v+8}c(Qe,"wrtBigUInt64BE"),w.prototype.writeBigUInt64LE=At(c(function(m,v=0){return vt(this,m,v,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),w.prototype.writeBigUInt64BE=At(c(function(m,v=0){return Qe(this,m,v,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),w.prototype.writeIntLE=c(function(m,v,M,ee){if(m=+m,v=v>>>0,!ee){const Ot=Math.pow(2,8*M-1);Z(this,m,v,M,Ot-1,-Ot)}let le=0,Se=1,dt=0;for(this[v]=m&255;++le<M&&(Se*=256);)m<0&&dt===0&&this[v+le-1]!==0&&(dt=1),this[v+le]=(m/Se>>0)-dt&255;return v+M},"writeIntLE"),w.prototype.writeIntBE=c(function(m,v,M,ee){if(m=+m,v=v>>>0,!ee){const Ot=Math.pow(2,8*M-1);Z(this,m,v,M,Ot-1,-Ot)}let le=M-1,Se=1,dt=0;for(this[v+le]=m&255;--le>=0&&(Se*=256);)m<0&&dt===0&&this[v+le+1]!==0&&(dt=1),this[v+le]=(m/Se>>0)-dt&255;return v+M},"writeIntBE"),w.prototype.writeInt8=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,1,127,-128),m<0&&(m=255+m+1),this[v]=m&255,v+1},"writeInt8"),w.prototype.writeInt16LE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,2,32767,-32768),this[v]=m&255,this[v+1]=m>>>8,v+2},"writeInt16LE"),w.prototype.writeInt16BE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,2,32767,-32768),this[v]=m>>>8,this[v+1]=m&255,v+2},"writeInt16BE"),w.prototype.writeInt32LE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,4,2147483647,-2147483648),this[v]=m&255,this[v+1]=m>>>8,this[v+2]=m>>>16,this[v+3]=m>>>24,v+4},"writeInt32LE"),w.prototype.writeInt32BE=c(function(m,v,M){return m=+m,v=v>>>0,M||Z(this,m,v,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),this[v]=m>>>24,this[v+1]=m>>>16,this[v+2]=m>>>8,this[v+3]=m&255,v+4},"writeInt32BE"),w.prototype.writeBigInt64LE=At(c(function(m,v=0){return vt(this,m,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),w.prototype.writeBigInt64BE=At(c(function(m,v=0){return Qe(this,m,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function at(I,m,v,M,ee,le){if(v+M>I.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}c(at,"checkIEEE754");function we(I,m,v,M,ee){return m=+m,v=v>>>0,ee||at(I,m,v,4,34028234663852886e22,-34028234663852886e22),N.write(I,m,v,M,23,4),v+4}c(we,"writeFloat"),w.prototype.writeFloatLE=c(function(m,v,M){return we(this,m,v,!0,M)},"writeFloatLE"),w.prototype.writeFloatBE=c(function(m,v,M){return we(this,m,v,!1,M)},"writeFloatBE");function be(I,m,v,M,ee){return m=+m,v=v>>>0,ee||at(I,m,v,8,17976931348623157e292,-17976931348623157e292),N.write(I,m,v,M,52,8),v+8}c(be,"writeDouble"),w.prototype.writeDoubleLE=c(function(m,v,M){return be(this,m,v,!0,M)},"writeDoubleLE"),w.prototype.writeDoubleBE=c(function(m,v,M){return be(this,m,v,!1,M)},"writeDoubleBE"),w.prototype.copy=c(function(m,v,M,ee){if(!w.isBuffer(m))throw new TypeError("argument should be a Buffer");if(M||(M=0),!ee&&ee!==0&&(ee=this.length),v>=m.length&&(v=m.length),v||(v=0),ee>0&&ee<M&&(ee=M),ee===M||m.length===0||this.length===0)return 0;if(v<0)throw new RangeError("targetStart out of bounds");if(M<0||M>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),m.length-v<ee-M&&(ee=m.length-v+M);const le=ee-M;return this===m&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(v,M,ee):Uint8Array.prototype.set.call(m,this.subarray(M,ee),v),le},"copy"),w.prototype.fill=c(function(m,v,M,ee){if(typeof m=="string"){if(typeof v=="string"?(ee=v,v=0,M=this.length):typeof M=="string"&&(ee=M,M=this.length),ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!w.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(m.length===1){const Se=m.charCodeAt(0);(ee==="utf8"&&Se<128||ee==="latin1")&&(m=Se)}}else typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=Number(m));if(v<0||this.length<v||this.length<M)throw new RangeError("Out of range index");if(M<=v)return this;v=v>>>0,M=M===void 0?this.length:M>>>0,m||(m=0);let le;if(typeof m=="number")for(le=v;le<M;++le)this[le]=m;else{const Se=w.isBuffer(m)?m:w.from(m,ee),dt=Se.length;if(dt===0)throw new TypeError('The value "'+m+'" is invalid for argument "value"');for(le=0;le<M-v;++le)this[le+v]=Se[le%dt]}return this},"fill");const Ge={};function Me(I,m,v){Ge[I]=c(class extends v{constructor(){super();Object.defineProperty(this,"message",{value:m.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${I}]`,this.stack,delete this.name}get code(){return I}set code(ee){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ee,writable:!0})}toString(){return`${this.name} [${I}]: ${this.message}`}},"NodeError")}c(Me,"E"),Me("ERR_BUFFER_OUT_OF_BOUNDS",function(I){return I?`${I} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Me("ERR_INVALID_ARG_TYPE",function(I,m){return`The "${I}" argument must be of type number. Received type ${typeof m}`},TypeError),Me("ERR_OUT_OF_RANGE",function(I,m,v){let M=`The value of "${I}" is out of range.`,ee=v;return Number.isInteger(v)&&Math.abs(v)>2**32?ee=Xe(String(v)):typeof v=="bigint"&&(ee=String(v),(v>BigInt(2)**BigInt(32)||v<-(BigInt(2)**BigInt(32)))&&(ee=Xe(ee)),ee+="n"),M+=` It must be ${m}. Received ${ee}`,M},RangeError);function Xe(I){let m="",v=I.length;const M=I[0]==="-"?1:0;for(;v>=M+4;v-=3)m=`_${I.slice(v-3,v)}${m}`;return`${I.slice(0,v)}${m}`}c(Xe,"addNumericalSeparator");function Xt(I,m,v){Tt(m,"offset"),(I[m]===void 0||I[m+v]===void 0)&&jr(m,I.length-(v+1))}c(Xt,"checkBounds");function _t(I,m,v,M,ee,le){if(I>v||I<m){const Se=typeof m=="bigint"?"n":"";let dt;throw le>3?m===0||m===BigInt(0)?dt=`>= 0${Se} and < 2${Se} ** ${(le+1)*8}${Se}`:dt=`>= -(2${Se} ** ${(le+1)*8-1}${Se}) and < 2 ** ${(le+1)*8-1}${Se}`:dt=`>= ${m}${Se} and <= ${v}${Se}`,new Ge.ERR_OUT_OF_RANGE("value",dt,I)}Xt(M,ee,le)}c(_t,"checkIntBI");function Tt(I,m){if(typeof I!="number")throw new Ge.ERR_INVALID_ARG_TYPE(m,"number",I)}c(Tt,"validateNumber");function jr(I,m,v){throw Math.floor(I)!==I?(Tt(I,v),new Ge.ERR_OUT_OF_RANGE(v||"offset","an integer",I)):m<0?new Ge.ERR_BUFFER_OUT_OF_BOUNDS:new Ge.ERR_OUT_OF_RANGE(v||"offset",`>= ${v?1:0} and <= ${m}`,I)}c(jr,"boundsError");const br=/[^+/0-9A-Za-z-_]/g;function er(I){if(I=I.split("=")[0],I=I.trim().replace(br,""),I.length<2)return"";for(;I.length%4!=0;)I=I+"=";return I}c(er,"base64clean");function rt(I,m){m=m||1/0;let v;const M=I.length;let ee=null;const le=[];for(let Se=0;Se<M;++Se){if(v=I.charCodeAt(Se),v>55295&&v<57344){if(!ee){if(v>56319){(m-=3)>-1&&le.push(239,191,189);continue}else if(Se+1===M){(m-=3)>-1&&le.push(239,191,189);continue}ee=v;continue}if(v<56320){(m-=3)>-1&&le.push(239,191,189),ee=v;continue}v=(ee-55296<<10|v-56320)+65536}else ee&&(m-=3)>-1&&le.push(239,191,189);if(ee=null,v<128){if((m-=1)<0)break;le.push(v)}else if(v<2048){if((m-=2)<0)break;le.push(v>>6|192,v&63|128)}else if(v<65536){if((m-=3)<0)break;le.push(v>>12|224,v>>6&63|128,v&63|128)}else if(v<1114112){if((m-=4)<0)break;le.push(v>>18|240,v>>12&63|128,v>>6&63|128,v&63|128)}else throw new Error("Invalid code point")}return le}c(rt,"utf8ToBytes");function Wt(I){const m=[];for(let v=0;v<I.length;++v)m.push(I.charCodeAt(v)&255);return m}c(Wt,"asciiToBytes");function yn(I,m){let v,M,ee;const le=[];for(let Se=0;Se<I.length&&!((m-=2)<0);++Se)v=I.charCodeAt(Se),M=v>>8,ee=v%256,le.push(ee),le.push(M);return le}c(yn,"utf16leToBytes");function fe(I){return E.toByteArray(er(I))}c(fe,"base64ToBytes");function st(I,m,v,M){let ee;for(ee=0;ee<M&&!(ee+v>=m.length||ee>=I.length);++ee)m[ee+v]=I[ee];return ee}c(st,"blitBuffer");function Ce(I,m){return I instanceof m||I!=null&&I.constructor!=null&&I.constructor.name!=null&&I.constructor.name===m.name}c(Ce,"isInstance");function ut(I){return I!==I}c(ut,"numberIsNaN");const Dt=function(){const I="0123456789abcdef",m=new Array(256);for(let v=0;v<16;++v){const M=v*16;for(let ee=0;ee<16;++ee)m[M+ee]=I[v]+I[ee]}return m}();function At(I){return typeof BigInt=="undefined"?te:I}c(At,"defineBigIntMethod");function te(){throw new Error("BigInt not supported")}c(te,"BufferBigIntNotDefined")},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var Buffer=__webpack_require__(8764).Buffer;const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(J){const h=await strtok3.fromStream(J);try{return await fromTokenizer(h)}finally{await h.close()}}c(fromStream,"fromStream");async function fromBuffer(J){if(!(J instanceof Uint8Array||J instanceof ArrayBuffer||Buffer.isBuffer(J)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof J}\``);const h=J instanceof Buffer?J:Buffer.from(J);if(!(h&&h.length>1))return;const U=strtok3.fromBuffer(h);return fromTokenizer(U)}c(fromBuffer,"fromBuffer");function _check(J,h,U){U={offset:0,...U};for(const[E,N]of h.entries())if(U.mask){if(N!==(U.mask[E]&J[E+U.offset]))return!1}else if(N!==J[E+U.offset])return!1;return!0}c(_check,"_check");async function fromTokenizer(J){try{return _fromTokenizer(J)}catch(h){if(!(h instanceof strtok3.EndOfStreamError))throw h}}c(fromTokenizer,"fromTokenizer");async function _fromTokenizer(J){let h=Buffer.alloc(minimumBytes);const U=12,E=c((L,V)=>_check(h,L,V),"check"),N=c((L,V)=>E(stringToBytes(L),V),"checkString");if(J.fileInfo.size||(J.fileInfo.size=Number.MAX_SAFE_INTEGER),await J.peekBuffer(h,{length:U,mayBeLess:!0}),E([66,77]))return{ext:"bmp",mime:"image/bmp"};if(E([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(E([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(E([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(E([37,33]))return await J.peekBuffer(h,{length:24,mayBeLess:!0}),N("PS-Adobe-",{offset:2})&&N(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(E([31,160])||E([31,157]))return{ext:"Z",mime:"application/x-compress"};if(E([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(E([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(E([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(E([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(N("ID3")){await J.ignore(6);const L=await J.readToken(uint32SyncSafeToken);return J.position+L>J.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await J.ignore(L),fromTokenizer(J))}if(N("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((h[0]===67||h[0]===70)&&E([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(E([71,73,70]))return{ext:"gif",mime:"image/gif"};if(N("FLIF"))return{ext:"flif",mime:"image/flif"};if(N("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(N("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(N("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(N("FORM"))return{ext:"aif",mime:"audio/aiff"};if(N("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(E([80,75,3,4])){try{for(;J.position+30<J.fileInfo.size;){await J.readBuffer(h,{length:30});const L={compressedSize:h.readUInt32LE(18),uncompressedSize:h.readUInt32LE(22),filenameLength:h.readUInt16LE(26),extraFieldLength:h.readUInt16LE(28)};if(L.filename=await J.readToken(new Token.StringType(L.filenameLength,"utf-8")),await J.ignore(L.extraFieldLength),L.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(L.filename.endsWith(".rels")||L.filename.endsWith(".xml"))switch(L.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(L.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(L.filename.startsWith("3D/")&&L.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(L.filename==="mimetype"&&L.compressedSize===L.uncompressedSize)switch(await J.readToken(new Token.StringType(L.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(L.compressedSize===0){let V=-1;for(;V<0&&J.position<J.fileInfo.size;)await J.peekBuffer(h,{mayBeLess:!0}),V=h.indexOf("504B0304",0,"hex"),await J.ignore(V>=0?V:h.length)}else await J.ignore(L.compressedSize)}}catch(L){if(!(L instanceof strtok3.EndOfStreamError))throw L}return{ext:"zip",mime:"application/zip"}}if(N("OggS")){await J.ignore(28);const L=Buffer.alloc(8);return await J.readBuffer(L),_check(L,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(L,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(L,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(L,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(L,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(L,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(E([80,75])&&(h[2]===3||h[2]===5||h[2]===7)&&(h[3]===4||h[3]===6||h[3]===8))return{ext:"zip",mime:"application/zip"};if(N("ftyp",{offset:4})&&(h[8]&96)!=0){const L=h.toString("binary",8,12).replace("\0"," ").trim();switch(L){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return L.startsWith("3g")?L.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(N("MThd"))return{ext:"mid",mime:"audio/midi"};if(N("wOFF")&&(E([0,1,0,0],{offset:4})||N("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(N("wOF2")&&(E([0,1,0,0],{offset:4})||N("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(E([212,195,178,161])||E([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(N("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(N("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(N("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(E([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(N("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(N("%PDF")){await J.ignore(1350);const L=10*1024*1024,V=Buffer.alloc(Math.min(L,J.fileInfo.size));return await J.readBuffer(V,{mayBeLess:!0}),V.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(E([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(E([73,73,42,0]))return N("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:E([28,0,254,0],{offset:8})||E([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:E([8,0,0,0],{offset:4})&&(E([45,0,254,0],{offset:8})||E([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(h=Buffer.alloc(24),await J.peekBuffer(h),(E([16,251,134,1],{offset:4})||E([8,0,0,0],{offset:4}))&&E([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(E([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(N("MAC "))return{ext:"ape",mime:"audio/ape"};if(E([26,69,223,163])){async function L(){const R=await J.peekNumber(Token.UINT8);let A=128,S=0;for(;(R&A)==0;)++S,A>>=1;const D=Buffer.alloc(S+1);return await J.readBuffer(D),D}c(L,"readField");async function V(){const R=await L(),A=await L();A[0]^=128>>A.length-1;const S=Math.min(6,A.length);return{id:R.readUIntBE(0,R.length),len:A.readUIntBE(A.length-S,S)}}c(V,"readElement");async function K(R,A){for(;A>0;){const S=await V();if(S.id===17026)return J.readToken(new Token.StringType(S.len,"utf-8"));await J.ignore(S.len),--A}}c(K,"readChildren");const P=await V();switch(await K(1,P.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(E([82,73,70,70])){if(E([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(E([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(E([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(N("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(E([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(N("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(N("MSCF")||N("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(E([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(E([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(E([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(E([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(N("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(N("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(E([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(N("IMPM"))return{ext:"it",mime:"audio/x-it"};if(N("-lh0-",{offset:2})||N("-lh1-",{offset:2})||N("-lh2-",{offset:2})||N("-lh3-",{offset:2})||N("-lh4-",{offset:2})||N("-lh5-",{offset:2})||N("-lh6-",{offset:2})||N("-lh7-",{offset:2})||N("-lzs-",{offset:2})||N("-lz4-",{offset:2})||N("-lz5-",{offset:2})||N("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(E([0,0,1,186])){if(E([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(E([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(N("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(E([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(N("<?xml "))return{ext:"xml",mime:"application/xml"};if(E([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(E([82,97,114,33,26,7])&&(h[6]===0||h[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(N("solid "))return{ext:"stl",mime:"model/stl"};if(N("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(N("!<arch>"))return await J.ignore(8),await J.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(E([137,80,78,71,13,10,26,10])){await J.ignore(8);async function L(){return{length:await J.readToken(Token.INT32_BE),type:await J.readToken(new Token.StringType(4,"binary"))}}c(L,"readChunkHeader");do{const V=await L();if(V.length<0)return;switch(V.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await J.ignore(V.length+4)}}while(J.position+8<J.fileInfo.size);return{ext:"png",mime:"image/png"}}if(E([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(E([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(E([102,114,101,101],{offset:4})||E([109,100,97,116],{offset:4})||E([109,111,111,118],{offset:4})||E([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(E([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(N("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(E([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(E([48,38,178,117,142,102,207,17,166,217])){async function L(){const V=Buffer.alloc(16);return await J.readBuffer(V),{id:V,size:Number(await J.readToken(Token.UINT64_LE))}}for(c(L,"readHeader"),await J.ignore(30);J.position+24<J.fileInfo.size;){const V=await L();let K=V.size-24;if(_check(V.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const P=Buffer.alloc(16);if(K-=await J.readBuffer(P),_check(P,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(P,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await J.ignore(K)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(E([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((E([126,16,4])||E([126,24,4]))&&E([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(E([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(E([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await J.ignore(20),await J.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(E([255,10])||E([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(E([0,0,1,186])||E([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(E([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(E([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(E([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(E([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await J.peekBuffer(h,{length:Math.min(256,J.fileInfo.size),mayBeLess:!0}),N("BEGIN:")){if(N("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(N("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(N("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(N("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(N("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(E([4,0,0,0])&&h.length>=16){const L=h.readUInt32LE(12);if(L>12&&h.length>=L+16)try{const V=h.slice(16,L+16).toString();if(JSON.parse(V).files)return{ext:"asar",mime:"application/x-asar"}}catch(V){}}if(E([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(N("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(E([71],{offset:4})&&(E([71],{offset:192})||E([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(E([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(E([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(E([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(E([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(E([76,80],{offset:34})&&(E([0,0,1],{offset:8})||E([1,0,2],{offset:8})||E([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(E([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await J.peekBuffer(h,{length:Math.min(512,J.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(h))return{ext:"tar",mime:"application/x-tar"};if(E([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(N("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(h.length>=2&&E([255,224],{offset:0,mask:[255,224]})){if(E([16],{offset:1,mask:[22]}))return E([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(E([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(E([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(E([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}c(_fromTokenizer,"_fromTokenizer");const stream=c(readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const J=new stream.PassThrough;let h;stream.pipeline?h=stream.pipeline(readableStream,J,()=>{}):h=readableStream.pipe(J);const U=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const E=await fromBuffer(U);J.fileType=E}catch(E){reject(E)}resolve(h)})}),"stream"),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get(){return new Set(supported.extensions)}}),Object.defineProperty(fileType,"mimeTypes",{get(){return new Set(supported.mimeTypes)}}),module.exports=fileType},7769:(J,h,U)=>{"use strict";const E=U(6597),N=U(1);async function L(K){const P=await E.fromFile(K);try{return await N.fromTokenizer(P)}finally{await P.close()}}c(L,"fromFile");const V={fromFile:L};Object.assign(V,N),Object.defineProperty(V,"extensions",{get(){return N.extensions}}),Object.defineProperty(V,"mimeTypes",{get(){return N.mimeTypes}}),J.exports=V},9898:J=>{"use strict";J.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(J,h)=>{"use strict";h.stringToBytes=U=>[...U].map(E=>E.charCodeAt(0)),h.tarHeaderChecksumMatches=(U,E=0)=>{const N=parseInt(U.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(N))return!1;let L=8*32;for(let V=E;V<E+148;V++)L+=U[V];for(let V=E+156;V<E+512;V++)L+=U[V];return N===L},h.uint32SyncSafeToken={get:(U,E)=>U[E+3]&127|U[E+2]<<7|U[E+1]<<14|U[E]<<21,len:4}},7360:function(J,h){var U,E,N;(function(L,V){E=[],U=V,N=typeof U=="function"?U.apply(h,E):U,N!==void 0&&(J.exports=N)})(this,c(function(){function V(z){var G={single:function(re,W,B){if(!re||(X(re)||(re=G.getPreparedSearch(re)),!W))return null;X(W)||(W=G.getPrepared(W));var ie=B&&B.allowTypo!==void 0?B.allowTypo:z&&z.allowTypo!==void 0?z.allowTypo:!0,Q=ie?G.algorithm:G.algorithmNoTypo;return Q(re,W,re[0])},go:function(re,W,B){if(!re)return R;re=G.prepareSearch(re);var ie=re[0],Q=B&&B.threshold||z&&z.threshold||-9007199254740991,de=B&&B.limit||z&&z.limit||9007199254740991,he=B&&B.allowTypo!==void 0?B.allowTypo:z&&z.allowTypo!==void 0?z.allowTypo:!0,xe=he?G.algorithm:G.algorithmNoTypo,Pe=0,He=0,q=W.length;if(B&&B.keys)for(var ve=B.scoreFn||j,De=B.keys,ot=De.length,je=q-1;je>=0;--je){for(var Ee=W[je],Je=new Array(ot),ft=ot-1;ft>=0;--ft){var Ve=De[ft],Z=F(Ee,Ve);if(!Z){Je[ft]=null;continue}X(Z)||(Z=G.getPrepared(Z)),Je[ft]=xe(re,Z,ie)}Je.obj=Ee;var vt=ve(Je);vt!==null&&(vt<Q||(Je.score=vt,Pe<de?(ye.add(Je),++Pe):(++He,vt>ye.peek().score&&ye.replaceTop(Je))))}else if(B&&B.key)for(var Ve=B.key,je=q-1;je>=0;--je){var Ee=W[je],Z=F(Ee,Ve);if(!!Z){X(Z)||(Z=G.getPrepared(Z));var Qe=xe(re,Z,ie);Qe!==null&&(Qe.score<Q||(Qe={target:Qe.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Qe.score,indexes:Qe.indexes,obj:Ee},Pe<de?(ye.add(Qe),++Pe):(++He,Qe.score>ye.peek().score&&ye.replaceTop(Qe))))}}else for(var je=q-1;je>=0;--je){var Z=W[je];if(!!Z){X(Z)||(Z=G.getPrepared(Z));var Qe=xe(re,Z,ie);Qe!==null&&(Qe.score<Q||(Pe<de?(ye.add(Qe),++Pe):(++He,Qe.score>ye.peek().score&&ye.replaceTop(Qe))))}}if(Pe===0)return R;for(var at=new Array(Pe),je=Pe-1;je>=0;--je)at[je]=ye.poll();return at.total=Pe+He,at},goAsync:function(re,W,B){var ie=!1,Q=new Promise(function(de,he){if(!re)return de(R);re=G.prepareSearch(re);var xe=re[0],Pe=se(),He=W.length-1,q=B&&B.threshold||z&&z.threshold||-9007199254740991,ve=B&&B.limit||z&&z.limit||9007199254740991,De=B&&B.allowTypo!==void 0?B.allowTypo:z&&z.allowTypo!==void 0?z.allowTypo:!0,ot=De?G.algorithm:G.algorithmNoTypo,je=0,Ee=0;function Je(){if(ie)return he("canceled");var ft=Date.now();if(B&&B.keys)for(var Ve=B.scoreFn||j,Z=B.keys,vt=Z.length;He>=0;--He){for(var Qe=W[He],at=new Array(vt),we=vt-1;we>=0;--we){var be=Z[we],Ge=F(Qe,be);if(!Ge){at[we]=null;continue}X(Ge)||(Ge=G.getPrepared(Ge)),at[we]=ot(re,Ge,xe)}at.obj=Qe;var Me=Ve(at);if(Me!==null&&!(Me<q)&&(at.score=Me,je<ve?(Pe.add(at),++je):(++Ee,Me>Pe.peek().score&&Pe.replaceTop(at)),He%1e3==0&&Date.now()-ft>=10)){K?setImmediate(Je):setTimeout(Je);return}}else if(B&&B.key)for(var be=B.key;He>=0;--He){var Qe=W[He],Ge=F(Qe,be);if(!!Ge){X(Ge)||(Ge=G.getPrepared(Ge));var Xe=ot(re,Ge,xe);if(Xe!==null&&!(Xe.score<q)&&(Xe={target:Xe.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Xe.score,indexes:Xe.indexes,obj:Qe},je<ve?(Pe.add(Xe),++je):(++Ee,Xe.score>Pe.peek().score&&Pe.replaceTop(Xe)),He%1e3==0&&Date.now()-ft>=10)){K?setImmediate(Je):setTimeout(Je);return}}}else for(;He>=0;--He){var Ge=W[He];if(!!Ge){X(Ge)||(Ge=G.getPrepared(Ge));var Xe=ot(re,Ge,xe);if(Xe!==null&&!(Xe.score<q)&&(je<ve?(Pe.add(Xe),++je):(++Ee,Xe.score>Pe.peek().score&&Pe.replaceTop(Xe)),He%1e3==0&&Date.now()-ft>=10)){K?setImmediate(Je):setTimeout(Je);return}}}if(je===0)return de(R);for(var Xt=new Array(je),_t=je-1;_t>=0;--_t)Xt[_t]=Pe.poll();Xt.total=je+Ee,de(Xt)}c(Je,"step"),K?setImmediate(Je):Je()});return Q.cancel=function(){ie=!0},Q},highlight:function(re,W,B){if(re===null)return null;W===void 0&&(W="<b>"),B===void 0&&(B="</b>");for(var ie="",Q=0,de=!1,he=re.target,xe=he.length,Pe=re.indexes,He=0;He<xe;++He){var q=he[He];if(Pe[Q]===He){if(++Q,de||(de=!0,ie+=W),Q===Pe.length){ie+=q+B+he.substr(He+1);break}}else de&&(de=!1,ie+=B);ie+=q}return ie},prepare:function(re){if(!!re)return{target:re,_targetLowerCodes:G.prepareLowerCodes(re),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(re){if(!!re)return{target:re,_targetLowerCodes:G.prepareLowerCodes(re),_nextBeginningIndexes:G.prepareNextBeginningIndexes(re),score:null,indexes:null,obj:null}},prepareSearch:function(re){if(!!re)return G.prepareLowerCodes(re)},getPrepared:function(re){if(re.length>999)return G.prepare(re);var W=P.get(re);return W!==void 0||(W=G.prepare(re),P.set(re,W)),W},getPreparedSearch:function(re){if(re.length>999)return G.prepareSearch(re);var W=w.get(re);return W!==void 0||(W=G.prepareSearch(re),w.set(re,W)),W},algorithm:function(re,W,B){for(var ie=W._targetLowerCodes,Q=re.length,de=ie.length,he=0,xe=0,Pe=0,He=0;;){var q=B===ie[xe];if(q){if(A[He++]=xe,++he,he===Q)break;B=re[Pe===0?he:Pe===he?he+1:Pe===he-1?he-1:he]}if(++xe,xe>=de)for(;;){if(he<=1)return null;if(Pe===0){--he;var ve=re[he];if(B===ve)continue;Pe=he}else{if(Pe===1)return null;--Pe,he=Pe,B=re[he+1];var ve=re[he];if(B===ve)continue}He=he,xe=A[He-1]+1;break}}var he=0,De=0,ot=!1,je=0,Ee=W._nextBeginningIndexes;Ee===null&&(Ee=W._nextBeginningIndexes=G.prepareNextBeginningIndexes(W.target));var Je=xe=A[0]===0?0:Ee[A[0]-1];if(xe!==de)for(;;)if(xe>=de){if(he<=0){if(++De,De>Q-2)break;if(re[De]===re[De+1])continue;xe=Je;continue}--he;var ft=S[--je];xe=Ee[ft]}else{var q=re[De===0?he:De===he?he+1:De===he-1?he-1:he]===ie[xe];if(q){if(S[je++]=xe,++he,he===Q){ot=!0;break}++xe}else xe=Ee[xe]}{if(ot)var Ve=S,Z=je;else var Ve=A,Z=He;for(var vt=0,Qe=-1,at=0;at<Q;++at){var xe=Ve[at];Qe!==xe-1&&(vt-=xe),Qe=xe}ot?De!==0&&(vt+=-20):(vt*=1e3,Pe!==0&&(vt+=-20)),vt-=de-Q,W.score=vt,W.indexes=new Array(Z);for(var at=Z-1;at>=0;--at)W.indexes[at]=Ve[at];return W}},algorithmNoTypo:function(re,W,B){for(var ie=W._targetLowerCodes,Q=re.length,de=ie.length,he=0,xe=0,Pe=0;;){var He=B===ie[xe];if(He){if(A[Pe++]=xe,++he,he===Q)break;B=re[he]}if(++xe,xe>=de)return null}var he=0,q=!1,ve=0,De=W._nextBeginningIndexes;De===null&&(De=W._nextBeginningIndexes=G.prepareNextBeginningIndexes(W.target));var ot=xe=A[0]===0?0:De[A[0]-1];if(xe!==de)for(;;)if(xe>=de){if(he<=0)break;--he;var je=S[--ve];xe=De[je]}else{var He=re[he]===ie[xe];if(He){if(S[ve++]=xe,++he,he===Q){q=!0;break}++xe}else xe=De[xe]}{if(q)var Ee=S,Je=ve;else var Ee=A,Je=Pe;for(var ft=0,Ve=-1,Z=0;Z<Q;++Z){var xe=Ee[Z];Ve!==xe-1&&(ft-=xe),Ve=xe}q||(ft*=1e3),ft-=de-Q,W.score=ft,W.indexes=new Array(Je);for(var Z=Je-1;Z>=0;--Z)W.indexes[Z]=Ee[Z];return W}},prepareLowerCodes:function(re){for(var W=re.length,B=[],ie=re.toLowerCase(),Q=0;Q<W;++Q)B[Q]=ie.charCodeAt(Q);return B},prepareBeginningIndexes:function(re){for(var W=re.length,B=[],ie=0,Q=!1,de=!1,he=0;he<W;++he){var xe=re.charCodeAt(he),Pe=xe>=65&&xe<=90,He=Pe||xe>=97&&xe<=122||xe>=48&&xe<=57,q=Pe&&!Q||!de||!He;Q=Pe,de=He,q&&(B[ie++]=he)}return B},prepareNextBeginningIndexes:function(re){for(var W=re.length,B=G.prepareBeginningIndexes(re),ie=[],Q=B[0],de=0,he=0;he<W;++he)Q>he?ie[he]=Q:(Q=B[++de],ie[he]=Q===void 0?W:Q);return ie},cleanup:D,new:V};return G}c(V,"fuzzysortNew");var K=typeof window=="undefined",P=new Map,w=new Map,R=[];R.total=0;var A=[],S=[];function D(){P.clear(),w.clear(),A=[],S=[]}c(D,"cleanup");function j(z){for(var G=-9007199254740991,re=z.length-1;re>=0;--re){var W=z[re];if(W!==null){var B=W.score;B>G&&(G=B)}}return G===-9007199254740991?null:G}c(j,"defaultScoreFn");function F(z,G){var re=z[G];if(re!==void 0)return re;var W=G;Array.isArray(G)||(W=G.split("."));for(var B=W.length,ie=-1;z&&++ie<B;)z=z[W[ie]];return z}c(F,"getValue");function X(z){return typeof z=="object"}c(X,"isObj");var se=c(function(){var z=[],G=0,re={};function W(){for(var B=0,ie=z[B],Q=1;Q<G;){var de=Q+1;B=Q,de<G&&z[de].score<z[Q].score&&(B=de),z[B-1>>1]=z[B],Q=1+(B<<1)}for(var he=B-1>>1;B>0&&ie.score<z[he].score;he=(B=he)-1>>1)z[B]=z[he];z[B]=ie}return c(W,"n"),re.add=function(B){var ie=G;z[G++]=B;for(var Q=ie-1>>1;ie>0&&B.score<z[Q].score;Q=(ie=Q)-1>>1)z[ie]=z[Q];z[ie]=B},re.poll=function(){if(G!==0){var B=z[0];return z[0]=z[--G],W(),B}},re.peek=function(B){if(G!==0)return z[0]},re.replaceTop=function(B){z[0]=B,W()},re},"fastpriorityqueue"),ye=se();return V()},"UMD"))},645:(J,h)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */h.read=function(U,E,N,L,V){var K,P,w=V*8-L-1,R=(1<<w)-1,A=R>>1,S=-7,D=N?V-1:0,j=N?-1:1,F=U[E+D];for(D+=j,K=F&(1<<-S)-1,F>>=-S,S+=w;S>0;K=K*256+U[E+D],D+=j,S-=8);for(P=K&(1<<-S)-1,K>>=-S,S+=L;S>0;P=P*256+U[E+D],D+=j,S-=8);if(K===0)K=1-A;else{if(K===R)return P?NaN:(F?-1:1)*(1/0);P=P+Math.pow(2,L),K=K-A}return(F?-1:1)*P*Math.pow(2,K-L)},h.write=function(U,E,N,L,V,K){var P,w,R,A=K*8-V-1,S=(1<<A)-1,D=S>>1,j=V===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=L?0:K-1,X=L?1:-1,se=E<0||E===0&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?(w=isNaN(E)?1:0,P=S):(P=Math.floor(Math.log(E)/Math.LN2),E*(R=Math.pow(2,-P))<1&&(P--,R*=2),P+D>=1?E+=j/R:E+=j*Math.pow(2,1-D),E*R>=2&&(P++,R/=2),P+D>=S?(w=0,P=S):P+D>=1?(w=(E*R-1)*Math.pow(2,V),P=P+D):(w=E*Math.pow(2,D-1)*Math.pow(2,V),P=0));V>=8;U[N+F]=w&255,F+=X,w/=256,V-=8);for(P=P<<V|w,A+=V;A>0;U[N+F]=P&255,F+=X,P/=256,A-=8);U[N+F-X]|=se*128}},3300:(J,h)=>{"use strict";var U=c(function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof E!="undefined")return E;throw new Error("unable to locate global object")},"getGlobal"),E=U();J.exports=h=E.fetch,E.fetch&&(h.default=E.fetch.bind(E)),h.Headers=E.Headers,h.Request=E.Request,h.Response=E.Response},447:(J,h,U)=>{var E=U(2479);J.exports=E(N),J.exports.strict=E(L),N.proto=N(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return N(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return L(this)},configurable:!0})});function N(V){var K=c(function(){return K.called?K.value:(K.called=!0,K.value=V.apply(this,arguments))},"f");return K.called=!1,K}c(N,"once");function L(V){var K=c(function(){if(K.called)throw new Error(K.onceError);return K.called=!0,K.value=V.apply(this,arguments)},"f"),P=V.name||"Function wrapped with `once`";return K.onceError=P+" shouldn't be called more than once",K.called=!1,K}c(L,"onceStrict")},6470:(J,h,U)=>{"use strict";var E=U(4155);function N(P){if(typeof P!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(P))}c(N,"assertPath");function L(P,w){for(var R="",A=0,S=-1,D=0,j,F=0;F<=P.length;++F){if(F<P.length)j=P.charCodeAt(F);else{if(j===47)break;j=47}if(j===47){if(!(S===F-1||D===1))if(S!==F-1&&D===2){if(R.length<2||A!==2||R.charCodeAt(R.length-1)!==46||R.charCodeAt(R.length-2)!==46){if(R.length>2){var X=R.lastIndexOf("/");if(X!==R.length-1){X===-1?(R="",A=0):(R=R.slice(0,X),A=R.length-1-R.lastIndexOf("/")),S=F,D=0;continue}}else if(R.length===2||R.length===1){R="",A=0,S=F,D=0;continue}}w&&(R.length>0?R+="/..":R="..",A=2)}else R.length>0?R+="/"+P.slice(S+1,F):R=P.slice(S+1,F),A=F-S-1;S=F,D=0}else j===46&&D!==-1?++D:D=-1}return R}c(L,"normalizeStringPosix");function V(P,w){var R=w.dir||w.root,A=w.base||(w.name||"")+(w.ext||"");return R?R===w.root?R+A:R+P+A:A}c(V,"_format");var K={resolve:c(function(){for(var w="",R=!1,A,S=arguments.length-1;S>=-1&&!R;S--){var D;S>=0?D=arguments[S]:(A===void 0&&(A=E.cwd()),D=A),N(D),D.length!==0&&(w=D+"/"+w,R=D.charCodeAt(0)===47)}return w=L(w,!R),R?w.length>0?"/"+w:"/":w.length>0?w:"."},"resolve"),normalize:c(function(w){if(N(w),w.length===0)return".";var R=w.charCodeAt(0)===47,A=w.charCodeAt(w.length-1)===47;return w=L(w,!R),w.length===0&&!R&&(w="."),w.length>0&&A&&(w+="/"),R?"/"+w:w},"normalize"),isAbsolute:c(function(w){return N(w),w.length>0&&w.charCodeAt(0)===47},"isAbsolute"),join:c(function(){if(arguments.length===0)return".";for(var w,R=0;R<arguments.length;++R){var A=arguments[R];N(A),A.length>0&&(w===void 0?w=A:w+="/"+A)}return w===void 0?".":K.normalize(w)},"join"),relative:c(function(w,R){if(N(w),N(R),w===R||(w=K.resolve(w),R=K.resolve(R),w===R))return"";for(var A=1;A<w.length&&w.charCodeAt(A)===47;++A);for(var S=w.length,D=S-A,j=1;j<R.length&&R.charCodeAt(j)===47;++j);for(var F=R.length,X=F-j,se=D<X?D:X,ye=-1,z=0;z<=se;++z){if(z===se){if(X>se){if(R.charCodeAt(j+z)===47)return R.slice(j+z+1);if(z===0)return R.slice(j+z)}else D>se&&(w.charCodeAt(A+z)===47?ye=z:z===0&&(ye=0));break}var G=w.charCodeAt(A+z),re=R.charCodeAt(j+z);if(G!==re)break;G===47&&(ye=z)}var W="";for(z=A+ye+1;z<=S;++z)(z===S||w.charCodeAt(z)===47)&&(W.length===0?W+="..":W+="/..");return W.length>0?W+R.slice(j+ye):(j+=ye,R.charCodeAt(j)===47&&++j,R.slice(j))},"relative"),_makeLong:c(function(w){return w},"_makeLong"),dirname:c(function(w){if(N(w),w.length===0)return".";for(var R=w.charCodeAt(0),A=R===47,S=-1,D=!0,j=w.length-1;j>=1;--j)if(R=w.charCodeAt(j),R===47){if(!D){S=j;break}}else D=!1;return S===-1?A?"/":".":A&&S===1?"//":w.slice(0,S)},"dirname"),basename:c(function(w,R){if(R!==void 0&&typeof R!="string")throw new TypeError('"ext" argument must be a string');N(w);var A=0,S=-1,D=!0,j;if(R!==void 0&&R.length>0&&R.length<=w.length){if(R.length===w.length&&R===w)return"";var F=R.length-1,X=-1;for(j=w.length-1;j>=0;--j){var se=w.charCodeAt(j);if(se===47){if(!D){A=j+1;break}}else X===-1&&(D=!1,X=j+1),F>=0&&(se===R.charCodeAt(F)?--F==-1&&(S=j):(F=-1,S=X))}return A===S?S=X:S===-1&&(S=w.length),w.slice(A,S)}else{for(j=w.length-1;j>=0;--j)if(w.charCodeAt(j)===47){if(!D){A=j+1;break}}else S===-1&&(D=!1,S=j+1);return S===-1?"":w.slice(A,S)}},"basename"),extname:c(function(w){N(w);for(var R=-1,A=0,S=-1,D=!0,j=0,F=w.length-1;F>=0;--F){var X=w.charCodeAt(F);if(X===47){if(!D){A=F+1;break}continue}S===-1&&(D=!1,S=F+1),X===46?R===-1?R=F:j!==1&&(j=1):R!==-1&&(j=-1)}return R===-1||S===-1||j===0||j===1&&R===S-1&&R===A+1?"":w.slice(R,S)},"extname"),format:c(function(w){if(w===null||typeof w!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof w);return V("/",w)},"format"),parse:c(function(w){N(w);var R={root:"",dir:"",base:"",ext:"",name:""};if(w.length===0)return R;var A=w.charCodeAt(0),S=A===47,D;S?(R.root="/",D=1):D=0;for(var j=-1,F=0,X=-1,se=!0,ye=w.length-1,z=0;ye>=D;--ye){if(A=w.charCodeAt(ye),A===47){if(!se){F=ye+1;break}continue}X===-1&&(se=!1,X=ye+1),A===46?j===-1?j=ye:z!==1&&(z=1):j!==-1&&(z=-1)}return j===-1||X===-1||z===0||z===1&&j===X-1&&j===F+1?X!==-1&&(F===0&&S?R.base=R.name=w.slice(1,X):R.base=R.name=w.slice(F,X)):(F===0&&S?(R.name=w.slice(1,j),R.base=w.slice(1,X)):(R.name=w.slice(F,j),R.base=w.slice(F,X)),R.ext=w.slice(j,X)),F>0?R.dir=w.slice(0,F-1):S&&(R.dir="/"),R},"parse"),sep:"/",delimiter:":",win32:null,posix:null};K.posix=K,J.exports=K},7279:(J,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.EndOfStreamError=h.defaultMessages=void 0,h.defaultMessages="End-Of-Stream";class U extends Error{constructor(){super(h.defaultMessages)}}c(U,"EndOfStreamError"),h.EndOfStreamError=U},5167:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.StreamReader=h.EndOfStreamError=void 0;const E=U(7279);var N=U(7279);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return N.EndOfStreamError}});class L{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((w,R)=>{this.reject=R,this.resolve=w})}}c(L,"Deferred");const V=1*1024*1024;class K{constructor(w){if(this.s=w,this.request=null,this.endOfStream=!1,this.peekQueue=[],!w.read||!w.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new E.EndOfStreamError)),this.s.once("error",R=>this.reject(R)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(w,R,A){const S=await this.read(w,R,A);return this.peekQueue.push(w.subarray(R,R+S)),S}async read(w,R,A){if(A===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new E.EndOfStreamError;let S=A,D=0;for(;this.peekQueue.length>0&&S>0;){const j=this.peekQueue.pop();if(!j)throw new Error("peekData should be defined");const F=Math.min(j.length,S);w.set(j.subarray(0,F),R+D),D+=F,S-=F,F<j.length&&this.peekQueue.push(j.subarray(F))}for(;S>0&&!this.endOfStream;){const j=Math.min(S,V),F=await this._read(w,R+D,j);if(D+=F,F<j)break;S-=F}return D}async _read(w,R,A){if(this.request)throw new Error("Concurrent read operation?");const S=this.s.read(A);return S?(w.set(S,R),S.length):(this.request={buffer:w,offset:R,length:A,deferred:new L},this.s.once("readable",()=>{this.tryRead()}),this.request.deferred.promise)}tryRead(){if(!this.request)throw new Error("this.request should be defined");const w=this.s.read(this.request.length);w?(this.request.buffer.set(w,this.request.offset),this.request.deferred.resolve(w.length),this.request=null):this.s.once("readable",()=>{this.tryRead()})}reject(w){this.endOfStream=!0,this.request&&(this.request.deferred.reject(w),this.request=null)}}c(K,"StreamReader"),h.StreamReader=K},4155:J=>{var h=J.exports={},U,E;function N(){throw new Error("setTimeout has not been defined")}c(N,"defaultSetTimout");function L(){throw new Error("clearTimeout has not been defined")}c(L,"defaultClearTimeout"),function(){try{typeof setTimeout=="function"?U=setTimeout:U=N}catch(X){U=N}try{typeof clearTimeout=="function"?E=clearTimeout:E=L}catch(X){E=L}}();function V(X){if(U===setTimeout)return setTimeout(X,0);if((U===N||!U)&&setTimeout)return U=setTimeout,setTimeout(X,0);try{return U(X,0)}catch(se){try{return U.call(null,X,0)}catch(ye){return U.call(this,X,0)}}}c(V,"runTimeout");function K(X){if(E===clearTimeout)return clearTimeout(X);if((E===L||!E)&&clearTimeout)return E=clearTimeout,clearTimeout(X);try{return E(X)}catch(se){try{return E.call(null,X)}catch(ye){return E.call(this,X)}}}c(K,"runClearTimeout");var P=[],w=!1,R,A=-1;function S(){!w||!R||(w=!1,R.length?P=R.concat(P):A=-1,P.length&&D())}c(S,"cleanUpNextTick");function D(){if(!w){var X=V(S);w=!0;for(var se=P.length;se;){for(R=P,P=[];++A<se;)R&&R[A].run();A=-1,se=P.length}R=null,w=!1,K(X)}}c(D,"drainQueue"),h.nextTick=function(X){var se=new Array(arguments.length-1);if(arguments.length>1)for(var ye=1;ye<arguments.length;ye++)se[ye-1]=arguments[ye];P.push(new j(X,se)),P.length===1&&!w&&V(D)};function j(X,se){this.fun=X,this.array=se}c(j,"Item"),j.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={};function F(){}c(F,"noop"),h.on=F,h.addListener=F,h.once=F,h.off=F,h.removeListener=F,h.removeAllListeners=F,h.emit=F,h.prependListener=F,h.prependOnceListener=F,h.listeners=function(X){return[]},h.binding=function(X){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(X){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},842:(J,h,U)=>{"use strict";var E=U(8764).Buffer;Object.defineProperty(h,"__esModule",{value:!0}),h.AbstractTokenizer=void 0;const N=U(5167);class L{constructor(K){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=K||{}}async readToken(K,P=this.position){const w=E.alloc(K.len);if(await this.readBuffer(w,{position:P})<K.len)throw new N.EndOfStreamError;return K.get(w,0)}async peekToken(K,P=this.position){const w=E.alloc(K.len);if(await this.peekBuffer(w,{position:P})<K.len)throw new N.EndOfStreamError;return K.get(w,0)}async readNumber(K){if(await this.readBuffer(this.numBuffer,{length:K.len})<K.len)throw new N.EndOfStreamError;return K.get(this.numBuffer,0)}async peekNumber(K){if(await this.peekBuffer(this.numBuffer,{length:K.len})<K.len)throw new N.EndOfStreamError;return K.get(this.numBuffer,0)}async ignore(K){if(this.fileInfo.size!==void 0){const P=this.fileInfo.size-this.position;if(K>P)return this.position+=P,P}return this.position+=K,K}async close(){}normalizeOptions(K,P){if(P&&P.position!==void 0&&P.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return P?{mayBeLess:P.mayBeLess===!0,offset:P.offset?P.offset:0,length:P.length?P.length:K.length-(P.offset?P.offset:0),position:P.position?P.position:this.position}:{mayBeLess:!1,offset:0,length:K.length,position:this.position}}}c(L,"AbstractTokenizer"),h.AbstractTokenizer=L},778:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.BufferTokenizer=void 0;const E=U(5167),N=U(842);class L extends N.AbstractTokenizer{constructor(K,P){super(P);this.uint8Array=K,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:K.length}async readBuffer(K,P){if(P&&P.position){if(P.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=P.position}const w=await this.peekBuffer(K,P);return this.position+=w,w}async peekBuffer(K,P){const w=this.normalizeOptions(K,P),R=Math.min(this.uint8Array.length-w.position,w.length);if(!w.mayBeLess&&R<w.length)throw new E.EndOfStreamError;return K.set(this.uint8Array.subarray(w.position,w.position+R),w.offset),R}async close(){}}c(L,"BufferTokenizer"),h.BufferTokenizer=L},7859:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromFile=h.FileTokenizer=void 0;const E=U(842),N=U(5167),L=U(7209);class V extends E.AbstractTokenizer{constructor(w,R){super(R);this.fd=w}async readBuffer(w,R){const A=this.normalizeOptions(w,R);this.position=A.position;const S=await L.read(this.fd,w,A.offset,A.length,A.position);if(this.position+=S.bytesRead,S.bytesRead<A.length&&(!R||!R.mayBeLess))throw new N.EndOfStreamError;return S.bytesRead}async peekBuffer(w,R){const A=this.normalizeOptions(w,R),S=await L.read(this.fd,w,A.offset,A.length,A.position);if(!A.mayBeLess&&S.bytesRead<A.length)throw new N.EndOfStreamError;return S.bytesRead}async close(){return L.close(this.fd)}}c(V,"FileTokenizer"),h.FileTokenizer=V;async function K(P){const w=await L.stat(P);if(!w.isFile)throw new Error(`File not a file: ${P}`);const R=await L.open(P,"r");return new V(R,{path:P,size:w.size})}c(K,"fromFile"),h.fromFile=K},7209:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.readFile=h.writeFileSync=h.writeFile=h.read=h.open=h.close=h.stat=h.createReadStream=h.pathExists=void 0;const E=U(4059);h.pathExists=E.existsSync,h.createReadStream=E.createReadStream;async function N(A){return new Promise((S,D)=>{E.stat(A,(j,F)=>{j?D(j):S(F)})})}c(N,"stat"),h.stat=N;async function L(A){return new Promise((S,D)=>{E.close(A,j=>{j?D(j):S()})})}c(L,"close"),h.close=L;async function V(A,S){return new Promise((D,j)=>{E.open(A,S,(F,X)=>{F?j(F):D(X)})})}c(V,"open"),h.open=V;async function K(A,S,D,j,F){return new Promise((X,se)=>{E.read(A,S,D,j,F,(ye,z,G)=>{ye?se(ye):X({bytesRead:z,buffer:G})})})}c(K,"read"),h.read=K;async function P(A,S){return new Promise((D,j)=>{E.writeFile(A,S,F=>{F?j(F):D()})})}c(P,"writeFile"),h.writeFile=P;function w(A,S){E.writeFileSync(A,S)}c(w,"writeFileSync"),h.writeFileSync=w;async function R(A){return new Promise((S,D)=>{E.readFile(A,(j,F)=>{j?D(j):S(F)})})}c(R,"readFile"),h.readFile=R},599:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.ReadStreamTokenizer=void 0;const E=U(842),N=U(5167),L=256e3;class V extends E.AbstractTokenizer{constructor(P,w){super(w);this.streamReader=new N.StreamReader(P)}async getFileInfo(){return this.fileInfo}async readBuffer(P,w){const R=this.normalizeOptions(P,w),A=R.position-this.position;if(A>0)return await this.ignore(A),this.readBuffer(P,w);if(A<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(R.length===0)return 0;const S=await this.streamReader.read(P,R.offset,R.length);if(this.position+=S,(!w||!w.mayBeLess)&&S<R.length)throw new N.EndOfStreamError;return S}async peekBuffer(P,w){const R=this.normalizeOptions(P,w);let A=0;if(R.position){const S=R.position-this.position;if(S>0){const D=new Uint8Array(R.length+S);return A=await this.peekBuffer(D,{mayBeLess:R.mayBeLess}),P.set(D.subarray(S),R.offset),A-S}else if(S<0)throw new Error("Cannot peek from a negative offset in a stream")}if(R.length>0){try{A=await this.streamReader.peek(P,R.offset,R.length)}catch(S){if(w&&w.mayBeLess&&S instanceof N.EndOfStreamError)return 0;throw S}if(!R.mayBeLess&&A<R.length)throw new N.EndOfStreamError}return A}async ignore(P){const w=Math.min(L,P),R=new Uint8Array(w);let A=0;for(;A<P;){const S=P-A,D=await this.readBuffer(R,{length:Math.min(w,S)});if(D<0)return D;A+=D}return A}}c(V,"ReadStreamTokenizer"),h.ReadStreamTokenizer=V},5849:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromBuffer=h.fromStream=h.EndOfStreamError=void 0;const E=U(599),N=U(778);var L=U(5167);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return L.EndOfStreamError}});function V(P,w){return w=w||{},new E.ReadStreamTokenizer(P,w)}c(V,"fromStream"),h.fromStream=V;function K(P,w){return new N.BufferTokenizer(P,w)}c(K,"fromBuffer"),h.fromBuffer=K},6597:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.fromStream=h.fromBuffer=h.EndOfStreamError=h.fromFile=void 0;const E=U(7209),N=U(5849);var L=U(7859);Object.defineProperty(h,"fromFile",{enumerable:!0,get:function(){return L.fromFile}});var V=U(5849);Object.defineProperty(h,"EndOfStreamError",{enumerable:!0,get:function(){return V.EndOfStreamError}}),Object.defineProperty(h,"fromBuffer",{enumerable:!0,get:function(){return V.fromBuffer}});async function K(P,w){if(w=w||{},P.path){const R=await E.stat(P.path);w.path=P.path,w.size=R.size}return N.fromStream(P,w)}c(K,"fromStream"),h.fromStream=K},3416:(J,h,U)=>{"use strict";var E=U(8764).Buffer;Object.defineProperty(h,"__esModule",{value:!0}),h.AnsiStringType=h.StringType=h.BufferType=h.Uint8ArrayType=h.IgnoreType=h.Float80_LE=h.Float80_BE=h.Float64_LE=h.Float64_BE=h.Float32_LE=h.Float32_BE=h.Float16_LE=h.Float16_BE=h.INT64_BE=h.UINT64_BE=h.INT64_LE=h.UINT64_LE=h.INT32_LE=h.INT32_BE=h.INT24_BE=h.INT24_LE=h.INT16_LE=h.INT16_BE=h.INT8=h.UINT32_BE=h.UINT32_LE=h.UINT24_BE=h.UINT24_LE=h.UINT16_BE=h.UINT16_LE=h.UINT8=void 0;const N=U(645);function L(A){return new DataView(A.buffer,A.byteOffset)}c(L,"dv"),h.UINT8={len:1,get(A,S){return L(A).getUint8(S)},put(A,S,D){return L(A).setUint8(S,D),S+1}},h.UINT16_LE={len:2,get(A,S){return L(A).getUint16(S,!0)},put(A,S,D){return L(A).setUint16(S,D,!0),S+2}},h.UINT16_BE={len:2,get(A,S){return L(A).getUint16(S)},put(A,S,D){return L(A).setUint16(S,D),S+2}},h.UINT24_LE={len:3,get(A,S){const D=L(A);return D.getUint8(S)+(D.getUint16(S+1,!0)<<8)},put(A,S,D){const j=L(A);return j.setUint8(S,D&255),j.setUint16(S+1,D>>8,!0),S+3}},h.UINT24_BE={len:3,get(A,S){const D=L(A);return(D.getUint16(S)<<8)+D.getUint8(S+2)},put(A,S,D){const j=L(A);return j.setUint16(S,D>>8),j.setUint8(S+2,D&255),S+3}},h.UINT32_LE={len:4,get(A,S){return L(A).getUint32(S,!0)},put(A,S,D){return L(A).setUint32(S,D,!0),S+4}},h.UINT32_BE={len:4,get(A,S){return L(A).getUint32(S)},put(A,S,D){return L(A).setUint32(S,D),S+4}},h.INT8={len:1,get(A,S){return L(A).getInt8(S)},put(A,S,D){return L(A).setInt8(S,D),S+2}},h.INT16_BE={len:2,get(A,S){return L(A).getInt16(S)},put(A,S,D){return L(A).setInt16(S,D),S+2}},h.INT16_LE={len:2,get(A,S){return L(A).getInt16(S,!0)},put(A,S,D){return L(A).setInt16(S,D,!0),S+2}},h.INT24_LE={len:3,get(A,S){const D=h.UINT24_LE.get(A,S);return D>8388607?D-16777216:D},put(A,S,D){const j=L(A);return j.setUint8(S,D&255),j.setUint16(S+1,D>>8,!0),S+3}},h.INT24_BE={len:3,get(A,S){const D=h.UINT24_BE.get(A,S);return D>8388607?D-16777216:D},put(A,S,D){const j=L(A);return j.setUint16(S,D>>8),j.setUint8(S+2,D&255),S+3}},h.INT32_BE={len:4,get(A,S){return L(A).getInt32(S)},put(A,S,D){return L(A).setInt32(S,D),S+4}},h.INT32_LE={len:4,get(A,S){return L(A).getInt32(S,!0)},put(A,S,D){return L(A).setInt32(S,D,!0),S+4}},h.UINT64_LE={len:8,get(A,S){return L(A).getBigUint64(S,!0)},put(A,S,D){return L(A).setBigUint64(S,D,!0),S+8}},h.INT64_LE={len:8,get(A,S){return L(A).getBigInt64(S,!0)},put(A,S,D){return L(A).setBigInt64(S,D,!0),S+8}},h.UINT64_BE={len:8,get(A,S){return L(A).getBigUint64(S)},put(A,S,D){return L(A).setBigUint64(S,D),S+8}},h.INT64_BE={len:8,get(A,S){return L(A).getBigInt64(S)},put(A,S,D){return L(A).setBigInt64(S,D),S+8}},h.Float16_BE={len:2,get(A,S){return N.read(A,S,!1,10,this.len)},put(A,S,D){return N.write(A,D,S,!1,10,this.len),S+this.len}},h.Float16_LE={len:2,get(A,S){return N.read(A,S,!0,10,this.len)},put(A,S,D){return N.write(A,D,S,!0,10,this.len),S+this.len}},h.Float32_BE={len:4,get(A,S){return L(A).getFloat32(S)},put(A,S,D){return L(A).setFloat32(S,D),S+4}},h.Float32_LE={len:4,get(A,S){return L(A).getFloat32(S,!0)},put(A,S,D){return L(A).setFloat32(S,D,!0),S+4}},h.Float64_BE={len:8,get(A,S){return L(A).getFloat64(S)},put(A,S,D){return L(A).setFloat64(S,D),S+8}},h.Float64_LE={len:8,get(A,S){return L(A).getFloat64(S,!0)},put(A,S,D){return L(A).setFloat64(S,D,!0),S+8}},h.Float80_BE={len:10,get(A,S){return N.read(A,S,!1,63,this.len)},put(A,S,D){return N.write(A,D,S,!1,63,this.len),S+this.len}},h.Float80_LE={len:10,get(A,S){return N.read(A,S,!0,63,this.len)},put(A,S,D){return N.write(A,D,S,!0,63,this.len),S+this.len}};class V{constructor(S){this.len=S}get(S,D){}}c(V,"IgnoreType"),h.IgnoreType=V;class K{constructor(S){this.len=S}get(S,D){return S.subarray(D,D+this.len)}}c(K,"Uint8ArrayType"),h.Uint8ArrayType=K;class P{constructor(S){this.len=S}get(S,D){return S.slice(D,D+this.len)}}c(P,"BufferType"),h.BufferType=P;class w{constructor(S,D){this.len=S,this.encoding=D}get(S,D){return E.from(S).toString(this.encoding,D,D+this.len)}}c(w,"StringType"),h.StringType=w;class R{constructor(S){this.len=S}static decode(S,D,j){let F="";for(let X=D;X<j;++X)F+=R.codePointToString(R.singleByteDecoder(S[X]));return F}static inRange(S,D,j){return D<=S&&S<=j}static codePointToString(S){return S<=65535?String.fromCharCode(S):(S-=65536,String.fromCharCode((S>>10)+55296,(S&1023)+56320))}static singleByteDecoder(S){if(R.inRange(S,0,127))return S;const D=R.windows1252[S-128];if(D===null)throw Error("invaliding encoding");return D}get(S,D=0){return R.decode(S,D,D+this.len)}}c(R,"AnsiStringType"),h.AnsiStringType=R,R.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},5102:()=>{},189:function(J,h,U){"use strict";var E=this&&this.__spreadArrays||function(){for(var w=0,R=0,A=arguments.length;R<A;R++)w+=arguments[R].length;for(var S=Array(w),D=0,R=0;R<A;R++)for(var j=arguments[R],F=0,X=j.length;F<X;F++,D++)S[D]=j[F];return S};Object.defineProperty(h,"__esModule",{value:!0}),h.config=h.loadMessageBundle=void 0;var N=U(1926),L=U(800),V=U(800);Object.defineProperty(h,"MessageFormat",{enumerable:!0,get:function(){return V.MessageFormat}}),Object.defineProperty(h,"BundleFormat",{enumerable:!0,get:function(){return V.BundleFormat}});function K(w){return function(R,A){for(var S=[],D=2;D<arguments.length;D++)S[D-2]=arguments[D];if(typeof R=="number")throw new Error("Browser implementation does currently not support externalized strings.");return L.localize.apply(void 0,E([R,A],S))}}c(K,"loadMessageBundle"),h.loadMessageBundle=K;function P(w){return L.setPseudo((w==null?void 0:w.locale.toLowerCase())==="pseudo"),K}c(P,"config"),h.config=P,N.default.install(Object.freeze({loadMessageBundle:K,config:P}))},800:(J,h,U)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.config=h.loadMessageBundle=h.localize=h.format=h.setPseudo=h.isPseudo=h.isDefined=h.BundleFormat=h.MessageFormat=void 0;var E=U(1926),N;(function(D){D.file="file",D.bundle="bundle",D.both="both"})(N=h.MessageFormat||(h.MessageFormat={}));var L;(function(D){D.standalone="standalone",D.languagePack="languagePack"})(L=h.BundleFormat||(h.BundleFormat={}));var V;(function(D){function j(F){var X=F;return X&&K(X.key)&&K(X.comment)}c(j,"is"),D.is=j})(V||(V={}));function K(D){return typeof D!="undefined"}c(K,"isDefined"),h.isDefined=K,h.isPseudo=!1;function P(D){h.isPseudo=D}c(P,"setPseudo"),h.setPseudo=P;function w(D,j){var F;return h.isPseudo&&(D="\uFF3B"+D.replace(/[aouei]/g,"$&$&")+"\uFF3D"),j.length===0?F=D:F=D.replace(/\{(\d+)\}/g,function(X,se){var ye=se[0],z=j[ye],G=X;return typeof z=="string"?G=z:(typeof z=="number"||typeof z=="boolean"||z===void 0||z===null)&&(G=String(z)),G}),F}c(w,"format"),h.format=w;function R(D,j){for(var F=[],X=2;X<arguments.length;X++)F[X-2]=arguments[X];return w(j,F)}c(R,"localize"),h.localize=R;function A(D){return E.default().loadMessageBundle(D)}c(A,"loadMessageBundle"),h.loadMessageBundle=A;function S(D){return E.default().config(D)}c(S,"config"),h.config=S},1926:(J,h)=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var U;function E(){if(U===void 0)throw new Error("No runtime abstraction layer installed");return U}c(E,"RAL"),function(N){function L(V){if(V===void 0)throw new Error("No runtime abstraction layer provided");U=V}c(L,"install"),N.install=L}(E||(E={})),h.default=E},6822:(J,h,U)=>{"use strict";J.exports=U(189)},2479:J=>{J.exports=h;function h(U,E){if(U&&E)return h(U)(E);if(typeof U!="function")throw new TypeError("need wrapper function");return Object.keys(U).forEach(function(L){N[L]=U[L]}),N;function N(){for(var L=new Array(arguments.length),V=0;V<L.length;V++)L[V]=arguments[V];var K=U.apply(this,L),P=L[L.length-1];return typeof K=="function"&&K!==P&&Object.keys(P).forEach(function(w){K[w]=P[w]}),K}c(N,"wrapper")}c(h,"wrappy")},6529:()=>{},6391:()=>{},4059:()=>{}},__webpack_module_cache__={};function __webpack_require__(J){var h=__webpack_module_cache__[J];if(h!==void 0)return h.exports;var U=__webpack_module_cache__[J]={id:J,loaded:!1,exports:{}};return __webpack_modules__[J].call(U.exports,U,U.exports,__webpack_require__),U.loaded=!0,U.exports}c(__webpack_require__,"__webpack_require__"),(()=>{__webpack_require__.n=J=>{var h=J&&J.__esModule?()=>J.default:()=>J;return __webpack_require__.d(h,{a:h}),h}})(),(()=>{__webpack_require__.d=(J,h)=>{for(var U in h)__webpack_require__.o(h,U)&&!__webpack_require__.o(J,U)&&Object.defineProperty(J,U,{enumerable:!0,get:h[U]})}})(),(()=>{__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(J){if(typeof window=="object")return window}}()})(),(()=>{__webpack_require__.o=(J,h)=>Object.prototype.hasOwnProperty.call(J,h)})(),(()=>{__webpack_require__.r=J=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(J,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(J,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.nmd=J=>(J.paths=[],J.children||(J.children=[]),J)})();var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{StateKeys:()=>qo,activate:()=>XE,getOpenActionsService:()=>Cu,getState:()=>Ny,updateState:()=>hp});var J={};__webpack_require__.r(J),__webpack_require__.d(J,{max:()=>Wu,min:()=>Fc});const h=require("vscode"),U=47;function E(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,fragment:""}).toString()}c(E,"asKey");function N(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.query&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,query:"",fragment:""}).toString()}c(N,"asFileKey");function L(t,e){return`${(e==null?void 0:e.excludeScheme)?"":`${t.scheme}-`}${t.authority}${t.path.endsWith("/")?t.path.slice(0,-1):t.path}`}c(L,"asFileStorageKey");function V(t){const e=t.path;let r=0,n=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===U){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":e.slice(r,n)}c(V,"basename");function K(t){const e=t.path;if(e.length===1)return"/";let r,n=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(r=e.charCodeAt(o),r===U){if(!i){n=o;break}}else i=!1;return n===-1?"/":e.slice(0,n)}c(K,"dirname");function P(t){const e=t.path.lastIndexOf("/");return e===-1?t.with({path:"/"}):t.with({path:t.path.substring(0,e)})}c(P,"getParent");function w(t,e){const r=typeof e=="string"?e:e.path;return r.startsWith(t.path)?h.Uri.joinPath(t,r.substr(t.path.length)):h.Uri.joinPath(t,r)}c(w,"joinRelativePath");function R(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),A(t,e)&&t.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):A(t,e)&&t.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}c(R,"isChild");function A(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||t.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===t.scheme&&e.authority===t.authority&&(e.path.length===1||t.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}c(A,"isDescendent");function S(t){return t&&typeof t=="object"&&"scheme"in t}c(S,"isSerializedUri");const D=new TextDecoder,j=new TextEncoder,F=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function X(t){const e=j.encode(t),r=new Array(e.length);for(let n=0;n<e.length;++n)r[n]=F[e[n]];return r.join("")}c(X,"encodeUtf8Hex");function se(t){const e=t.match(/(\w{2})/g);if(e===null)return"";const r=new Uint8Array(e.map(n=>parseInt(n,16)));return D.decode(r)}c(se,"decodeUtf8Hex");const ye=/^[0-9a-f]{40}$/i;function z(t){return t!==void 0&&ye.test(t)}c(z,"isSha");const G=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function re(t){return G.test(t)}c(re,"isValidBranchName");function W(t){return t===""||t==="~"||t==="HEAD"?t:t.endsWith("^")?`${t.substr(0,7)}^`:t.substr(0,7)}c(W,"shortenRef");var B;(function(t){t.authoritySeparator="+",t.scheme="vscode-vfs",t.baseVirtualWorkspaceUri=h.Uri.parse(`${t.scheme}://`);function e(u){const{authority:d}=u,f=d.indexOf(t.authoritySeparator);return f!==-1?d.substr(0,f):d}c(e,"getProviderId"),t.getProviderId=e;function r(u){return u.scheme!==t.scheme?u:u.with({scheme:e(u)})}c(r,"getProviderUri"),t.getProviderUri=r;function n(u,d){const f=new Map,p=h.workspace.textDocuments;if(p.length===0)return f;for(const g of p)g.uri.scheme===u&&d.some(_=>A(g.uri,_))&&f.set(E(g.uri),g.uri);return f}c(n,"getOpenUris"),t.getOpenUris=n;function i(u){return u.scheme===t.scheme?u:u.with({scheme:t.scheme})}c(i,"getVirtualUri"),t.getVirtualUri=i;function o(u,d){const[f,p]=u.authority.split(t.authoritySeparator);let g;if(p)try{const _=JSON.parse(se(p));g=d?d(_):_}catch{}return{scheme:f,metadata:g}}c(o,"decodeAuthority"),t.decodeAuthority=o;function a(u,d){const f=d?`${t.authoritySeparator}${X(JSON.stringify(d))}`:"";return`${u}${f}`}c(a,"encodeAuthority"),t.encodeAuthority=a;function s(u){return u.authority.indexOf(t.authoritySeparator)===-1}c(s,"isCanonicalUri"),t.isCanonicalUri=s;function l(){var u,d;return(d=(u=h.workspace.workspaceFolders)==null?void 0:u.every(f=>f.uri.scheme===t.scheme))!=null?d:!1}c(l,"isVirtualWorkspace"),t.isVirtualWorkspace=l})(B||(B={}));var ie;(function(t){t[t.Admin=100]="Admin",t[t.Maintain=40]="Maintain",t[t.WriteToPullRequest=31]="WriteToPullRequest",t[t.Write=30]="Write",t[t.Triage=20]="Triage",t[t.Read=10]="Read",t[t.None=0]="None"})(ie||(ie={}));var Q;(function(t){t[t.Branch=0]="Branch",t[t.RemoteBranch=1]="RemoteBranch",t[t.Tag=2]="Tag",t[t.Commit=3]="Commit"})(Q||(Q={}));var de;(function(t){function e(r){return r!==void 0&&r.type===Pe.Active}c(e,"isActive"),t.isActive=e})(de||(de={}));var he;(function(t){function e(r){const n=B.decodeAuthority(r).metadata;if(!(n===void 0||n.idx===void 0)){if(n.idx==="latest")return{type:xe.Latest};if(z(n.idx))return{type:xe.SHA,sha:n.idx}}}c(e,"decode"),t.decode=e})(he||(he={}));var xe;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(xe||(xe={}));var Pe;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(Pe||(Pe={})),function(t){function e(r){return r!==void 0&&(r===t.Indexed||r===t.Match||r===t.Active)}c(e,"hasIndex"),t.hasIndex=e}(Pe||(Pe={}));var He;(function(t){t[t.Open=0]="Open",t[t.Closed=1]="Closed",t[t.Merged=2]="Merged"})(He||(He={}));var q;(function(t){t[t.Changed=1]="Changed",t[t.Created=2]="Created",t[t.Deleted=3]="Deleted"})(q||(q={}));var ve;(function(t){t.CurrentWindow="currentWindow",t.NewWindow="newWindow",t.AddToWorkspace="addToWorkspace"})(ve||(ve={}));var De;(function(t){t[t.Branch=0]="Branch",t[t.Tag=1]="Tag",t[t.Commit=2]="Commit",t[t.PullRequest=3]="PullRequest",t[t.Tree=4]="Tree"})(De||(De={}));var ot;(function(t){t[t.Abort=0]="Abort",t[t.KeepCurrent=1]="KeepCurrent",t[t.DiscardCurrent=2]="DiscardCurrent",t[t.Merge=3]="Merge"})(ot||(ot={}));var je;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.File=4]="File",t[t.Tag=5]="Tag"})(je||(je={}));var Ee;(function(t){t.Branch="branch",t.RemoteBranch="remoteBranch",t.PullRequestBranch="pullRequestBranch",t.PullRequestRemoteBranch="pullRequestRemoteBranch",t.Tag="tag",t.Commit="commit"})(Ee||(Ee={}));var Je;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(Je||(Je={}));var ft;(function(t){t.Browse="browse",t.Edit="edit"})(ft||(ft={}));var Ve;(function(t){t.CommitFailedError="CommitFailedError",t.DetachedHEADError="DetachedHEADError",t.InvalidBranchNameError="InvalidBranchNameError",t.InvalidCredentialsError="InvalidCredentialsError",t.MergeConflictError="MergeConflictError",t.NothingToCommitError="NothingToCommitError",t.SyncConflictsError="SyncConflictsError",t.SyncOrFetchError="SyncOrFetchError",t.Unknown="Unknown"})(Ve||(Ve={}));class Z extends Error{constructor(e,r,n){super(typeof e=="string"?e:e.message);this.messageOrError=e,this.errorCode=r,this.action=n}static CommitFailedError(){return new Z("Failed to create and push commit",Ve.CommitFailedError)}static DetachedHEADError(e){return new Z(e,Ve.DetachedHEADError)}static InvalidBranchNameError(e,r=!1){const n=r?`Branch '${e}' already exists`:`Invalid branch name '${e}'`;return new Z(n,Ve.InvalidBranchNameError)}static InvalidCredentialsError(e,r){return new Z(e,Ve.InvalidCredentialsError,r)}static MergeConflictError(e){return new Z(e,Ve.MergeConflictError)}static NothingToCommitError(e){return new Z(e,Ve.NothingToCommitError)}static SyncOrFetchError(e=!1){const r=e?"Unable to sync the repository":"Unable to fetch the repository";return new Z(r,Ve.SyncOrFetchError)}static SyncConflictsError(){const e="Sync operation will result in conflicts";return new Z(e,Ve.SyncConflictsError)}static asVirtualProviderErrorCode(e){return e instanceof Error&&"messageOrError"in e&&"errorCode"in e?e.errorCode:Ve.Unknown}}c(Z,"VirtualProviderError");class vt extends Error{constructor(e,r,n){super(e.message);this.original=e,this.name=r,this.id=n;var i;(i=Error.captureStackTrace)==null||i.call(Error,this,vt)}}c(vt,"PullRequestNotFoundError");class Qe extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Qe)}}c(Qe,"RepositoryForbiddenError");class at extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,at)}}c(at,"RepositoryNotFoundError");class we extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,we)}}c(we,"RepositoryEmptyError");const be=6;var Ge;(function(t){t.Off="off",t.Auto="auto",t.Always="always"})(Ge||(Ge={}));var Me;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(Me||(Me={})),function(t){function e(r){return r===t.None||r===t.Latest||r===t.Match||r===t.TipPlusLatest?r:t.None}c(e,"sanitize"),t.sanitize=e}(Me||(Me={}));var Xe;(function(t){t.Browse="browse",t.Edit="edit"})(Xe||(Xe={})),function(t){function e(n){return n===t.Browse||n===t.Edit?n:t.Edit}c(e,"sanitize"),t.sanitize=e;function r(n){return n===t.Browse?t.Edit:t.Browse}c(r,"toggle"),t.toggle=r}(Xe||(Xe={}));var Xt;(function(t){function e(r,n){return r.display===n.display&&r.index===n.index}c(e,"equals"),t.equals=e})(Xt||(Xt={}));var _t;(function(t){const e=new Map([[Ee.Branch,Me.None],[Ee.RemoteBranch,Me.None],[Ee.PullRequestBranch,Me.Match],[Ee.PullRequestRemoteBranch,Me.Match],[Ee.Commit,Me.Match],[Ee.Tag,Me.Match]]),r=new Map([[Ee.Branch,Xe.Edit],[Ee.RemoteBranch,Xe.Edit],[Ee.PullRequestBranch,Xe.Browse],[Ee.PullRequestRemoteBranch,Xe.Browse],[Ee.Commit,Xe.Browse],[Ee.Tag,Xe.Browse]]);function n(o){var a,s;return{display:(a=r.get(o))!=null?a:Xe.Edit,index:(s=e.get(o))!=null?s:Me.None}}c(n,"getDefault"),t.getDefault=n;function i(o){switch(o){case Ee.Branch:case Ee.RemoteBranch:return{display:Xe.Browse,index:Me.Latest};case Ee.PullRequestBranch:case Ee.PullRequestRemoteBranch:return{display:Xe.Browse,index:Me.Match};case Ee.Commit:case Ee.Tag:return{display:Xe.Browse,index:Me.Match};default:return{display:Xe.Edit,index:Me.None}}}c(i,"getIndexDefault"),t.getIndexDefault=i})(_t||(_t={}));const Tt=null;function jr(t){const[,e]=t.extension.packageJSON.version.split(".");return Number.parseInt(e)%2==1}c(jr,"isPreRelease");var br=__webpack_require__(5179),er=__webpack_require__.n(br);const rt="modes",Wt="indexMemento";class yn{constructor(){this._onDidChange=new h.EventEmitter,this._onDidChangeAny=new h.EventEmitter,this.memoryState=new Map}static configure(e,r){fe.configPrefix=e,fe.state=r.workspaceState,r.subscriptions.push(h.workspace.onDidChangeConfiguration(fe.onConfigurationChanged,fe))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(this.configPrefix)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(rt),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const r of this.memoryState.entries())this.modes[r[0]]=r[1];this._state.update(rt,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(Wt),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,r,n){return n===void 0?h.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,r).get(e===void 0?this.configPrefix:e):h.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,r).get(e===void 0?this.configPrefix:e,n)}getMode(e,r,n){var i;const o=e.toString();let a=this.modes!==void 0?this.modes[o]:void 0;if(a!==void 0)return{display:Xe.sanitize(a.display),index:Me.sanitize(a.index)};if(a=this.memoryState.get(o),a!==void 0)return a;if(r===Ee.Branch||r===Ee.RemoteBranch)switch((i=h.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:Xe.Edit,index:Me.None};case"latest":return{display:Xe.Browse,index:Me.Latest};case"tipPlusLatest":return{display:Xe.Edit,index:Me.TipPlusLatest}}if(!n)return _t.getDefault(r)}setMode(e,r){const n=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(n,r),Promise.resolve()):(this.modes[n]=r,this._state.update(rt,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,r){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=r,this._state.update(Wt,this.indexMemento))}getAny(e,r,n){return n===void 0?h.workspace.getConfiguration(void 0,r).get(e):h.workspace.getConfiguration(void 0,r).get(e,n)}changed(e,r,n){var i;return(i=e==null?void 0:e.affectsConfiguration(`${this.configPrefix}.${r}`,n))!=null?i:!0}inspect(e,r){return h.workspace.getConfiguration(e===void 0?void 0:this.configPrefix,r).inspect(e===void 0?this.configPrefix:e)}inspectAny(e,r){return h.workspace.getConfiguration(void 0,r).inspect(e)}async migrate(e,r,n){const i=fe.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&n.fallbackValue!==void 0&&(await this.update(r,n.fallbackValue,h.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,r,n){const i=fe.inspect(e);if(i===void 0)return;const o=fe.inspect(r);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,h.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,h.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,h.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,r,n){return h.workspace.getConfiguration(this.configPrefix).update(e,r,n)}updateAny(e,r,n,i){return h.workspace.getConfiguration(void 0,n===h.ConfigurationTarget.Global?void 0:i).update(e,r,n)}updateEffective(e,r){const n=fe.inspect(e);return n.workspaceFolderValue!==void 0?r===n.workspaceFolderValue?Promise.resolve(void 0):fe.update(e,r,h.ConfigurationTarget.WorkspaceFolder):n.workspaceValue!==void 0?r===n.workspaceValue?Promise.resolve(void 0):fe.update(e,r,h.ConfigurationTarget.Workspace):n.globalValue===r||n.globalValue===void 0&&r===n.defaultValue?Promise.resolve(void 0):fe.update(e,er()(r,n.defaultValue)?void 0:r,h.ConfigurationTarget.Global)}getUseNewCommitApi(){let e=this.get("experimental.useNewCommitApi");return e===null&&(e=!0),e}}c(yn,"Configuration");const fe=new yn,st="";var Ce;(function(t){t.Off="off",t.Error="error",t.Warn="warn",t.Info="info",t.Debug="debug"})(Ce||(Ce={}));var ut;(function(t){t[t.Off=0]="Off",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(ut||(ut={}));const Dt="[RemoteHub]",At=c(class{static configure(t,e,r){this._isDebugging=t.extensionMode===h.ExtensionMode.Development,this.outputChannelName=e,this.logLevel=r}static enabled(t){return this.level>=this.toOrderedLevel(t)}static get logLevel(){return this._logLevel}static set logLevel(t){var e,r;this._logLevel=t,this.level=this.toOrderedLevel(t),t===Ce.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(r=this.output)!=null?r:h.window.createOutputChannel(this.outputChannelName)}static toOrderedLevel(t){switch(t){case Ce.Off:return 0;case Ce.Error:return 1;case Ce.Warn:return 2;case Ce.Info:return 3;case Ce.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(t,...e){At.isDebugging&&console.log(this.timestamp,Dt,t!=null?t:st,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:st}${this.toLoggableParams(!0,e)}`)}static error(t,e,...r){if(!(this.level<1&&!At.isDebugging)){if(e===void 0){const n=t instanceof Error?t.stack:void 0;if(n){const i=/.*\s*?at\s(.+?)\s/.exec(n);i!==null&&(e=i[1])}}At.isDebugging&&console.error(this.timestamp,Dt,e!=null?e:st,...r,t),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:st}${this.toLoggableParams(!1,r)}
${String(t)}`)}}static log(t,...e){At.isDebugging&&console.log(this.timestamp,Dt,t!=null?t:st,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:st}${this.toLoggableParams(!1,e)}`)}static warn(t,...e){At.isDebugging&&console.warn(this.timestamp,Dt,t!=null?t:st,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:st}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var t;(t=this.output)==null||t.show()}static toLoggable(t,e){if(typeof t!="object")return String(t);if(t instanceof h.Uri)return`Uri(${t.toString(!0)})`;try{return JSON.stringify(t,e)}catch{return"<error>"}}static toLoggableName(t){var e,r,n;let i;if(typeof t=="function"){if(t.prototype===void 0||t.prototype.constructor===void 0)return t.name;i=(e=t.prototype.constructor.name)!=null?e:st}else i=(n=(r=t.constructor)==null?void 0:r.name)!=null?n:st;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const t=new Date;return`[${t.toISOString().replace(/T/," ").replace(/\..+/,st)}:${`00${t.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(t,e){if(e.length===0||t&&this.level<4&&!At.isDebugging)return st;const r=e.map(n=>this.toLoggable(n)).join(", ");return r.length!==0?` \u2014 ${r}`:st}},"_Logger");let te=At;te.level=0,te._logLevel=Ce.Off;class I{constructor(e){this.provider=e,this._timeout=0,this._disposable=fe.onDidChange(this.onConfigurationChanged,this),this.maybeQueueFetch()}dispose(){this._disposable.dispose(),this._timeout&&clearTimeout(this._timeout)}get config(){var e;if(this._config===void 0){const r=fe.get("autoFetch");this._config={enabled:(e=r.enabled)!=null?e:!0,interval:r.interval*1e3}}return this._config}onConfigurationChanged(e){!fe.changed(e,"autoFetch")||(this._config=void 0,this.maybeQueueFetch())}async fetchAll(){const e=this.provider.repositories;e.length!==0&&(await h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{for(const r of e)try{await this.provider.fetch(r.uri)}catch(n){te.error(n)}}),this.maybeQueueFetch())}maybeQueueFetch(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),!!this.config.enabled&&(this._timeout=setTimeout(()=>this.fetchAll(),this.config.interval))}}c(I,"AutoFetchService");var m=__webpack_require__(189);function v(t){return t!==void 0&&typeof t.then=="function"}c(v,"isPromise");const M="";function ee(...t){if(t.length===1){const e=t[0];return e===void 0?M:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}c(ee,"defaultResolver");function le(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$gate$${r}`;n.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:ee)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let l=this[s];if(l===void 0){let u;try{if(u=i.apply(this,a),u==null||!v(u))return u;this[s]=l=u.then(d=>(this[s]=void 0,d)).catch(d=>{throw this[s]=void 0,d})}catch(d){throw this[s]=void 0,d}}return l}}}c(le,"gate");function Se(t){const e=performance.now()*.001;let r=Math.floor(e),n=Math.floor(e%1*1e9);return t!==void 0&&(r=r-t[0],n=n-t[1],n<0&&(r--,n+=1e9)),[r,n]}c(Se,"hrtime");let dt=0;function Ot(){return dt===Number.MAX_SAFE_INTEGER&&(dt=0),++dt}c(Ot,"getNextInstanceId");const Et=c(class{constructor(t,e,...r){this.context=t,this.instance=`[${Ot().toString().padStart(5)}] `;var n,i,o,a,s,l;let u;if(typeof(e==null?void 0:e.log)=="boolean"?u=e.log?{}:void 0:u=(n=e==null?void 0:e.log)!=null?n:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:Ce.Info,this.time=Se(),u){if(!te.enabled(this.logLevel))return;r.length?wt(this.logLevel,`${this.instance}${(o=u.prefix)!=null?o:""}${t}${(a=u.message)!=null?a:""}`,...r):wt(this.logLevel,`${this.instance}${(s=u.prefix)!=null?s:""}${t}${(l=u.message)!=null?l:""}`)}}log(t){this.logCore(this.context,t,!1)}logStep(t,e){(!t||e)&&this.logCore(this.context,e,!1),this.step=t?{time:Se(),label:t}:void 0}restart(t){this.logCore(this.context,t,!0),this.step=void 0,this.time=Se()}stop(t){this.restart(t)}logCore(t,e,r){var n,i,o,a,s,l,u;if(!te.enabled(this.logLevel))return;let d="";if(this.step){const[_,b]=Se(this.step.time),y=_*1e3+Math.floor(b/1e6);d=`${this.step.label?`${this.step.label} took `:""}${y} ms`}if(!r){wt(this.logLevel,`${this.instance}${(n=e==null?void 0:e.prefix)!=null?n:""}${t}${(i=e==null?void 0:e.message)!=null?i:""}${d?` ${d}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[f,p]=Se(this.time),g=f*1e3+Math.floor(p/1e6);wt(g>500?Ce.Warn:this.logLevel,`${this.instance}${(a=e==null?void 0:e.prefix)!=null?a:""}${t}${(s=e==null?void 0:e.message)!=null?s:""}${(l=e==null?void 0:e.took)!=null?l:" took "}${g} ms${d?` (${d})`:""}${(u=e==null?void 0:e.suffix)!=null?u:""}`)}static start(t,e,...r){var n;(n=Et.watches.get(t))==null||n.log(),Et.watches.set(t,new Et(t,e,...r))}static log(t,e){var r;(r=Et.watches.get(t))==null||r.log(e)}static stop(t,e){var r;(r=Et.watches.get(t))==null||r.stop(e),Et.watches.delete(t)}},"_Stopwatch");let Fe=Et;Fe.watches=new Map;function wt(t,e,...r){switch(t){case Ce.Warn:te.warn(e,...r);break;case Ce.Info:te.log(e,...r);break;default:te.debug(e,...r);break}}c(wt,"log");function nn(){}c(nn,"Diff"),nn.prototype={diff:c(function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var o=this;function a(b){return i?(setTimeout(function(){i(void 0,b)},0),!0):b}c(a,"done"),e=this.castInput(e),r=this.castInput(r),e=this.removeEmpty(this.tokenize(e)),r=this.removeEmpty(this.tokenize(r));var s=r.length,l=e.length,u=1,d=s+l,f=[{newPos:-1,components:[]}],p=this.extractCommon(f[0],r,e,0);if(f[0].newPos+1>=s&&p+1>=l)return a([{value:this.join(r),count:r.length}]);function g(){for(var b=-1*u;b<=u;b+=2){var y=void 0,x=f[b-1],C=f[b+1],k=(C?C.newPos:0)-b;x&&(f[b-1]=void 0);var T=x&&x.newPos+1<s,O=C&&0<=k&&k<l;if(!T&&!O){f[b]=void 0;continue}if(!T||O&&x.newPos<C.newPos?(y=Au(C),o.pushComponent(y.components,void 0,!0)):(y=x,y.newPos++,o.pushComponent(y.components,!0,void 0)),k=o.extractCommon(y,r,e,b),y.newPos+1>=s&&k+1>=l)return a(Ru(o,y.components,r,e,o.useLongestToken));f[b]=y}u++}if(c(g,"execEditLength"),i)c(function b(){setTimeout(function(){if(u>d)return i();g()||b()},0)},"exec")();else for(;u<=d;){var _=g();if(_)return _}},"diff"),pushComponent:c(function(e,r,n){var i=e[e.length-1];i&&i.added===r&&i.removed===n?e[e.length-1]={count:i.count+1,added:r,removed:n}:e.push({count:1,added:r,removed:n})},"pushComponent"),extractCommon:c(function(e,r,n,i){for(var o=r.length,a=n.length,s=e.newPos,l=s-i,u=0;s+1<o&&l+1<a&&this.equals(r[s+1],n[l+1]);)s++,l++,u++;return u&&e.components.push({count:u}),e.newPos=s,l},"extractCommon"),equals:c(function(e,r){return this.options.comparator?this.options.comparator(e,r):e===r||this.options.ignoreCase&&e.toLowerCase()===r.toLowerCase()},"equals"),removeEmpty:c(function(e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r},"removeEmpty"),castInput:c(function(e){return e},"castInput"),tokenize:c(function(e){return e.split("")},"tokenize"),join:c(function(e){return e.join("")},"join")};function Ru(t,e,r,n,i){for(var o=0,a=e.length,s=0,l=0;o<a;o++){var u=e[o];if(u.removed){if(u.value=t.join(n.slice(l,l+u.count)),l+=u.count,o&&e[o-1].added){var f=e[o-1];e[o-1]=e[o],e[o]=f}}else{if(!u.added&&i){var d=r.slice(s,s+u.count);d=d.map(function(g,_){var b=n[l+_];return b.length>g.length?b:g}),u.value=t.join(d)}else u.value=t.join(r.slice(s,s+u.count));s+=u.count,u.added||(l+=u.count)}}var p=e[a-1];return a>1&&typeof p.value=="string"&&(p.added||p.removed)&&t.equals("",p.value)&&(e[a-2].value+=p.value,e.pop()),e}c(Ru,"buildValues");function Au(t){return{newPos:t.newPos,components:t.components.slice(0)}}c(Au,"clonePath");var Ga=new nn;function jo(t,e,r){return Ga.diff(t,e,r)}c(jo,"diffChars");function Vo(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}c(Vo,"generateOptions");var Go=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Ko=/\S/,Nn=new nn;Nn.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Ko.test(t)&&!Ko.test(e)},Nn.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<e.length-1;r++)!e[r+1]&&e[r+2]&&Go.test(e[r])&&Go.test(e[r+2])&&(e[r]+=e[r+2],e.splice(r+1,2),r--);return e};function gp(t,e,r){return r=Vo(r,{ignoreWhitespace:!0}),Nn.diff(t,e,r)}c(gp,"diffWords");function mp(t,e,r){return Nn.diff(t,e,r)}c(mp,"diffWordsWithSpace");var Qo=new nn;Qo.tokenize=function(t){var e=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var i=r[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function Iu(t,e,r){return Qo.diff(t,e,r)}c(Iu,"diffLines");function vp(t,e,r){var n=Vo(r,{ignoreWhitespace:!0});return Qo.diff(t,e,n)}c(vp,"diffTrimmedLines");var Ka=new nn;Ka.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};function xc(t,e,r){return Ka.diff(t,e,r)}c(xc,"diffSentences");var Mn=new nn;Mn.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function wp(t,e,r){return Mn.diff(t,e,r)}c(wp,"diffCss");function Zo(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zo=c(function(e){return typeof e},"_typeof"):Zo=c(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),Zo(t)}c(Zo,"_typeof");function bn(t){return ku(t)||Tu(t)||_n(t)||Du()}c(bn,"_toConsumableArray");function ku(t){if(Array.isArray(t))return Qa(t)}c(ku,"_arrayWithoutHoles");function Tu(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}c(Tu,"_iterableToArray");function _n(t,e){if(!!t){if(typeof t=="string")return Qa(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qa(t,e)}}c(_n,"_unsupportedIterableToArray");function Qa(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}c(Qa,"_arrayLikeToArray");function Du(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}c(Du,"_nonIterableSpread");var Fu=Object.prototype.toString,Pi=new nn;Pi.useLongestToken=!0,Pi.tokenize=Qo.tokenize,Pi.castInput=function(t){var e=this.options,r=e.undefinedReplacement,n=e.stringifyReplacer,i=n===void 0?function(o,a){return typeof a=="undefined"?r:a}:n;return typeof t=="string"?t:JSON.stringify(xn(t,null,null,i),i,"  ")},Pi.equals=function(t,e){return nn.prototype.equals.call(Pi,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function yp(t,e,r){return Pi.diff(t,e,r)}c(yp,"diffJson");function xn(t,e,r,n,i){e=e||[],r=r||[],n&&(t=n(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return r[o];var a;if(Fu.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),r.push(a),o=0;o<t.length;o+=1)a[o]=xn(t[o],e,r,n,i);return e.pop(),r.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),Zo(t)==="object"&&t!==null){e.push(t),a={},r.push(a);var s=[],l;for(l in t)t.hasOwnProperty(l)&&s.push(l);for(s.sort(),o=0;o<s.length;o+=1)l=s[o],a[l]=xn(t[l],e,r,n,l);e.pop(),r.pop()}else a=t;return a}c(xn,"canonicalize");var Xo=new nn;Xo.tokenize=function(t){return t.slice()},Xo.join=Xo.removeEmpty=function(t){return t};function bp(t,e,r){return Xo.diff(t,e,r)}c(bp,"diffArrays");function oo(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.split(/\r\n|[\n\v\f\r\x85]/),n=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var u={};for(i.push(u);o<r.length;){var d=r[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(d))break;var f=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(d);f&&(u.index=f[1]),o++}for(s(u),s(u),u.hunks=[];o<r.length;){var p=r[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(p))break;if(/^@@/.test(p))u.hunks.push(l());else{if(p&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(p));o++}}}c(a,"parseIndex");function s(u){var d=/^(---|\+\+\+)\s+(.*)$/.exec(r[o]);if(d){var f=d[1]==="---"?"old":"new",p=d[2].split("	",2),g=p[0].replace(/\\\\/g,"\\");/^".*"$/.test(g)&&(g=g.substr(1,g.length-2)),u[f+"FileName"]=g,u[f+"Header"]=(p[1]||"").trim(),o++}}c(s,"parseFileHeader");function l(){var u=o,d=r[o++],f=d.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),p={oldStart:+f[1],oldLines:typeof f[2]=="undefined"?1:+f[2],newStart:+f[3],newLines:typeof f[4]=="undefined"?1:+f[4],lines:[],linedelimiters:[]};p.oldLines===0&&(p.oldStart+=1),p.newLines===0&&(p.newStart+=1);for(var g=0,_=0;o<r.length&&!(r[o].indexOf("--- ")===0&&o+2<r.length&&r[o+1].indexOf("+++ ")===0&&r[o+2].indexOf("@@")===0);o++){var b=r[o].length==0&&o!=r.length-1?" ":r[o][0];if(b==="+"||b==="-"||b===" "||b==="\\")p.lines.push(r[o]),p.linedelimiters.push(n[o]||`
`),b==="+"?g++:b==="-"?_++:b===" "&&(g++,_++);else break}if(!g&&p.newLines===1&&(p.newLines=0),!_&&p.oldLines===1&&(p.oldLines=0),e.strict){if(g!==p.newLines)throw new Error("Added line count did not match for hunk at line "+(u+1));if(_!==p.oldLines)throw new Error("Removed line count did not match for hunk at line "+(u+1))}return p}for(c(l,"parseHunk");o<r.length;)a();return i}c(oo,"parsePatch");function Pu(t,e,r){var n=!0,i=!1,o=!1,a=1;return c(function s(){if(n&&!o){if(i?a++:n=!1,t+a<=r)return a;o=!0}if(!i)return o||(n=!0),e<=t-a?-a++:(i=!0,s())},"iterator")}c(Pu,"distanceIterator");function Sc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=oo(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var n=t.split(/\r\n|[\n\v\f\r\x85]/),i=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,a=r.compareLine||function(Ie,Oe,$e,et){return Oe===et},s=0,l=r.fuzzFactor||0,u=0,d=0,f,p;function g(Ie,Oe){for(var $e=0;$e<Ie.lines.length;$e++){var et=Ie.lines[$e],it=et.length>0?et[0]:" ",ht=et.length>0?et.substr(1):et;if(it===" "||it==="-"){if(!a(Oe+1,n[Oe],it,ht)&&(s++,s>l))return!1;Oe++}}return!0}c(g,"hunkFits");for(var _=0;_<o.length;_++){for(var b=o[_],y=n.length-b.oldLines,x=0,C=d+b.oldStart-1,k=Pu(C,u,y);x!==void 0;x=k())if(g(b,C+x)){b.offset=d+=x;break}if(x===void 0)return!1;u=b.offset+b.oldStart+b.oldLines}for(var T=0,O=0;O<o.length;O++){var ne=o[O],ae=ne.oldStart+ne.offset+T-1;T+=ne.newLines-ne.oldLines;for(var Y=0;Y<ne.lines.length;Y++){var me=ne.lines[Y],ce=me.length>0?me[0]:" ",pe=me.length>0?me.substr(1):me,Ae=ne.linedelimiters[Y];if(ce===" ")ae++;else if(ce==="-")n.splice(ae,1),i.splice(ae,1);else if(ce==="+")n.splice(ae,0,pe),i.splice(ae,0,Ae),ae++;else if(ce==="\\"){var Ye=ne.lines[Y-1]?ne.lines[Y-1][0]:null;Ye==="+"?f=!0:Ye==="-"&&(p=!0)}}}if(f)for(;!n[n.length-1];)n.pop(),i.pop();else p&&(n.push(""),i.push(`
`));for(var ue=0;ue<n.length-1;ue++)n[ue]=n[ue]+i[ue];return n.join("")}c(Sc,"applyPatch");function Za(t,e){typeof t=="string"&&(t=oo(t));var r=0;function n(){var i=t[r++];if(!i)return e.complete();e.loadFile(i,function(o,a){if(o)return e.complete(o);var s=Sc(a,i,e);e.patched(i,s,function(l){if(l)return e.complete(l);n()})})}c(n,"processIndex"),n()}c(Za,"applyPatches");function Cc(t,e,r,n,i,o,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var s=Iu(r,n,a);s.push({value:"",lines:[]});function l(x){return x.map(function(C){return" "+C})}c(l,"contextLines");for(var u=[],d=0,f=0,p=[],g=1,_=1,b=c(function(C){var k=s[C],T=k.lines||k.value.replace(/\n$/,"").split(`
`);if(k.lines=T,k.added||k.removed){var O;if(!d){var ne=s[C-1];d=g,f=_,ne&&(p=a.context>0?l(ne.lines.slice(-a.context)):[],d-=p.length,f-=p.length)}(O=p).push.apply(O,bn(T.map(function(ue){return(k.added?"+":"-")+ue}))),k.added?_+=T.length:g+=T.length}else{if(d)if(T.length<=a.context*2&&C<s.length-2){var ae;(ae=p).push.apply(ae,bn(l(T)))}else{var Y,me=Math.min(T.length,a.context);(Y=p).push.apply(Y,bn(l(T.slice(0,me))));var ce={oldStart:d,oldLines:g-d+me,newStart:f,newLines:_-f+me,lines:p};if(C>=s.length-2&&T.length<=a.context){var pe=/\n$/.test(r),Ae=/\n$/.test(n),Ye=T.length==0&&p.length>ce.oldLines;!pe&&Ye&&r.length>0&&p.splice(ce.oldLines,0,"\\ No newline at end of file"),(!pe&&!Ye||!Ae)&&p.push("\\ No newline at end of file")}u.push(ce),d=0,f=0,p=[]}g+=T.length,_+=T.length}},"_loop"),y=0;y<s.length;y++)b(y);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:u}}c(Cc,"structuredPatch");function Nu(t){var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader=="undefined"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader=="undefined"?"":"	"+t.newHeader));for(var r=0;r<t.hunks.length;r++){var n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}c(Nu,"formatPatch");function Ln(t,e,r,n,i,o,a){return Nu(Cc(t,e,r,n,i,o,a))}c(Ln,"createTwoFilesPatch");function Mu(t,e,r,n,i,o){return Ln(t,t,e,r,n,i,o)}c(Mu,"createPatch");function Lu(t,e){return t.length!==e.length?!1:Xa(t,e)}c(Lu,"arrayEqual");function Xa(t,e){if(e.length>t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}c(Xa,"arrayStartsWith");function $u(t){var e=$n(t.lines),r=e.oldLines,n=e.newLines;r!==void 0?t.oldLines=r:delete t.oldLines,n!==void 0?t.newLines=n:delete t.newLines}c($u,"calcLineCount");function _p(t,e,r){t=Ec(t,r),e=Ec(e,r);var n={};(t.index||e.index)&&(n.index=t.index||e.index),(t.newFileName||e.newFileName)&&(ao(t)?ao(e)?(n.oldFileName=Yo(n,t.oldFileName,e.oldFileName),n.newFileName=Yo(n,t.newFileName,e.newFileName),n.oldHeader=Yo(n,t.oldHeader,e.oldHeader),n.newHeader=Yo(n,t.newHeader,e.newHeader)):(n.oldFileName=t.oldFileName,n.newFileName=t.newFileName,n.oldHeader=t.oldHeader,n.newHeader=t.newHeader):(n.oldFileName=e.oldFileName||t.oldFileName,n.newFileName=e.newFileName||t.newFileName,n.oldHeader=e.oldHeader||t.oldHeader,n.newHeader=e.newHeader||t.newHeader)),n.hunks=[];for(var i=0,o=0,a=0,s=0;i<t.hunks.length||o<e.hunks.length;){var l=t.hunks[i]||{oldStart:1/0},u=e.hunks[o]||{oldStart:1/0};if(Ni(l,u))n.hunks.push(Ya(l,a)),i++,s+=l.newLines-l.oldLines;else if(Ni(u,l))n.hunks.push(Ya(u,s)),o++,a+=u.newLines-u.oldLines;else{var d={oldStart:Math.min(l.oldStart,u.oldStart),oldLines:0,newStart:Math.min(l.newStart+a,u.oldStart+s),newLines:0,lines:[]};Rc(d,l.oldStart,l.lines,u.oldStart,u.lines),o++,i++,n.hunks.push(d)}}return n}c(_p,"merge");function Ec(t,e){if(typeof t=="string"){if(/^@@/m.test(t)||/^Index:/m.test(t))return oo(t)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return Cc(void 0,void 0,e,t)}return t}c(Ec,"loadPatch");function ao(t){return t.newFileName&&t.newFileName!==t.oldFileName}c(ao,"fileNameChanged");function Yo(t,e,r){return e===r?e:(t.conflict=!0,{mine:e,theirs:r})}c(Yo,"selectField");function Ni(t,e){return t.oldStart<e.oldStart&&t.oldStart+t.oldLines<e.oldStart}c(Ni,"hunkBefore");function Ya(t,e){return{oldStart:t.oldStart,oldLines:t.oldLines,newStart:t.newStart+e,newLines:t.newLines,lines:t.lines}}c(Ya,"cloneHunk");function Rc(t,e,r,n,i){var o={offset:e,lines:r,index:0},a={offset:n,lines:i,index:0};for(Ic(t,o,a),Ic(t,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var s=o.lines[o.index],l=a.lines[a.index];if((s[0]==="-"||s[0]==="+")&&(l[0]==="-"||l[0]==="+"))Bu(t,o,a);else if(s[0]==="+"&&l[0]===" "){var u;(u=t.lines).push.apply(u,bn(di(o)))}else if(l[0]==="+"&&s[0]===" "){var d;(d=t.lines).push.apply(d,bn(di(a)))}else s[0]==="-"&&l[0]===" "?Ac(t,o,a):l[0]==="-"&&s[0]===" "?Ac(t,a,o,!0):s===l?(t.lines.push(s),o.index++,a.index++):Ja(t,di(o),di(a))}es(t,o),es(t,a),$u(t)}c(Rc,"mergeLines");function Bu(t,e,r){var n=di(e),i=di(r);if(ts(n)&&ts(i)){if(Xa(n,i)&&so(r,n,n.length-i.length)){var o;(o=t.lines).push.apply(o,bn(n));return}else if(Xa(i,n)&&so(e,i,i.length-n.length)){var a;(a=t.lines).push.apply(a,bn(i));return}}else if(Lu(n,i)){var s;(s=t.lines).push.apply(s,bn(n));return}Ja(t,n,i)}c(Bu,"mutualChange");function Ac(t,e,r,n){var i=di(e),o=Ou(r,i);if(o.merged){var a;(a=t.lines).push.apply(a,bn(o.merged))}else Ja(t,n?o:i,n?i:o)}c(Ac,"removal");function Ja(t,e,r){t.conflict=!0,t.lines.push({conflict:!0,mine:e,theirs:r})}c(Ja,"conflict");function Ic(t,e,r){for(;e.offset<r.offset&&e.index<e.lines.length;){var n=e.lines[e.index++];t.lines.push(n),e.offset++}}c(Ic,"insertLeading");function es(t,e){for(;e.index<e.lines.length;){var r=e.lines[e.index++];t.lines.push(r)}}c(es,"insertTrailing");function di(t){for(var e=[],r=t.lines[t.index][0];t.index<t.lines.length;){var n=t.lines[t.index];if(r==="-"&&n[0]==="+"&&(r="+"),r===n[0])e.push(n),t.index++;else break}return e}c(di,"collectChange");function Ou(t,e){for(var r=[],n=[],i=0,o=!1,a=!1;i<e.length&&t.index<t.lines.length;){var s=t.lines[t.index],l=e[i];if(l[0]==="+")break;if(o=o||s[0]!==" ",n.push(l),i++,s[0]==="+")for(a=!0;s[0]==="+";)r.push(s),s=t.lines[++t.index];l.substr(1)===s.substr(1)?(r.push(s),t.index++):a=!0}if((e[i]||"")[0]==="+"&&o&&(a=!0),a)return r;for(;i<e.length;)n.push(e[i++]);return{merged:n,changes:r}}c(Ou,"collectContext");function ts(t){return t.reduce(function(e,r){return e&&r[0]==="-"},!0)}c(ts,"allRemoves");function so(t,e,r){for(var n=0;n<r;n++){var i=e[e.length-r+n].substr(1);if(t.lines[t.index+n]!==" "+i)return!1}return t.index+=r,!0}c(so,"skipRemoveSuperset");function $n(t){var e=0,r=0;return t.forEach(function(n){if(typeof n!="string"){var i=$n(n.mine),o=$n(n.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),r!==void 0&&(i.newLines===o.newLines?r+=i.newLines:r=void 0)}else r!==void 0&&(n[0]==="+"||n[0]===" ")&&r++,e!==void 0&&(n[0]==="-"||n[0]===" ")&&e++}),{oldLines:e,newLines:r}}c($n,"calcOldNewLineCount");function xp(t){for(var e=[],r,n,i=0;i<t.length;i++)r=t[i],r.added?n=1:r.removed?n=-1:n=0,e.push([n,r.value]);return e}c(xp,"convertChangesToDMP");function Sp(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n.added?e.push("<ins>"):n.removed&&e.push("<del>"),e.push(Bn(n.value)),n.added?e.push("</ins>"):n.removed&&e.push("</del>")}return e.join("")}c(Sp,"convertChangesToXML");function Bn(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}c(Bn,"escapeHTML");var kc=/[^a-zA-Z0-9]/,Tc=/\s/,Dc=/[\r\n]/,Uu=/\n\r?\n$/,Hu=/^\r?\n\r?\n/,Te;(function(t){t[t.DIFF_DELETE=-1]="DIFF_DELETE",t[t.DIFF_INSERT=1]="DIFF_INSERT",t[t.DIFF_EQUAL=0]="DIFF_EQUAL"})(Te||(Te={}));function Fc(t,e){return t<e?t:e}c(Fc,"min");function Wu(t,e){return t>e?t:e}c(Wu,"max");var cr=J,co=function(){function t(){this.diffs=[],this.start1=0,this.start2=0,this.length1=0,this.length2=0}return c(t,"PatchObject"),t.prototype.toString=function(){var e,r;this.length1===0?e=this.start1+",0":this.length1===1?e=this.start1+1:e=this.start1+1+","+this.length1,this.length2===0?r=this.start2+",0":this.length2===1?r=this.start2+1:r=this.start2+1+","+this.length2;for(var n=["@@ -"+e+" +"+r+` @@
`],i,o=0;o<this.diffs.length;o++){switch(this.diffs[o][0]){case Te.DIFF_INSERT:i="+";break;case Te.DIFF_DELETE:i="-";break;case Te.DIFF_EQUAL:i=" ";break}n[o+1]=i+encodeURI(this.diffs[o][1])+`
`}return n.join("").replace(/%20/g," ")},t}(),rs=function(){function t(){this.diffTimeout=1,this.diffEditCost=4,this.matchThreshold=.5,this.matchDistance=1e3,this.patchDeleteThreshold=.5,this.patchMargin=4,this.matchMaxBits=32}return c(t,"DiffMatchPatch"),t.prototype.diff_main=function(e,r,n,i){typeof i=="undefined"&&(this.diffTimeout<=0?i=Number.MAX_VALUE:i=Date.now()+this.diffTimeout*1e3);var o=i;if(e==null||r==null)throw new Error("Null input. (diff_main)");if(e===r)return e?[[Te.DIFF_EQUAL,e]]:[];typeof n=="undefined"&&(n=!0);var a=n,s=this.diff_commonPrefix(e,r),l=e.substring(0,s);e=e.substring(s),r=r.substring(s),s=this.diff_commonSuffix(e,r);var u=e.substring(e.length-s);e=e.substring(0,e.length-s),r=r.substring(0,r.length-s);var d=this.diff_compute_(e,r,a,o);return l&&d.unshift([Te.DIFF_EQUAL,l]),u&&d.push([Te.DIFF_EQUAL,u]),this.diff_cleanupMerge(d),d},t.prototype.diff_commonPrefix=function(e,r){if(!e||!r||e.charAt(0)!==r.charAt(0))return 0;for(var n=0,i=cr.min(e.length,r.length),o=i,a=0;n<o;)e.substring(a,o)===r.substring(a,o)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o},t.prototype.diff_commonSuffix=function(e,r){if(!e||!r||e.charAt(e.length-1)!==r.charAt(r.length-1))return 0;for(var n=0,i=cr.min(e.length,r.length),o=i,a=0;n<o;)e.substring(e.length-o,e.length-a)===r.substring(r.length-o,r.length-a)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o},t.prototype.diff_cleanupSemantic=function(e){for(var r=!1,n=[],i=0,o=null,a=0,s=0,l=0,u=0,d=0;a<e.length;)e[a][0]===Te.DIFF_EQUAL?(n[i++]=a,s=u,l=d,u=0,d=0,o=e[a][1]):(e[a][0]===Te.DIFF_INSERT?u+=e[a][1].length:d+=e[a][1].length,o&&o.length<=cr.max(s,l)&&o.length<=cr.max(u,d)&&(e.splice(n[i-1],0,[Te.DIFF_DELETE,o]),e[n[i-1]+1][0]=Te.DIFF_INSERT,i--,i--,a=i>0?n[i-1]:-1,s=0,l=0,u=0,d=0,o=null,r=!0)),a++;for(r&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]===Te.DIFF_DELETE&&e[a][0]===Te.DIFF_INSERT){var f=e[a-1][1],p=e[a][1],g=this.diff_commonOverlap_(f,p),_=this.diff_commonOverlap_(p,f);g>=_?(g>=f.length/2||g>=p.length/2)&&(e.splice(a,0,[Te.DIFF_EQUAL,p.substring(0,g)]),e[a-1][1]=f.substring(0,f.length-g),e[a+1][1]=p.substring(g),a++):(_>=f.length/2||_>=p.length/2)&&(e.splice(a,0,[Te.DIFF_EQUAL,f.substring(0,_)]),e[a-1][0]=Te.DIFF_INSERT,e[a-1][1]=p.substring(0,p.length-_),e[a+1][0]=Te.DIFF_DELETE,e[a+1][1]=f.substring(_),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){for(var r=1;r<e.length-1;){if(e[r-1][0]===Te.DIFF_EQUAL&&e[r+1][0]===Te.DIFF_EQUAL){var n=e[r-1][1],i=e[r][1],o=e[r+1][1],a=this.diff_commonSuffix(n,i);if(a){var s=i.substring(i.length-a);n=n.substring(0,n.length-a),i=s+i.substring(0,i.length-a),o=s+o}for(var l=n,u=i,d=o,f=this.diff_cleanupSemanticScore_(n,i)+this.diff_cleanupSemanticScore_(i,o);i.charAt(0)===o.charAt(0);){n+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);var p=this.diff_cleanupSemanticScore_(n,i)+this.diff_cleanupSemanticScore_(i,o);p>=f&&(f=p,l=n,u=i,d=o)}e[r-1][1]!==l&&(l?e[r-1][1]=l:(e.splice(r-1,1),r--),e[r][1]=u,d?e[r+1][1]=d:(e.splice(r+1,1),r--))}r++}},t.prototype.diff_cleanupEfficiency=function(e){for(var r=!1,n=[],i=0,o=null,a=0,s=!1,l=!1,u=!1,d=!1;a<e.length;)e[a][0]===Te.DIFF_EQUAL?(e[a][1].length<this.diffEditCost&&(u||d)?(n[i++]=a,s=u,l=d,o=e[a][1]):(i=0,o=null),u=d=!1):(e[a][0]===Te.DIFF_DELETE?d=!0:u=!0,o&&(s&&l&&u&&d||o.length<this.diffEditCost/2&&Number(s)+Number(l)+Number(u)+Number(d)===3)&&(e.splice(n[i-1],0,[Te.DIFF_DELETE,o]),e[n[i-1]+1][0]=Te.DIFF_INSERT,i--,o=null,s&&l?(u=d=!0,i=0):(i--,a=i>0?n[i-1]:-1,u=d=!1),r=!0)),a++;r&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push([Te.DIFF_EQUAL,""]);for(var r=0,n=0,i=0,o="",a="",s;r<e.length;)switch(e[r][0]){case Te.DIFF_INSERT:i++,a+=e[r][1],r++;break;case Te.DIFF_DELETE:n++,o+=e[r][1],r++;break;case Te.DIFF_EQUAL:n+i>1?(n!==0&&i!==0&&(s=this.diff_commonPrefix(a,o),s!==0&&(r-n-i>0&&e[r-n-i-1][0]===Te.DIFF_EQUAL?e[r-n-i-1][1]+=a.substring(0,s):(e.splice(0,0,[Te.DIFF_EQUAL,a.substring(0,s)]),r++),a=a.substring(s),o=o.substring(s)),s=this.diff_commonSuffix(a,o),s!==0&&(e[r][1]=a.substring(a.length-s)+e[r][1],a=a.substring(0,a.length-s),o=o.substring(0,o.length-s))),r-=n+i,e.splice(r,n+i),o.length&&(e.splice(r,0,[Te.DIFF_DELETE,o]),r++),a.length&&(e.splice(r,0,[Te.DIFF_INSERT,a]),r++),r++):r!==0&&e[r-1][0]===Te.DIFF_EQUAL?(e[r-1][1]+=e[r][1],e.splice(r,1)):r++,i=0,n=0,o="",a="";break}e[e.length-1][1]===""&&e.pop();var l=!1;for(r=1;r<e.length-1;)e[r-1][0]===Te.DIFF_EQUAL&&e[r+1][0]===Te.DIFF_EQUAL&&(e[r][1].substring(e[r][1].length-e[r-1][1].length)===e[r-1][1]?(e[r][1]=e[r-1][1]+e[r][1].substring(0,e[r][1].length-e[r-1][1].length),e[r+1][1]=e[r-1][1]+e[r+1][1],e.splice(r-1,1),l=!0):e[r][1].substring(0,e[r+1][1].length)===e[r+1][1]&&(e[r-1][1]+=e[r+1][1],e[r][1]=e[r][1].substring(e[r+1][1].length)+e[r+1][1],e.splice(r+1,1),l=!0)),r++;l&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,r){var n=0,i=0,o=0,a=0,s;for(s=0;s<e.length&&(e[s][0]!==Te.DIFF_INSERT&&(n+=e[s][1].length),e[s][0]!==Te.DIFF_DELETE&&(i+=e[s][1].length),!(n>r));s++)o=n,a=i;return e.length!==s&&e[s][0]===Te.DIFF_DELETE?a:a+(r-o)},t.prototype.diff_prettyHtml=function(e){for(var r=[],n=/&/g,i=/</g,o=/>/g,a=/\n/g,s=0;s<e.length;s++){var l=e[s][0],u=e[s][1],d=u.replace(n,"&amp;").replace(i,"&lt;").replace(o,"&gt;").replace(a,"&para;<br>");switch(l){case Te.DIFF_INSERT:r[s]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case Te.DIFF_DELETE:r[s]='<del style="background:#ffe6e6;">'+d+"</del>";break;case Te.DIFF_EQUAL:r[s]="<span>"+d+"</span>";break}}return r.join("")},t.prototype.diff_text1=function(e){for(var r=[],n=0;n<e.length;n++)e[n][0]!==Te.DIFF_INSERT&&(r[n]=e[n][1]);return r.join("")},t.prototype.diff_text2=function(e){for(var r=[],n=0;n<e.length;n++)e[n][0]!==Te.DIFF_DELETE&&(r[n]=e[n][1]);return r.join("")},t.prototype.diff_levenshtein=function(e){for(var r=0,n=0,i=0,o=0;o<e.length;o++){var a=e[o][0],s=e[o][1];switch(a){case Te.DIFF_INSERT:n+=s.length;break;case Te.DIFF_DELETE:i+=s.length;break;case Te.DIFF_EQUAL:r+=cr.max(n,i),n=0,i=0;break}}return r+=cr.max(n,i),r},t.prototype.diff_toDelta=function(e){for(var r=[],n=0;n<e.length;n++)switch(e[n][0]){case Te.DIFF_INSERT:r[n]="+"+encodeURI(e[n][1]);break;case Te.DIFF_DELETE:r[n]="-"+e[n][1].length;break;case Te.DIFF_EQUAL:r[n]="="+e[n][1].length;break}return r.join("	").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,r){for(var n=[],i=0,o=0,a=r.split(/\t/g),s=0;s<a.length;s++){var l=a[s].substring(1);switch(a[s].charAt(0)){case"+":try{n[i++]=[Te.DIFF_INSERT,decodeURI(l)]}catch(f){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var u=parseInt(l,10);if(isNaN(u)||u<0)throw new Error("Invalid number in diff_fromDelta: "+l);var d=e.substring(o,o+=u);a[s].charAt(0)==="="?n[i++]=[Te.DIFF_EQUAL,d]:n[i++]=[Te.DIFF_DELETE,d];break;default:if(a[s])throw new Error("Invalid diff operation in diff_fromDelta: "+a[s])}}if(o!==e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+")");return n},t.prototype.diff_linesToChars=function(e,r){var n=[],i={};n[0]="";var o=this.diff_linesToCharsMunge_(e,n,i,4e4),a=this.diff_linesToCharsMunge_(r,n,i,65535);return{chars1:o,chars2:a,lineArray:n}},t.prototype.diff_charsToLines=function(e,r){for(var n=0;n<e.length;n++){for(var i=e[n][1],o=[],a=0;a<i.length;a++)o[a]=r[i.charCodeAt(a)];e[n][1]=o.join("")}},t.prototype.match_main=function(e,r,n){if(e==null||r==null||n==null)throw new Error("Null input. (match_main)");return n=cr.max(0,cr.min(n,e.length)),e===r?0:e.length?e.substring(n,n+r.length)===r?n:this.match_bitap_(e,r,n):-1},t.prototype.patch_make=function(e,r,n){var i,o;if(typeof e=="string"&&typeof r=="string"&&typeof n=="undefined")i=e,o=this.diff_main(i,r,!0),o.length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&typeof e=="object"&&typeof r=="undefined"&&typeof n=="undefined")o=e,i=this.diff_text1(o);else if(typeof e=="string"&&r&&typeof r=="object"&&typeof n=="undefined")i=e,o=r;else if(typeof e=="string"&&typeof r=="string"&&n&&typeof n=="object")i=e,o=n;else throw new Error("Unknown call format to patch_make");if(o.length===0)return[];for(var a=[],s=new co,l=0,u=0,d=0,f=i,p=i,g=0;g<o.length;g++){var _=o[g][0],b=o[g][1];switch(!l&&_!==Te.DIFF_EQUAL&&(s.start1=u,s.start2=d),_){case Te.DIFF_INSERT:s.diffs[l++]=o[g],s.length2+=b.length,p=p.substring(0,d)+b+p.substring(d);break;case Te.DIFF_DELETE:s.length1+=b.length,s.diffs[l++]=o[g],p=p.substring(0,d)+p.substring(d+b.length);break;case Te.DIFF_EQUAL:b.length<=2*this.patchMargin&&l&&o.length!==g+1?(s.diffs[l++]=o[g],s.length1+=b.length,s.length2+=b.length):b.length>=2*this.patchMargin&&l&&(this.patch_addContext_(s,f),a.push(s),s=new co,l=0,f=p,u=d);break}_!==Te.DIFF_INSERT&&(u+=b.length),_!==Te.DIFF_DELETE&&(d+=b.length)}return l&&(this.patch_addContext_(s,f),a.push(s)),a},t.prototype.patch_deepCopy=function(e){for(var r=[],n=0;n<e.length;n++){for(var i=e[n],o=new co,a=0;a<i.diffs.length;a++)o.diffs[a]=[i.diffs[a][0],i.diffs[a][1]];o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,r[n]=o}return r},t.prototype.patch_apply=function(e,r){if(e.length===0)return[r,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);r=n+r+n,this.patch_splitMax(e);for(var i=0,o=[],a=0;a<e.length;a++){var s=e[a].start2+i,l=this.diff_text1(e[a].diffs),u=void 0,d=-1;if(l.length>this.matchMaxBits?(u=this.match_main(r,l.substring(0,this.matchMaxBits),s),u!==-1&&(d=this.match_main(r,l.substring(l.length-this.matchMaxBits),s+l.length-this.matchMaxBits),(d===-1||u>=d)&&(u=-1))):u=this.match_main(r,l,s),u===-1)o[a]=!1,i-=e[a].length2-e[a].length1;else{o[a]=!0,i=u-s;var f=void 0;if(d===-1?f=r.substring(u,u+l.length):f=r.substring(u,d+this.matchMaxBits),l===f)r=r.substring(0,u)+this.diff_text2(e[a].diffs)+r.substring(u+l.length);else{var p=this.diff_main(l,f,!1);if(l.length>this.matchMaxBits&&this.diff_levenshtein(p)/l.length>this.patchDeleteThreshold)o[a]=!1;else{this.diff_cleanupSemanticLossless(p);for(var g=0,_=0,b=0;b<e[a].diffs.length;b++){var y=e[a].diffs[b];y[0]!==Te.DIFF_EQUAL&&(_=this.diff_xIndex(p,g)),y[0]===Te.DIFF_INSERT?r=r.substring(0,u+_)+y[1]+r.substring(u+_):y[0]===Te.DIFF_DELETE&&(r=r.substring(0,u+_)+r.substring(u+this.diff_xIndex(p,g+y[1].length))),y[0]!==Te.DIFF_DELETE&&(g+=y[1].length)}}}}}return r=r.substring(n.length,r.length-n.length),[r,o]},t.prototype.patch_addPadding=function(e){for(var r=this.patchMargin,n="",i=1;i<=r;i++)n+=String.fromCharCode(i);for(var i=0;i<e.length;i++)e[i].start1+=r,e[i].start2+=r;var o=e[0],a=o.diffs;if(a.length===0||a[0][0]!==Te.DIFF_EQUAL)a.unshift([Te.DIFF_EQUAL,n]),o.start1-=r,o.start2-=r,o.length1+=r,o.length2+=r;else if(r>a[0][1].length){var s=r-a[0][1].length;a[0][1]=n.substring(a[0][1].length)+a[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}if(o=e[e.length-1],a=o.diffs,a.length===0||a[a.length-1][0]!==Te.DIFF_EQUAL)a.push([Te.DIFF_EQUAL,n]),o.length1+=r,o.length2+=r;else if(r>a[a.length-1][1].length){var s=r-a[a.length-1][1].length;a[a.length-1][1]+=n.substring(0,s),o.length1+=s,o.length2+=s}return n},t.prototype.patch_splitMax=function(e){for(var r=this.matchMaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=r)){var i=e[n];e.splice(n--,1);for(var o=i.start1,a=i.start2,s="";i.diffs.length!==0;){var l=new co,u=!0;for(l.start1=o-s.length,l.start2=a-s.length,s!==""&&(l.length1=l.length2=s.length,l.diffs.push([Te.DIFF_EQUAL,s]));i.diffs.length!==0&&l.length1<r-this.patchMargin;){var d=i.diffs[0][0],f=i.diffs[0][1];d===Te.DIFF_INSERT?(l.length2+=f.length,a+=f.length,l.diffs.push(i.diffs.shift()),u=!1):d===Te.DIFF_DELETE&&l.diffs.length===1&&l.diffs[0][0]===Te.DIFF_EQUAL&&f.length>2*r?(l.length1+=f.length,o+=f.length,u=!1,l.diffs.push([d,f]),i.diffs.shift()):(f=f.substring(0,r-l.length1-this.patchMargin),l.length1+=f.length,o+=f.length,d===Te.DIFF_EQUAL?(l.length2+=f.length,a+=f.length):u=!1,l.diffs.push([d,f]),f===i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(f.length))}s=this.diff_text2(l.diffs),s=s.substring(s.length-this.patchMargin);var p=this.diff_text1(i.diffs).substring(0,this.patchMargin);p!==""&&(l.length1+=p.length,l.length2+=p.length,l.diffs.length!==0&&l.diffs[l.diffs.length-1][0]===Te.DIFF_EQUAL?l.diffs[l.diffs.length-1][1]+=p:l.diffs.push([Te.DIFF_EQUAL,p])),u||e.splice(++n,0,l)}}},t.prototype.patch_toText=function(e){for(var r=[],n=0;n<e.length;n++)r[n]=e[n];return r.join("")},t.prototype.patch_fromText=function(e){var r=[];if(!e)return r;for(var n=e.split(`
`),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var a=n[i].match(o);if(!a)throw new Error("Invalid patch string: "+n[i]);var s=new co;r.push(s),s.start1=parseInt(a[1],10),a[2]===""?(s.start1--,s.length1=1):a[2]==="0"?s.length1=0:(s.start1--,s.length1=parseInt(a[2],10)),s.start2=parseInt(a[3],10),a[4]===""?(s.start2--,s.length2=1):a[4]==="0"?s.length2=0:(s.start2--,s.length2=parseInt(a[4],10)),i++;for(var l=void 0,u=void 0,d=void 0;i<n.length;){l=n[i].charAt(0),d=n[i].substring(1);try{u=decodeURI(d)}catch(f){throw new Error("Illegal escape in patch_fromText: "+d)}if(l==="-")s.diffs.push([Te.DIFF_DELETE,u]);else if(l==="+")s.diffs.push([Te.DIFF_INSERT,u]);else if(l===" ")s.diffs.push([Te.DIFF_EQUAL,u]);else{if(l==="@")break;if(l!=="")throw new Error('Invalid patch mode "'+l+'" in: '+u)}i++}}return r},t.prototype.diff_compute_=function(e,r,n,i){var o;if(!e)return[[Te.DIFF_INSERT,r]];if(!r)return[[Te.DIFF_DELETE,e]];var a=e.length>r.length?e:r,s=e.length>r.length?r:e,l=a.indexOf(s);if(l!==-1)return o=[[Te.DIFF_INSERT,a.substring(0,l)],[Te.DIFF_EQUAL,s],[Te.DIFF_INSERT,a.substring(l+s.length)]],e.length>r.length&&(o[0][0]=Te.DIFF_DELETE,o[2][0]=Te.DIFF_DELETE),o;if(s.length===1)return[[Te.DIFF_DELETE,e],[Te.DIFF_INSERT,r]];var u=this.diff_halfMatch_(e,r);if(u){var d=u[0],f=u[1],p=u[2],g=u[3],_=u[4],b=this.diff_main(d,p,n,i),y=this.diff_main(f,g,n,i);return b.concat([[Te.DIFF_EQUAL,_]],y)}return n&&e.length>100&&r.length>100?this.diff_lineMode_(e,r,i):this.diff_bisect_(e,r,i)},t.prototype.diff_lineMode_=function(e,r,n){var i=this.diff_linesToChars(e,r);e=i.chars1,r=i.chars2;var o=i.lineArray,a=this.diff_main(e,r,!1,n);this.diff_charsToLines(a,o),this.diff_cleanupSemantic(a),a.push([Te.DIFF_EQUAL,""]);for(var s=0,l=0,u=0,d="",f="";s<a.length;){switch(a[s][0]){case Te.DIFF_INSERT:u++,f+=a[s][1];break;case Te.DIFF_DELETE:l++,d+=a[s][1];break;case Te.DIFF_EQUAL:if(l>=1&&u>=1){a.splice(s-l-u,l+u),s=s-l-u;for(var p=this.diff_main(d,f,!1,n),g=p.length-1;g>=0;g--)a.splice(s,0,p[g]);s=s+p.length}u=0,l=0,d="",f="";break}s++}return a.pop(),a},t.prototype.diff_bisect_=function(e,r,n){for(var i=e.length,o=r.length,a=Math.ceil((i+o)/2),s=a,l=2*a,u=new Array(l),d=new Array(l),f=0;f<l;f++)u[f]=-1,d[f]=-1;u[s+1]=0,d[s+1]=0;for(var p=i-o,g=p%2!=0,_=0,b=0,y=0,x=0,C=0;C<a&&!(Date.now()>n);C++){for(var k=-C+_;k<=C-b;k+=2){var T=s+k,O=void 0;k===-C||k!==C&&u[T-1]<u[T+1]?O=u[T+1]:O=u[T-1]+1;for(var ne=O-k;O<i&&ne<o&&e.charAt(O)===r.charAt(ne);)O++,ne++;if(u[T]=O,O>i)b+=2;else if(ne>o)_+=2;else if(g){var ae=s+p-k;if(ae>=0&&ae<l&&d[ae]!==-1){var Y=i-d[ae];if(O>=Y)return this.diff_bisectSplit_(e,r,O,ne,n)}}}for(var me=-C+y;me<=C-x;me+=2){var ae=s+me,Y=void 0;me===-C||me!==C&&d[ae-1]<d[ae+1]?Y=d[ae+1]:Y=d[ae-1]+1;for(var ce=Y-me;Y<i&&ce<o&&e.charAt(i-Y-1)===r.charAt(o-ce-1);)Y++,ce++;if(d[ae]=Y,Y>i)x+=2;else if(ce>o)y+=2;else if(!g){var T=s+p-me;if(T>=0&&T<l&&u[T]!==-1){var O=u[T],ne=s+O-T;if(Y=i-Y,O>=Y)return this.diff_bisectSplit_(e,r,O,ne,n)}}}}return[[Te.DIFF_DELETE,e],[Te.DIFF_INSERT,r]]},t.prototype.diff_bisectSplit_=function(e,r,n,i,o){var a=e.substring(0,n),s=r.substring(0,i),l=e.substring(n),u=r.substring(i),d=this.diff_main(a,s,!1,o),f=this.diff_main(l,u,!1,o);return d.concat(f)},t.prototype.diff_linesToCharsMunge_=function(e,r,n,i){for(var o="",a=0,s=-1,l=r.length;s<e.length-1;){s=e.indexOf(`
`,a),s===-1&&(s=e.length-1);var u=e.substring(a,s+1);(n.hasOwnProperty?n.hasOwnProperty(u):n[u]!==void 0)?o+=String.fromCharCode(n[u]):(l===i&&(u=e.substring(a),s=e.length),o+=String.fromCharCode(l),n[u]=l,r[l++]=u),a=s+1}return o},t.prototype.diff_commonOverlap_=function(e,r){var n=e.length,i=r.length;if(n===0||i===0)return 0;n>i?e=e.substring(n-i):n<i&&(r=r.substring(0,n));var o=cr.min(n,i);if(e===r)return o;for(var a=0,s=1;;){var l=e.substring(o-s),u=r.indexOf(l);if(u===-1)return a;s+=u,(u===0||e.substring(o-s)===r.substring(0,s))&&(a=s,s++)}},t.prototype.diff_halfMatch_=function(e,r){if(this.diffTimeout<=0)return null;var n=e.length>r.length?e:r,i=e.length>r.length?r:e;if(n.length<4||i.length*2<n.length)return null;var o=this.diff_halfMatchI_(n,i,Math.ceil(n.length/4)),a=this.diff_halfMatchI_(n,i,Math.ceil(n.length/2)),s;if(!o&&!a)return null;a?o?s=o[4].length>a[4].length?o:a:s=a:s=o;var l,u,d,f,p=s[4];return e.length>r.length?(l=s[0],u=s[1],d=s[2],f=s[3]):(d=s[0],f=s[1],l=s[2],u=s[3]),[l,u,d,f,p]},t.prototype.diff_halfMatchI_=function(e,r,n){for(var i=e.substring(n,n+Math.floor(e.length/4)),o="",a,s,l,u,d=r.indexOf(i,0);d!==-1;){var f=this.diff_commonPrefix(e.substring(n),r.substring(d)),p=this.diff_commonSuffix(e.substring(0,n),r.substring(0,d));o.length<p+f&&(o=r.substring(d-p,d)+r.substring(d,d+f),a=e.substring(0,n-p),s=e.substring(n+f),l=r.substring(0,d-p),u=r.substring(d+f)),d=r.indexOf(i,d+1)}return o.length*2>=e.length?[a,s,l,u,o]:null},t.prototype.diff_cleanupSemanticScore_=function(e,r){if(!e||!r)return 6;var n=e.charAt(e.length-1),i=r.charAt(0),o=n.match(kc),a=i.match(kc),s=o&&n.match(Tc),l=a&&i.match(Tc),u=s&&n.match(Dc),d=l&&i.match(Dc),f=u&&e.match(Uu),p=d&&r.match(Hu);return f||p?5:u||d?4:o&&!s&&l?3:s||l?2:o||a?1:0},t.prototype.match_bitap_=function(e,r,n){if(r.length>this.matchMaxBits)throw new Error("Pattern too long for this browser");var i=this.match_alphabet_(r),o=this.matchThreshold,a=e.indexOf(r,n);a!==-1&&(o=cr.min(this.match_bitapScore_(0,a,r,n),o),a=e.lastIndexOf(r,n+r.length),a!==-1&&(o=cr.min(this.match_bitapScore_(0,a,r,n),o)));var s=1<<r.length-1;a=-1;for(var l,u,d=r.length+e.length,f,p=0;p<r.length;p++){for(l=0,u=d;l<u;)this.match_bitapScore_(p,n+u,r,n)<=o?l=u:d=u,u=Math.floor((d-l)/2+l);d=u;var g=cr.max(1,n-u+1),_=cr.min(n+u,e.length)+r.length,b=Array(_+2);b[_+1]=(1<<p)-1;for(var y=_;y>=g;y--){var x=i[e.charAt(y-1)];if(p===0?b[y]=(b[y+1]<<1|1)&x:b[y]=(b[y+1]<<1|1)&x|((f[y+1]|f[y])<<1|1)|f[y+1],b[y]&s){var C=this.match_bitapScore_(p,y-1,r,n);if(C<=o)if(o=C,a=y-1,a>n)g=cr.max(1,2*n-a);else break}}if(this.match_bitapScore_(p+1,n,r,n)>o)break;f=b}return a},t.prototype.match_bitapScore_=function(e,r,n,i){var o=e/n.length,a=Math.abs(i-r);return this.matchDistance?o+a/this.matchDistance:a?1:o},t.prototype.match_alphabet_=function(e){for(var r={},n=0;n<e.length;n++)r[e.charAt(n)]=0;for(var n=0;n<e.length;n++)r[e.charAt(n)]|=1<<e.length-n-1;return r},t.prototype.patch_addContext_=function(e,r){if(r.length!==0){if(e.start2==null)throw Error("patch not initialized");for(var n=r.substring(e.start2,e.start2+e.length1),i=0;r.indexOf(n)!==r.lastIndexOf(n)&&n.length<this.matchMaxBits-this.patchMargin-this.patchMargin;)i+=this.patchMargin,n=r.substring(e.start2-i,e.start2+e.length1+i);i+=this.patchMargin;var o=r.substring(e.start2-i,e.start2);o&&e.diffs.unshift([Te.DIFF_EQUAL,o]);var a=r.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push([Te.DIFF_EQUAL,a]),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},t}();function ns(t,e){let r={};for(let o=0;o<e.length;o++){const a=e[o];r[a]?r[a].push(o):r[a]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<t.length;o++){const a=t[o],s=r[a]||[];let l=0,u=i[0];for(let d=0;d<s.length;d++){const f=s[d];let p;for(p=l;p<i.length&&!(i[p].buffer2index<f&&(p===i.length-1||i[p+1].buffer2index>f));p++);if(p<i.length){const g={buffer1index:o,buffer2index:f,chain:i[p]};if(l===i.length?i.push(u):i[l]=u,l=p+1,u=g,l===i.length)break}}i[l]=u}return i[i.length-1]}c(ns,"LCS");function Pc(t,e){const r=ns(t,e);let n=[],i=t.length,o=e.length,a={common:[]};function s(){a.common.length&&(a.common.reverse(),n.push(a),a={common:[]})}c(s,"processCommon");for(let l=r;l!==null;l=l.chain){let u={buffer1:[],buffer2:[]};for(;--i>l.buffer1index;)u.buffer1.push(t[i]);for(;--o>l.buffer2index;)u.buffer2.push(e[o]);(u.buffer1.length||u.buffer2.length)&&(s(),u.buffer1.reverse(),u.buffer2.reverse(),n.push(u)),i>=0&&a.common.push(t[i])}return s(),n.reverse(),n}c(Pc,"diffComm");function is(t,e){const r=ns(t,e);let n=[],i=t.length,o=e.length;for(let a=r;a!==null;a=a.chain){const s=i-a.buffer1index-1,l=o-a.buffer2index-1;i=a.buffer1index,o=a.buffer2index,(s||l)&&n.push({buffer1:[i+1,s],buffer1Content:t.slice(i+1,i+1+s),buffer2:[o+1,l],buffer2Content:e.slice(o+1,o+1+l)})}return n.reverse(),n}c(is,"diffIndices");function zu(t,e){const r=ns(t,e);let n=[],i=t.length,o=e.length;function a(s,l,u){let d=[];for(let f=0;f<u;f++)d.push(s[l+f]);return{offset:l,length:u,chunk:d}}c(a,"chunkDescription");for(let s=r;s!==null;s=s.chain){const l=i-s.buffer1index-1,u=o-s.buffer2index-1;i=s.buffer1index,o=s.buffer2index,(l||u)&&n.push({buffer1:a(t,s.buffer1index+1,l),buffer2:a(e,s.buffer2index+1,u)})}return n.reverse(),n}c(zu,"diffPatch");function lo(t,e,r){let n=[];function i(l,u){n.push({ab:u,oStart:l.buffer1[0],oLength:l.buffer1[1],abStart:l.buffer2[0],abLength:l.buffer2[1]})}c(i,"addHunk"),is(e,t).forEach(l=>i(l,"a")),is(e,r).forEach(l=>i(l,"b")),n.sort((l,u)=>l.oStart-u.oStart);let o=[],a=0;function s(l){l>a&&(o.push({stable:!0,buffer:"o",bufferStart:a,bufferLength:l-a,bufferContent:e.slice(a,l)}),a=l)}for(c(s,"advanceTo");n.length;){let l=n.shift(),u=l.oStart,d=l.oStart+l.oLength,f=[l];for(s(u);n.length;){const p=n[0],g=p.oStart;if(g>d)break;d=Math.max(d,g+p.oLength),f.push(n.shift())}if(f.length===1){if(l.abLength>0){const p=l.ab==="a"?t:r;o.push({stable:!0,buffer:l.ab,bufferStart:l.abStart,bufferLength:l.abLength,bufferContent:p.slice(l.abStart,l.abStart+l.abLength)})}}else{let p={a:[t.length,-1,e.length,-1],b:[r.length,-1,e.length,-1]};for(;f.length;){l=f.shift();const C=l.oStart,k=C+l.oLength,T=l.abStart,O=T+l.abLength;let ne=p[l.ab];ne[0]=Math.min(T,ne[0]),ne[1]=Math.max(O,ne[1]),ne[2]=Math.min(C,ne[2]),ne[3]=Math.max(k,ne[3])}const g=p.a[0]+(u-p.a[2]),_=p.a[1]+(d-p.a[3]),b=p.b[0]+(u-p.b[2]),y=p.b[1]+(d-p.b[3]);let x={stable:!1,aStart:g,aLength:_-g,aContent:t.slice(g,_),oStart:u,oLength:d-u,oContent:e.slice(u,d),bStart:b,bLength:y-b,bContent:r.slice(b,y)};o.push(x)}a=d}return s(e.length),o}c(lo,"diff3MergeRegions");function Jo(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=typeof t=="string",a=typeof e=="string",s=typeof r=="string";o&&(t=t.split(n.stringSeparator)),a&&(e=e.split(n.stringSeparator)),s&&(r=r.split(n.stringSeparator));let l=[];const u=lo(t,e,r);let d=[];function f(){d.length&&l.push({ok:d}),d=[]}c(f,"flushOk");function p(g,_){if(g.length!==_.length)return!1;for(let b=0;b<g.length;b++)if(g[b]!==_[b])return!1;return!0}return c(p,"isFalseConflict"),u.forEach(g=>{g.stable?d.push(...g.bufferContent):n.excludeFalseConflicts&&p(g.aContent,g.bContent)?d.push(...g.aContent):(f(),l.push({conflict:{a:g.aContent,aIndex:g.aStart,o:g.oContent,oIndex:g.oStart,b:g.bContent,bIndex:g.bStart}}))}),f(),l}c(Jo,"diff3Merge");function Cp(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},n);const o=Jo(t,e,r,n);let a=!1,s=[];return o.forEach(l=>{l.ok?s=s.concat(l.ok):l.conflict&&(a=!0,s.push(`<<<<<<<${n.label.a?` ${n.label.a}`:""}`),s=s.concat(l.conflict.a),s.push(`|||||||${n.label.o?` ${n.label.o}`:""}`),s=s.concat(l.conflict.o),s.push("======="),s=s.concat(l.conflict.b),s.push(`>>>>>>>${n.label.b?` ${n.label.b}`:""}`))}),{conflict:a,result:s}}c(Cp,"mergeDiff3");function qu(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=Jo(t,e,r,n);let a=!1,s=[];for(let l=0;l<o.length;l++){const u=o[l];u.ok?s=s.concat(u.ok):(a=!0,s=s.concat([`
<<<<<<<<<
`],u.conflict.a,[`
=========
`],u.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:a,result:s}}c(qu,"node_diff3_merge");function Ep(t,e,r,n){n=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},n);const o=Jo(t,e,r,n);let a=!1,s=[];for(let l=0;l<o.length;l++){const u=o[l];if(u.ok)s=s.concat(u.ok);else{const d=Pc(u.conflict.a,u.conflict.b);for(let f=0;f<d.length;f++){let p=d[f];p.common?s=s.concat(p.common):(a=!0,s=s.concat([`
<<<<<<<<<
`],p.buffer1,[`
=========
`],p.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:a,result:s}}c(Ep,"mergeDigIn");function $(t,e){let r=[],n=0;function i(o){for(;n<o;)r.push(t[n]),n++}c(i,"advanceTo");for(let o=0;o<e.length;o++){let a=e[o];i(a.buffer1.offset);for(let s=0;s<a.buffer2.chunk.length;s++)r.push(a.buffer2.chunk[s]);n+=a.buffer1.length}return i(t.length),r}c($,"patch");function oe(t){return t.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}c(oe,"stripPatch");function ke(t){return t.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}c(ke,"invertPatch");const Ze=new rs;Ze.diffTimeout=0;function Mt(t,e,r){return fe.get("diff.useDiffMatchPatch")===!0?Ze.patch_toText(Ze.patch_make(e,r)):Mu(t,e,r)}c(Mt,"diffs_createPatch");function pt(t,e,r){return Sc(t,e,r)}c(pt,"diffs_applyPatch");function Kt(t,e){const r=[];for(const n of oo(t,e))r.push({...n,oldFileName:n.newFileName,oldHeader:n.newHeader,newFileName:n.oldFileName,newHeader:n.oldHeader,hunks:n.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),r.push(n);return r}c(Kt,"reversePatch");function tr(t,e,r,n,i){let o=`
`;const a=t.match(/(?:\r?\n)/g);if(a!==null&&a.length!==0){const d=a.filter(f=>f===`\r
`).length;o=d>a.length-d?`\r
`:`
`}const s=qu(t,e,r,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),l=s.result;let u=s.conflict;if(n){let d=!1;if(s.conflict){let f;const p=[];let g=0;for(const y of l)y===`
<<<<<<<<<
`?f={start:g,separator:g,end:g}:y===`
=========
`?f.separator=g:y===`
>>>>>>>>>
`&&(f.end=g,p.push(f)),g++;let _=0,b=0;for(const y of p)l.splice(y.start-_,1),_++,b=y.end-y.separator+1,l.splice(y.separator-_,b),_+=b;p.length&&(d=!0)}}else for(let d=0;d<l.length;d+=1)l[d]===`
<<<<<<<<<
`?l[d]="<<<<<<< HEAD":l[d]===`
=========
`?l[d]="=======":l[d]===`
>>>>>>>>>
`&&(l[d]=`>>>>>>> ${i}`);return{conflicts:u,mergedContent:l.join(o)}}c(tr,"diffs_merge");let rr=0;function jt(){return rr===Number.MAX_SAFE_INTEGER&&(rr=0),String(++rr)}c(jt,"getNextLockId");class Ar{constructor(){this.id=jt()}async synchronize(e){let r;const n=this.promise;this.promise=new Promise(i=>r=i),await n;try{return await e()}finally{r()}}}c(Ar,"Lock");class _r{constructor(e){this.lock=new Ar,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,r){let n;const i=new Fe(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:Ce.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(a=>n=a),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),n()}}async synchronizeWrite(e,r){let n;const i=new Fe(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:Ce.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>n=o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),n(),this.writer=void 0}}}c(_r,"ReaderWriterLock");class lr{constructor(){this.locks=new Map}async synchronizeRead(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new _r(String(e)),this.locks.set(e,i)),i.synchronizeRead(r,n)}async synchronizeWrite(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new _r(String(e)),this.locks.set(e,i)),i.synchronizeWrite(r,n)}}c(lr,"KeyedReaderWriterLock");const Vr=new TextDecoder,Gr=new TextEncoder;async function Br(t){const e=typeof t=="string"?Gr.encode(t):t;let r;if(globalThis.crypto.subtle)r=await globalThis.crypto.subtle.digest({name:"sha-1"},e);else{const n=new ho;n.update(e),r=n.digest()}return globalThis.btoa(encodeURIComponent(Vr.decode(r)))}c(Br,"sha1");var on;(function(t){t[t.BLOCK_SIZE=64]="BLOCK_SIZE"})(on||(on={}));function Sn(t,e,r=32){const n=r-e,i=~((1<<n)-1);return(t<<e|(i&t)>>>n)>>>0}c(Sn,"leftRotate");function os(t,e=0,r=t.byteLength,n=0){for(let i=0;i<r;i++)t[e+i]=n}c(os,"fill");const uo=c(class{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(64+3),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._finished=!1}update(t){const e=this._buff;let r=this._buffLen,n=0;const i=t.byteLength;for(;n<i;){const o=Math.min(64-r,i-n);for(let a=0;a<o;a++)e[r++]=t[n++];r>=64&&(this._step(),r-=64,this._totalLen+=64)}this._buffLen=r}digest(){this._finished||(this._finished=!0,this._totalLen+=this._buffLen,this._wrapUp());const t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this._h0,!1),e.setUint32(4,this._h1,!1),e.setUint32(8,this._h2,!1),e.setUint32(12,this._h3,!1),e.setUint32(16,this._h4,!1),t}_wrapUp(){this._buff[this._buffLen++]=128,os(this._buff,this._buffLen),this._buffLen>56&&(this._step(),os(this._buff));const t=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(t/4294967296),!1),this._buffDV.setUint32(60,t%4294967296,!1),this._step()}_step(){const t=uo._bigBlock32,e=this._buffDV;for(let d=0;d<64;d+=4)t.setUint32(d,e.getUint32(d,!1),!1);for(let d=64;d<320;d+=4)t.setUint32(d,Sn(t.getUint32(d-12,!1)^t.getUint32(d-32,!1)^t.getUint32(d-56,!1)^t.getUint32(d-64,!1),1),!1);let r=this._h0,n=this._h1,i=this._h2,o=this._h3,a=this._h4,s,l,u;for(let d=0;d<80;d++)d<20?(s=n&i|~n&o,l=1518500249):d<40?(s=n^i^o,l=1859775393):d<60?(s=n&i|n&o|i&o,l=2400959708):(s=n^i^o,l=3395469782),u=Sn(r,5)+s+a+l+t.getUint32(d*4,!1)&4294967295,a=o,o=i,i=Sn(n,30),n=r,r=u;this._h0=this._h0+r&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+i&4294967295,this._h3=this._h3+o&4294967295,this._h4=this._h4+a&4294967295}},"_SHA1Computer");let ho=uo;ho._bigBlock32=new DataView(new ArrayBuffer(320));function Ly(t){const e=globalThis.atob(t),r=e.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=e.charCodeAt(i);return n}c(Ly,"fromBase64");const{fromCharCode:$y}=String;function Rp(t){let e;if(typeof t=="string")e=t;else{e="";for(let r=0,{length:n}=t;r<n;r++)e+=$y(t[r])}return globalThis.btoa(e)}c(Rp,"toBase64");function By(t,e){if(t===e)return-1;let r=0;for(;t[r]===e[r];)r++;return r}c(By,"indexOfDifference");var Oy=Object.defineProperty,Uy=Object.getOwnPropertyDescriptor,Hy=c((t,e,r,n)=>{for(var i=n>1?void 0:n?Uy(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&Oy(e,r,i),i},"__decorateClass");const nr=(0,m.loadMessageBundle)(),Wy=h.FileSystemError.FileNotFound().code,Ap=`===================================================================
`,On=new TextDecoder,zy=new TextEncoder;function qy(t){return t&&"type"in t&&"uri"in t&&"uri"in t&&"fileType"in t&&"revision"in t&&"timestamp"in t}c(qy,"isOperation");function as(t,e,r){return{type:t.type,rootUri:e,uri:r!=null?r:t.uri}}c(as,"toEvent");const ea=c(class{constructor(t,e,r,n,i,o){this.providerService=t,this.storageService=e,this.fileStorageService=r,this.telemetryService=n,this.workspaceId=i,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new lr,this.scopedStores=new Map,o===void 0&&(ea._instance=this,this.disposable=h.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}static get instance(){return this._instance}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}async exportDebugInfo(t){var e;async function r(n){const i=await h.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${n.toString(!0)}

${this.toStorage(await this.getWorkingOperations(n))}`});return void h.window.showTextDocument(i)}if(c(r,"exportCore"),t===void 0)for(const n of(e=h.workspace.workspaceFolders)!=null?e:[])await r.call(this,n.uri);else return r.call(this,t)}async getWorkspaceProvidersWithChanges(){var t,e;const r=new Map;for(const n of(t=h.workspace.workspaceFolders)!=null?t:[])if(n.uri.scheme===B.scheme&&await this.hasChanges(n.uri)){const i=(e=this.providerService.getRepository(n.uri))==null?void 0:e.provider;if(!i)continue;r.set(i.id,i)}return[...r.values()]}async getWorkspacesWithChanges(){var t;const e=new Fe("ChangeStore.getWorkspacesWithChanges()");try{const r=[];for(const n of(t=h.workspace.workspaceFolders)!=null?t:[])n.uri.scheme===B.scheme&&await this.hasChanges(n.uri)&&r.push(n.uri);return r.length>0?r:void 0}finally{e.stop()}}async acceptAll(t,e){const r=`ChangeStore.acceptAll(${t.toString()}, ${e==null?void 0:e.staged})`;te.log(r);const n=[];await this.lock.synchronizeWrite(E(t),async()=>{const i=await this.getWorkingOperations(t),o=[];let a=[];const s=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(l=>l.staged));for(const l of i){if(s&&!l.staged){a.push(l);continue}l.fileType===h.FileType.File&&await this.discardWorkingContent(t,l.uri);let u;if(l.type===q.Created&&l.fileType===h.FileType.Directory&&(i.some(d=>R(d.uri,l.uri))||(u={type:q.Deleted,rootUri:t,uri:l.uri})),n.push(u!=null?u:as(l,t)),l.type===q.Created){let d=l.uri;for(;;){const{parent:f}=this.findParent(d,i,p=>p.type===q.Created);if(f){o.push(f),d=f.uri;continue}break}}}a.length>0&&o.length>0&&(a=a.filter(l=>o.includes(l)?(n.push(as(l,t)),!1):!0)),await this.saveWorkingOperations(t,a)},r),n.length!==0&&this._onDidChange.fire(n)}async discard(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.discard(${t.toString()})`;te.log(r);const n=[];await this.lock.synchronizeWrite(E(e),async()=>this.discardCore(e,t,n),r),n.length!==0&&this._onDidChange.fire(n)}async discardCore(t,e,r){te.debug(`ChangeStore.discardCore(${e.toString()})`);const n=await this.getWorkingOperations(t);if(n.length===0)return;const i=N(e),o=n.findIndex(l=>N(l.uri)===i);if(o===-1)return;const[a]=n.splice(o,1);let s;switch(a.type){case q.Created:s=q.Deleted;break;case q.Deleted:s=q.Created;break;default:s=a.type;break}if(r.push({type:s,rootUri:t,uri:e}),a.type===q.Created){let l=a.uri;for(;;){const{parent:u,parentIndex:d}=this.findNewParentWithOnlyChild(l,n);if(u){n.splice(d,1),r.push({type:q.Deleted,rootUri:t,uri:u.uri}),l=u.uri;continue}break}}await this.saveWorkingOperations(t,n),a.fileType===h.FileType.File&&await this.discardWorkingContent(t,e)}async discardAll(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).discardAll(t,e);const n=`ChangeStore.discardAll(${t.toString()}, ${e==null?void 0:e.staged})`;te.log(n);const i=[];await this.lock.synchronizeWrite(E(t),async()=>{const o=await this.getWorkingOperations(t),a=[];let s=[];const l=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(u=>u.staged));for(const u of o){if(l&&!u.staged){s.push(u);continue}u.fileType===h.FileType.File&&await this.discardWorkingContent(t,u.uri);let d;switch(u.type){case q.Created:d=q.Deleted;break;case q.Deleted:d=q.Created;break;default:d=u.type;break}if(i.push({type:d,rootUri:t,uri:u.uri}),u.type===q.Created){let f=u.uri;for(;;){const{parent:p}=this.findNewParentWithOnlyChild(f,o);if(p){a.push(p),f=p.uri;continue}break}}}s.length>0&&a.length>0&&(s=s.filter(u=>a.includes(u)?(i.push({type:q.Deleted,rootUri:t,uri:u.uri}),!1):!0)),await this.saveWorkingOperations(t,s)},n),i.length!==0&&this._onDidChange.fire(i)}async stage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.stage(${t.toString()})`;te.log(r);const n=[];await this.lock.synchronizeWrite(E(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if(i!==void 0){if(i.conflicts){if(!i.conflicts.status.includes(q.Deleted)){const s=nr("yes","Yes");if(await h.window.showWarningMessage(nr("stage with merge conflicts","Are you sure you want to stage {0} with merge conflicts?",V(t)),{modal:!0},s)!==s)return}const[,a]=i.conflicts.status;switch(a){case q.Changed:switch(i.type){case q.Created:return;case q.Changed:await this.spliceOperation(t,o,{...i,conflicts:void 0,staged:!0,timestamp:Date.now()},n);return;case q.Deleted:const s=nr("keep theirs","Keep Their Version"),l=nr("delete","Delete File"),u=await h.window.showInformationMessage(nr("deleted by us",`File '{0}' was deleted by us and modified by them.

What would you like to do?`,V(t)),{modal:!0},s,l);if(u===s){await this.discardCore(e,t,n);return}else if(u===l){await this.spliceOperation(t,o,{...i,type:q.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,staged:!0,timestamp:Date.now()},n);return}else return}case q.Created:switch(i.type){case q.Changed:case q.Deleted:return;case q.Created:await this.spliceOperation(t,o,{...i,type:q.Changed,conflicts:void 0,size:i.size,hash:i.hash,originalHash:i.originalHash,staged:!0,timestamp:Date.now()},n);return}case q.Deleted:switch(i.type){case q.Created:case q.Changed:{const s=nr("keep ours","Keep Our Version"),l=nr("delete","Delete File"),u=await h.window.showInformationMessage(nr("deleted by them",`File '{0}' was deleted by them and modified by us.

What would you like to do?`,V(t)),{modal:!0},s,l);if(u===s){await this.spliceOperation(t,o,{...i,type:q.Created,originalHash:void 0,conflicts:void 0,staged:!0,timestamp:Date.now()},n);return}else if(u===l){await this.discardCore(e,t,n);return}else return}case q.Deleted:await this.discardCore(e,t,n);return}}}await this.spliceOperation(t,o,{...i,staged:!0,conflicts:void 0,timestamp:Date.now()},n)}},r),n.length!==0&&this._onDidChange.fire(n)}async stageAll(t){const e=`ChangeStore.stageAll(${t.toString()})`;te.log(e);const r=[];await this.lock.synchronizeWrite(E(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!0,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>as(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async unstage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.unstage(${t.toString()})`;te.log(r);const n=[];await this.lock.synchronizeWrite(E(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!1,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async unstageAll(t){const e=`ChangeStore.unstageAll(${t.toString()})`;te.log(e);const r=[];await this.lock.synchronizeWrite(E(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!1,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>as(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async hasChanges(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).hasChanges(t);const r=E(t),n=this.cache.get(r);return n!==void 0?n.length!==0:this.lock.synchronizeRead(r,async()=>(await this.getWorkingOperations(t)).length!==0,`ChangeStore.hasChanges(${t.toString()})`)}maybeHasChanges(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).maybeHasChanges(t,e);const n=E(t),i=this.cache.get(n);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=N(e);return i.some(a=>N(a.uri)===o)}async hasMergeConflicts(t){return this.lock.synchronizeRead(E(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${t.toString()})`)}async hasStagedChanges(t){return this.lock.synchronizeRead(E(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${t.toString()})`)}async hasWorkingChanges(t){return this.lock.synchronizeRead(E(t),async()=>(await this.getWorkingOperations(t)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${t.toString()})`)}async getChange(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).getChange(t);const r=this.providerService.getVirtualRootUri(t);if(r!==void 0)return this.lock.synchronizeRead(E(r),async()=>{const{operation:n}=await this.getWorkingOperation(t,r);return n},`ChangeStore.getChange(${t.toString()})`)}async getChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getChanges(t,e):this.lock.synchronizeRead(E(t),async()=>{let n=await this.getWorkingOperations(t);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;n=n.filter(a=>{var s;return(!i||a.conflicts===void 0)&&((s=o==null?void 0:o(a))!=null?s:!0)})}return n},`ChangeStore.getChanges(${t.toString()})`)}async getGroupedChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getGroupedChanges(t,e):this.lock.synchronizeRead(E(t),async()=>{var n,i;const o=await this.getWorkingOperations(t),a={conflicts:[],staged:[],working:[]};for(const s of o)!((i=(n=e==null?void 0:e.predicate)==null?void 0:n.call(e,s))!=null?i:!0)||(s.conflicts?a.conflicts.push(s):s.staged?a.staged.push(s):a.working.push(s));return a},`ChangeStore.getChangesByType(${t.toString()})`)}async getContent(t){const e=this.providerService.getVirtualRootUri(t);if(e===void 0)throw new Error(`Unable to find content for ${t.toString()}; Repository not found`);const r=E(e),n=this.cache.get(r);if((n==null?void 0:n.length)===0)throw new Error(`Unable to find content for ${t.toString()}`);return this.lock.synchronizeRead(r,async()=>{const i=On.decode(await this.getWorkingContent(e,t));if(i!==void 0)return i;throw new Error(`Unable to find content for ${t.toString()}`)},`ChangeStore.getContent(${t.toString()}}`)}async getMergeConflicts(t,e){return this.lock.synchronizeRead(E(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${t.toString()})`)}async getStagedChanges(t,e){return this.lock.synchronizeRead(E(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getStagedChanges(${t.toString()})`)}async getWorkingChanges(t,e){return this.lock.synchronizeRead(E(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return!n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${t.toString()})`)}async applyChangeset(t,e,r,n){var i;let o;qy(r)?o=r:n=n!=null?n:r,te.log(`ChangeStore.applyChangeset${t.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,n==null?void 0:n.save);const a=this.getScopedChangeStore(e.workspaceId),s=(i=e.patch)!=null?i:await a.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(t,s,{...n,getIncomingContent:async l=>{const u=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,l),e.workspaceId);return On.decode(await h.workspace.fs.readFile(u))},merge:async(l,u,d)=>{try{const f=B.getProviderUri(l),p=On.decode(await h.workspace.fs.readFile(f)),g=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,u),e.workspaceId),_=On.decode(await h.workspace.fs.readFile(g)),b=await this.providerService.getMetadata(g);return{...tr(d,p,_,Boolean(n==null?void 0:n.useSimplifiedMerge),b.HEAD.sha),baseUri:f,incomingUri:g}}catch(f){throw new Error(`Unable to apply patch to ${u}: ${String(f)}`)}}})}async applyPatch(t,e,r){if(te.log(`ChangeStore.applyPatch(${t.toString()})`,r==null?void 0:r.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(t,e,r)}async applyPatchCore(t,e,r={}){const n=`ChangeStore.applyPatchCore(${t.toString()})`;te.debug(n,r==null?void 0:r.save);const i=new h.WorkspaceEdit,o=[],a=new Map;async function s(p){var g;const _=E(p),b=h.workspace.textDocuments.find(y=>E(y.uri)===_);return(g=b==null?void 0:b.getText())!=null?g:On.decode(await h.workspace.fs.readFile(p))}c(s,"getContent");async function l(p){try{const g=await h.workspace.fs.stat(p);return Boolean(g)}catch{return!1}}c(l,"exists");async function u(p,g,_){let b=pt("",_,{fuzzFactor:0});if(b===!1){if(!r.getIncomingContent)throw new Error(`Unable to apply patch to ${g}`);b=await r.getIncomingContent(g)}i.createFile(p,{overwrite:!0}),i.replace(p,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),b)}c(u,"applyCreate");async function d(p,g,_,b){const y=await s(p);let x=pt(y,_,{fuzzFactor:1});if(x===!1){if(r.merge===void 0)throw new Error(`Unable to apply patch to ${g}; Resulted in conflicts`);const C={title:nr("apply patch failed prompt confirm","Merge")},k={title:nr("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await h.window.showWarningMessage(nr("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,g),{modal:!0,useCustom:!0},C,k)!==C)return;const O=await r.merge(p,g,y);x=O.mergedContent,O.conflicts&&a.set(E(p),{type:b,baseUri:O.baseUri,incomingUri:O.incomingUri})}i.replace(p,new h.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),x)}c(d,"applyModification");const f=(r==null?void 0:r.reverse)?Kt(e,{}):oo(e,{});for(const p of f)if(p.oldFileName==="/dev/null"){if(!p.newFileName)continue;const g=p.newFileName.startsWith("b/")?p.newFileName.substr(2):p.newFileName,_=this.providerService.createRelativeVirtualUri(t,g);o.push(E(_)),!await l(_)?await u(_,g,p):await d(_,g,p,q.Created)}else if(p.newFileName==="/dev/null"){if(!p.oldFileName)continue;const g=p.oldFileName.startsWith("a/")?p.oldFileName.substr(2):p.oldFileName,_=this.providerService.createRelativeVirtualUri(t,g);await l(_)&&i.deleteFile(_)}else if(p.oldFileName===p.newFileName){if(!p.newFileName)continue;const g=this.providerService.createRelativeVirtualUri(t,p.newFileName);o.push(E(g)),!await l(g)?await u(g,p.newFileName,p):await d(g,p.newFileName,p,q.Changed)}else throw new Error(`Unable to apply patch to ${p.oldFileName}; Renames aren't currently supported`);if(await h.workspace.applyEdit(i),r.save&&o.length)for(const p of o){const g=h.workspace.textDocuments.find(_=>E(_.uri)===p);await(g==null?void 0:g.save())}a.size&&setTimeout(async()=>{const p=[];await this.lock.synchronizeWrite(E(t),async()=>{const g=await this.getWorkingOperations(t);if(g.length===0)return;let _=-1;for(const b of g){_++;const y=a.get(E(b.uri));y!==void 0&&await this.spliceOperation(b.uri,_,{...b,conflicts:{baseUri:y.baseUri,incomingUri:y.incomingUri,status:[b.type,y.type]},timestamp:Date.now()},p)}},n),p.length!==0&&this._onDidChange.fire(p)},0)}async createChangeset(t){te.log(`ChangeStore.createChangeset${t.toString()})`);const e=await this.createPatch(t);return e?{workspaceId:this.workspaceId,uri:t,patch:e}:void 0}async createPatch(t,e,r){if(te.log(`ChangeStore.createPatch${t.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(t);if((r==null?void 0:r.staged)&&(o=o.filter(s=>s.staged)),o.length===0)return"";const a=[];for(const s of o){const l=await this.createPatchCore(t,s);a.push(l)}return a.join("")}const{operation:n}=await this.getWorkingOperation(e,t);if(n===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(r==null?void 0:r.staged)&&n.staged?"":await this.createPatchCore(t,n)}async createPatchCore(t,e){const r=this.providerService.getRelativeFilePath(t,e.uri),n=`diff --git a/${r} b/${r}`;if(e.type===q.Created){let l=await this.getContent(e.uri),u;!l.endsWith(`
`)&&!l.endsWith(`\r
`)?u=`
\\ No newline at end of file`:u="";let d=0;return l=l.replace(/\r?\n/g,f=>(d++,`${f}+`)),`${n}
new file mode 100644
--- /dev/null
+++ b/${r}
@@ -0,0 +1,${d} @@
+${l}${u}`}if(e.type===q.Deleted){let l=On.decode(await h.workspace.fs.readFile(B.getProviderUri(e.uri))),u=0;return l=l.replace(/\r?\n/g,d=>(u++,`${d}-`)),`${n}
deleted file mode 100644
--- a/${r}
+++ /dev/null
@@ -1,${u} +0,0 @@
-${l}`}const i=await this.getContent(e.uri),o=On.decode(await h.workspace.fs.readFile(B.getProviderUri(e.uri))),a=Mt(r,o,i),s=a.indexOf(Ap);return`${n}
${a.substr(s+Ap.length)}`}async keep(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=`ChangeStore.keep(${t.toString()})`;te.log(n,e);const i=[];await this.lock.synchronizeWrite(E(r),async()=>{const{operation:o,index:a}=await this.getWorkingOperation(t,r);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,l]=o.conflicts.status;switch(l){case q.Changed:switch(o.type){case q.Changed:case q.Created:case q.Deleted:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case q.Created:switch(o.type){case q.Changed:case q.Deleted:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case q.Created:await this.spliceOperation(t,a,{...o,type:q.Changed,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case q.Deleted:switch(o.type){case q.Deleted:await this.discardCore(r,t,i);break;case q.Changed:await this.spliceOperation(t,a,{...o,type:q.Created,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case q.Created:await this.spliceOperation(t,a,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case q.Changed:switch(o.type){case q.Deleted:await this.spliceOperation(t,a,{...o,type:q.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case q.Created:break;case q.Changed:break}break;case q.Created:switch(o.type){case q.Changed:case q.Deleted:return;case q.Created:break}break;case q.Deleted:switch(o.type){case q.Deleted:return this.discardCore(r,t,i);case q.Changed:await this.spliceOperation(t,a,{...o,type:q.Created,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case q.Created:return}}const s=e!==void 0?await h.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(t,a,{...o,type:q.Changed,originalHash:s!==void 0?await Br(s):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},n),i.length!==0&&this._onDidChange.fire(i)}async merge(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=`ChangeStore.merge(${t.toString()})`;te.log(o,e,r);const a=[];await this.lock.synchronizeWrite(E(i),async()=>{const{operation:s,index:l}=await this.getWorkingOperation(t,i);if(s===void 0)return;switch(e.type){case q.Changed:switch(s.type){case q.Deleted:await this.spliceOperation(t,l,{...s,type:q.Deleted,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:r.providerUri,incomingUri:e.providerUri,status:[s.type,e.type]},timestamp:Date.now()},a);return;case q.Created:break;case q.Changed:break}break;case q.Created:switch(s.type){case q.Deleted:case q.Changed:return;case q.Created:break}break;case q.Deleted:switch(s.type){case q.Deleted:return this.discardCore(i,t,a);case q.Changed:await this.spliceOperation(t,l,{...s,type:q.Created,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[s.type,e.type]},timestamp:Date.now()},a);return;case q.Created:return}}const u=await this.providerService.getMetadata(e.providerUri),d=await this.getWorkingContent(i,t),f=s.type===q.Created?new Uint8Array(0):await h.workspace.fs.readFile(r.providerUri),p=await h.workspace.fs.readFile(e.providerUri),g=tr(On.decode(d),On.decode(f),On.decode(p),n,u.HEAD.sha);await this.writeFileCore(i,t,a,zy.encode(g.mergedContent),p!=null?p:new Uint8Array(0),g.conflicts?{baseUri:r.providerUri,incomingUri:e.providerUri,status:[s.type,e.type]}:void 0)},o),a.length!==0&&this._onDidChange.fire(a)}async resolveDiffCommand(t,e,r,n){let i;const o=this.providerService.getVirtualRootUri(t);return o!==void 0&&({operation:i}=await this.getWorkingOperation(t,o)),(i==null?void 0:i.type)===q.Deleted?this.resolveOpenCommand(e):((i==null?void 0:i.type)===q.Created&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,t,r,n]})}resolveOpenCommand(t,e){return{command:"vscode.open",title:"Open File",arguments:[t,e]}}getScopedUri(t,e){const r=typeof e=="string"?e:e.workspaceId;return r===this.workspaceId?t:t.with({fragment:r})}getUriScope(t){return t.fragment||void 0}getScopedChangeStore(t){const e=typeof t=="string"?t:t.workspaceId;te.log(`ChangeStore.getScopedChangeStore(${e})`);let r=this.scopedStores.get(e);return r===void 0&&(r=e===this.workspaceId?new ea.ScopedChangeStore(this,e,this.workspaceId):new ea.ScopedChangeStore(new ea(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,r)),r}async stat(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).stat(t);const r=this.providerService.getVirtualRootUri(t);if(r===void 0)return;const n=E(r),i=this.cache.get(n);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(n,async()=>{var o;const{operation:a}=await this.getWorkingOperation(t,r);if(a!==void 0){if(a.type===q.Deleted)throw h.FileSystemError.FileNotFound(`The ${a.fileType===h.FileType.Directory?"folder":"file"} has been deleted.`);return{type:a.fileType,size:(o=a.size)!=null?o:0,ctime:0,mtime:a.timestamp}}},`ChangeStore.stat(${t.toString()}`)}async readFile(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).readFile(t);const r=new Fe(`ChangeStore.readFile(${t.toString()})`);try{const n=this.providerService.getVirtualRootUri(t);if(n===void 0)return;const i=E(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const a=this.cache.get(i);if((a==null?void 0:a.length)===0){r.log({message:": Not found; no operations"});return}return this.getWorkingContent(n,t)},r.context)}finally{r.stop()}}async createDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Fe(`ChangeStore.createDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(E(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e),a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,i===void 0?{type:q.Created,uri:t,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async deleteDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Fe(`ChangeStore.deleteDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(E(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===q.Created)return this.discardCore(e,t,n);const a=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,{type:q.Deleted,uri:t,fileType:h.FileType.Directory,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async updateDirectoryEntries(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return e;const n=new Fe(`ChangeStore.updateDirectoryEntries(${t.toString()})`,{},e.length);try{const i=E(r),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:a}=w(r,t),s=await this.getWorkingOperations(r);for(const l of s)switch(l.type){case q.Changed:break;case q.Created:{if(R(l.uri,a)){const u=this.providerService.getRelativeFilePath(t,l.uri);e.push([u,l.fileType])}break}case q.Deleted:{if(R(l.uri,a)){const u=this.providerService.getRelativeFilePath(t,l.uri),d=e.findIndex(([f])=>f===u);d!==-1&&e.splice(d,1)}break}}return e},n.context)}finally{n.stop()}}async writeFile(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=new Fe(`ChangeStore.writeFile(${t.toString()})`,{},e.length,n);try{const a=[];if(await this.lock.synchronizeWrite(E(i),async()=>this.writeFileCore(i,t,a,e,r,n),o.context),a.length===0)return;this._onDidChange.fire(a)}finally{o.stop()}}async writeFileCore(t,e,r,n,i,o){const a=new Fe(`ChangeStore.writeFileCore(${e.toString()})`,{},n.length,o);try{const[{operation:s,index:l},u,d]=await Promise.all([this.getWorkingOperation(e,t),Br(n),Br(i)]);if(u===d&&(s==null?void 0:s.type)===q.Changed)return this.discardCore(t,e,r);if(u===(s==null?void 0:s.hash)&&d===(s==null?void 0:s.originalHash))return;const[{HEAD:f}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(t,e,n)]);await this.spliceOperation(e,l,s===void 0?{type:q.Changed,uri:e,fileType:h.FileType.File,revision:f.sha,timestamp:Date.now(),size:n.byteLength,hash:u,originalHash:d,conflicts:o,staged:!1}:{...s,revision:f.sha,timestamp:Date.now(),size:n.byteLength,hash:u,originalHash:d,conflicts:o,staged:!1},r)}finally{a.stop()}}async createFile(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=new Fe(`ChangeStore.createFile(${t.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(E(r),async()=>{const[{operation:o,index:a},s,l]=await Promise.all([this.getWorkingOperation(t,r),Br(e),this.providerService.getMetadata(t),this.saveWorkingContent(r,t,e)]);await this.spliceOperation(t,a,o===void 0?{type:q.Created,uri:t,fileType:h.FileType.File,revision:l.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s,originalHash:s}:{...o,type:q.Created,revision:l.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:s},i)},n.context),i.length===0)return;this._onDidChange.fire(i)}finally{n.stop()}}async deleteFile(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new Fe(`ChangeStore.deleteFile(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(E(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===q.Created)return this.discardCore(e,t,n);const[a]=await Promise.all([this.providerService.getMetadata(t),this.discardWorkingContent(e,t)]);await this.spliceOperation(t,o,{type:q.Deleted,uri:t,fileType:h.FileType.File,revision:a.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}findParent(t,e,r){const n=P(t),{operation:i,index:o}=this.findWorkingOperation(n,e);return i!==void 0&&r(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(t,e){const r=N(t);return this.findParent(t,e,(n,i)=>n.type===q.Created&&!i.some(o=>R(o.uri,n.uri)&&N(o.uri)!==r))}async getWorkingOperation(t,e){return this.findWorkingOperation(t,await this.getWorkingOperations(e))}findWorkingOperation(t,e){if(e.length===0)return{operation:void 0,index:-1};const r=N(t);let n=-1;const i=e.find((o,a)=>N(o.uri)!==r?!1:(n=a,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:n}}async getWorkingOperations(t){const e=E(t);let r=this.cache.get(e);return r===void 0&&(r=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,r)),r}async saveWorkingOperations(t,e){te.debug(`ChangeStore.saveWorkingOperations(${t.toString()})`,e.length);const r=E(t);this.cache.set(r,e);try{await this.storageService.store(this.getOperationsStorageKey(r),this.toStorage(e))}catch(n){throw this.cache.delete(r),te.error(n,`Failed to save repository changes for ${r}`),n}}getOperationsStorageKey(t){return`operations/${t}`}async getWorkingContent(t,e){try{return await this.fileStorageService.get(this.getFileStorageKey(t,e))}catch(r){throw te.error(r),this.telemetryService.sendException(r),r}}async discardWorkingContent(t,e){te.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(t,e))}catch(r){if(r instanceof h.FileSystemError&&r.code===Wy)return;throw te.error(r),this.telemetryService.sendException(r),r}}async saveWorkingContent(t,e,r){te.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,r.length);try{return await this.fileStorageService.store(this.getFileStorageKey(t,e),r)}catch(n){throw te.error(n),this.telemetryService.sendException(n),n}}getFileStorageKey(t,e){return`changestore/${L(e)}`}async spliceOperation(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,r):o.push(r),await this.saveWorkingOperations(i,o),n.push(as(r,i,t))}fromStorage(t){if(!t)return[];try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&S(n)?typeof n=="string"?h.Uri.parse(n):h.Uri.from(n):n);return Array.isArray(e)?e:e.operations}catch(e){throw te.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(t){const e={schemaVersion:ea.operationsStorageSchemaVersion,operations:t};return JSON.stringify(e)}},"_ChangeStore");let ss=ea;ss.operationsStorageSchemaVersion=1,ss.ScopedChangeStore=class{constructor(t,e,r){this.changeStore=t,this.scope=e,this.workspaceId=r}createPatch(t,e,r){return this.changeStore.createPatch(this.stripUriScope(t),this.stripUriScope(e),r)}discardAll(t,e){return this.changeStore.discardAll(this.stripUriScope(t),e)}getChange(t){return this.changeStore.getChange(this.stripUriScope(t))}getChanges(t,e){return this.changeStore.getChanges(this.stripUriScope(t),e)}async getGroupedChanges(t,e){return this.changeStore.getGroupedChanges(this.stripUriScope(t),e)}hasChanges(t){return this.changeStore.hasChanges(this.stripUriScope(t))}maybeHasChanges(t,e){return this.changeStore.maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}async stat(t){const r=this.changeStore.getUriScope(t)!==this.workspaceId,n=await this.changeStore.stat(this.stripUriScope(t));return n!==void 0&&r&&(n.permissions=h.FilePermission.Readonly),n}readFile(t){return this.changeStore.readFile(this.stripUriScope(t))}resolveDiffCommand(t,e,r,n){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(t,this.scope),this.changeStore.getScopedUri(e,this.scope),r,n)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}},Hy([le()],ss.prototype,"getWorkingOperations",1);function Ip(t){switch(t){case q.Changed:return nr("change type changed","Modified");case q.Created:return nr("change type created","Added");case q.Deleted:return nr("change type deleted","Deleted")}}c(Ip,"getStatusText");function jy(t){const[e,r]=t;switch(e){case q.Changed:switch(r){case q.Changed:case q.Created:return nr("conflict status changed both","Modified by Both");case q.Deleted:return nr("conflict status deleted them","Deleted by Incoming")}break;case q.Created:switch(r){case q.Changed:case q.Created:return nr("conflict status created both","Added by Both");case q.Deleted:return nr("conflict status deleted them","Deleted by Incoming")}break;case q.Deleted:switch(r){case q.Changed:case q.Created:return nr("conflict status deleted us","Deleted by Current");case q.Deleted:return nr("conflict status deleted both","Deleted by Both")}break}}c(jy,"getConflictStatusText");let Cn;var ju;(function(t){function e(r){const n=Gy(r);return Cn=h.env.uiKind===h.UIKind.Web,te.warn(`Running on the ${Cn?"web":"desktop"}${r.extensionRuntime!==h.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${n}; storageUri=${r.globalStorageUri.toString(!0)}`),n}c(e,"configure"),t.configure=e})(ju||(ju={}));const Vy=/\/workspaceStorage\/(?<id>[^/]+)/i;function Gy(t){var e;if(t.storageUri===void 0)return"";const r=Vy.exec(t.storageUri.path);let n;if((e=r==null?void 0:r.groups)==null?void 0:e.id)n=r.groups.id;else{n=t.storageUri.path;const i=By(t.globalStorageUri.path,n),o=`/${t.extension.id}`;n.endsWith(o)?n=n.slice(i,-o.length):n=n.substr(i)}return/-[0-9]$/.test(n)?n.slice(0,-2):n}c(Gy,"getWorkspaceId");var Un;(function(t){t.HasVirtualFolders="remoteHub:hasVirtualFolders",t.VirtualFolderProviders="remoteHub:virtualFolderProviders",t.HasRecentRepositories="remoteHub:hasRecentRepositories",t.HasWriteableScmProvider="remoteHub:hasWriteableScmProvider",t.HasSearchIndexes="gitHub:hasSearchIndexes",t.EnabledSomeSearchIndexes="gitHub:enabledSomeSearchIndexes",t.EnabledAllSearchIndexes="gitHub:enabledAllSearchIndexes",t.HasPullRequestExtension="gitHub:hasPullRequestExtension"})(Un||(Un={}));const kp=new Map;function ta(t){return t==="isWeb"?Cn:t==="remoteName"?h.env.remoteName:t==="virtualWorkspace"?B.isVirtualWorkspace():t.startsWith("config.")?fe.getAny(t.substring(7)):kp.get(t)}c(ta,"getContext");function ra(t){return t==="isWeb"||t==="remoteName"||t==="virtualWorkspace"||t.startsWith("config.")||t.startsWith("remoteHub:")||t.startsWith("continueOn:")}c(ra,"isSupportedContextKey");async function hi(t,e){kp.set(t,e),!t.startsWith("continueOn:")&&await h.commands.executeCommand("setContext",t,e)}c(hi,"setContext");const Vu=c(class{constructor(t){this.storageService=t,this._onDidChange=new h.EventEmitter,this.cache=new Map}get onDidChange(){return this._onDidChange.event}async delete(t){const e=E(t),r=this.cache.has(e);this.cache.delete(e);try{await this.storageService.delete(this.getStorageKey(e))}catch(n){throw te.error(n,`Failed to delete repository metadata for ${e}`),n}!r||setTimeout(()=>this._onDidChange.fire({uri:t}),0)}async get(t){this.assertMatchingScheme(t);const e=E(t),r=this.cache.get(e);if(r!==void 0)return r;let n;try{n=this.fromStorage(await this.storageService.get(this.getStorageKey(e)))}catch(i){throw te.error(i,`Failed to get repository metadata for ${e}`),i}return n?this.cache.set(e,{revision:n}):this.cache.delete(e),{revision:n}}async set(t,e,r,n){this.assertMatchingScheme(t);const i=(await this.get(t)).revision!==e?"revision":void 0,o=E(t);if(r!==void 0&&!this.validate(r))throw new Error(`Metadata validation failed for ${t.toString()}`);const a={revision:e,cachedMetadata:r};this.cache.set(o,a);try{await this.storageService.store(this.getStorageKey(o),this.toStorage(e))}catch(s){throw this.cache.delete(o),te.error(s,`Failed to save repository metadata for ${o}`),s}(n==null?void 0:n.silent)||setTimeout(()=>this._onDidChange.fire({uri:t,reason:i}),0)}refresh(){this.cache.clear()}validate(t){var e,r,n,i,o,a,s,l;return typeof t.version=="number"&&t.version>=Vu.schemaVersion&&typeof t.timestamp=="number"&&typeof((e=t.provider)==null?void 0:e.id)=="string"&&typeof t.provider.name=="string"&&typeof t.name=="string"&&t.repo&&typeof t.accessLevel=="number"&&typeof((r=t.HEAD)==null?void 0:r.type)=="number"&&typeof((n=t.HEAD)==null?void 0:n.name)=="string"&&typeof((i=t.HEAD)==null?void 0:i.sha)=="string"&&(typeof((o=t.HEAD.detached)==null?void 0:o.name)=="string"&&typeof((a=t.HEAD.detached)==null?void 0:a.type)=="number"||typeof((s=t.HEAD.branch)==null?void 0:s.name)=="string")&&typeof((l=t.defaultBranch)==null?void 0:l.name)=="string"&&typeof t.defaultBranch.sha=="string"}assertMatchingScheme(t){if(t.scheme!==B.scheme)throw new Error(`Uri scheme '${t.scheme}' must match configured scheme '${B.scheme}'; uri=${t.toString()}`)}getStorageKey(t){return`metadata/${t}`}fromStorage(t){if(!t)return;const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&S(n)?h.Uri.from(n):n);return e==null?void 0:e.revision}toStorage(t){const e={schemaVersion:Vu.storageSchemaVersion,revision:t};return JSON.stringify(e)}},"_MetadataStore");let Nc=Vu;Nc.schemaVersion=be,Nc.storageSchemaVersion=1;class Mc{constructor(e,r){this.memento=e,this.scope=r,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new Fe(`MementoStorage.get(${e}): scopedKey=${r}`,{logLevel:Ce.Debug});try{return await Promise.resolve(this.memento.get(r))}finally{n.stop()}}async getKeys(e){const r=this.getScoped(e),n=new Fe(`MementoStorage.getKeys(${e}): scopedPrefix=${r}`,{logLevel:Ce.Debug});try{let i=this.getKeysCore(e);if(this.scope!==void 0){const o=this.scope.length+1;i=i.map(a=>a.substr(o))}return await Promise.resolve(i)}finally{n.stop()}}getKeysCore(e){let r=this.memento.keys();return e&&(r=r.filter(n=>n.startsWith(e))),r}async store(e,r){const n=this.getScoped(e),i=new Fe(`MementoStorage.store(${e}): scopedKey=${n}`,{logLevel:Ce.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await this.memento.update(r,n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new Fe(`MementoStorage.delete(${e}): scopedKey=${r}`,{logLevel:Ce.Debug});try{return await this.storeCore(e,r,void 0)}finally{n.stop()}}async deleteKeys(e){const r=this.getScoped(e),n=new Fe(`MementoStorage.deleteKeys(${e}): scopedPrefix=${r}`,{logLevel:Ce.Debug});try{const i=[],o=this.scope!==void 0?this.scope.length+1:0,a=this.getKeysCore(r);for(const s of a){const l=o!==0?s.substr(o):s;te.debug(`MementoStorage.deleteKeys(${e}): Deleting key=${l}, scopedKey=${s}`);try{await this.storeCore(l,s,void 0)}catch(u){te.debug(`MementoStorage.deleteKeys(${e}): Failed to delete key=${l}, scopedKey=${s}`),i.push(l)}}if(i.length)throw new Error(`Failed to delete keys: ${i.join(", ")}`)}finally{n.stop()}}with(e){return new Mc(this.memento,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e!=null?e:""}`}}c(Mc,"MementoStorageService");class Lc{constructor(e,r){this.storageUri=e,this.scope=r,this._onDidChange=new h.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new Fe(`ExtFileStorageService.get(${e}): scopedKey=${r}`,{logLevel:Ce.Debug});try{return await h.workspace.fs.readFile(h.Uri.joinPath(this.storageUri,r))}catch(i){return}finally{n.stop()}}async store(e,r){const n=this.getScoped(e),i=new Fe(`ExtFileStorageService.store(${e}): scopedKey=${n}`,{logLevel:Ce.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await h.workspace.fs.writeFile(h.Uri.joinPath(this.storageUri,r),n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new Fe(`ExtFileStorageService.delete(${e}): scopedKey=${r}`,{logLevel:Ce.Debug});try{return await h.workspace.fs.delete(h.Uri.joinPath(this.storageUri,r))}finally{n.stop()}}with(e){return new Lc(this.storageUri,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e}`}}c(Lc,"ExtFileStorageService");var Gu=Object.defineProperty,Tp=Object.getOwnPropertySymbols,Ky=Object.prototype.hasOwnProperty,Qy=Object.prototype.propertyIsEnumerable,Dp=c((t,e,r)=>e in t?Gu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,"yo"),an=c((t,e)=>{for(var r in e||(e={}))Ky.call(e,r)&&Dp(t,r,e[r]);if(Tp)for(var r of Tp(e))Qy.call(e,r)&&Dp(t,r,e[r]);return t},"Xe"),Zy=c(t=>Gu(t,"__esModule",{value:!0}),"Iu"),Ne=c((t,e)=>()=>(t&&(e=t(t=0)),e),"C"),Xy=c((t,e)=>{Zy(t);for(var r in e)Gu(t,r,{get:e[r],enumerable:!0})},"Tu"),Ku=c((t,e,r)=>new Promise((n,i)=>{var o=c(l=>{try{s(r.next(l))}catch(u){i(u)}},"a"),a=c(l=>{try{s(r.throw(l))}catch(u){i(u)}},"o"),s=c(l=>l.done?n(l.value):Promise.resolve(l.value).then(o,a),"c");s((r=r.apply(t,e)).next())}),"Br"),Fp,Yy=Ne(()=>{Fp={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}}),na,Hn,fi,Yr,$c,pi,Bc,Oc,Pp,Np,cs,Qu=Ne(()=>{na="function",Hn="object",fi="undefined",Yr="prototype",$c="hasOwnProperty",pi=Object,Bc=pi[Yr],Oc=pi.assign,Pp=pi.create,Np=pi.defineProperty,cs=Bc[$c]});function ia(){return typeof globalThis!==fi&&globalThis?globalThis:typeof self!==fi&&self?self:typeof window!==fi&&window?window:typeof __webpack_require__.g!==fi&&__webpack_require__.g?__webpack_require__.g:null}c(ia,"st");function Zu(t){throw new TypeError(t)}c(Zu,"Er");function Uc(t){var e=Pp;if(e)return e(t);if(t==null)return{};var r=typeof t;r!==Hn&&r!==na&&Zu("Object prototype may only be an Object:"+t);function n(){}return c(n,"n"),n[Yr]=t,new n}c(Uc,"Nt");var Mp=Ne(()=>{Qu()});function Lt(t,e){typeof e!==na&&e!==null&&Zu("Class extends value "+String(e)+" is not a constructor or null"),Hc(t,e);function r(){this.constructor=t}c(r,"r"),t[Yr]=e===null?Uc(e):(r[Yr]=e[Yr],new r)}c(Lt,"z");var Jy,eb,Lp,oa,Hc,tb=Ne(()=>{Qu(),Mp(),Jy=(ia()||{}).Symbol,eb=(ia()||{}).Reflect,Lp=c(function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Bc[$c].call(e,i)&&(t[i]=e[i])}return t},"Pu"),oa=Oc||Lp,Hc=c(function(t,e){return Hc=pi.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n[$c](i)&&(r[i]=n[i])},Hc(t,e)},"Mi")}),rb=Ne(()=>{}),Ut=Ne(()=>{Qu(),Mp(),tb(),rb()});function Mi(t,e){return t&&hs[Wn].hasOwnProperty.call(t,e)}c(Mi,"Bt");function $p(t){return t&&(t===hs[Wn]||t===Array[Wn])}c($p,"Do");function Xu(t){return $p(t)||t===Function[Wn]}c(Xu,"Oi");function fo(t){if(t){if(sa)return sa(t);var e=t[Op]||t[Wn]||(t[ls]?t[ls][Wn]:null);if(e)return e}return null}c(fo,"ar");function Wc(t,e){var r=[],n=hs.getOwnPropertyNames;if(n)r=n(t);else for(var i in t)typeof i=="string"&&Mi(t,i)&&r.push(i);if(r&&r.length>0)for(var o=0;o<r.length;o++)e(r[o])}c(Wc,"qn");function Yu(t,e,r){return e!==ls&&typeof t[e]===us&&(r||Mi(t,e))}c(Yu,"zi");function zc(t){throw new TypeError("DynamicProto: "+t)}c(zc,"Gn");function nb(t){var e={};return Wc(t,function(r){!e[r]&&Yu(t,r,!1)&&(e[r]=t[r])}),e}c(nb,"Au");function Ju(t,e){for(var r=t.length-1;r>=0;r--)if(t[r]===e)return!0;return!1}c(Ju,"Hi");function ib(t,e,r,n){function i(l,u,d){var f=u[d];if(f[qc]&&n){var p=l[ds]||{};p[aa]!==!1&&(f=(p[u[po]]||{})[d]||f)}return function(){return f.apply(l,arguments)}}c(i,"i");var o={};Wc(r,function(l){o[l]=i(e,r,l)});for(var a=fo(t),s=[];a&&!Xu(a)&&!Ju(s,a);)Wc(a,function(l){!o[l]&&Yu(a,l,!sa)&&(o[l]=i(e,a,l))}),s.push(a),a=fo(a);return o}c(ib,"Nu");function ob(t,e,r,n){var i=null;if(t&&Mi(r,po)){var o=t[ds]||{};if(i=(o[r[po]]||{})[e],i||zc("Missing ["+e+"] "+us),!i[jc]&&o[aa]!==!1){for(var a=!Mi(t,e),s=fo(t),l=[];a&&s&&!Xu(s)&&!Ju(l,s);){var u=s[e];if(u){a=u===n;break}l.push(s),s=fo(s)}try{a&&(t[e]=i),i[jc]=1}catch(d){o[aa]=!1}}}return i}c(ob,"Fu");function ab(t,e,r){var n=e[t];return n===r&&(n=fo(e)[t]),typeof n!==us&&zc("["+t+"] is not a "+us),n}c(ab,"ku");function sb(t,e,r,n,i){function o(l,u){var d=c(function(){var f=ob(this,u,l,d)||ab(u,l,d);return f.apply(this,arguments)},"l");return d[qc]=1,d}if(c(o,"a"),!$p(t)){var a=r[ds]=r[ds]||{},s=a[e]=a[e]||{};a[aa]!==!1&&(a[aa]=!!i),Wc(r,function(l){Yu(r,l,!1)&&r[l]!==n[l]&&(s[l]=r[l],delete r[l],(!Mi(t,l)||t[l]&&!t[l][qc])&&(t[l]=o(t,l)))})}}c(sb,"Ru");function cb(t,e){if(sa)for(var r=[],n=fo(e);n&&!Xu(n)&&!Ju(r,n);){if(n===t)return!0;r.push(n),n=fo(n)}return!1}c(cb,"Mu");function ed(t,e){return Mi(t,Wn)?t.name||e||nd:((t||{})[ls]||{}).name||e||nd}c(ed,"ji");function td(t,e,r,n){Mi(t,Wn)||zc("theClass is an invalid class definition.");var i=t[Wn];cb(i,e)||zc("["+ed(t)+"] is not in class hierarchy of ["+ed(e)+"]");var o=null;Mi(i,po)?o=i[po]:(o=Bp+ed(t,"_")+"$"+od,od++,i[po]=o);var a=td[rd],s=!!a[Vc];s&&n&&n[Vc]!==void 0&&(s=!!n[Vc]);var l=nb(e),u=ib(i,e,l,s);r(e,u);var d=!!sa&&!!a[id];d&&n&&(d=!!n[id]),sb(i,o,e,l,d!==!1)}c(td,"Bi");var ls,Wn,us,ds,qc,po,Bp,jc,aa,rd,nd,Op,Vc,id,hs,sa,od,Up,ir,vr=Ne(()=>{ls="constructor",Wn="prototype",us="function",ds="_dynInstFuncs",qc="_isDynProxy",po="_dynClass",Bp="_dynCls$",jc="_dynInstChk",aa=jc,rd="_dfOpts",nd="_unknown_",Op="__proto__",Vc="useBaseInst",id="setInstFuncs",hs=Object,sa=hs.getPrototypeOf,od=0,Up={setInstFuncs:!0,useBaseInst:!0},td[rd]=Up,ir=td}),We,Be,Gc=Ne(()=>{(function(t){t[t.CRITICAL=1]="CRITICAL",t[t.WARNING=2]="WARNING"})(We||(We={})),Be={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103}});function ad(t){return Bc.toString.call(t)}c(ad,"Vi");function lb(t,e){return typeof t===e}c(lb,"qi");function Or(t){return t===void 0||typeof t===fi}c(Or,"de");function ze(t){return t===null||Or(t)}c(ze,"x");function ub(t){return!ze(t)}c(ub,"Gi");function sd(t,e){return t&&cs.call(t,e)}c(sd,"Pr");function go(t){return typeof t===Hn}c(go,"ct");function It(t){return typeof t===na}c(It,"H");function fs(t,e,r,n){n===void 0&&(n=!1);var i=!1;if(!ze(t))try{ze(t[pd])?ze(t[fd])||(t[fd](hd+e,r),i=!0):(t[pd](e,r,n),i=!0)}catch(o){}return i}c(fs,"Vt");function Hp(t,e,r,n){if(n===void 0&&(n=!1),!ze(t))try{ze(t[md])?ze(t[gd])||t[gd](hd+e,r):t[md](e,r,n)}catch(i){}}c(Hp,"Kn");function db(t){var e=t,r=/([^\w\d_$])/g;return r.test(t)&&(e=t.replace(r,"_")),e}c(db,"Ki");function ur(t,e){if(t)for(var r in t)cs.call(t,r)&&e.call(t,r,t[r])}c(ur,"Y");function hb(t,e){if(t&&e){var r=e.length,n=t.length;if(t===e)return!0;if(n>=r){for(var i=n-1,o=r-1;o>=0;o--){if(t[i]!=e[o])return!1;i--}return!0}}return!1}c(hb,"Wi");function Ir(t,e){return t&&e?t.indexOf(e)!==-1:!1}c(Ir,"we");function cd(t){return ad(t)==="[object Date]"}c(cd,"br");function gi(t){return ad(t)==="[object Array]"}c(gi,"Me");function Kc(t){return ad(t)==="[object Error]"}c(Kc,"qt");function yt(t){return typeof t=="string"}c(yt,"_");function ld(t){return typeof t=="number"}c(ld,"or");function ud(t){return typeof t=="boolean"}c(ud,"Wr");function Li(t){if(cd(t)){var e=c(function(r){var n=String(r);return n.length===1&&(n="0"+n),n},"e");return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}c(Li,"Le");function bt(t,e,r){for(var n=t.length,i=0;i<n&&!(i in t&&e.call(r||t,t[i],i,t)===-1);i++);}c(bt,"R");function ps(t,e,r){for(var n=t.length,i=r||0,o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in t&&t[o]===e)return o;return-1}c(ps,"kt");function gs(t,e,r){for(var n=t.length,i=r||t,o=new Array(n),a=0;a<n;a++)a in t&&(o[a]=e.call(i,t[a],t));return o}c(gs,"Gt");function Wp(t,e,r){var n=t.length,i=0,o;if(arguments.length>=3)o=arguments[2];else{for(;i<n&&!(i in t);)i++;o=t[i++]}for(;i<n;)i in t&&(o=e(o,t[i],i,t)),i++;return o}c(Wp,"Jr");function xr(t){return typeof t!="string"?t:t.replace(/^\s+|\s+$/g,"")}c(xr,"oe");function mo(t){var e=typeof t;e!==na&&(e!==Hn||t===null)&&Zu("objKeys called on non-object");var r=[];for(var n in t)t&&cs.call(t,n)&&r.push(n);if(Vp)for(var i=Qc.length,o=0;o<i;o++)t&&cs.call(t,Qc[o])&&r.push(Qc[o]);return r}c(mo,"et");function ca(t,e,r,n){if(vd)try{var i={enumerable:!0,configurable:!0};return r&&(i.get=r),n&&(i.set=n),vd(t,e,i),!0}catch(o){}return!1}c(ca,"Ct");function sn(){var t=Date;return t.now?t.now():new t().getTime()}c(sn,"me");function Nt(t){return Kc(t)?t.name:""}c(Nt,"G");function kt(t,e,r,n,i){var o=r;return t&&(o=t[e],o!==r&&(!i||i(o))&&(!n||n(r))&&(o=r,t[e]=o)),o}c(kt,"K");function kr(t,e,r){var n;return t?(n=t[e],!n&&ze(n)&&(n=Or(r)?{}:r,t[e]=n)):n=Or(r)?{}:r,n}c(kr,"ve");function zp(t){return!t}c(zp,"Wn");function dd(t){return!!t}c(dd,"Dr");function zn(t){throw new Error(t)}c(zn,"Ne");function qp(t,e,r){if(t&&e&&t!==e&&go(t)&&go(e)){var n=c(function(o){if(yt(o)){var a=e[o];It(a)?(!r||r(o,!0,e,t))&&(t[o]=function(s){return function(){var l=arguments;return e[s].apply(e,l)}}(o)):(!r||r(o,!1,e,t))&&(sd(t,o)&&delete t[o],ca(t,o,function(){return e[o]},function(s){e[o]=s})||(t[o]=a))}},"n");for(var i in e)n(i)}return t}c(qp,"Xr");function fb(t){return function(){function e(){var r=this;t&&ur(t,function(n,i){r[n]=i})}return c(e,"e"),e}()}c(fb,"Xi");function jp(t){return t&&(t=pi(Oc?Oc({},t):t)),t}c(jp,"Jn");var hd,fd,pd,gd,md,vd,pb,gb,Vp,Qc,Tr=Ne(()=>{Ut(),hd="on",fd="attachEvent",pd="addEventListener",gd="detachEvent",md="removeEventListener",vd=Np,pb=pi.freeze,gb=pi.seal,Vp=!{toString:null}.propertyIsEnumerable("toString"),Qc=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]});function Dr(t){var e=ia();return e&&e[t]?e[t]:t===yd&&Zc()?window:null}c(Dr,"Pe");function Zc(){return Boolean(typeof window===Hn&&window)}c(Zc,"sr");function ms(){return Zc()?window:Dr(yd)}c(ms,"It");function Gp(){return Boolean(typeof document===Hn&&document)}c(Gp,"Xn");function qn(){return Gp()?document:Dr(Kp)}c(qn,"Fe");function mb(){return Boolean(typeof navigator===Hn&&navigator)}c(mb,"_o");function jn(){return mb()?navigator:Dr(Qp)}c(jn,"_e");function vb(){return Boolean(typeof history===Hn&&history)}c(vb,"Oo");function wb(){return vb()?history:Dr(Zp)}c(wb,"ea");function vo(t){if(t&&ng){var e=Dr("__mockLocation");if(e)return e}return typeof location===Hn&&location?location:Dr(Xp)}c(vo,"tt");function yb(){return typeof console!==fi?console:Dr(Yp)}c(yb,"ta");function mi(){return Dr(Jp)}c(mi,"Ze");function la(){return Boolean(typeof JSON===Hn&&JSON||Dr(bd)!==null)}c(la,"ht");function En(){return la()?JSON||Dr(bd):null}c(En,"be");function bb(){return Dr(eg)}c(bb,"ra");function _b(){return Dr(tg)}c(_b,"na");function xb(){var t=jn();return t&&t.product?t.product===rg:!1}c(xb,"ia");function Xc(){var t=jn();if(t&&(t.userAgent!==tl||el===null)){tl=t.userAgent;var e=(tl||"").toLowerCase();el=Ir(e,Yc)||Ir(e,Jc)}return el}c(Xc,"Kt");function wd(t){if(t===void 0&&(t=null),!t){var e=jn()||{};t=e?(e.userAgent||"").toLowerCase():""}var r=(t||"").toLowerCase();if(Ir(r,Yc))return parseInt(r.split(Yc)[1]);if(Ir(r,Jc)){var n=parseInt(r.split(Jc)[1]);if(n)return n+4}return null}c(wd,"cr");function gt(t){var e=Object[Yr].toString.call(t),r="";return e==="[object Error]"?r="{ stack: '"+t.stack+"', message: '"+t.message+"', name: '"+t.name+"'":la()&&(r=En().stringify(t)),e+r}c(gt,"O");var yd,Kp,Qp,Zp,Xp,Yp,Jp,bd,eg,tg,rg,Yc,Jc,el,tl,ng,vs=Ne(()=>{Ut(),Tr(),yd="window",Kp="document",Qp="navigator",Zp="history",Xp="location",Yp="console",Jp="performance",bd="JSON",eg="crypto",tg="msCrypto",rg="ReactNative",Yc="msie",Jc="trident/",el=null,tl=null,ng=!1});function ig(t){return t?'"'+t.replace(/\"/g,"")+'"':""}c(ig,"zo");function rl(t,e){return(t||{}).logger||new _d(e)}c(rl,"Mt");var og,ag,sg,ua,_d,xd=Ne(()=>{Gc(),vs(),vr(),Tr(),og="AI (Internal): ",ag="AI: ",sg="AITR_",ua=function(){function t(e,r,n,i){n===void 0&&(n=!1);var o=this;o.messageId=e,o.message=(n?ag:og)+e;var a="";la()&&(a=En().stringify(i));var s=(r?" message:"+ig(r):"")+(i?" props:"+ig(a):"");o.message+=s}return c(t,"t"),t.dataType="MessageData",t}(),_d=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var r=0,n={};ir(t,this,function(i){ze(e)&&(e={}),i.consoleLoggingLevel=function(){return o("loggingLevelConsole",0)},i.telemetryLoggingLevel=function(){return o("loggingLevelTelemetry",1)},i.maxInternalMessageLimit=function(){return o("maxMessageLimit",25)},i.enableDebugExceptions=function(){return o("enableDebugExceptions",!1)},i.throwInternal=function(s,l,u,d,f){f===void 0&&(f=!1);var p=new ua(l,u,f,d);if(i.enableDebugExceptions())throw p;if(!Or(p.message)){var g=i.consoleLoggingLevel();if(f){var _=+p.messageId;!n[_]&&g>=We.WARNING&&(i.warnToConsole(p.message),n[_]=!0)}else g>=We.WARNING&&i.warnToConsole(p.message);i.logInternalMessage(s,p)}},i.warnToConsole=function(s){var l=yb();if(l){var u="log";l.warn&&(u="warn"),It(l[u])&&l[u](s)}},i.resetInternalMessageCount=function(){r=0,n={}},i.logInternalMessage=function(s,l){if(!a()){var u=!0,d=sg+l.messageId;if(n[d]?u=!1:n[d]=!0,u&&(s<=i.telemetryLoggingLevel()&&(i.queue.push(l),r++),r===i.maxInternalMessageLimit())){var f="Internal events throttle limit per PageView reached for this app.",p=new ua(Be.MessageLimitPerPVExceeded,f,!1);i.queue.push(p),i.warnToConsole(f)}}};function o(s,l){var u=e[s];return ze(u)?l:u}c(o,"a");function a(){return r>=i.maxInternalMessageLimit()}c(a,"o")})}return c(t,"t"),t}()});function da(t,e,r,n,i){if(t){var o=t;if(It(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(nl);try{if(a=o.create(e(),n,i),a){if(s&&a.setCtx&&(a.setCtx(ha.ParentContextKey,s),s.getCtx&&s.setCtx)){var l=s.getCtx(ha.ChildrenContextKey);l||(l=[],s.setCtx(ha.ChildrenContextKey,l)),l.push(a)}return o.setCtx(nl,a),r(a)}}catch(u){a&&a.setCtx&&a.setCtx("exception",u)}finally{a&&o.fire(a),o.setCtx(nl,s)}}}return r()}c(da,"ut");var wo,ha,Sd,nl,il=Ne(()=>{vr(),Tr(),wo="ctx",ha=function(){function t(e,r,n){var i=this,o=!1;if(i.start=sn(),i.name=e,i.isAsync=n,i.isChildEvt=function(){return!1},It(r)){var a;o=ca(i,"payload",function(){return!a&&It(r)&&(a=r(),r=null),a})}i.getCtx=function(s){return s?s===t.ParentContextKey||s===t.ChildrenContextKey?i[s]:(i[wo]||{})[s]:null},i.setCtx=function(s,l){if(s)if(s===t.ParentContextKey)i[s]||(i.isChildEvt=function(){return!0}),i[s]=l;else if(s===t.ChildrenContextKey)i[s]=l;else{var u=i[wo]=i[wo]||{};u[s]=l}},i.complete=function(){var s=0,l=i.getCtx(t.ChildrenContextKey);if(gi(l))for(var u=0;u<l.length;u++){var d=l[u];d&&(s+=d.time)}i.time=sn()-i.start,i.exTime=i.time-s,i.complete=function(){},!o&&It(r)&&(i.payload=r())}}return c(t,"t"),t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),Sd=function(){function t(e){this.ctx={},ir(t,this,function(r){r.create=function(n,i,o){return new ha(n,i,o)},r.fire=function(n){n&&(n.complete(),e&&e.perfEvent(n))},r.setCtx=function(n,i){if(n){var o=r[wo]=r[wo]||{};o[n]=i}},r.getCtx=function(n){return(r[wo]||{})[n]}})}return c(t,"t"),t}(),nl="CoreUtils.doPerf"}),cg,Sb=Ne(()=>{il(),Gc(),Tr(),cg=function(){function t(e,r){var n=this,i=null,o=It(e.processTelemetry),a=It(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(s){i=s},n.processTelemetry=function(s,l){l||(l=r);var u=e?e.identifier:"TelemetryPluginChain";da(l?l.core():null,function(){return u+":processTelemetry"},function(){if(e&&o){n._hasRun=!0;try{l.setNext(i),a&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(s,l)}catch(f){var d=i&&i._hasRun;(!i||!d)&&l.diagLog().throwInternal(We.CRITICAL,Be.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+f),i&&!d&&i.processTelemetry(s,l)}}else i&&(n._hasRun=!0,i.processTelemetry(s,l))},function(){return{item:s}},!s.sync)}}return c(t,"t"),t}()});function Cd(t,e){var r=[];if(t&&t.length>0)for(var n=null,i=0;i<t.length;i++){var o=t[i];if(o&&It(o.processTelemetry)){var a=new cg(o,e);r.push(a),n&&n.setNext(a),n=a}}return r.length>0?r[0]:null}c(Cd,"oa");function Cb(t,e,r){var n=[],i=!r;if(t)for(;t;){var o=t.getPlugin();(i||o===r)&&(i=!0,n.push(o)),t=t.getNext()}return i||n.push(r),Cd(n,e)}c(Cb,"Qu");function Eb(t,e,r){var n=t,i=!1;return r&&t&&(n=[],bt(t,function(o){(i||o===r)&&(i=!0,n.push(o))})),r&&!i&&(n||(n=[]),n.push(r)),Cd(n,e)}c(Eb,"Zu");var yo,Ed=Ne(()=>{xd(),Sb(),Tr(),yo=function(){function t(e,r,n,i){var o=this,a=null;i!==null&&(e&&It(e.getPlugin)?a=Cb(e,o,i||e.getPlugin()):i?a=Eb(e,o,i):Or(i)&&(a=Cd(e,o))),o.core=function(){return n},o.diagLog=function(){return rl(n,r)},o.getCfg=function(){return r},o.getExtCfg=function(s,l){l===void 0&&(l={});var u;if(r){var d=r.extensionConfig;d&&s&&(u=d[s])}return u||l},o.getConfig=function(s,l,u){u===void 0&&(u=!1);var d,f=o.getExtCfg(s,null);return f&&!ze(f[l])?d=f[l]:r&&!ze(r[l])&&(d=r[l]),ze(d)?u:d},o.hasNext=function(){return a!=null},o.getNext=function(){return a},o.setNext=function(s){a=s},o.processNext=function(s){var l=a;l&&(a=l.getNext(),l.processTelemetry(s,o))},o.createNew=function(s,l){return s===void 0&&(s=null),new t(s||a,r,n,l)}}return c(t,"t"),t}()}),lg,Rd,ug=Ne(()=>{lg="iKey",Rd="extensionConfig"}),ws,bo,dg=Ne(()=>{Ed(),Tr(),ug(),ws="getPlugin",bo=function(){function t(){var e=this,r=!1,n=null,i=null;e.core=null,e.diagLog=function(o){return e._getTelCtx(o).diagLog()},e.isInitialized=function(){return r},e.setInitialized=function(o){r=o},e.setNextPlugin=function(o){i=o},e.processNext=function(o,a){a?a.processNext(o):i&&It(i.processTelemetry)&&i.processTelemetry(o,null)},e._getTelCtx=function(o){o===void 0&&(o=null);var a=o;if(!a){var s=n||new yo(null,{},e.core);i&&i[ws]?a=s.createNew(null,i[ws]):a=s.createNew(null,i)}return a},e._baseTelInit=function(o,a,s,l){o&&kt(o,Rd,[],null,ze),!l&&a&&(l=a.getProcessTelContext().getNext());var u=i;i&&i[ws]&&(u=i[ws]()),e.core=a,n=new yo(l,o,a,u),r=!0}}return c(t,"t"),t.prototype.initialize=function(e,r,n,i){this._baseTelInit(e,r,n,i)},t}()});function Ad(t,e){for(var r=[],n=null,i=t.getNext();i;){var o=i.getPlugin();o&&(n&&It(n[kd])&&It(o[ol])&&n[kd](o),(!It(o[Td])||!o[Td]())&&r.push(o),n=o,i=i.getNext())}bt(r,function(a){a.initialize(t.getCfg(),t.core(),e,t.getNext())})}c(Ad,"$r");function hg(t){return t.sort(function(e,r){var n=0,i=It(r[ol]);return It(e[ol])?n=i?e[Id]-r[Id]:1:i&&(n=-1),n})}c(hg,"la");var ol,Id,kd,Td,fg=Ne(()=>{Tr(),ol="processTelemetry",Id="priority",kd="setNextPlugin",Td="isInitialized"}),al,pg,gg,Rb=Ne(()=>{Ut(),vr(),dg(),Ed(),fg(),Tr(),al=500,pg="Channel has invalid priority",gg=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.identifier="ChannelControllerPlugin",r.priority=al;var n;ir(e,r,function(s,l){s.setNextPlugin=function(u){},s.processTelemetry=function(u,d){n&&bt(n,function(f){if(f.length>0){var p=r._getTelCtx(d).createNew(f);p.processNext(u)}})},s.getChannelControls=function(){return n},s.initialize=function(u,d,f){s.isInitialized()||(l.initialize(u,d,f),a((u||{}).channels,f),bt(n,function(p){return Ad(new yo(p,u,d),f)}))}});function i(s){bt(s,function(l){l.priority<al&&zn(pg+l.identifier)})}c(i,"i");function o(s){s&&s.length>0&&(s=s.sort(function(l,u){return l.priority-u.priority}),i(s),n.push(s))}c(o,"a");function a(s,l){if(n=[],s&&bt(s,function(d){return o(d)}),l){var u=[];bt(l,function(d){d.priority>al&&u.push(d)}),o(u)}}return c(a,"o"),r}return c(e,"e"),e._staticInit=function(){var r=e.prototype;ca(r,"ChannelControls",r.getChannelControls),ca(r,"channelQueue",r.getChannelControls)}(),e}(bo)});function mg(t,e){var r=ys[vi]||_s[vi];return r||(r=ys[vi]=ys(t,e),_s[vi]=r),r}c(mg,"ha");function sl(t){return t?t.isEnabled():!0}c(sl,"ni");function Ab(t){var e=t.cookieCfg=t.cookieCfg||{};if(kt(e,"domain",t.cookieDomain,ub,ze),kt(e,"path",t.cookiePath||"/",null,ze),ze(e[ul])){var r=void 0;Or(t[Nd])||(r=!t[Nd]),Or(t[Md])||(r=!t[Md]),e[ul]=r}return e}c(Ab,"Yu");function Dd(t,e){var r;if(t)r=t.getCookieMgr();else if(e){var n=e.cookieCfg;n[vi]?r=n[vi]:r=ys(e)}return r||(r=mg(e,(t||{}).logger)),r}c(Dd,"lr");function ys(t,e){var r=Ab(t||_s),n=r.path||"/",i=r.domain,o=r[ul]!==!1,a={isEnabled:function(){var s=o&&vg(e),l=_s[vi];return s&&l&&a!==l&&(s=sl(l)),s},setEnabled:function(s){o=s!==!1},set:function(s,l,u,d,f){if(sl(a)){var p={},g=xr(l||cn),_=g.indexOf(";");if(_!==-1&&(g=xr(l.substring(0,_)),p=wg(l.substring(_+1))),kt(p,"domain",d||i,dd,Or),!ze(u)){var b=Xc();if(Or(p[ll])){var y=sn(),x=y+u*1e3;if(x>0){var C=new Date;C.setTime(x),kt(p,ll,yg(C,b?Fd:Pd)||yg(C,b?Fd:Pd)||cn,dd)}}b||kt(p,"max-age",cn+u,null,Or)}var k=vo();k&&k.protocol==="https:"&&(kt(p,"secure",null,null,Or),dl===null&&(dl=!xg((jn()||{}).userAgent)),dl&&kt(p,"SameSite","None",null,Or)),kt(p,"path",f||n,null,Or);var T=r.setCookie||_g;T(s,bg(g,p))}},get:function(s){var l=cn;return sl(a)&&(l=(r.getCookie||Ib)(s)),l},del:function(s,l){sl(a)&&a.purge(s,l)},purge:function(s,l){if(vg(e)){var u=(f={},f.path=l||"/",f[ll]="Thu, 01 Jan 1970 00:00:01 GMT",f);Xc()||(u["max-age"]="0");var d=r.delCookie||_g;d(s,bg(cn,u))}var f}};return a[vi]=a,a}c(ys,"fr");function vg(t){if(bs===null){bs=!1;try{var e=fa||{};bs=e[cl]!==void 0}catch(r){t&&t.throwInternal(We.WARNING,Be.CannotAccessCookie,"Cannot access document.cookie - "+Nt(r),{exception:gt(r)})}}return bs}c(vg,"xa");function wg(t){var e={};if(t&&t.length){var r=xr(t).split(";");bt(r,function(n){if(n=xr(n||cn),n){var i=n.indexOf("=");i===-1?e[n]=null:e[xr(n.substring(0,i))]=xr(n.substring(i+1))}})}return e}c(wg,"es");function yg(t,e){return It(t[e])?t[e]():null}c(yg,"ts");function bg(t,e){var r=t||cn;return ur(e,function(n,i){r+="; "+n+(ze(i)?cn:"="+i)}),r}c(bg,"rs");function Ib(t){var e=cn;if(fa){var r=fa[cl]||cn;Ld!==r&&($d=wg(r),Ld=r),e=xr($d[t]||cn)}return e}c(Ib,"el");function _g(t,e){fa&&(fa[cl]=t+"="+e)}c(_g,"ns");function xg(t){return yt(t)?!!(Ir(t,"CPU iPhone OS 12")||Ir(t,"iPad; CPU OS 12")||Ir(t,"Macintosh; Intel Mac OS X 10_14")&&Ir(t,"Version/")&&Ir(t,"Safari")||Ir(t,"Macintosh; Intel Mac OS X 10_14")&&hb(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Ir(t,"Chrome/5")||Ir(t,"Chrome/6")||Ir(t,"UnrealEngine")&&!Ir(t,"Chrome")||Ir(t,"UCBrowser/12")||Ir(t,"UCBrowser/11")):!1}c(xg,"ii");var Fd,Pd,cl,ll,ul,Nd,Md,vi,cn,bs,dl,Ld,fa,$d,_s,Bd=Ne(()=>{Gc(),vs(),Tr(),Fd="toGMTString",Pd="toUTCString",cl="cookie",ll="expires",ul="enabled",Nd="isCookieUseDisabled",Md="disableCookiesUsage",vi="_ckMgr",cn="",bs=null,dl=null,Ld=null,fa=qn(),$d={},_s={}}),Sg,Od,Ud,Cg=Ne(()=>{Ut(),vr(),Rb(),Ed(),fg(),il(),Bd(),Tr(),ug(),Sg="Extensions must provide callback to initialize",Od="_notificationManager",Ud=function(){function t(){var e=!1,r,n,i,o,a;ir(t,this,function(s){s._extensions=new Array,n=new gg,s.logger=Uc({throwInternal:function(l,u,d,f,p){p===void 0&&(p=!1)},warnToConsole:function(l){},resetInternalMessageCount:function(){}}),r=[],s.isInitialized=function(){return e},s.initialize=function(l,u,d,f){s.isInitialized()&&zn("Core should not be initialized more than once"),(!l||ze(l.instrumentationKey))&&zn("Please provide instrumentation key"),i=f,s[Od]=f,s.config=l||{},l.extensions=ze(l.extensions)?[]:l.extensions;var p=kr(l,Rd);p.NotificationManager=f,d&&(s.logger=d);var g=[];g.push.apply(g,u.concat(l.extensions)),g=hg(g);var _=[],b=[],y={};bt(g,function(x){(ze(x)||ze(x.initialize))&&zn(Sg);var C=x.priority,k=x.identifier;x&&C&&(ze(y[C])?y[C]=k:d.warnToConsole("Two extensions have same priority #"+C+" - "+y[C]+", "+k)),!C||C<n.priority?_.push(x):b.push(x)}),g.push(n),_.push(n),g=hg(g),s._extensions=g,Ad(new yo([n],l,s),g),Ad(new yo(_,l,s),g),s._extensions=_,s.getTransmissionControls().length===0&&zn("No channels available"),e=!0,s.releaseQueue()},s.getTransmissionControls=function(){return n.getChannelControls()},s.track=function(l){kt(l,lg,s.config.instrumentationKey,null,zp),kt(l,"time",Li(new Date),null,zp),kt(l,"ver","4.0",null,ze),s.isInitialized()?s.getProcessTelContext().processNext(l):r.push(l)},s.getProcessTelContext=function(){var l=s._extensions,u=l;return(!l||l.length===0)&&(u=[n]),new yo(u,s.config,s)},s.getNotifyMgr=function(){return i||(i=Uc({addNotificationListener:function(l){},removeNotificationListener:function(l){},eventsSent:function(l){},eventsDiscarded:function(l,u){},eventsSendRequest:function(l,u){}}),s[Od]=i),i},s.getCookieMgr=function(){return a||(a=ys(s.config,s.logger)),a},s.setCookieMgr=function(l){a=l},s.getPerfMgr=function(){return o||s.config&&s.config.enablePerfMgr&&(o=new Sd(s.getNotifyMgr())),o},s.setPerfMgr=function(l){o=l},s.eventCnt=function(){return r.length},s.releaseQueue=function(){r.length>0&&(bt(r,function(l){s.getProcessTelContext().processNext(l)}),r=[])}})}return c(t,"t"),t}()}),Hd,Eg=Ne(()=>{vr(),Tr(),Hd=function(){function t(e){this.listeners=[];var r=!!(e||{}).perfEvtsSendAll;ir(t,this,function(n){n.addNotificationListener=function(i){n.listeners.push(i)},n.removeNotificationListener=function(i){for(var o=ps(n.listeners,i);o>-1;)n.listeners.splice(o,1),o=ps(n.listeners,i)},n.eventsSent=function(i){bt(n.listeners,function(o){o&&o.eventsSent&&setTimeout(function(){return o.eventsSent(i)},0)})},n.eventsDiscarded=function(i,o){bt(n.listeners,function(a){a&&a.eventsDiscarded&&setTimeout(function(){return a.eventsDiscarded(i,o)},0)})},n.eventsSendRequest=function(i,o){bt(n.listeners,function(a){if(a&&a.eventsSendRequest)if(o)setTimeout(function(){return a.eventsSendRequest(i,o)},0);else try{a.eventsSendRequest(i,o)}catch(s){}})},n.perfEvent=function(i){i&&(r||!i.isChildEvt())&&bt(n.listeners,function(o){if(o&&o.perfEvent)if(i.isAsync)setTimeout(function(){return o.perfEvent(i)},0);else try{o.perfEvent(i)}catch(a){}})}})}return c(t,"t"),t}()}),Wd,kb=Ne(()=>{Ut(),Cg(),Yy(),Eg(),il(),xd(),vr(),Tr(),Wd=function(t){Lt(e,t);function e(){var r=t.call(this)||this;return ir(e,r,function(n,i){n.initialize=function(s,l,u,d){i.initialize(s,l,u||new _d(s),d||new Hd(s))},n.track=function(s){da(n.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){s===null&&(a(s),zn("Invalid telemetry item")),o(s),i.track(s)},function(){return{item:s}},!s.sync)},n.addNotificationListener=function(s){var l=n.getNotifyMgr();l&&l.addNotificationListener(s)},n.removeNotificationListener=function(s){var l=n.getNotifyMgr();l&&l.removeNotificationListener(s)},n.pollInternalLogs=function(s){var l=n.config.diagnosticLogInterval;return(!l||!(l>0))&&(l=1e4),setInterval(function(){var u=n.logger?n.logger.queue:[];bt(u,function(d){var f={name:s||"InternalMessageId: "+d.messageId,iKey:n.config.instrumentationKey,time:Li(new Date),baseType:ua.dataType,baseData:{message:d.message}};n.track(f)}),u.length=0},l)};function o(s){if(ze(s.name))throw a(s),Error("telemetry name required")}c(o,"a");function a(s){var l=n.getNotifyMgr();l&&l.eventsDiscarded([s],Fp.InvalidEvent)}c(a,"o")}),r}return c(e,"e"),e}(Ud)});function Rg(t){t<0&&(t>>>=0),pa=123456789+t&wi,ga=987654321-t&wi,qd=!0}c(Rg,"cs");function Ag(){try{var t=sn()&2147483647;Rg((Math.random()*zd^t)+t)}catch(e){}}c(Ag,"us");function Ig(t){return t>0?Math.floor(_o()/wi*(t+1))>>>0:0}c(Ig,"oi");function _o(t){var e,r=bb()||_b();return r&&r.getRandomValues?e=r.getRandomValues(new Uint32Array(1))[0]&wi:Xc()?(qd||Ag(),e=kg()&wi):e=Math.floor(zd*Math.random()|0),t||(e>>>=0),e}c(_o,"Tt");function Tb(t){t?Rg(t):Ag()}c(Tb,"Ca");function kg(t){ga=36969*(ga&65535)+(ga>>16)&wi,pa=18e3*(pa&65535)+(pa>>16)&wi;var e=(ga<<16)+(pa&65535)>>>0&wi|0;return t||(e>>>=0),e}c(kg,"si");var zd,wi,qd,pa,ga,Tg=Ne(()=>{vs(),Tr(),zd=4294967296,wi=4294967295,qd=!1,pa=123456789,ga=987654321});function xo(t,e){var r=!1,n=ms();n&&(r=fs(n,t,e),r=fs(n.body,t,e)||r);var i=qn();return i&&(r=Ss.Attach(i,t,e)||r),r}c(xo,"Ut");function Db(){function t(){return Ig(15)}return c(t,"t"),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Fg,function(e){var r=t()|0,n=e==="x"?r:r&3|8;return n.toString(16)})}c(Db,"ls");function Fb(){var t=mi();return t&&t.now?t.now():sn()}c(Fb,"fs");function hl(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=_o()>>>0,n=0,i="";i.length<t;)n++,i+=e.charAt(r&63),r>>>=6,n===5&&(r=(_o()<<2&4294967295|r&3)>>>0,n=0);return i}c(hl,"Xt");function Vn(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e="",r,n=0;n<4;n++)r=_o(),e+=t[r&15]+t[r>>4&15]+t[r>>8&15]+t[r>>12&15]+t[r>>16&15]+t[r>>20&15]+t[r>>24&15]+t[r>>28&15];var i=t[8+(_o()&3)|0];return e.substr(0,8)+e.substr(9,4)+"4"+e.substr(13,3)+i+e.substr(16,3)+e.substr(19,12)}c(Vn,"He");function ma(t,e){var r=mg(t,e),n=fl._canUseCookies;return va===null&&(va=[],xs=n,ca(fl,"_canUseCookies",function(){return xs},function(i){xs=i,bt(va,function(o){o.setEnabled(i)})})),ps(va,r)===-1&&va.push(r),ud(n)&&r.setEnabled(n),ud(xs)&&r.setEnabled(xs),r}c(ma,"Zt");function Dg(){ma().setEnabled(!1)}c(Dg,"ci");function Pb(t){return ma(null,t).isEnabled()}c(Pb,"Ta");function Nb(t,e){return ma(null,t).get(e)}c(Nb,"Ea");function Mb(t,e,r,n){ma(null,t).set(e,r,null,n)}c(Mb,"wa");function Lb(t,e){return ma(null,t).del(e)}c(Lb,"Pa");var va,xs,fl,Fg,Ss,$b=Ne(()=>{Ut(),Bd(),vs(),Tr(),Tg(),va=null,fl={_canUseCookies:void 0,isTypeof:lb,isUndefined:Or,isNullOrUndefined:ze,hasOwnProperty:sd,isFunction:It,isObject:go,isDate:cd,isArray:gi,isError:Kc,isString:yt,isNumber:ld,isBoolean:ud,toISOString:Li,arrForEach:bt,arrIndexOf:ps,arrMap:gs,arrReduce:Wp,strTrim:xr,objCreate:Uc,objKeys:mo,objDefineAccessors:ca,addEventHandler:xo,dateNow:sn,isIE:Xc,disableCookies:Dg,newGuid:Db,perfNow:Fb,newId:hl,randomValue:Ig,random32:_o,mwcRandomSeed:Tb,mwcRandom32:kg,generateW3CId:Vn},Fg=/[xy]/g,Ss={Attach:fs,AttachEvent:fs,Detach:Hp,DetachEvent:Hp}});function jd(t,e){if(t)for(var r=0;r<t.length&&!e(t[r],r);r++);}c(jd,"ba");function Vd(t,e,r,n,i){i>=0&&i<=2&&jd(t,function(o,a){var s=o.cbks,l=s[Qd[i]];if(l){e.ctx=function(){var f=n[a]=n[a]||{};return f};try{l.apply(e.inst,r)}catch(f){var u=e.err;try{var d=s[Qd[2]];d&&(e.err=f,d.apply(e.inst,r))}catch(p){}finally{e.err=u}}}})}c(Vd,"Da");function Bb(t){return function(){var e=this,r=arguments,n=t.h,i={name:t.n,inst:e,ctx:null,set:l},o=[],a=s([i],r);function s(d,f){return jd(f,function(p){d.push(p)}),d}c(s,"c");function l(d,f){r=s([],r),r[d]=f,a=s([i],r)}c(l,"s"),Vd(n,i,a,o,0);var u=t.f;try{i.rslt=u.apply(e,r)}catch(d){throw i.err=d,Vd(n,i,a,o,3),d}return Vd(n,i,a,o,1),i.rslt}}c(Bb,"al");function Ob(t){if(t){if(Zd)return Zd(t);var e=t[Ng]||t[Yr]||t[Mg];if(e)return e}return null}c(Ob,"ol");function Pg(t,e,r){var n=null;return t&&(sd(t,e)?n=t:r&&(n=Pg(Ob(t),e,!1))),n}c(Pg,"vs");function Ub(t,e,r){return t?Gd(t[Yr],e,r,!1):null}c(Ub,"Aa");function Gd(t,e,r,n){if(n===void 0&&(n=!0),t&&e&&r){var i=Pg(t,e,n);if(i){var o=i[e];if(typeof o===na){var a=o[Kd];if(!a){a={i:0,n:e,f:o,h:[]};var s=Bb(a);s[Kd]=a,i[e]=s}var l={id:a.i,cbks:r,rm:function(){var u=this.id;jd(a.h,function(d,f){if(d.id===u)return a.h.splice(f,1),1})}};return a.i++,a.h.push(l),l}}}return null}c(Gd,"un");var Kd,Qd,Ng,Mg,Zd,Hb=Ne(()=>{Ut(),Tr(),Kd="_aiHooks",Qd=["req","rsp","hkErr","fnErr"],Ng="__proto__",Mg="constructor",Zd=Object.getPrototypeOf}),xt=Ne(()=>{kb(),Cg(),dg(),Tg(),$b(),Tr(),vs(),Ut(),Eg(),il(),xd(),Gc(),Hb(),Bd()}),zt,Lg=Ne(()=>{zt={requestContextHeader:"Request-Context",requestContextTargetKey:"appId",requestContextAppIdFormat:"appId=cid-v1:",requestIdHeader:"Request-Id",traceParentHeader:"traceparent",traceStateHeader:"tracestate",sdkContextHeader:"Sdk-Context",sdkContextHeaderAppIdRequest:"appId",requestContextHeaderLowerCase:"request-context"}});function Xd(t,e,r){var n=e.length,i=$g(t,e);if(i.length!==n){for(var o=0,a=i;r[a]!==void 0;)o++,a=i.substring(0,150-3)+Ug(o);i=a}return i}c(Xd,"ui");function $g(t,e){var r;return e&&(e=xr(e.toString()),e.length>150&&(r=e.substring(0,150),t.throwInternal(We.WARNING,Be.NameTooLong,"name is too long.  It has been truncated to "+150+" characters.",{name:e},!0))),r||e}c($g,"Fa");function Ur(t,e,r){r===void 0&&(r=1024);var n;return e&&(r=r||1024,e=xr(e),e.toString().length>r&&(n=e.toString().substring(0,r),t.throwInternal(We.WARNING,Be.StringValueTooLong,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),n||e}c(Ur,"ae");function Cs(t,e){return Jd(t,e,2048,Be.UrlTooLong)}c(Cs,"Et");function Yd(t,e){var r;return e&&e.length>32768&&(r=e.substring(0,32768),t.throwInternal(We.WARNING,Be.MessageTruncated,"message is too long, it has been truncated to "+32768+" characters.",{message:e},!0)),r||e}c(Yd,"Fr");function Bg(t,e){var r;if(e){var n=""+e;n.length>32768&&(r=n.substring(0,32768),t.throwInternal(We.WARNING,Be.ExceptionTruncated,"exception is too long, it has been truncated to "+32768+" characters.",{exception:e},!0))}return r||e}c(Bg,"li");function $i(t,e){if(e){var r={};ur(e,function(n,i){if(go(i)&&la())try{i=En().stringify(i)}catch(o){t.throwInternal(We.WARNING,Be.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:o},!0)}i=Ur(t,i,8192),n=Xd(t,n,r),r[n]=i}),e=r}return e}c($i,"je");function Bi(t,e){if(e){var r={};ur(e,function(n,i){n=Xd(t,n,r),r[n]=i}),e=r}return e}c(Bi,"Be");function Og(t,e){return e&&Jd(t,e,128,Be.IdTooLong).toString()}c(Og,"fi");function Jd(t,e,r,n){var i;return e&&(e=xr(e),e.length>r&&(i=e.substring(0,r),t.throwInternal(We.WARNING,n,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0))),i||e}c(Jd,"pi");function Ug(t){var e="00"+t;return e.substr(e.length-3)}c(Ug,"ka");var Hg,Rn=Ne(()=>{xt(),Hg={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768,sanitizeKeyAndAddUniqueness:Xd,sanitizeKey:$g,sanitizeString:Ur,sanitizeUrl:Cs,sanitizeMessage:Yd,sanitizeException:Bg,sanitizeProperties:$i,sanitizeMeasurements:Bi,sanitizeId:Og,sanitizeInput:Jd,padNumber:Ug,trim:xr}});function wa(t){var e=null;if(It(Event))e=new Event(t);else{var r=qn();r&&r.createEvent&&(e=r.createEvent("Event"),e.initEvent(t,!0,!0))}return e}c(wa,"_t");var Wg=Ne(()=>{xt()});function $t(t,e){return e===void 0&&(e=!1),t==null?e:t.toString().toLowerCase()==="true"}c($t,"ee");function yi(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=""+t%1e3,r=""+Math.floor(t/1e3)%60,n=""+Math.floor(t/(1e3*60))%60,i=""+Math.floor(t/(1e3*60*60))%24,o=Math.floor(t/(1e3*60*60*24));return e=e.length===1?"00"+e:e.length===2?"0"+e:e,r=r.length<2?"0"+r:r,n=n.length<2?"0"+n:n,i=i.length<2?"0"+i:i,(o>0?o+".":"")+i+":"+n+":"+r+"."+e}c(yi,"Ke");function eh(){var t=jn();return"sendBeacon"in t&&t.sendBeacon}c(eh,"kr");function zg(t,e){var r=null;return bt(t,function(n){if(n.identifier===e)return r=n,-1}),r}c(zg,"ln");function qg(t,e,r,n,i){return!i&&yt(t)&&(t==="Script error."||t==="Script error")}c(qg,"fn");var pl=Ne(()=>{xt()}),So,gl,ya,ml,th,ln,An=Ne(()=>{So="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",gl="sampleRate",ya="ProcessLegacy",ml="http.method",th="https://dc.services.visualstudio.com",ln="not_specified"}),Co,In,jg=Ne(()=>{(function(t){t[t.LocalStorage=0]="LocalStorage",t[t.SessionStorage=1]="SessionStorage"})(Co||(Co={})),function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C",t[t.W3C=2]="W3C"}(In||(In={}))});function rh(){return ih()?vl(Co.LocalStorage):null}c(rh,"Ua");function vl(t){try{if(ze(ia()))return null;var e=new Date,r=Dr(t===Co.LocalStorage?"localStorage":"sessionStorage");r.setItem(e.toString(),e.toString());var n=r.getItem(e.toString())!==e.toString();if(r.removeItem(e.toString()),!n)return r}catch(i){}return null}c(vl,"di");function nh(){return ba()?vl(Co.SessionStorage):null}c(nh,"_a");function Vg(){Oi=!1,Ui=!1}c(Vg,"mn");function ih(){return Oi===void 0&&(Oi=!!vl(Co.LocalStorage)),Oi}c(ih,"Mr");function Gg(t,e){var r=rh();if(r!==null)try{return r.getItem(e)}catch(n){Oi=!1,t.throwInternal(We.WARNING,Be.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+Nt(n),{exception:gt(n)})}return null}c(Gg,"gn");function Kg(t,e,r){var n=rh();if(n!==null)try{return n.setItem(e,r),!0}catch(i){Oi=!1,t.throwInternal(We.WARNING,Be.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+Nt(i),{exception:gt(i)})}return!1}c(Kg,"vn");function Qg(t,e){var r=rh();if(r!==null)try{return r.removeItem(e),!0}catch(n){Oi=!1,t.throwInternal(We.WARNING,Be.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+Nt(n),{exception:gt(n)})}return!1}c(Qg,"hn");function ba(){return Ui===void 0&&(Ui=!!vl(Co.SessionStorage)),Ui}c(ba,"Pt");function Wb(){var t=[];return ba()&&ur(Dr("sessionStorage"),function(e){t.push(e)}),t}c(Wb,"Oa");function wl(t,e){var r=nh();if(r!==null)try{return r.getItem(e)}catch(n){Ui=!1,t.throwInternal(We.WARNING,Be.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+Nt(n),{exception:gt(n)})}return null}c(wl,"Yt");function yl(t,e,r){var n=nh();if(n!==null)try{return n.setItem(e,r),!0}catch(i){Ui=!1,t.throwInternal(We.WARNING,Be.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+Nt(i),{exception:gt(i)})}return!1}c(yl,"er");function Zg(t,e){var r=nh();if(r!==null)try{return r.removeItem(e),!0}catch(n){Ui=!1,t.throwInternal(We.WARNING,Be.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+Nt(n),{exception:gt(n)})}return!1}c(Zg,"xn");var Oi,Ui,Xg=Ne(()=>{xt(),jg(),Oi=void 0,Ui=void 0});function Es(t){var e=sh,r=tm,n=r[e];return ah.createElement?r[e]||(n=r[e]=ah.createElement("a")):n={host:em(t,!0)},n.href=t,e++,e>=r.length&&(e=0),sh=e,n}c(Es,"gr");function Yg(t){var e,r=Es(t);return r&&(e=r.href),e}c(Yg,"yn");function zb(t){var e,r=Es(t);return r&&(e=r.pathname),e}c(zb,"Ha");function Jg(t,e){return t?t.toUpperCase()+" "+e:e}c(Jg,"Sn");function em(t,e){var r=oh(t,e)||"";if(r){var n=r.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n.length>3&&yt(n[2])&&n[2].length>0)return n[2]+(n[3]||"")}return r}c(em,"mi");function oh(t,e){var r=null;if(t){var n=t.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n.length>2&&yt(n[2])&&n[2].length>0&&(r=n[2]||"",e&&n.length>2)){var i=(n[1]||"").toLowerCase(),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),r+=o}}return r}c(oh,"Cn");var ah,sh,tm,rm=Ne(()=>{xt(),ah=qn()||{},sh=0,tm=[null,null,null,null,null]});function bl(t){return nm.indexOf(t.toLowerCase())!==-1}c(bl,"Lr");function qb(t,e,r,n){var i,o=n,a=n;if(e&&e.length>0){var s=Es(e);if(i=s.host,!o)if(s.pathname!=null){var l=s.pathname.length===0?"/":s.pathname;l.charAt(0)!=="/"&&(l="/"+l),a=s.pathname,o=Ur(t,r?r+" "+l:l)}else o=Ur(t,e)}else i=n,o=n;return{target:i,name:o,data:a}}c(qb,"Ss");function Rs(){var t=mi();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return sn()}c(Rs,"vr");function Hr(t,e){var r=null;return t!==0&&e!==0&&!ze(t)&&!ze(e)&&(r=e-t),r}c(Hr,"he");var nm,ch,im,Hi,om,am=Ne(()=>{xt(),Lg(),Rn(),Wg(),pl(),An(),Xg(),rm(),nm=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],ch={NotSpecified:ln,createDomEvent:wa,disableStorage:Vg,isInternalApplicationInsightsEndpoint:bl,canUseLocalStorage:ih,getStorage:Gg,setStorage:Kg,removeStorage:Qg,canUseSessionStorage:ba,getSessionStorageKeys:Wb,getSessionStorage:wl,setSessionStorage:yl,removeSessionStorage:Zg,disableCookies:Dg,canUseCookies:Pb,disallowsSameSiteNone:xg,setCookie:Mb,stringToBoolOrDefault:$t,getCookie:Nb,deleteCookie:Lb,trim:xr,newId:hl,random32:function(){return _o(!0)},generateW3CId:Vn,isArray:gi,isError:Kc,isDate:cd,toISOStringForIE8:Li,getIEVersion:wd,msToTimeSpan:yi,isCrossOriginError:qg,dump:gt,getExceptionName:Nt,addEventHandler:fs,IsBeaconApiSupported:eh,getExtension:zg},im={parseUrl:Es,getAbsoluteUrl:Yg,getPathName:zb,getCompleteUrl:Jg,parseHost:em,parseFullHost:oh},Hi={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(t,e,r){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t.correlationHeaderExcludePatterns){for(var n=0;n<t.correlationHeaderExcludePatterns.length;n++)if(t.correlationHeaderExcludePatterns[n].test(e))return!1}var i=Es(e).host.toLowerCase();if(i&&(i.indexOf(":443")!==-1||i.indexOf(":80")!==-1)&&(i=(oh(e,!0)||"").toLowerCase()),(!t||!t.enableCorsCorrelation)&&i&&i!==r)return!1;var o=t&&t.correlationHeaderDomains;if(o){var a;if(bt(o,function(u){var d=new RegExp(u.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(i)}),!a)return!1}var s=t&&t.correlationHeaderExcludedDomains;if(!s||s.length===0)return!0;for(var n=0;n<s.length;n++){var l=new RegExp(s[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(l.test(i))return!1}return i&&i.length>0},getCorrelationContext:function(t){if(t){var e=Hi.getCorrelationContextValue(t,zt.requestContextTargetKey);if(e&&e!==Hi.correlationIdPrefix)return e}},getCorrelationContextValue:function(t,e){if(t)for(var r=t.split(","),n=0;n<r.length;++n){var i=r[n].split("=");if(i.length===2&&i[0]===e)return i[1]}}},om={Now:Rs,GetDuration:Hr}});function sm(t){if(!t)return{};var e=t.split(cm),r=Wp(e,function(i,o){var a=o.split(lm);if(a.length===2){var s=a[0].toLowerCase(),l=a[1];i[s]=l}return i},{});if(mo(r).length>0){if(r.endpointsuffix){var n=r.location?r.location+".":"";r.ingestionendpoint=r.ingestionendpoint||"https://"+n+"dc."+r.endpointsuffix}r.ingestionendpoint=r.ingestionendpoint||th}return r}c(sm,"gi");var cm,lm,um,jb=Ne(()=>{An(),xt(),cm=";",lm="=",um={parse:sm}}),lh,dm=Ne(()=>{lh=function(){function t(){}return c(t,"t"),t}()}),uh,hm=Ne(()=>{Ut(),dm(),uh=function(t){Lt(e,t);function e(){return t.call(this)||this}return c(e,"e"),e}(lh)}),fm,Vb=Ne(()=>{fm=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return c(t,"t"),t}()}),dh,Gb=Ne(()=>{Ut(),Vb(),Rn(),xt(),An(),dh=function(t){Lt(e,t);function e(r,n,i){var o=t.call(this)||this;return o.name=Ur(r,i)||ln,o.data=n,o.time=Li(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1},o}return c(e,"e"),e}(fm)}),hh,pm=Ne(()=>{hh=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return c(t,"t"),t}()}),kn,Kb=Ne(()=>{Ut(),pm(),Rn(),An(),kn=function(t){Lt(e,t);function e(r,n,i,o){var a=t.call(this)||this;return a.aiDataContract={ver:1,name:1,properties:0,measurements:0},a.name=Ur(r,n)||ln,a.properties=$i(r,i),a.measurements=Bi(r,o),a}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}(hh)}),gm,Qb=Ne(()=>{gm=function(){function t(){}return c(t,"t"),t}()}),mm,Zb=Ne(()=>{mm=function(){function t(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}}return c(t,"t"),t}()}),vm,Xb=Ne(()=>{vm=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return c(t,"t"),t}()});function fh(t,e){var r=t;return r&&!yt(r)&&(JSON&&JSON.stringify?(r=JSON.stringify(t),e&&(!r||r==="{}")&&(It(t.toString)?r=t.toString():r=""+t)):r=""+t+" - (Missing JSON.stringify)"),r||""}c(fh,"Za");function wm(t,e){var r=t;return t&&(r=t[Sl]||t[mh]||"",r&&!yt(r)&&(r=fh(r,!0)),t.filename&&(r=r+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(r||"").indexOf(e)===-1&&(r=e+": "+r),r||""}c(wm,"Ms");function Yb(t){return go(t)?"hasFullStack"in t&&"typeName"in t:!1}c(Yb,"pl");function Jb(t){return go(t)?"ver"in t&&"exceptions"in t&&"properties"in t:!1}c(Jb,"dl");function ym(t){return t&&t.src&&yt(t.src)&&t.obj&&gi(t.obj)}c(ym,"Ls");function _a(t){var e=t||"";yt(e)||(yt(e[Jr])?e=e[Jr]:e=""+e);var r=e.split(`
`);return{src:e,obj:r}}c(_a,"_r");function e_(t){for(var e=[],r=t.split(`
`),n=0;n<r.length;n++){var i=r[n];r[n+1]&&(i+="@"+r[n+1],n++),e.push(i)}return{src:t,obj:e}}c(e_,"ml");function bm(t){var e=null;if(t)try{if(t[Jr])e=_a(t[Jr]);else if(t[Eo]&&t[Eo][Jr])e=_a(t[Eo][Jr]);else if(t.exception&&t.exception[Jr])e=_a(t.exception[Jr]);else if(ym(t))e=t;else if(ym(t[xl]))e=t[xl];else if(window.opera&&t[Sl])e=e_(t.message);else if(yt(t))e=_a(t);else{var r=t[Sl]||t[mh]||"";yt(t[gh])&&(r&&(r+=`
`),r+=" from "+t[gh]),r&&(e=_a(r))}}catch(n){e=_a(n)}return e||{src:"",obj:null}}c(bm,"Us");function t_(t){var e="";return t&&(t.obj?bt(t.obj,function(r){e+=r+`
`}):e=t.src||""),e}c(t_,"gl");function r_(t){var e,r=t.obj;if(r&&r.length>0){e=[];var n=0,i=0;bt(r,function(_){var b=_.toString();if(Cl.regex.test(b)){var y=new Cl(b,n++);i+=y.sizeInBytes,e.push(y)}});var o=32*1024;if(i>o)for(var a=0,s=e.length-1,l=0,u=a,d=s;a<s;){var f=e[a].sizeInBytes,p=e[s].sizeInBytes;if(l+=f+p,l>o){var g=d-u+1;e.splice(u,g);break}u=a,d=s,a++,s--}}return e}c(r_,"vl");function _l(t){var e="";if(t&&(e=t.typeName||t.name||"",!e))try{var r=/function (.{1,200})\(/,n=r.exec(t.constructor.toString());e=n&&n.length>1?n[1]:""}catch(i){}return e}c(_l,"hi");function ph(t){if(t)try{if(!yt(t)){var e=_l(t),r=fh(t,!1);return(!r||r==="{}")&&(t[Eo]&&(t=t[Eo],e=_l(t)),r=fh(t,!0)),r.indexOf(e)!==0&&e!=="String"?e+":"+r:r}}catch(n){}return""+(t||"")}c(ph,"$a");var _m,Eo,Jr,xl,gh,Sl,mh,Wr,vh,Cl,n_=Ne(()=>{Ut(),Qb(),Zb(),Xb(),Rn(),xt(),An(),_m="<no_method>",Eo="error",Jr="stack",xl="stackDetails",gh="errorSrc",Sl="message",mh="description",Wr=function(t){Lt(e,t);function e(r,n,i,o,a,s){var l=t.call(this)||this;return l.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},Jb(n)?(l.exceptions=n.exceptions,l.properties=n.properties,l.measurements=n.measurements,n.severityLevel&&(l.severityLevel=n.severityLevel),n.id&&(l.id=n.id),n.problemGroup&&(l.problemGroup=n.problemGroup),l.ver=2,ze(n.isManual)||(l.isManual=n.isManual)):(i||(i={}),l.exceptions=[new vh(r,n,i)],l.properties=$i(r,i),l.measurements=Bi(r,o),a&&(l.severityLevel=a),s&&(l.id=s)),l}return c(e,"e"),e.CreateAutoException=function(r,n,i,o,a,s,l,u){var d=_l(a||s||r);return{message:wm(r,d),url:n,lineNumber:i,columnNumber:o,error:ph(a||s||r),evt:ph(s||r),typeName:d,stackDetails:bm(l||a||s),errorSrc:u}},e.CreateFromInterface=function(r,n,i,o){var a=n.exceptions&&gs(n.exceptions,function(l){return vh.CreateFromInterface(r,l)}),s=new e(r,oa({},n,{exceptions:a}),i,o);return s},e.prototype.toInterface=function(){var r=this,n=r.exceptions,i=r.properties,o=r.measurements,a=r.severityLevel,s=r.ver,l=r.problemGroup,u=r.id,d=r.isManual,f=n instanceof Array&&gs(n,function(p){return p.toInterface()})||void 0;return{ver:"4.0",exceptions:f,severityLevel:a,properties:i,measurements:o,problemGroup:l,id:u,isManual:d}},e.CreateSimpleException=function(r,n,i,o,a,s){return{exceptions:[{hasFullStack:!0,message:r,stack:a,typeName:n}]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=ph,e}(mm),vh=function(t){Lt(e,t);function e(r,n,i){var o=t.call(this)||this;if(o.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},Yb(n))o.typeName=n.typeName,o.message=n.message,o[Jr]=n[Jr],o.parsedStack=n.parsedStack,o.hasFullStack=n.hasFullStack;else{var a=n,s=a&&a.evt;Kc(a)||(a=a[Eo]||s||a),o.typeName=Ur(r,_l(a))||ln,o.message=Yd(r,wm(n||a,o.typeName))||ln;var l=n[xl]||bm(n);o.parsedStack=r_(l),o[Jr]=Bg(r,t_(l)),o.hasFullStack=gi(o.parsedStack)&&o.parsedStack.length>0,i&&(i.typeName=i.typeName||o.typeName)}return o}return c(e,"e"),e.prototype.toInterface=function(){var r=this.parsedStack instanceof Array&&gs(this.parsedStack,function(i){return i.toInterface()}),n={id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this[Jr],parsedStack:r||void 0};return n},e.CreateFromInterface=function(r,n){var i=n.parsedStack instanceof Array&&gs(n.parsedStack,function(a){return Cl.CreateFromInterface(a)})||n.parsedStack,o=new e(r,oa({},n,{parsedStack:i}));return o},e}(vm),Cl=function(t){Lt(e,t);function e(r,n){var i=t.call(this)||this;if(i.sizeInBytes=0,i.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},typeof r=="string"){var o=r;i.level=n,i.method=_m,i.assembly=xr(o),i.fileName="",i.line=0;var a=o.match(e.regex);a&&a.length>=5&&(i.method=xr(a[2])||i.method,i.fileName=xr(a[4]),i.line=parseInt(a[5])||0)}else i.level=r.level,i.method=r.method,i.assembly=r.assembly,i.fileName=r.fileName,i.line=r.line,i.sizeInBytes=0;return i.sizeInBytes+=i.method.length,i.sizeInBytes+=i.fileName.length,i.sizeInBytes+=i.assembly.length,i.sizeInBytes+=e.baseSize,i.sizeInBytes+=i.level.toString().length,i.sizeInBytes+=i.line.toString().length,i}return c(e,"e"),e.CreateFromInterface=function(r){return new e(r,null)},e.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}(gm)}),xm,i_=Ne(()=>{xm=function(){function t(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}}return c(t,"t"),t}()}),wh,o_=Ne(()=>{(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(wh||(wh={}))}),Sm,a_=Ne(()=>{o_(),Sm=function(){function t(){this.kind=wh.Measurement}return c(t,"t"),t}()}),Cm,s_=Ne(()=>{Ut(),a_(),Cm=function(t){Lt(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},r}return c(e,"e"),e}(Sm)}),Gn,c_=Ne(()=>{Ut(),i_(),Rn(),s_(),An(),Gn=function(t){Lt(e,t);function e(r,n,i,o,a,s,l,u){var d=t.call(this)||this;d.aiDataContract={ver:1,metrics:1,properties:0};var f=new Cm;return f.count=o>0?o:void 0,f.max=isNaN(s)||s===null?void 0:s,f.min=isNaN(a)||a===null?void 0:a,f.name=Ur(r,n)||ln,f.value=i,d.metrics=[f],d.properties=$i(r,l),d.measurements=Bi(r,u),d}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}(xm)}),El,yh=Ne(()=>{Ut(),pm(),El=function(t){Lt(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return c(e,"e"),e}(hh)}),Tn,l_=Ne(()=>{Ut(),yh(),Rn(),pl(),An(),Tn=function(t){Lt(e,t);function e(r,n,i,o,a,s,l){var u=t.call(this)||this;return u.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},u.id=Og(r,l),u.url=Cs(r,i),u.name=Ur(r,n)||ln,isNaN(o)||(u.duration=yi(o)),u.properties=$i(r,a),u.measurements=Bi(r,s),u}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}(El)}),Em,u_=Ne(()=>{Em=function(){function t(){this.ver=2,this.success=!0,this.properties={},this.measurements={}}return c(t,"t"),t}()}),Kn,d_=Ne(()=>{Ut(),Rn(),am(),u_(),pl(),Kn=function(t){Lt(e,t);function e(r,n,i,o,a,s,l,u,d,f,p,g){d===void 0&&(d="Ajax");var _=t.call(this)||this;_.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},_.id=n,_.duration=yi(a),_.success=s,_.resultCode=l+"",_.type=Ur(r,d);var b=qb(r,i,u,o);return _.data=Cs(r,o)||b.data,_.target=Ur(r,b.target),f&&(_.target=_.target+" | "+f),_.name=Ur(r,b.name),_.properties=$i(r,p),_.measurements=Bi(r,g),_}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}(Em)}),Rm,h_=Ne(()=>{Rm=function(){function t(){this.ver=2,this.properties={},this.measurements={}}return c(t,"t"),t}()}),bi,f_=Ne(()=>{Ut(),h_(),Rn(),An(),bi=function(t){Lt(e,t);function e(r,n,i,o,a){var s=t.call(this)||this;return s.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},n=n||ln,s.message=Yd(r,n),s.properties=$i(r,o),s.measurements=Bi(r,a),i&&(s.severityLevel=i),s}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}(Rm)}),Am,p_=Ne(()=>{Ut(),yh(),Am=function(t){Lt(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return c(e,"e"),e}(El)}),_i,g_=Ne(()=>{Ut(),p_(),Rn(),An(),_i=function(t){Lt(e,t);function e(r,n,i,o,a,s,l){var u=t.call(this)||this;return u.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},u.url=Cs(r,i),u.name=Ur(r,n)||ln,u.properties=$i(r,a),u.measurements=Bi(r,s),l&&(u.domProcessing=l.domProcessing,u.duration=l.duration,u.networkConnect=l.networkConnect,u.perfTotal=l.perfTotal,u.receivedResponse=l.receivedResponse,u.sentRequest=l.sentRequest),u}return c(e,"e"),e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}(Am)}),xi,m_=Ne(()=>{Ut(),hm(),xi=function(t){Lt(e,t);function e(r,n){var i=t.call(this)||this;return i.aiDataContract={baseType:1,baseData:1},i.baseType=r,i.baseData=n,i}return c(e,"e"),e}(uh)}),As,v_=Ne(()=>{(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(As||(As={}))}),Im,w_=Ne(()=>{xt(),Im=function(){function t(){}return c(t,"t"),t.getConfig=function(e,r,n,i){i===void 0&&(i=!1);var o;return n&&e.extensionConfig&&e.extensionConfig[n]&&!ze(e.extensionConfig[n][r])?o=e.extensionConfig[n][r]:o=e[r],ze(o)?i:o},t}()});function Wi(t){var e="ai."+t+".";return function(r){return e+r}}c(Wi,"tr");var xa,or,Is,Ro,Rl,Si,zi,Sa,Al,km=Ne(()=>{Ut(),xt(),xa=Wi("application"),or=Wi("device"),Is=Wi("location"),Ro=Wi("operation"),Rl=Wi("session"),Si=Wi("user"),zi=Wi("cloud"),Sa=Wi("internal"),Al=function(t){Lt(e,t);function e(){return t.call(this)||this}return c(e,"e"),e}(fb({applicationVersion:xa("ver"),applicationBuild:xa("build"),applicationTypeId:xa("typeId"),applicationId:xa("applicationId"),applicationLayer:xa("layer"),deviceId:or("id"),deviceIp:or("ip"),deviceLanguage:or("language"),deviceLocale:or("locale"),deviceModel:or("model"),deviceFriendlyName:or("friendlyName"),deviceNetwork:or("network"),deviceNetworkName:or("networkName"),deviceOEMName:or("oemName"),deviceOS:or("os"),deviceOSVersion:or("osVersion"),deviceRoleInstance:or("roleInstance"),deviceRoleName:or("roleName"),deviceScreenResolution:or("screenResolution"),deviceType:or("type"),deviceMachineName:or("machineName"),deviceVMName:or("vmName"),deviceBrowser:or("browser"),deviceBrowserVersion:or("browserVersion"),locationIp:Is("ip"),locationCountry:Is("country"),locationProvince:Is("province"),locationCity:Is("city"),operationId:Ro("id"),operationName:Ro("name"),operationParentId:Ro("parentId"),operationRootId:Ro("rootId"),operationSyntheticSource:Ro("syntheticSource"),operationCorrelationVector:Ro("correlationVector"),sessionId:Rl("id"),sessionIsFirst:Rl("isFirst"),sessionIsNew:Rl("isNew"),userAccountAcquisitionDate:Si("accountAcquisitionDate"),userAccountId:Si("accountId"),userAgent:Si("userAgent"),userId:Si("id"),userStoreRegion:Si("storeRegion"),userAuthUserId:Si("authUserId"),userAnonymousUserAcquisitionDate:Si("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:Si("authUserAcquisitionDate"),cloudName:zi("name"),cloudRole:zi("role"),cloudRoleVer:zi("roleVer"),cloudRoleInstance:zi("roleInstance"),cloudEnvironment:zi("environment"),cloudLocation:zi("location"),cloudDeploymentUnit:zi("deploymentUnit"),internalNodeName:Sa("nodeName"),internalSdkVersion:Sa("sdkVersion"),internalAgentVersion:Sa("agentVersion"),internalSnippet:Sa("snippet"),internalSdkSrc:Sa("sdkSrc")}))}),Qn,y_=Ne(()=>{Rn(),xt(),An(),Qn=function(){function t(){}return c(t,"t"),t.create=function(e,r,n,i,o,a){if(n=Ur(i,n)||ln,ze(e)||ze(r)||ze(n))throw Error("Input doesn't contain all required fields");var s={name:n,time:Li(new Date),iKey:"",ext:a||{},tags:[],data:{},baseType:r,baseData:e};return ze(o)||ur(o,function(l,u){s.data[l]=u}),s},t}()}),zr,Ht,b_=Ne(()=>{km(),zr={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},Ht=new Al}),Ca,Il,bh,dr=Ne(()=>{am(),jb(),Lg(),An(),hm(),dm(),Gb(),Kb(),n_(),c_(),l_(),yh(),d_(),f_(),g_(),m_(),v_(),w_(),km(),Rn(),y_(),b_(),jg(),pl(),Wg(),Xg(),rm(),Ca="AppInsightsPropertiesPlugin",Il="AppInsightsChannelPlugin",bh="ApplicationInsightsAnalytics"}),Tm,__=Ne(()=>{dr(),xt(),vr(),Tm=function(){function t(e,r,n,i){ir(t,this,function(o){var a=null,s=[],l=!1,u;n&&(u=n.logger);function d(){n&&bt(n.getTransmissionControls(),function(p){bt(p,function(g){return g.flush(!0)})})}c(d,"l");function f(p){s.push(p),a||(a=setInterval(function(){var g=s.slice(0),_=!1;s=[],bt(g,function(b){b()?_=!0:s.push(b)}),s.length===0&&(clearInterval(a),a=null),_&&d()},100))}c(f,"f"),o.trackPageView=function(p,g){var _=p.name;if(ze(_)||typeof _!="string"){var b=qn();_=p.name=b&&b.title||""}var y=p.uri;if(ze(y)||typeof y!="string"){var x=vo();y=p.uri=x&&x.href||""}if(!i.isPerformanceTimingSupported()){e.sendPageViewInternal(p,g),d(),u.throwInternal(We.WARNING,Be.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var C=!1,k,T=i.getPerformanceTiming().navigationStart;T>0&&(k=Hr(T,+new Date),i.shouldCollectDuration(k)||(k=void 0));var O;!ze(g)&&!ze(g.duration)&&(O=g.duration),(r||!isNaN(O))&&(isNaN(O)&&(g||(g={}),g.duration=k),e.sendPageViewInternal(p,g),d(),C=!0);var ne=6e4;g||(g={}),f(function(){var ae=!1;try{if(i.isPerformanceTimingDataReady()){ae=!0;var Y={name:_,uri:y};i.populatePageViewPerformanceEvent(Y),!Y.isValid&&!C?(g.duration=k,e.sendPageViewInternal(p,g)):(C||(g.duration=Y.durationMs,e.sendPageViewInternal(p,g)),l||(e.sendPageViewPerformanceInternal(Y,g),l=!0))}else T>0&&Hr(T,+new Date)>ne&&(ae=!0,C||(g.duration=ne,e.sendPageViewInternal(p,g)))}catch(me){u.throwInternal(We.CRITICAL,Be.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+Nt(me),{exception:gt(me)})}return ae})}})}return c(t,"t"),t}()}),Dm,Fm,x_=Ne(()=>{dr(),xt(),Dm=function(){function t(e,r){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=r,this._logger=e}return c(t,"t"),t.prototype.trackPreviousPageVisit=function(e,r){try{var n=this.restartPageVisitTimer(e,r);n&&this.pageVisitTimeTrackingHandler(n.pageName,n.pageUrl,n.pageVisitTime)}catch(i){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+gt(i))}},t.prototype.restartPageVisitTimer=function(e,r){try{var n=this.stopPageVisitTimer();return this.startPageVisitTimer(e,r),n}catch(i){return this._logger.warnToConsole("Call to restart failed: "+gt(i)),null}},t.prototype.startPageVisitTimer=function(e,r){try{if(ba()){wl(this._logger,this.prevPageVisitDataKeyName)!=null&&zn("Cannot call startPageVisit consecutively without first calling stopPageVisit");var n=new Fm(e,r),i=En().stringify(n);yl(this._logger,this.prevPageVisitDataKeyName,i)}}catch(o){this._logger.warnToConsole("Call to start failed: "+gt(o))}},t.prototype.stopPageVisitTimer=function(){try{if(ba()){var e=sn(),r=wl(this._logger,this.prevPageVisitDataKeyName);if(r&&la()){var n=En().parse(r);return n.pageVisitTime=e-n.pageVisitStartTime,Zg(this._logger,this.prevPageVisitDataKeyName),n}else return null}return null}catch(i){return this._logger.warnToConsole("Stop page visit timer failed: "+gt(i)),null}},t}(),Fm=function(){function t(e,r){this.pageVisitStartTime=sn(),this.pageName=e,this.pageUrl=r}return c(t,"t"),t}()}),Pm,S_=Ne(()=>{dr(),xt(),Pm=function(){function t(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return c(t,"t"),t.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var r=this.getPerformanceNavigationTiming(),n=this.getPerformanceTiming(),i=0,o=0,a=0,s=0,l=0;(r||n)&&(r?(i=r.duration,o=r.startTime===0?r.connectEnd:Hr(r.startTime,r.connectEnd),a=Hr(r.requestStart,r.responseStart),s=Hr(r.responseStart,r.responseEnd),l=Hr(r.responseEnd,r.loadEventEnd)):(i=Hr(n.navigationStart,n.loadEventEnd),o=Hr(n.navigationStart,n.connectEnd),a=Hr(n.requestStart,n.responseStart),s=Hr(n.responseStart,n.responseEnd),l=Hr(n.responseEnd,n.loadEventEnd)),i===0?this._logger.throwInternal(We.WARNING,Be.ErrorPVCalc,"error calculating page view performance.",{total:i,network:o,request:a,response:s,dom:l}):this.shouldCollectDuration(i,o,a,s,l)?i<Math.floor(o)+Math.floor(a)+Math.floor(s)+Math.floor(l)?this._logger.throwInternal(We.WARNING,Be.ClientPerformanceMathError,"client performance math error.",{total:i,network:o,request:a,response:s,dom:l}):(e.durationMs=i,e.perfTotal=e.duration=yi(i),e.networkConnect=yi(o),e.sentRequest=yi(a),e.receivedResponse=yi(s),e.domProcessing=yi(l),e.isValid=!0):this._logger.throwInternal(We.WARNING,Be.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:i,network:o,request:a,response:s,dom:l}))},t.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?mi().timing:null},t.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?mi().getEntriesByType("navigation")[0]:null},t.prototype.isPerformanceNavigationTimingSupported=function(){var e=mi();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},t.prototype.isPerformanceTimingSupported=function(){var e=mi();return e&&e.timing},t.prototype.isPerformanceTimingDataReady=function(){var e=mi(),r=e?e.timing:0;return r&&r.domainLookupStart>0&&r.navigationStart>0&&r.responseStart>0&&r.requestStart>0&&r.loadEventEnd>0&&r.responseEnd>0&&r.connectEnd>0&&r.domLoading>0},t.prototype.shouldCollectDuration=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=jn()||{},i=["googlebot","adsbot-google","apis-google","mediapartners-google"],o=n.userAgent,a=!1;if(o)for(var s=0;s<i.length;s++)a=a||o.toLowerCase().indexOf(i[s])!==-1;if(a)return!1;for(var s=0;s<e.length;s++)if(e[s]<0||e[s]>=this.MAX_DURATION_ALLOWED)return!1;return!0},t}()});function ks(t,e){t&&t.dispatchEvent&&e&&t.dispatchEvent(e)}c(ks,"Dn");var _h,kl,xh,Sh,C_=Ne(()=>{Ut(),dr(),xt(),__(),x_(),S_(),vr(),_h="duration",kl="event",xh=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.identifier=bh,r.priority=180,r.autoRoutePVDelay=500;var n,i,o,a=0,s,l;return ir(e,r,function(u,d){var f=vo(!0);s=f&&f.href||"",u.getCookieMgr=function(){return Dd(u.core)},u.processTelemetry=function(y,x){da(u.core,function(){return u.identifier+":processTelemetry"},function(){var C=!1,k=u._telemetryInitializers.length;x=u._getTelCtx(x);for(var T=0;T<k;++T){var O=u._telemetryInitializers[T];if(O)try{if(O.apply(null,[y])===!1){C=!0;break}}catch(ne){x.diagLog().throwInternal(We.CRITICAL,Be.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Nt(ne),{exception:gt(ne)},!0)}}C||u.processNext(y,x)},function(){return{item:y}},!y.sync)},u.trackEvent=function(y,x){try{var C=Qn.create(y,kn.dataType,kn.envelopeType,u.diagLog(),x);u.core.track(C)}catch(k){u.diagLog().throwInternal(We.WARNING,Be.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Nt(k),{exception:gt(k)})}},u.startTrackEvent=function(y){try{n.start(y)}catch(x){u.diagLog().throwInternal(We.CRITICAL,Be.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+Nt(x),{exception:gt(x)})}},u.stopTrackEvent=function(y,x,C){try{n.stop(y,void 0,x)}catch(k){u.diagLog().throwInternal(We.CRITICAL,Be.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+Nt(k),{exception:gt(k)})}},u.trackTrace=function(y,x){try{var C=Qn.create(y,bi.dataType,bi.envelopeType,u.diagLog(),x);u.core.track(C)}catch(k){u.diagLog().throwInternal(We.WARNING,Be.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Nt(k),{exception:gt(k)})}},u.trackMetric=function(y,x){try{var C=Qn.create(y,Gn.dataType,Gn.envelopeType,u.diagLog(),x);u.core.track(C)}catch(k){u.diagLog().throwInternal(We.CRITICAL,Be.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+Nt(k),{exception:gt(k)})}},u.trackPageView=function(y,x){try{var C=y||{};u._pageViewManager.trackPageView(C,oa({},C.properties,C.measurements,x)),u.config.autoTrackPageVisitTime&&u._pageVisitTimeManager.trackPreviousPageVisit(C.name,C.uri)}catch(k){u.diagLog().throwInternal(We.CRITICAL,Be.TrackPVFailed,"trackPageView failed, page view will not be collected: "+Nt(k),{exception:gt(k)})}},u.sendPageViewInternal=function(y,x,C){var k=qn();k&&(y.refUri=y.refUri===void 0?k.referrer:y.refUri);var T=Qn.create(y,Tn.dataType,Tn.envelopeType,u.diagLog(),x,C);u.core.track(T),a=0},u.sendPageViewPerformanceInternal=function(y,x,C){var k=Qn.create(y,_i.dataType,_i.envelopeType,u.diagLog(),x,C);u.core.track(k)},u.trackPageViewPerformance=function(y,x){try{u._pageViewPerformanceManager.populatePageViewPerformanceEvent(y),u.sendPageViewPerformanceInternal(y,x)}catch(C){u.diagLog().throwInternal(We.CRITICAL,Be.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+Nt(C),{exception:gt(C)})}},u.startTrackPage=function(y){try{if(typeof y!="string"){var x=qn();y=x&&x.title||""}i.start(y)}catch(C){u.diagLog().throwInternal(We.CRITICAL,Be.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+Nt(C),{exception:gt(C)})}},u.stopTrackPage=function(y,x,C,k){try{if(typeof y!="string"){var T=qn();y=T&&T.title||""}if(typeof x!="string"){var O=vo();x=O&&O.href||""}i.stop(y,x,C,k),u.config.autoTrackPageVisitTime&&u._pageVisitTimeManager.trackPreviousPageVisit(y,x)}catch(ne){u.diagLog().throwInternal(We.CRITICAL,Be.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+Nt(ne),{exception:gt(ne)})}},u.sendExceptionInternal=function(y,x,C){var k=y.exception||y.error||new Error(ln),T=new Wr(u.diagLog(),k,y.properties||x,y.measurements,y.severityLevel,y.id).toInterface(),O=Qn.create(T,Wr.dataType,Wr.envelopeType,u.diagLog(),x,C);u.core.track(O)},u.trackException=function(y,x){try{u.sendExceptionInternal(y,x)}catch(C){u.diagLog().throwInternal(We.CRITICAL,Be.TrackExceptionFailed,"trackException failed, exception will not be collected: "+Nt(C),{exception:gt(C)})}},u._onerror=function(y){var x=y&&y.error,C=y&&y.evt;try{if(!C){var k=ms();k&&(C=k[kl])}var T=y&&y.url||(qn()||{}).URL,O=y.errorSrc||"window.onerror@"+T+":"+(y.lineNumber||0)+":"+(y.columnNumber||0),ne={errorSrc:O,url:T,lineNumber:y.lineNumber||0,columnNumber:y.columnNumber||0,message:y.message};qg(y.message,y.url,y.lineNumber,y.columnNumber,y.error)?b(Wr.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",T,y.lineNumber||0,y.columnNumber||0,x,C,null,O),ne):(y.errorSrc||(y.errorSrc=O),u.trackException({exception:y,severityLevel:As.Error},ne))}catch(Y){var ae=x?x.name+", "+x.message:"null";u.diagLog().throwInternal(We.CRITICAL,Be.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+Nt(Y),{exception:gt(Y),errorString:ae})}},u.addTelemetryInitializer=function(y){u._telemetryInitializers.push(y)},u.initialize=function(y,x,C,k){if(!u.isInitialized()){if(ze(x))throw Error("Error initializing");d.initialize(y,x,C,k),u.setInitialized(!1);var T=u._getTelCtx(),O=u.identifier;u.config=T.getExtCfg(O);var ne=e.getDefaultConfig(y);ne!==void 0&&ur(ne,function($e,et){u.config[$e]=T.getConfig(O,$e,et),u.config[$e]===void 0&&(u.config[$e]=et)}),u.config.isStorageUseDisabled&&Vg();var ae={instrumentationKey:function(){return y.instrumentationKey},accountId:function(){return u.config.accountId||y.accountId},sessionRenewalMs:function(){return u.config.sessionRenewalMs||y.sessionRenewalMs},sessionExpirationMs:function(){return u.config.sessionExpirationMs||y.sessionExpirationMs},sampleRate:function(){return u.config.samplingPercentage||y.samplingPercentage},sdkExtension:function(){return u.config.sdkExtension||y.sdkExtension},isBrowserLinkTrackingEnabled:function(){return u.config.isBrowserLinkTrackingEnabled||y.isBrowserLinkTrackingEnabled},appId:function(){return u.config.appId||y.appId}};u._pageViewPerformanceManager=new Pm(u.core),u._pageViewManager=new Tm(r,u.config.overridePageViewDuration,u.core,u._pageViewPerformanceManager),u._pageVisitTimeManager=new Dm(u.diagLog(),function($e,et,it){return p($e,et,it)}),u._telemetryInitializers=u._telemetryInitializers||[],g(ae),n=new Sh(u.diagLog(),"trackEvent"),n.action=function($e,et,it,ht){ht||(ht={}),ht[_h]=it.toString(),u.trackEvent({name:$e,properties:ht})},i=new Sh(u.diagLog(),"trackPageView"),i.action=function($e,et,it,ht,St){ze(ht)&&(ht={}),ht[_h]=it.toString();var Bt={name:$e,uri:et,properties:ht,measurements:St};u.sendPageViewInternal(Bt,ht)};var Y=ms(),me=wb(),ce=vo(!0),pe=r;if(u.config.disableExceptionTracking===!1&&!u.config.autoExceptionInstrumented&&Y){var Ae="onerror",Ye=Y[Ae];Y.onerror=function($e,et,it,ht,St){var Bt=Y[kl],vn=Ye&&Ye($e,et,it,ht,St);return vn!==!0&&pe._onerror(Wr.CreateAutoException($e,et,it,ht,St,Bt)),vn},u.config.autoExceptionInstrumented=!0}if(u.config.disableExceptionTracking===!1&&u.config.enableUnhandledPromiseRejectionTracking===!0&&!u.config.autoUnhandledPromiseInstrumented&&Y){var ue="onunhandledrejection",Ie=Y[ue];Y[ue]=function($e){var et=Y[kl],it=Ie&&Ie.call(Y,$e);return it!==!0&&pe._onerror(Wr.CreateAutoException($e.reason.toString(),ce?ce.href:"",0,0,$e,et)),it},u.config.autoUnhandledPromiseInstrumented=!0}if(u.config.enableAutoRouteTracking===!0&&me&&It(me.pushState)&&It(me.replaceState)&&Y&&typeof Event!="undefined"){var Oe=r;bt(C,function($e){$e.identifier===Ca&&(o=$e)}),me.pushState=function($e){return function(){var et=$e.apply(this,arguments);return ks(Y,wa(Oe.config.namePrefix+"pushState")),ks(Y,wa(Oe.config.namePrefix+"locationchange")),et}}(me.pushState),me.replaceState=function($e){return function(){var et=$e.apply(this,arguments);return ks(Y,wa(Oe.config.namePrefix+"replaceState")),ks(Y,wa(Oe.config.namePrefix+"locationchange")),et}}(me.replaceState),Y.addEventListener&&(Y.addEventListener(Oe.config.namePrefix+"popstate",function(){ks(Y,wa(Oe.config.namePrefix+"locationchange"))}),Y.addEventListener(Oe.config.namePrefix+"locationchange",function(){if(o&&o.context&&o.context.telemetryTrace){o.context.telemetryTrace.traceID=Vn();var $e="_unknown_";ce&&ce.pathname&&($e=ce.pathname+(ce.hash||"")),o.context.telemetryTrace.name=$e}l&&(s=l),l=ce&&ce.href||"",setTimeout(function(et){Oe.trackPageView({refUri:et,properties:{duration:0}})}.bind(r,s),Oe.autoRoutePVDelay)}))}u.setInitialized(!0)}};function p(y,x,C){var k={PageName:y,PageUrl:x};u.trackMetric({name:"PageVisitTime",average:C,max:C,min:C,sampleCount:1},k)}c(p,"m");function g(y){if(!y.isBrowserLinkTrackingEnabled()){var x=["/browserLinkSignalR/","/__browserLink/"],C=c(function(k){if(k.baseType===Kn.dataType){var T=k.baseData;if(T){for(var O=0;O<x.length;O++)if(T.target&&T.target.indexOf(x[O])>=0)return!1}}return!0},"y");_(C)}}c(g,"I");function _(y){u._telemetryInitializers.push(y)}c(_,"E");function b(y,x){var C=Qn.create(y,Wr.dataType,Wr.envelopeType,u.diagLog(),x);u.core.track(C)}c(b,"b")}),r}return c(e,"e"),e.getDefaultConfig=function(r){return r||(r={}),r.sessionRenewalMs=30*60*1e3,r.sessionExpirationMs=24*60*60*1e3,r.disableExceptionTracking=$t(r.disableExceptionTracking),r.autoTrackPageVisitTime=$t(r.autoTrackPageVisitTime),r.overridePageViewDuration=$t(r.overridePageViewDuration),r.enableUnhandledPromiseRejectionTracking=$t(r.enableUnhandledPromiseRejectionTracking),(isNaN(r.samplingPercentage)||r.samplingPercentage<=0||r.samplingPercentage>=100)&&(r.samplingPercentage=100),r.isStorageUseDisabled=$t(r.isStorageUseDisabled),r.isBrowserLinkTrackingEnabled=$t(r.isBrowserLinkTrackingEnabled),r.enableAutoRouteTracking=$t(r.enableAutoRouteTracking),r.namePrefix=r.namePrefix||"",r.enableDebug=$t(r.enableDebug),r.disableFlushOnBeforeUnload=$t(r.disableFlushOnBeforeUnload),r.disableFlushOnUnload=$t(r.disableFlushOnUnload,r.disableFlushOnBeforeUnload),r},e.Version="2.6.4",e}(bo),Sh=function(){function t(e,r){var n=this,i={};n.start=function(o){typeof i[o]!="undefined"&&e.throwInternal(We.WARNING,Be.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:o,key:o},!0),i[o]=+new Date},n.stop=function(o,a,s,l){var u=i[o];if(isNaN(u))e.throwInternal(We.WARNING,Be.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:o,key:o},!0);else{var d=+new Date,f=Hr(u,d);n.action(o,a,f,s,l)}delete i[o],i[o]=void 0}}return c(t,"t"),t}()}),Nm=Ne(()=>{C_()}),Mm,Lm,E_=Ne(()=>{dr(),xt(),vr(),Mm=function(){function t(e){var r=[];ir(t,this,function(n){n.enqueue=function(i){r.push(i)},n.count=function(){return r.length},n.clear=function(){r.length=0},n.getItems=function(){return r.slice(0)},n.batchPayloads=function(i){if(i&&i.length>0){var o=e.emitLineDelimitedJson()?i.join(`
`):"["+i.join(",")+"]";return o}return null},n.markAsSent=function(i){n.clear()},n.clearSent=function(i){}})}return c(t,"t"),t}(),Lm=function(){function t(e,r){var n=!1,i;ir(t,this,function(o){var a=u(t.BUFFER_KEY),s=u(t.SENT_BUFFER_KEY);i=a.concat(s),i.length>t.MAX_BUFFER_SIZE&&(i.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,[]),d(t.BUFFER_KEY,i),o.enqueue=function(f){if(i.length>=t.MAX_BUFFER_SIZE){n||(e.throwInternal(We.WARNING,Be.SessionStorageBufferFull,"Maximum buffer size reached: "+i.length,!0),n=!0);return}i.push(f),d(t.BUFFER_KEY,i)},o.count=function(){return i.length},o.clear=function(){i=[],d(t.BUFFER_KEY,[]),d(t.SENT_BUFFER_KEY,[]),n=!1},o.getItems=function(){return i.slice(0)},o.batchPayloads=function(f){if(f&&f.length>0){var p=r.emitLineDelimitedJson()?f.join(`
`):"["+f.join(",")+"]";return p}return null},o.markAsSent=function(f){i=l(f,i),d(t.BUFFER_KEY,i);var p=u(t.SENT_BUFFER_KEY);p instanceof Array&&f instanceof Array&&(p=p.concat(f),p.length>t.MAX_BUFFER_SIZE&&(e.throwInternal(We.CRITICAL,Be.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+p.length,!0),p.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,p))},o.clearSent=function(f){var p=u(t.SENT_BUFFER_KEY);p=l(f,p),d(t.SENT_BUFFER_KEY,p)};function l(f,p){var g=[];return bt(p,function(_){!It(_)&&ps(f,_)===-1&&g.push(_)}),g}c(l,"s");function u(f){var p=f;try{p=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+p:p;var g=wl(e,p);if(g){var _=En().parse(g);if(yt(_)&&(_=En().parse(_)),_&&gi(_))return _}}catch(b){e.throwInternal(We.CRITICAL,Be.FailedToRestoreStorageBuffer," storage key: "+p+", "+Nt(b),{exception:gt(b)})}return[]}c(u,"u");function d(f,p){var g=f;try{g=r.namePrefix&&r.namePrefix()?r.namePrefix()+"_"+g:g;var _=JSON.stringify(p);yl(e,g,_)}catch(b){yl(e,g,JSON.stringify([])),e.throwInternal(We.WARNING,Be.FailedToSetStorageBuffer," storage key: "+g+", "+Nt(b)+". Buffer cleared",{exception:gt(b)})}}c(d,"l")})}return c(t,"t"),t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}()});function ar(t,e,r){return kt(t,e,r,dd)}c(ar,"Se");var Tl,Vt,hr,Ch,Yt,$m,Eh,Bm,Om,Um,Hm,Wm,R_=Ne(()=>{Ut(),dr(),xt(),Tl="baseType",Vt="baseData",hr="properties",Ch="true",Yt=function(){function t(){}return c(t,"t"),t.extractPropsAndMeasurements=function(e,r,n){ze(e)||ur(e,function(i,o){ld(o)?n[i]=o:yt(o)?r[i]=o:la()&&(r[i]=En().stringify(o))})},t.createEnvelope=function(e,r,n,i){var o=new dh(e,i,r);ar(o,"sampleRate",n[gl]),(n[Vt]||{}).startTime&&(o.time=Li(n[Vt].startTime)),o.iKey=n.iKey;var a=n.iKey.replace(/-/g,"");return o.name=o.name.replace("{0}",a),t.extractPartAExtensions(n,o),n.tags=n.tags||[],jp(o)},t.extractPartAExtensions=function(e,r){var n=r.tags=r.tags||{},i=e.ext=e.ext||{},o=e.tags=e.tags||[],a=i.user;a&&(ar(n,Ht.userAuthUserId,a.authId),ar(n,Ht.userId,a.id||a.localId));var s=i.app;s&&ar(n,Ht.sessionId,s.sesId);var l=i.device;l&&(ar(n,Ht.deviceId,l.id||l.localId),ar(n,Ht.deviceType,l.deviceClass),ar(n,Ht.deviceIp,l.ip),ar(n,Ht.deviceModel,l.model),ar(n,Ht.deviceType,l.deviceType));var u=e.ext.web;if(u){ar(n,Ht.deviceLanguage,u.browserLang),ar(n,Ht.deviceBrowserVersion,u.browserVer),ar(n,Ht.deviceBrowser,u.browser);var d=r.data=r.data||{},f=d[Vt]=d[Vt]||{},p=f[hr]=f[hr]||{};ar(p,"domain",u.domain),ar(p,"isManual",u.isManual?Ch:null),ar(p,"screenRes",u.screenRes),ar(p,"userConsent",u.userConsent?Ch:null)}var g=i.os;g&&ar(n,Ht.deviceOS,g.name);var _=i.trace;_&&(ar(n,Ht.operationParentId,_.parentID),ar(n,Ht.operationName,_.name),ar(n,Ht.operationId,_.traceID));for(var b={},y=o.length-1;y>=0;y--){var x=o[y];ur(x,function(k,T){b[k]=T}),o.splice(y,1)}ur(o,function(k,T){b[k]=T});var C=oa({},n,b);C[Ht.internalSdkVersion]||(C[Ht.internalSdkVersion]="javascript:"+t.Version),r.tags=jp(C)},t.prototype.Init=function(e,r){this._logger=e,ze(r[Vt])&&this._logger.throwInternal(We.CRITICAL,Be.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},t.Version="2.6.4",t}(),$m=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Vt].measurements||{},o=n[Vt][hr]||{};Yt.extractPropsAndMeasurements(n.data,o,i);var a=n[Vt];if(ze(a))return r.warnToConsole("Invalid input for dependency data"),null;var s=a[hr]&&a[hr][ml]?a[hr][ml]:"GET",l=new Kn(r,a.id,a.target,a.name,a.duration,a.success,a.responseCode,s,a.type,a.correlationContext,o,i),u=new xi(Kn.dataType,l);return Yt.createEnvelope(r,Kn.envelopeType,n,u)},e.DependencyEnvelopeCreator=new e,e}(Yt),Eh=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i={},o={};n[Tl]!==kn.dataType&&(i.baseTypeSource=n[Tl]),n[Tl]===kn.dataType?(i=n[Vt][hr]||{},o=n[Vt].measurements||{}):n[Vt]&&Yt.extractPropsAndMeasurements(n[Vt],i,o),Yt.extractPropsAndMeasurements(n.data,i,o);var a=n[Vt].name,s=new kn(r,a,i,o),l=new xi(kn.dataType,s);return Yt.createEnvelope(r,kn.envelopeType,n,l)},e.EventEnvelopeCreator=new e,e}(Yt),Bm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Vt].measurements||{},o=n[Vt][hr]||{};Yt.extractPropsAndMeasurements(n.data,o,i);var a=n[Vt],s=Wr.CreateFromInterface(r,a,o,i),l=new xi(Wr.dataType,s);return Yt.createEnvelope(r,Wr.envelopeType,n,l)},e.ExceptionEnvelopeCreator=new e,e}(Yt),Om=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Vt],o=i[hr]||{},a=i.measurements||{};Yt.extractPropsAndMeasurements(n.data,o,a);var s=new Gn(r,i.name,i.average,i.sampleCount,i.min,i.max,o,a),l=new xi(Gn.dataType,s);return Yt.createEnvelope(r,Gn.envelopeType,n,l)},e.MetricEnvelopeCreator=new e,e}(Yt),Um=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i="duration",o,a=n[Vt];!ze(a)&&!ze(a[hr])&&!ze(a[hr][i])?(o=a[hr][i],delete a[hr][i]):!ze(n.data)&&!ze(n.data[i])&&(o=n.data[i],delete n.data[i]);var s=n[Vt],l;((n.ext||{}).trace||{}).traceID&&(l=n.ext.trace.traceID);var u=s.id||l,d=s.name,f=s.uri,p=s[hr]||{},g=s.measurements||{};if(ze(s.refUri)||(p.refUri=s.refUri),ze(s.pageType)||(p.pageType=s.pageType),ze(s.isLoggedIn)||(p.isLoggedIn=s.isLoggedIn.toString()),!ze(s[hr])){var _=s[hr];ur(_,function(x,C){p[x]=C})}Yt.extractPropsAndMeasurements(n.data,p,g);var b=new Tn(r,d,f,o,p,g,u),y=new xi(Tn.dataType,b);return Yt.createEnvelope(r,Tn.envelopeType,n,y)},e.PageViewEnvelopeCreator=new e,e}(Yt),Hm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Vt],o=i.name,a=i.uri||i.url,s=i[hr]||{},l=i.measurements||{};Yt.extractPropsAndMeasurements(n.data,s,l);var u=new _i(r,o,a,void 0,s,l,i),d=new xi(_i.dataType,u);return Yt.createEnvelope(r,_i.envelopeType,n,d)},e.PageViewPerformanceEnvelopeCreator=new e,e}(Yt),Wm=function(t){Lt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return c(e,"e"),e.prototype.Create=function(r,n){t.prototype.Init.call(this,r,n);var i=n[Vt].message,o=n[Vt].severityLevel,a=n[Vt][hr]||{},s=n[Vt].measurements||{};Yt.extractPropsAndMeasurements(n.data,a,s);var l=new bi(r,i,o,a,s),u=new xi(bi.dataType,l);return Yt.createEnvelope(r,bi.envelopeType,n,u)},e.TraceEnvelopeCreator=new e,e}(Yt)}),zm,A_=Ne(()=>{xt(),vr(),zm=function(){function t(e){ir(t,this,function(r){r.serialize=function(a){var s=n(a,"root");try{return En().stringify(s)}catch(l){e.throwInternal(We.CRITICAL,Be.CannotSerializeObject,l&&It(l.toString)?l.toString():"Error serializing object",null,!0)}};function n(a,s){var l="__aiCircularRefCheck",u={};if(!a)return e.throwInternal(We.CRITICAL,Be.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:s},!0),u;if(a[l])return e.throwInternal(We.WARNING,Be.CircularReferenceDetected,"Circular reference detected while serializing object",{name:s},!0),u;if(!a.aiDataContract){if(s==="measurements")u=o(a,"number",s);else if(s==="properties")u=o(a,"string",s);else if(s==="tags")u=o(a,"string",s);else if(gi(a))u=i(a,s);else{e.throwInternal(We.WARNING,Be.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:s},!0);try{En().stringify(a),u=a}catch(d){e.throwInternal(We.CRITICAL,Be.CannotSerializeObject,d&&It(d.toString)?d.toString():"Error serializing object",null,!0)}}return u}return a[l]=!0,ur(a.aiDataContract,function(d,f){var p=It(f)?f()&1:f&1,g=It(f)?f()&4:f&4,_=f&2,b=a[d]!==void 0,y=go(a[d])&&a[d]!==null;if(p&&!b&&!_)e.throwInternal(We.CRITICAL,Be.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:d,name:s});else if(!g){var x=void 0;y?_?x=i(a[d],d):x=n(a[d],d):x=a[d],x!==void 0&&(u[d]=x)}}),delete a[l],u}c(n,"n");function i(a,s){var l;if(a)if(!gi(a))e.throwInternal(We.CRITICAL,Be.ItemNotInArray,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:s},!0);else{l=[];for(var u=0;u<a.length;u++){var d=a[u],f=n(d,s+"["+u+"]");l.push(f)}}return l}c(i,"i");function o(a,s,l){var u;return a&&(u={},ur(a,function(d,f){if(s==="string")f===void 0?u[d]="undefined":f===null?u[d]="null":f.toString?u[d]=f.toString():u[d]="invalid field: toString() is not defined.";else if(s==="number")if(f===void 0)u[d]="undefined";else if(f===null)u[d]="null";else{var p=parseFloat(f);isNaN(p)?u[d]="NaN":u[d]=p}else u[d]="invalid field: "+l+" is of unknown type.",e.throwInternal(We.CRITICAL,u[d],null,!0)})),u}c(o,"a")})}return c(t,"t"),t}()}),qm,Rh,I_=Ne(()=>{xt(),vr(),qm=function(){function t(){var e=ms(),r=qn(),n=!1,i=!0;ir(t,this,function(o){try{if(e&&Ss.Attach(e,"online",l)&&(Ss.Attach(e,"offline",u),n=!0),r){var a=r.body||r;Or(a.ononline)||(a.ononline=l,a.onoffline=u,n=!0)}if(n){var s=jn();s&&!ze(s.onLine)&&(i=s.onLine)}}catch(d){n=!1}o.isListening=n,o.isOnline=function(){var d=!0,f=jn();return n?d=i:f&&!ze(f.onLine)&&(d=f.onLine),d},o.isOffline=function(){return!o.isOnline()};function l(){i=!0}c(l,"s");function u(){i=!1}c(u,"u")})}return c(t,"t"),t.Offline=new t,t}(),Rh=qm.Offline}),jm,k_=Ne(()=>{jm=function(){function t(){}return c(t,"t"),t.prototype.getHashCodeScore=function(e){var r=this.getHashCode(e)/t.INT_MAX_VALUE;return r*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e.length<t.MIN_INPUT_LENGTH;)e=e.concat(e);for(var r=5381,n=0;n<e.length;++n)r=(r<<5)+r+e.charCodeAt(n),r=r&r;return Math.abs(r)},t.INT_MAX_VALUE=2147483647,t.MIN_INPUT_LENGTH=8,t}()}),Vm,T_=Ne(()=>{k_(),dr(),Vm=function(){function t(){this.hashCodeGeneragor=new jm,this.keys=new Al}return c(t,"t"),t.prototype.getSamplingScore=function(e){var r=0;return e.tags&&e.tags[this.keys.userId]?r=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?r=this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?r=this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?r=this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):r=Math.random()*100,r},t}()}),Gm,D_=Ne(()=>{T_(),dr(),xt(),Gm=function(){function t(e,r){this.INT_MAX_VALUE=2147483647,this._logger=r||rl(null),(e>100||e<0)&&(this._logger.throwInternal(We.WARNING,Be.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new Vm}return c(t,"t"),t.prototype.isSampledIn=function(e){var r=this.sampleRate,n=!1;return r==null||r>=100||e.baseType===Gn.dataType?!0:(n=this.samplingScoreGenerator.getSamplingScore(e)<r,n)},t}()});function Dl(t){try{return t.responseText}catch(e){}return null}c(Dl,"Ii");var Ah,F_=Ne(()=>{Ut(),E_(),R_(),A_(),dr(),xt(),I_(),D_(),vr(),Ah=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.priority=1001,r.identifier=Il,r._XMLHttpRequestSupported=!1;var n,i,o,a,s,l,u={};return ir(e,r,function(d,f){function p(){zn("Method not implemented.")}c(p,"m"),d.pause=p,d.resume=p,d.flush=function(){try{d.triggerSend(!0,null,1)}catch(ue){d.diagLog().throwInternal(We.CRITICAL,Be.FlushFailed,"flush failed, telemetry will not be collected: "+Nt(ue),{exception:gt(ue)})}},d.onunloadFlush=function(){if((d._senderConfig.onunloadDisableBeacon()===!1||d._senderConfig.isBeaconApiDisabled()===!1)&&eh())try{d.triggerSend(!0,y,2)}catch(ue){d.diagLog().throwInternal(We.CRITICAL,Be.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Nt(ue),{exception:gt(ue)})}else d.flush()},d.teardown=p,d.addHeader=function(ue,Ie){u[ue]=Ie},d.initialize=function(ue,Ie,Oe,$e){f.initialize(ue,Ie,Oe,$e);var et=d._getTelCtx(),it=d.identifier;s=new zm(Ie.logger),n=0,i=null,o=0,d._sender=null,l=0;var ht=e._getDefaultAppInsightsChannelConfig();if(d._senderConfig=e._getEmptyAppInsightsChannelConfig(),ur(ht,function(Re,Ue){d._senderConfig[Re]=function(){return et.getConfig(it,Re,Ue())}}),d._buffer=d._senderConfig.enableSessionStorageBuffer()&&ba()?new Lm(d.diagLog(),d._senderConfig):new Mm(d._senderConfig),d._sample=new Gm(d._senderConfig.samplingPercentage(),d.diagLog()),Ye(ue)||d.diagLog().throwInternal(We.CRITICAL,Be.InvalidInstrumentationKey,"Invalid Instrumentation key "+ue.instrumentationKey),!bl(d._senderConfig.endpointUrl())&&d._senderConfig.customHeaders()&&d._senderConfig.customHeaders().length>0&&bt(d._senderConfig.customHeaders(),function(Re){r.addHeader(Re.header,Re.value)}),!d._senderConfig.isBeaconApiDisabled()&&eh())d._sender=y;else{var St=Dr("XMLHttpRequest");if(St){var Bt=new St;"withCredentials"in Bt?(d._sender=x,d._XMLHttpRequestSupported=!0):typeof XDomainRequest!==fi&&(d._sender=me)}else{var vn=Dr("fetch");vn&&(d._sender=C)}}},d.processTelemetry=function(ue,Ie){Ie=d._getTelCtx(Ie);try{if(d._senderConfig.disableTelemetry())return;if(!ue){Ie.diagLog().throwInternal(We.CRITICAL,Be.CannotSendEmptyTelemetry,"Cannot send empty telemetry");return}if(ue.baseData&&!ue.baseType){Ie.diagLog().throwInternal(We.CRITICAL,Be.InvalidEvent,"Cannot send telemetry without baseData and baseType");return}if(ue.baseType||(ue.baseType="EventData"),!d._sender){Ie.diagLog().throwInternal(We.CRITICAL,Be.SenderNotInitialized,"Sender was not initialized");return}if(g(ue))ue[gl]=d._sample.sampleRate;else{Ie.diagLog().throwInternal(We.WARNING,Be.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:d._sample.sampleRate});return}var Oe=e.constructEnvelope(ue,d._senderConfig.instrumentationKey(),Ie.diagLog());if(!Oe){Ie.diagLog().throwInternal(We.CRITICAL,Be.CreateEnvelopeError,"Unable to create an AppInsights envelope");return}var $e=!1;if(ue.tags&&ue.tags[ya]&&(bt(ue.tags[ya],function(St){try{St&&St(Oe)===!1&&($e=!0,Ie.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(Bt){Ie.diagLog().throwInternal(We.CRITICAL,Be.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Nt(Bt),{exception:gt(Bt)},!0)}}),delete ue.tags[ya]),$e)return;var et=s.serialize(Oe),it=d._buffer.getItems(),ht=d._buffer.batchPayloads(it);ht&&ht.length+et.length>d._senderConfig.maxBatchSizeInBytes()&&d.triggerSend(!0,null,10),d._buffer.enqueue(et),ne()}catch(St){Ie.diagLog().throwInternal(We.WARNING,Be.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Nt(St),{exception:gt(St)})}d.processNext(ue,Ie)},d._xhrReadyStateChange=function(ue,Ie,Oe){ue.readyState===4&&_(ue.status,Ie,ue.responseURL,Oe,Y(ue),Dl(ue)||ue.response)},d.triggerSend=function(ue,Ie,Oe){ue===void 0&&(ue=!0);try{if(d._senderConfig.disableTelemetry())d._buffer.clear();else{if(d._buffer.count()>0){var $e=d._buffer.getItems();Ae(Oe||0,ue),Ie?Ie.call(r,$e,ue):d._sender($e,ue)}o=+new Date}clearTimeout(a),a=null,i=null}catch(it){var et=wd();(!et||et>9)&&d.diagLog().throwInternal(We.CRITICAL,Be.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+Nt(it),{exception:gt(it)})}},d._onError=function(ue,Ie,Oe){d.diagLog().throwInternal(We.WARNING,Be.OnError,"Failed to send telemetry.",{message:Ie}),d._buffer.clearSent(ue)},d._onPartialSuccess=function(ue,Ie){for(var Oe=[],$e=[],et=Ie.errors.reverse(),it=0,ht=et;it<ht.length;it++){var St=ht[it],Bt=ue.splice(St.index,1)[0];ae(St.statusCode)?$e.push(Bt):Oe.push(Bt)}ue.length>0&&d._onSuccess(ue,Ie.itemsAccepted),Oe.length>0&&d._onError(Oe,Y(null,["partial success",Ie.itemsAccepted,"of",Ie.itemsReceived].join(" "))),$e.length>0&&(T($e),d.diagLog().throwInternal(We.WARNING,Be.TransmissionFailed,"Partial success. Delivered: "+ue.length+", Failed: "+Oe.length+". Will retry to send "+$e.length+" our of "+Ie.itemsReceived+" items"))},d._onSuccess=function(ue,Ie){d._buffer.clearSent(ue)},d._xdrOnLoad=function(ue,Ie){var Oe=Dl(ue);if(ue&&(Oe+""=="200"||Oe===""))n=0,d._onSuccess(Ie,0);else{var $e=k(Oe);$e&&$e.itemsReceived&&$e.itemsReceived>$e.itemsAccepted&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(Ie,$e):d._onError(Ie,ce(ue))}};function g(ue){return d._sample.isSampledIn(ue)}c(g,"I");function _(ue,Ie,Oe,$e,et,it){var ht=null;if(d._appId||(ht=k(it),ht&&ht.appId&&(d._appId=ht.appId)),(ue<200||ue>=300)&&ue!==0){if((ue===301||ue===307||ue===308)&&!b(Oe)){d._onError(Ie,et);return}!d._senderConfig.isRetryDisabled()&&ae(ue)?(T(Ie),d.diagLog().throwInternal(We.WARNING,Be.TransmissionFailed,". Response code "+ue+". Will retry to send "+Ie.length+" items.")):d._onError(Ie,et)}else if(Rh.isOffline()){if(!d._senderConfig.isRetryDisabled()){var St=10;T(Ie,St),d.diagLog().throwInternal(We.WARNING,Be.TransmissionFailed,". Offline - Response Code: "+ue+". Offline status: "+Rh.isOffline()+". Will retry to send "+Ie.length+" items.")}}else b(Oe),ue===206?(ht||(ht=k(it)),ht&&!d._senderConfig.isRetryDisabled()?d._onPartialSuccess(Ie,ht):d._onError(Ie,et)):(n=0,d._onSuccess(Ie,$e))}c(_,"E");function b(ue){return l>=10?!1:!ze(ue)&&ue!==""&&ue!==d._senderConfig.endpointUrl()?(d._senderConfig.endpointUrl=function(){return ue},++l,!0):!1}c(b,"b");function y(ue,Ie){var Oe=d._senderConfig.endpointUrl(),$e=d._buffer.batchPayloads(ue),et=new Blob([$e],{type:"text/plain;charset=UTF-8"}),it=jn().sendBeacon(Oe,et);it?(d._buffer.markAsSent(ue),d._onSuccess(ue,ue.length)):(x(ue,!0),d.diagLog().throwInternal(We.WARNING,Be.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}c(y,"p");function x(ue,Ie){var Oe=new XMLHttpRequest,$e=d._senderConfig.endpointUrl();try{Oe[So]=!0}catch(it){}Oe.open("POST",$e,Ie),Oe.setRequestHeader("Content-type","application/json"),bl($e)&&Oe.setRequestHeader(zt.sdkContextHeader,zt.sdkContextHeaderAppIdRequest),bt(mo(u),function(it){Oe.setRequestHeader(it,u[it])}),Oe.onreadystatechange=function(){return d._xhrReadyStateChange(Oe,ue,ue.length)},Oe.onerror=function(it){return d._onError(ue,Y(Oe),it)};var et=d._buffer.batchPayloads(ue);Oe.send(et),d._buffer.markAsSent(ue)}c(x,"v");function C(ue,Ie){var Oe=d._senderConfig.endpointUrl(),$e=d._buffer.batchPayloads(ue),et=new Blob([$e],{type:"text/plain;charset=UTF-8"}),it=new Headers;bl(Oe)&&it.append(zt.sdkContextHeader,zt.sdkContextHeaderAppIdRequest),bt(mo(u),function(Bt){it.append(Bt,u[Bt])});var ht={method:"POST",headers:it,body:et},St=new Request(Oe,ht);fetch(St).then(function(Bt){if(Bt.ok)Bt.text().then(function(vn){_(Bt.status,ue,Bt.url,ue.length,Bt.statusText,vn)}),d._buffer.markAsSent(ue);else throw Error(Bt.statusText)}).catch(function(Bt){d._onError(ue,Bt.message)})}c(C,"y");function k(ue){try{if(ue&&ue!==""){var Ie=En().parse(ue);if(Ie&&Ie.itemsReceived&&Ie.itemsReceived>=Ie.itemsAccepted&&Ie.itemsReceived-Ie.itemsAccepted===Ie.errors.length)return Ie}}catch(Oe){d.diagLog().throwInternal(We.CRITICAL,Be.InvalidBackendResponse,"Cannot parse the response. "+Nt(Oe),{response:ue})}return null}c(k,"w");function T(ue,Ie){if(Ie===void 0&&(Ie=1),!(!ue||ue.length===0)){d._buffer.clearSent(ue),n++;for(var Oe=0,$e=ue;Oe<$e.length;Oe++){var et=$e[Oe];d._buffer.enqueue(et)}O(Ie),ne()}}c(T,"L");function O(ue){var Ie=10,Oe;if(n<=1)Oe=Ie;else{var $e=(Math.pow(2,n)-1)/2,et=Math.floor(Math.random()*$e*Ie)+1;et=ue*et,Oe=Math.max(Math.min(et,3600),Ie)}var it=sn()+Oe*1e3;i=it}c(O,"F");function ne(){if(!a){var ue=i?Math.max(0,i-sn()):0,Ie=Math.max(d._senderConfig.maxBatchInterval(),ue);a=setTimeout(function(){d.triggerSend(!0,null,1)},Ie)}}c(ne,"Q");function ae(ue){return ue===408||ue===429||ue===500||ue===503}c(ae,"Ce");function Y(ue,Ie){return ue?"XMLHttpRequest,Status:"+ue.status+",Response:"+Dl(ue)||0||0:Ie}c(Y,"X");function me(ue,Ie){var Oe=ms(),$e=new XDomainRequest;$e.onload=function(){return d._xdrOnLoad($e,ue)},$e.onerror=function(St){return d._onError(ue,ce($e),St)};var et=Oe&&Oe.location&&Oe.location.protocol||"";if(d._senderConfig.endpointUrl().lastIndexOf(et,0)!==0){d.diagLog().throwInternal(We.WARNING,Be.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),d._buffer.clear();return}var it=d._senderConfig.endpointUrl().replace(/^(https?:)/,"");$e.open("POST",it);var ht=d._buffer.batchPayloads(ue);$e.send(ht),d._buffer.markAsSent(ue)}c(me,"ge");function ce(ue,Ie){return ue?"XDomainRequest,Response:"+Dl(ue)||0:Ie}c(ce,"Ae");function pe(){var ue="getNotifyMgr";return d.core[ue]?d.core[ue]():d.core._notificationManager}c(pe,"dt");function Ae(ue,Ie){var Oe=pe();if(Oe&&Oe.eventsSendRequest)try{Oe.eventsSendRequest(ue,Ie)}catch($e){d.diagLog().throwInternal(We.CRITICAL,Be.NotificationException,"send request notification failed: "+Nt($e),{exception:gt($e)})}}c(Ae,"ot");function Ye(ue){var Ie=ze(ue.disableInstrumentationKeyValidation)?!1:ue.disableInstrumentationKeyValidation;if(Ie)return!0;var Oe="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",$e=new RegExp(Oe);return $e.test(ue.instrumentationKey)}c(Ye,"mt")}),r}return c(e,"e"),e.constructEnvelope=function(r,n,i){var o;switch(n!==r.iKey&&!ze(n)?o=oa({},r,{iKey:n}):o=r,o.baseType){case kn.dataType:return Eh.EventEnvelopeCreator.Create(i,o);case bi.dataType:return Wm.TraceEnvelopeCreator.Create(i,o);case Tn.dataType:return Um.PageViewEnvelopeCreator.Create(i,o);case _i.dataType:return Hm.PageViewPerformanceEnvelopeCreator.Create(i,o);case Wr.dataType:return Bm.ExceptionEnvelopeCreator.Create(i,o);case Gn.dataType:return Om.MetricEnvelopeCreator.Create(i,o);case Kn.dataType:return $m.DependencyEnvelopeCreator.Create(i,o);default:return Eh.EventEnvelopeCreator.Create(i,o)}},e._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){}}},e._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0,customHeaders:void 0}},e}(bo)}),Km=Ne(()=>{F_()}),Qm,Ih,Zm,P_=Ne(()=>{vr(),dr(),xt(),Qm="ai_session",Ih=function(){function t(){}return c(t,"t"),t}(),Zm=function(){function t(e,r){var n=this,i,o,a=rl(r),s=Dd(r);ir(t,n,function(l){e||(e={}),It(e.sessionExpirationMs)||(e.sessionExpirationMs=function(){return t.acquisitionSpan}),It(e.sessionRenewalMs)||(e.sessionRenewalMs=function(){return t.renewalSpan}),l.config=e;var u=l.config.sessionCookiePostfix&&l.config.sessionCookiePostfix()?l.config.sessionCookiePostfix():l.config.namePrefix&&l.config.namePrefix()?l.config.namePrefix():"";i=c(function(){return Qm+u},"i"),l.automaticSession=new Ih,l.update=function(){var b=sn(),y=!1,x=l.automaticSession;x.id||(y=!d(x,b));var C=l.config.sessionExpirationMs();if(!y&&C>0){var k=l.config.sessionRenewalMs(),T=b-x.acquisitionDate,O=b-x.renewalDate;y=T<0||O<0,y=y||T>C,y=y||O>k}y?p(b):(!o||b-o>t.cookieUpdateInterval)&&g(x,b)},l.backup=function(){var b=l.automaticSession;_(b.id,b.acquisitionDate,b.renewalDate)};function d(b,y){var x=!1,C=s.get(i());if(C&&It(C.split))x=f(b,C);else{var k=Gg(a,i());k&&(x=f(b,k))}return x||!!b.id}c(d,"l");function f(b,y){var x=!1,C=", session will be reset",k=y.split("|");if(k.length>=2)try{var T=+k[1]||0,O=+k[2]||0;isNaN(T)||T<=0?a.throwInternal(We.WARNING,Be.SessionRenewalDateIsZero,"AI session acquisition date is 0"+C):isNaN(O)||O<=0?a.throwInternal(We.WARNING,Be.SessionRenewalDateIsZero,"AI session renewal date is 0"+C):k[0]&&(b.id=k[0],b.acquisitionDate=T,b.renewalDate=O,x=!0)}catch(ne){a.throwInternal(We.CRITICAL,Be.ErrorParsingAISessionCookie,"Error parsing ai_session value ["+(y||"")+"]"+C+" - "+Nt(ne),{exception:gt(ne)})}return x}c(f,"f");function p(b){var y=l.config||{},x=(y.getNewId?y.getNewId():null)||hl;l.automaticSession.id=x(y.idLength?y.idLength():22),l.automaticSession.acquisitionDate=b,g(l.automaticSession,b),ih()||a.throwInternal(We.WARNING,Be.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")}c(p,"m");function g(b,y){var x=b.acquisitionDate;b.renewalDate=y;var C=l.config,k=C.sessionRenewalMs(),T=x+C.sessionExpirationMs()-y,O=[b.id,x,y],ne=0;T<k?ne=T/1e3:ne=k/1e3;var ae=C.cookieDomain?C.cookieDomain():null;s.set(i(),O.join("|"),C.sessionExpirationMs()>0?ne:null,ae),o=y}c(g,"I");function _(b,y,x){Kg(a,i(),[b,y,x].join("|"))}c(_,"E")})}return c(t,"t"),t.acquisitionSpan=864e5,t.renewalSpan=18e5,t.cookieUpdateInterval=6e4,t}()}),Xm,N_=Ne(()=>{Xm=function(){function t(){}return c(t,"t"),t}()}),Ym,M_=Ne(()=>{Ym=function(){function t(){this.id="browser",this.deviceClass="Browser"}return c(t,"t"),t}()}),Jm,e0,L_=Ne(()=>{Jm="2.6.4",e0=function(){function t(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:"+Jm}return c(t,"t"),t}()});function t0(t){return!(typeof t!="string"||!t||t.match(/,|;|=| |\|/))}c(t0,"Kc");var r0,$_=Ne(()=>{vr(),dr(),xt(),r0=function(){function t(e,r){this.isNewUser=!1;var n=rl(r),i=Dd(r),o;ir(t,this,function(a){a.config=e;var s=a.config.userCookiePostfix&&a.config.userCookiePostfix()?a.config.userCookiePostfix():"";o=c(function(){return t.userCookieName+s},"a");var l=i.get(o());if(l){a.isNewUser=!1;var u=l.split(t.cookieSeparator);u.length>0&&(a.id=u[0])}if(!a.id){var d=e||{},f=(d.getNewId?d.getNewId():null)||hl;a.id=f(d.idLength?e.idLength():22);var p=31536e3,g=Li(new Date);a.accountAcquisitionDate=g,a.isNewUser=!0;var _=[a.id,g];i.set(o(),_.join(t.cookieSeparator),p);var b=e.namePrefix&&e.namePrefix()?e.namePrefix()+"ai_session":"ai_session";Qg(n,b)}a.accountId=e.accountId?e.accountId():void 0;var y=i.get(t.authUserCookieName);if(y){y=decodeURI(y);var x=y.split(t.cookieSeparator);x[0]&&(a.authenticatedId=x[0]),x.length>1&&x[1]&&(a.accountId=x[1])}a.setAuthenticatedUserContext=function(C,k,T){T===void 0&&(T=!1);var O=!t0(C)||k&&!t0(k);if(O){n.throwInternal(We.WARNING,Be.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}a.authenticatedId=C;var ne=a.authenticatedId;k&&(a.accountId=k,ne=[a.authenticatedId,a.accountId].join(t.cookieSeparator)),T&&i.set(t.authUserCookieName,encodeURI(ne))},a.clearAuthenticatedUserContext=function(){a.authenticatedId=null,a.accountId=null,i.del(t.authUserCookieName)}})}return c(t,"t"),t.cookieSeparator="|",t.userCookieName="ai_user",t.authUserCookieName="ai_authUser",t}()}),n0,B_=Ne(()=>{n0=function(){function t(){}return c(t,"t"),t}()}),i0,O_=Ne(()=>{dr(),xt(),i0=function(){function t(e,r,n,i){var o=this;o.traceID=e||Vn(),o.parentID=r,o.name=n;var a=vo();!n&&a&&a.pathname&&(o.name=a.pathname),o.name=Ur(i,o.name)}return c(t,"t"),t}()});function Ea(t,e){t&&t[e]&&mo(t[e]).length===0&&delete t[e]}c(Ea,"Hr");var Ts,Ds,o0,U_=Ne(()=>{vr(),xt(),P_(),dr(),N_(),M_(),L_(),$_(),B_(),O_(),Ts="ext",Ds="tags",o0=function(){function t(e,r){var n=this,i=e.logger;this.appId=function(){return null},ir(t,this,function(o){o.application=new Xm,o.internal=new e0(r),Zc()&&(o.sessionManager=new Zm(r,e),o.device=new Ym,o.location=new n0,o.user=new r0(r,e),o.telemetryTrace=new i0(void 0,void 0,void 0,i),o.session=new Ih),o.applySessionContext=function(a,s){var l=o.session,u=o.sessionManager;l&&yt(l.id)?kt(kr(a.ext,zr.AppExt),"sesId",l.id):u&&u.automaticSession&&kt(kr(a.ext,zr.AppExt),"sesId",u.automaticSession.id,yt)},o.applyOperatingSystemContxt=function(a,s){kt(a.ext,zr.OSExt,o.os)},o.applyApplicationContext=function(a,s){var l=o.application;if(l){var u=kr(a,Ds);kt(u,Ht.applicationVersion,l.ver,yt),kt(u,Ht.applicationBuild,l.build,yt)}},o.applyDeviceContext=function(a,s){var l=o.device;if(l){var u=kr(kr(a,Ts),zr.DeviceExt);kt(u,"localId",l.id,yt),kt(u,"ip",l.ip,yt),kt(u,"model",l.model,yt),kt(u,"deviceClass",l.deviceClass,yt)}},o.applyInternalContext=function(a,s){var l=o.internal;if(l){var u=kr(a,Ds);kt(u,Ht.internalAgentVersion,l.agentVersion,yt),kt(u,Ht.internalSdkVersion,l.sdkVersion,yt),(a.baseType===ua.dataType||a.baseType===Tn.dataType)&&(kt(u,Ht.internalSnippet,l.snippetVer,yt),kt(u,Ht.internalSdkSrc,l.sdkSrc,yt))}},o.applyLocationContext=function(a,s){var l=n.location;l&&kt(kr(a,Ds,[]),Ht.locationIp,l.ip,yt)},o.applyOperationContext=function(a,s){var l=o.telemetryTrace;if(l){var u=kr(kr(a,Ts),zr.TraceExt,{traceID:void 0,parentID:void 0});kt(u,"traceID",l.traceID,yt),kt(u,"name",l.name,yt),kt(u,"parentID",l.parentID,yt)}},o.applyWebContext=function(a,s){var l=n.web;l&&kt(kr(a,Ts),zr.WebExt,l)},o.applyUserContext=function(a,s){var l=o.user;if(l){var u=kr(a,Ds,[]);kt(u,Ht.userAccountId,l.accountId,yt);var d=kr(kr(a,Ts),zr.UserExt);kt(d,"id",l.id,yt),kt(d,"authId",l.authenticatedId,yt)}},o.cleanUp=function(a,s){var l=a.ext;l&&(Ea(l,zr.DeviceExt),Ea(l,zr.UserExt),Ea(l,zr.WebExt),Ea(l,zr.OSExt),Ea(l,zr.AppExt),Ea(l,zr.TraceExt))}})}return c(t,"t"),t}()}),a0,kh,H_=Ne(()=>{Ut(),vr(),xt(),U_(),dr(),a0=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.priority=110,r.identifier=Ca;var n,i;return ir(e,r,function(o,a){o.initialize=function(l,u,d,f){a.initialize(l,u,d,f);var p=o._getTelCtx(),g=o.identifier,_=e.getDefaultConfig();i=i||{},ur(_,function(b,y){i[b]=function(){return p.getConfig(g,b,y())}}),o.context=new o0(u,i),n=zg(d,Il),o.context.appId=function(){return n?n._appId:null},o._extConfig=i},o.processTelemetry=function(l,u){if(!ze(l)){u=o._getTelCtx(u),l.name===Tn.envelopeType&&u.diagLog().resetInternalMessageCount();var d=o.context||{};if(d.session&&typeof o.context.session.id!="string"&&d.sessionManager&&d.sessionManager.update(),s(l,u),d.user&&d.user.isNewUser){d.user.isNewUser=!1;var f=new ua(Be.SendBrowserInfoOnUserInit,(jn()||{}).userAgent||"");u.diagLog().logInternalMessage(We.CRITICAL,f)}o.processNext(l,u)}};function s(l,u){kr(l,"tags",[]),kr(l,"ext",{});var d=o.context;d.applySessionContext(l,u),d.applyApplicationContext(l,u),d.applyDeviceContext(l,u),d.applyOperationContext(l,u),d.applyUserContext(l,u),d.applyOperatingSystemContxt(l,u),d.applyWebContext(l,u),d.applyLocationContext(l,u),d.applyInternalContext(l,u),d.cleanUp(l,u)}c(s,"c")}),r}return c(e,"e"),e.getDefaultConfig=function(){var r={instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 30*60*1e3},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 24*60*60*1e3},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}};return r},e}(bo),kh=a0}),s0=Ne(()=>{H_()});function c0(t,e,r){var n=0,i=t[e],o=t[r];return i&&o&&(n=Hr(i,o)),n}c(c0,"ru");function Ao(t,e,r,n,i){var o=0,a=c0(r,n,i);return a&&(o=qi(t,e,yi(a))),o}c(Ao,"Sr");function qi(t,e,r){var n="ajaxPerf",i=0;if(t&&e&&r){var o=t[n]=t[n]||{};o[e]=r,i=1}return i}c(qi,"nr");function W_(t,e){var r=t.perfTiming,n=e[Kr]||{},i=0,o="name",a="Start",s="End",l="domainLookup",u="connect",d="redirect",f="request",p="response",g="duration",_="startTime",b=l+a,y=l+s,x=u+a,C=u+s,k=f+a,T=f+s,O=p+a,ne=p+s,ae=d+a,Y=d=s,me="transferSize",ce="encodedBodySize",pe="decodedBodySize",Ae="serverTiming";if(r){i|=Ao(n,d,r,ae,Y),i|=Ao(n,l,r,b,y),i|=Ao(n,u,r,x,C),i|=Ao(n,f,r,k,T),i|=Ao(n,p,r,O,ne),i|=Ao(n,"networkConnect",r,_,C),i|=Ao(n,"sentRequest",r,k,ne);var Ye=r[g];Ye||(Ye=c0(r,_,ne)||0),i|=qi(n,g,Ye),i|=qi(n,"perfTotal",Ye);var ue=r[Ae];if(ue){var Ie={};bt(ue,function(Oe,$e){var et=db(Oe[o]||""+$e),it=Ie[et]||{};ur(Oe,function(ht,St){(ht!==o&&yt(St)||ld(St))&&(it[ht]&&(St=it[ht]+";"+St),(St||!yt(St))&&(it[ht]=St))}),Ie[et]=it}),i|=qi(n,Ae,Ie)}i|=qi(n,me,r[me]),i|=qi(n,ce,r[ce]),i|=qi(n,pe,r[pe])}else t.perfMark&&(i|=qi(n,"missing",t.perfAttempts));i&&(e[Kr]=n)}c(W_,"Il");var Kr,l0,Th,z_=Ne(()=>{dr(),xt(),vr(),Kr="properties",l0=function(){function t(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1}return c(t,"t"),t}(),Th=function(){function t(e,r,n){var i=this,o=n,a="responseText";i.perfMark=null,i.completed=!1,i.requestHeadersSize=null,i.requestHeaders=null,i.responseReceivingDuration=null,i.callbackDuration=null,i.ajaxTotalDuration=null,i.aborted=0,i.pageUrl=null,i.requestUrl=null,i.requestSize=0,i.method=null,i.status=null,i.requestSentTime=null,i.responseStartedTime=null,i.responseFinishedTime=null,i.callbackFinishedTime=null,i.endTime=null,i.xhrMonitoringState=new l0,i.clientFailure=0,i.traceID=e,i.spanID=r,ir(t,i,function(s){s.getAbsoluteUrl=function(){return s.requestUrl?Yg(s.requestUrl):null},s.getPathName=function(){return s.requestUrl?Cs(o,Jg(s.method,s.requestUrl)):null},s.CreateTrackItem=function(l,u,d){if(s.ajaxTotalDuration=Math.round(Hr(s.requestSentTime,s.responseFinishedTime)*1e3)/1e3,s.ajaxTotalDuration<0)return null;var f=(b={id:"|"+s.traceID+"."+s.spanID,target:s.getAbsoluteUrl(),name:s.getPathName(),type:l,startTime:null,duration:s.ajaxTotalDuration,success:+s.status>=200&&+s.status<400,responseCode:+s.status,method:s.method},b[Kr]={HttpMethod:s.method},b);if(s.requestSentTime&&(f.startTime=new Date,f.startTime.setTime(s.requestSentTime)),W_(s,f),u&&mo(s.requestHeaders).length>0&&(f[Kr]=f[Kr]||{},f[Kr].requestHeaders=s.requestHeaders),d){var p=d();if(p){var g=p.correlationContext;if(g&&(f.correlationContext=g),p.headerMap&&mo(p.headerMap).length>0&&(f[Kr]=f[Kr]||{},f[Kr].responseHeaders=p.headerMap),s.status>=400){var _=p.type;f[Kr]=f[Kr]||{},(_===""||_==="text")&&(f[Kr][a]=p[a]?p.statusText+" - "+p[a]:p.statusText),_==="json"&&(f[Kr][a]=p.response?p.statusText+" - "+JSON.stringify(p.response):p.statusText)}}}return f;var b}})}return c(t,"t"),t}()}),q_,j_=Ne(()=>{xt(),xt(),q_=function(){function t(){}return c(t,"t"),t.GetLength=function(e){var r=0;if(!ze(e)){var n="";try{n=e.toString()}catch(i){}r=n.length,r=isNaN(r)?0:r}return r},t}()}),Dh,V_=Ne(()=>{xt(),Dh=function(){function t(e,r){var n=this;n.traceFlag=t.DEFAULT_TRACE_FLAG,n.version=t.DEFAULT_VERSION,e&&t.isValidTraceId(e)?n.traceId=e:n.traceId=Vn(),r&&t.isValidSpanId(r)?n.spanId=r:n.spanId=Vn().substr(0,16)}return c(t,"t"),t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.prototype.toString=function(){var e=this;return e.version+"-"+e.traceId+"-"+e.spanId+"-"+e.traceFlag},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}()});function G_(){var t=ia();return!t||ze(t.Request)||ze(t.Request[Yr])||ze(t[Ia])?null:t[Ia]}c(G_,"El");function K_(t){var e=!1;if(typeof XMLHttpRequest!==fi&&!ze(XMLHttpRequest)){var r=XMLHttpRequest[Yr];e=!ze(r)&&!ze(r.open)&&!ze(r.send)&&!ze(r.abort)}var n=wd();if(n&&n<9&&(e=!1),e)try{var i=new XMLHttpRequest;i[Qr]={};var o=XMLHttpRequest[Yr].open;XMLHttpRequest[Yr].open=o}catch(a){e=!1,Fs(t,Be.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:gt(a)})}return e}c(K_,"wl");function Fl(t){var e="";try{!ze(t)&&!ze(t[Qr])&&!ze(t[Qr].requestUrl)&&(e+="(url: '"+t[Qr].requestUrl+"')")}catch(r){}return e}c(Fl,"wi");function Fs(t,e,r,n,i){t[Aa]()[Ph](We.CRITICAL,e,r,n,i)}c(Fs,"Mn");function Pl(t,e,r,n,i){t[Aa]()[Ph](We.WARNING,e,r,n,i)}c(Pl,"Pi");function Ps(t,e,r){return function(n){Fs(t,e,r,{ajaxDiagnosticsMessage:Fl(n.inst),exception:gt(n.err)})}}c(Ps,"Ln");function Ra(t,e){return t&&e?t.indexOf(e):-1}c(Ra,"jr");var Fh,Aa,Qr,Ph,Ia,Nh,Mh,Q_=Ne(()=>{Ut(),dr(),xt(),z_(),j_(),V_(),vr(),Fh="ai.ajxmn.",Aa="diagLog",Qr="ajaxData",Ph="throwInternal",Ia="fetch",Nh=0,Mh=function(t){Lt(e,t);function e(){var r=t.call(this)||this;r.identifier=e.identifier,r.priority=120;var n="trackDependencyDataInternal",i=vo(),o=!1,a=!1,s=i&&i.host&&i.host.toLowerCase(),l=e.getEmptyConfig(),u=!1,d=0,f,p,g,_,b=!1,y=0,x=!1,C=[],k={},T;return ir(e,r,function(O,ne){O.initialize=function(Re,Ue,Ke,qe){if(!O.isInitialized()){ne.initialize(Re,Ue,Ke,qe);var tt=O._getTelCtx(),lt=e.getDefaultConfig();ur(lt,function($r,Fi){l[$r]=tt.getConfig(e.identifier,$r,Fi)});var ct=l.distributedTracingMode;if(u=l.enableRequestHeaderTracking,b=l.enableAjaxPerfTracking,y=l.maxAjaxCallsPerView,x=l.enableResponseHeaderTracking,T=l.excludeRequestFromAutoTrackingPatterns,g=ct===In.AI||ct===In.AI_AND_W3C,p=ct===In.AI_AND_W3C||ct===In.W3C,b){var Ct=Re.instrumentationKey||"unkwn";Ct.length>5?_=Fh+Ct.substring(Ct.length-5)+".":_=Fh+Ct+"."}if(l.disableAjaxTracking===!1&&ce(),Y(),Ke.length>0&&Ke){for(var qt=void 0,Jt=0;!qt&&Jt<Ke.length;)Ke[Jt]&&Ke[Jt].identifier===Ca&&(qt=Ke[Jt]),Jt++;qt&&(f=qt.context)}}},O.teardown=function(){bt(C,function(Re){Re.rm()}),C=[],o=!1,a=!1,O.setInitialized(!1)},O.trackDependencyData=function(Re,Ue){O[n](Re,Ue)},O.includeCorrelationHeaders=function(Re,Ue,Ke,qe){var tt=O._currentWindowHost||s;if(Ue){if(Hi.canIncludeCorrelationHeader(l,Re.getAbsoluteUrl(),tt)){if(Ke||(Ke={}),Ke.headers=new Headers(Ke.headers||(Ue instanceof Request?Ue.headers||{}:{})),g){var lt="|"+Re.traceID+"."+Re.spanID;Ke.headers.set(zt.requestIdHeader,lt),u&&(Re.requestHeaders[zt.requestIdHeader]=lt)}var ct=l.appId||f&&f.appId();if(ct&&(Ke.headers.set(zt.requestContextHeader,zt.requestContextAppIdFormat+ct),u&&(Re.requestHeaders[zt.requestContextHeader]=zt.requestContextAppIdFormat+ct)),p){var Ct=new Dh(Re.traceID,Re.spanID);Ke.headers.set(zt.traceParentHeader,Ct.toString()),u&&(Re.requestHeaders[zt.traceParentHeader]=Ct.toString())}}return Ke}else if(qe){if(Hi.canIncludeCorrelationHeader(l,Re.getAbsoluteUrl(),tt)){if(g){var lt="|"+Re.traceID+"."+Re.spanID;qe.setRequestHeader(zt.requestIdHeader,lt),u&&(Re.requestHeaders[zt.requestIdHeader]=lt)}var ct=l.appId||f&&f.appId();if(ct&&(qe.setRequestHeader(zt.requestContextHeader,zt.requestContextAppIdFormat+ct),u&&(Re.requestHeaders[zt.requestContextHeader]=zt.requestContextAppIdFormat+ct)),p){var Ct=new Dh(Re.traceID,Re.spanID);qe.setRequestHeader(zt.traceParentHeader,Ct.toString()),u&&(Re.requestHeaders[zt.traceParentHeader]=Ct.toString())}}return qe}},O[n]=function(Re,Ue,Ke){if(y===-1||d<y){(l.distributedTracingMode===In.W3C||l.distributedTracingMode===In.AI_AND_W3C)&&typeof Re.id=="string"&&Re.id[Re.id.length-1]!=="."&&(Re.id+="."),ze(Re.startTime)&&(Re.startTime=new Date);var qe=Qn.create(Re,Kn.dataType,Kn.envelopeType,O[Aa](),Ue,Ke);O.core.track(qe)}else d===y&&Fs(O,Be.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++d};function ae(Re){var Ue=!0;return(Re||l.ignoreHeaders)&&bt(l.ignoreHeaders,function(Ke){if(Ke.toLowerCase()===Re.toLowerCase())return Ue=!1,-1}),Ue}c(ae,"Ce");function Y(){var Re=G_();if(Re){var Ue=ia(),Ke=Re.polyfill;l.disableFetchTracking===!1?(C.push(Gd(Ue,Ia,{req:function(qe,tt,lt){var ct;if(o&&!pe(null,tt,lt)&&!(Ke&&a)){var Ct=qe.ctx();ct=ht(tt,lt);var qt=O.includeCorrelationHeaders(ct,tt,lt);qt!==lt&&qe.set(1,qt),Ct.data=ct}},rsp:function(qe,tt){var lt=qe.ctx().data;lt&&(qe.rslt=qe.rslt.then(function(ct){return Bt(qe,(ct||{}).status,ct,lt,function(){var Ct={statusText:ct.statusText,headerMap:null,correlationContext:vn(ct)};if(x){var qt={};ct.headers.forEach(function(Jt,$r){ae($r)&&(qt[$r]=Jt)}),Ct.headerMap=qt}return Ct}),ct}).catch(function(ct){throw Bt(qe,0,tt,lt,null,{error:ct.message}),ct}))},hkErr:Ps(O,Be.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),o=!0):Ke&&C.push(Gd(Ue,Ia,{req:function(qe,tt,lt){pe(null,tt,lt)}})),Ke&&(Ue[Ia].polyfill=Ke)}}c(Y,"X");function me(Re,Ue,Ke){C.push(Ub(Re,Ue,Ke))}c(me,"ge");function ce(){K_(O)&&!a&&(me(XMLHttpRequest,"open",{req:function(Re,Ue,Ke,qe){var tt=Re.inst,lt=tt[Qr];!pe(tt,Ke)&&Ae(tt,!0)&&(!lt||!lt.xhrMonitoringState.openDone)&&Ye(tt,Ue,Ke,qe)},hkErr:Ps(O,Be.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),me(XMLHttpRequest,"send",{req:function(Re,Ue){var Ke=Re.inst,qe=Ke[Qr];Ae(Ke)&&!qe.xhrMonitoringState.sendDone&&(et("xhr",qe),qe.requestSentTime=Rs(),O.includeCorrelationHeaders(qe,void 0,void 0,Ke),qe.xhrMonitoringState.sendDone=!0)},hkErr:Ps(O,Be.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),me(XMLHttpRequest,"abort",{req:function(Re){var Ue=Re.inst,Ke=Ue[Qr];Ae(Ue)&&!Ke.xhrMonitoringState.abortDone&&(Ke.aborted=1,Ke.xhrMonitoringState.abortDone=!0)},hkErr:Ps(O,Be.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),u&&me(XMLHttpRequest,"setRequestHeader",{req:function(Re,Ue,Ke){var qe=Re.inst;Ae(qe)&&ae(Ue)&&(qe[Qr].requestHeaders[Ue]=Ke)},hkErr:Ps(O,Be.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),a=!0)}c(ce,"Ae");function pe(Re,Ue,Ke){var qe=!1,tt=((yt(Ue)?Ue:(Ue||{}).url||"")||"").toLowerCase();if(bt(T,function(Ct){var qt=Ct;yt(Ct)&&(qt=new RegExp(Ct)),qe||(qe=qt.test(tt))}),qe)return qe;var lt=Ra(tt,"?"),ct=Ra(tt,"#");return(lt===-1||ct!==-1&&ct<lt)&&(lt=ct),lt!==-1&&(tt=tt.substring(0,lt)),ze(Re)?ze(Ue)||(qe=(typeof Ue=="object"?Ue[So]===!0:!1)||(Ke?Ke[So]===!0:!1)):qe=Re[So]===!0||tt[So]===!0,qe?k[tt]||(k[tt]=1):k[tt]&&(qe=!0),qe}c(pe,"dt");function Ae(Re,Ue){var Ke=!0,qe=a;return ze(Re)||(Ke=Ue===!0||!ze(Re[Qr])),qe&&Ke}c(Ae,"ot");function Ye(Re,Ue,Ke,qe){var tt=f&&f.telemetryTrace&&f.telemetryTrace.traceID||Vn(),lt=Vn().substr(0,16),ct=new Th(tt,lt,O[Aa]());ct.method=Ue,ct.requestUrl=Ke,ct.xhrMonitoringState.openDone=!0,ct.requestHeaders={},ct.async=qe,Re[Qr]=ct,ue(Re)}c(Ye,"mt");function ue(Re){Re[Qr].xhrMonitoringState.stateChangeAttached=Ss.Attach(Re,"readystatechange",function(){try{Re&&Re.readyState===4&&Ae(Re)&&Oe(Re)}catch(Ke){var Ue=gt(Ke);(!Ue||Ra(Ue.toLowerCase(),"c00c023f")===-1)&&Fs(O,Be.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Fl(Re),exception:Ue})}})}c(ue,"d");function Ie(Re){try{var Ue=Re.responseType;if(Ue===""||Ue==="text")return Re.responseText}catch(Ke){}return null}c(Ie,"T");function Oe(Re){var Ue=Re[Qr];Ue.responseFinishedTime=Rs(),Ue.status=Re.status;function Ke(qe,tt){var lt=tt||{};lt.ajaxDiagnosticsMessage=Fl(Re),qe&&(lt.exception=gt(qe)),Pl(O,Be.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",lt)}c(Ke,"N"),it("xmlhttprequest",Ue,function(){try{var qe=Ue.CreateTrackItem("Ajax",u,function(){var tt={statusText:Re.statusText,headerMap:null,correlationContext:$e(Re),type:Re.responseType,responseText:Ie(Re),response:Re.response};if(x){var lt=Re.getAllResponseHeaders();if(lt){var ct=xr(lt).split(/[\r\n]+/),Ct={};bt(ct,function(qt){var Jt=qt.split(": "),$r=Jt.shift(),Fi=Jt.join(": ");ae($r)&&(Ct[$r]=Fi)}),tt.headerMap=Ct}}return tt});qe?O[n](qe):Ke(null,{requestSentTime:Ue.requestSentTime,responseFinishedTime:Ue.responseFinishedTime})}finally{try{Re[Qr]=null}catch(tt){}}},function(qe){Ke(qe,null)})}c(Oe,"A");function $e(Re){try{var Ue=Re.getAllResponseHeaders();if(Ue!==null){var Ke=Ra(Ue.toLowerCase(),zt.requestContextHeaderLowerCase);if(Ke!==-1){var qe=Re.getResponseHeader(zt.requestContextHeader);return Hi.getCorrelationContext(qe)}}}catch(tt){Pl(O,Be.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Fl(Re),exception:gt(tt)})}}c($e,"D");function et(Re,Ue){if(Ue.requestUrl&&_&&b){var Ke=mi();if(Ke&&It(Ke.mark)){Nh++;var qe=_+Re+"#"+Nh;Ke.mark(qe);var tt=Ke.getEntriesByName(qe);tt&&tt.length===1&&(Ue.perfMark=tt[0])}}}c(et,"j");function it(Re,Ue,Ke,qe){var tt=Ue.perfMark,lt=mi(),ct=l.maxAjaxPerfLookupAttempts,Ct=l.ajaxPerfLookupDelay,qt=Ue.requestUrl,Jt=0;c(function $r(){try{if(lt&&tt){Jt++;for(var Fi=null,Eu=lt.getEntries(),Va=Eu.length-1;Va>=0;Va--){var wn=Eu[Va];if(wn){if(wn.entryType==="resource")wn.initiatorType===Re&&(Ra(wn.name,qt)!==-1||Ra(qt,wn.name)!==-1)&&(Fi=wn);else if(wn.entryType==="mark"&&wn.name===tt.name){Ue.perfTiming=Fi;break}if(wn.startTime<tt.startTime-1e3)break}}}!tt||Ue.perfTiming||Jt>=ct||Ue.async===!1?(tt&&It(lt.clearMarks)&&lt.clearMarks(tt.name),Ue.perfAttempts=Jt,Ke()):setTimeout($r,Ct)}catch(fp){qe(fp)}},"Je")()}c(it,"U");function ht(Re,Ue){var Ke=f&&f.telemetryTrace&&f.telemetryTrace.traceID||Vn(),qe=Vn().substr(0,16),tt=new Th(Ke,qe,O[Aa]());tt.requestSentTime=Rs(),Re instanceof Request?tt.requestUrl=Re?Re.url:"":tt.requestUrl=Re;var lt="GET";Ue&&Ue.method?lt=Ue.method:Re&&Re instanceof Request&&(lt=Re.method),tt.method=lt;var ct={};if(u){var Ct=new Headers((Ue?Ue.headers:0)||(Re instanceof Request?Re.headers||{}:{}));Ct.forEach(function(qt,Jt){ae(Jt)&&(ct[Jt]=qt)})}return tt.requestHeaders=ct,et("fetch",tt),tt}c(ht,"q");function St(Re){var Ue="";try{ze(Re)||(typeof Re=="string"?Ue+="(url: '"+Re+"')":Ue+="(url: '"+Re.url+"')")}catch(Ke){Fs(O,Be.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:gt(Ke)})}return Ue}c(St,"Z");function Bt(Re,Ue,Ke,qe,tt,lt){if(!qe)return;function ct(Ct,qt,Jt){var $r=Jt||{};$r.fetchDiagnosticsMessage=St(Ke),qt&&($r.exception=gt(qt)),Pl(O,Ct,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",$r)}c(ct,"B"),qe.responseFinishedTime=Rs(),qe.status=Ue,it("fetch",qe,function(){var Ct=qe.CreateTrackItem("Fetch",u,tt);Ct?O[n](Ct):ct(Be.FailedMonitorAjaxDur,null,{requestSentTime:qe.requestSentTime,responseFinishedTime:qe.responseFinishedTime})},function(Ct){ct(Be.FailedMonitorAjaxGetCorrelationHeader,Ct,null)})}c(Bt,"ie");function vn(Re){if(Re&&Re.headers)try{var Ue=Re.headers.get(zt.requestContextHeader);return Hi.getCorrelationContext(Ue)}catch(Ke){Pl(O,Be.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:St(Re),exception:gt(Ke)})}}c(vn,"jt")}),r}return c(e,"e"),e.getDefaultConfig=function(){var r={maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:In.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"]};return r},e.getEmptyConfig=function(){var r=this.getDefaultConfig();return ur(r,function(n){r[n]=void 0}),r},e.prototype.processTelemetry=function(r,n){this.processNext(r,n)},e.identifier="AjaxDependencyPlugin",e}(bo)}),u0=Ne(()=>{Q_()}),Lh,$h,d0,h0,Bh,f0=Ne(()=>{xt(),Nm(),Km(),s0(),u0(),dr(),$h=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],d0={Default:0,Required:1,Array:2,Hidden:4},h0={__proto__:null,PropertiesPluginIdentifier:Ca,BreezeChannelIdentifier:Il,AnalyticsPluginIdentifier:bh,Util:ch,CorrelationIdHelper:Hi,UrlHelper:im,DateTimeUtils:om,ConnectionStringParser:um,FieldType:d0,RequestHeaders:zt,DisabledPropertyName:So,ProcessLegacy:ya,SampleRate:gl,HttpMethod:ml,DEFAULT_BREEZE_ENDPOINT:th,AIData:uh,AIBase:lh,Envelope:dh,Event:kn,Exception:Wr,Metric:Gn,PageView:Tn,PageViewData:El,RemoteDependencyData:Kn,Trace:bi,PageViewPerformance:_i,Data:xi,SeverityLevel:As,ConfigurationManager:Im,ContextTagKeys:Al,DataSanitizer:Hg,TelemetryItemCreator:Qn,CtxTagKeys:Ht,Extensions:zr,DistributedTracingModes:In},Bh=function(){function t(e){var r=this;r._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var n=e.config||{};if(n.connectionString){var i=sm(n.connectionString),o=i.ingestionendpoint;n.endpointUrl=o?o+"/v2/track":n.endpointUrl,n.instrumentationKey=i.instrumentationkey||n.instrumentationKey}r.appInsights=new xh,r.properties=new kh,r.dependencies=new Mh,r.core=new Wd,r._sender=new Ah,r.snippet=e,r.config=n,r.getSKUDefaults()}return c(t,"t"),t.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},t.prototype.trackEvent=function(e,r){this.appInsights.trackEvent(e,r)},t.prototype.trackPageView=function(e){var r=e||{};this.appInsights.trackPageView(r)},t.prototype.trackPageViewPerformance=function(e){var r=e||{};this.appInsights.trackPageViewPerformance(r)},t.prototype.trackException=function(e){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},t.prototype._onerror=function(e){this.appInsights._onerror(e)},t.prototype.trackTrace=function(e,r){this.appInsights.trackTrace(e,r)},t.prototype.trackMetric=function(e,r){this.appInsights.trackMetric(e,r)},t.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},t.prototype.stopTrackPage=function(e,r,n,i){this.appInsights.stopTrackPage(e,r,n,i)},t.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,r,n){this.appInsights.stopTrackEvent(e,r,n)},t.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},t.prototype.setAuthenticatedUserContext=function(e,r,n){n===void 0&&(n=!1),this.properties.context.user.setAuthenticatedUserContext(e,r,n)},t.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},t.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},t.prototype.flush=function(e){var r=this;e===void 0&&(e=!0),da(this.core,function(){return"AISKU.flush"},function(){bt(r.core.getTransmissionControls(),function(n){bt(n,function(i){i.flush(e)})})},null,e)},t.prototype.onunloadFlush=function(e){e===void 0&&(e=!0),bt(this.core.getTransmissionControls(),function(r){bt(r,function(n){n.onunloadFlush?n.onunloadFlush():n.flush(e)})})},t.prototype.loadAppInsights=function(e,r,n){var i=this;e===void 0&&(e=!1);var o=this;function a(s){if(s){var l="";ze(o._snippetVersion)||(l+=o._snippetVersion),e&&(l+=".lg"),o.context&&o.context.internal&&(o.context.internal.snippetVer=l||"-"),ur(o,function(u,d){yt(u)&&!It(d)&&u&&u[0]!=="_"&&$h.indexOf(u)===-1&&(s[u]=d)})}}return c(a,"o"),e&&o.config.extensions&&o.config.extensions.length>0&&zn("Extensions not allowed in legacy mode"),da(o.core,function(){return"AISKU.loadAppInsights"},function(){var s=[];s.push(o._sender),s.push(o.properties),s.push(o.dependencies),s.push(o.appInsights),o.core.initialize(o.config,s,r,n),o.context=o.properties.context,Lh&&o.context&&(o.context.internal.sdkSrc=Lh),a(o.snippet),o.emptyQueue(),o.pollInternalLogs(),o.addHousekeepingBeforeUnload(i)}),o},t.prototype.updateSnippetDefinitions=function(e){qp(e,this,function(r){return r&&$h.indexOf(r)===-1})},t.prototype.emptyQueue=function(){var e=this;try{if(gi(e.snippet.queue)){for(var r=e.snippet.queue.length,n=0;n<r;n++){var i=e.snippet.queue[n];i()}e.snippet.queue=void 0,delete e.snippet.queue}}catch(a){var o={};a&&It(a.toString)&&(o.exception=a.toString())}},t.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},t.prototype.addHousekeepingBeforeUnload=function(e){if(Zc()||Gp()){var r=c(function(){e.onunloadFlush(!1),bt(e.appInsights.core._extensions,function(i){if(i.identifier===Ca)return i&&i.context&&i.context._sessionManager&&i.context._sessionManager.backup(),-1})},"r");if(!e.appInsights.config.disableFlushOnBeforeUnload){var n=xo("beforeunload",r);n=xo("unload",r)||n,n=xo("pagehide",r)||n,n=xo("visibilitychange",r)||n,!n&&!xb()&&e.appInsights.core.logger.throwInternal(We.CRITICAL,Be.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||(xo("pagehide",r),xo("visibilitychange",r))}},t.prototype.getSender=function(){return this._sender},t.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},t}(),function(){var t=null,e=!1,r=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(t=n.src)}catch(s){}if(t)try{var i=t.toLowerCase();if(i){for(var o="",a=0;a<r.length;a++)if(i.indexOf(r[a])!==-1){o="cdn"+(a+1),i.indexOf("/scripts/")===-1&&(i.indexOf("/next/")!==-1?o+="-next":i.indexOf("/beta/")!==-1&&(o+="-beta")),Lh=o+(e?".mod":"");break}}}catch(s){}}()}),p0,g0,Z_=Ne(()=>{dr(),xt(),p0=["snippet","getDefaultConfig","_hasLegacyInitializers","_queue","_processLegacyInitializers"],g0=function(){function t(e,r){this._hasLegacyInitializers=!1,this._queue=[],this.config=t.getDefaultConfig(e.config),this.appInsightsNew=r,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return c(t,"t"),t.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=30*60*1e3,e.sessionExpirationMs=24*60*60*1e3,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=$t(e.enableDebug),e.disableExceptionTracking=$t(e.disableExceptionTracking),e.disableTelemetry=$t(e.disableTelemetry),e.verboseLogging=$t(e.verboseLogging),e.emitLineDelimitedJson=$t(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=$t(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=$t(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=$t(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=$t(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=$t(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=$t(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=$t(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=$t(e.isRetryDisabled),e.isCookieUseDisabled=$t(e.isCookieUseDisabled),e.isStorageUseDisabled=$t(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=$t(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=$t(e.enableCorsCorrelation),e},t.prototype.addTelemetryInitializers=function(e){var r=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer(function(n){r._processLegacyInitializers(n)}),this._hasLegacyInitializers=!0),this._queue.push(e)},t.prototype.getCookieMgr=function(){return this.appInsightsNew.getCookieMgr()},t.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},t.prototype.stopTrackPage=function(e,r,n,i){this.appInsightsNew.stopTrackPage(e,r,n)},t.prototype.trackPageView=function(e,r,n,i,o){var a={name:e,uri:r,properties:n,measurements:i};this.appInsightsNew.trackPageView(a)},t.prototype.trackEvent=function(e,r,n){this.appInsightsNew.trackEvent({name:e})},t.prototype.trackDependency=function(e,r,n,i,o,a,s){this.appInsightsNew.trackDependencyData({id:e,target:n,type:i,duration:o,properties:{HttpMethod:r},success:a,responseCode:s})},t.prototype.trackException=function(e,r,n,i,o){this.appInsightsNew.trackException({exception:e})},t.prototype.trackMetric=function(e,r,n,i,o,a){this.appInsightsNew.trackMetric({name:e,average:r,sampleCount:n,min:i,max:o})},t.prototype.trackTrace=function(e,r,n){this.appInsightsNew.trackTrace({message:e,severityLevel:n})},t.prototype.flush=function(e){this.appInsightsNew.flush(e)},t.prototype.setAuthenticatedUserContext=function(e,r,n){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,r,n)},t.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},t.prototype._onerror=function(e,r,n,i,o){this.appInsightsNew._onerror({message:e,url:r,lineNumber:n,columnNumber:i,error:o})},t.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},t.prototype.stopTrackEvent=function(e,r,n){this.appInsightsNew.stopTrackEvent(e,r,n)},t.prototype.downloadAndSetup=function(e){zn("downloadAndSetup not implemented in web SKU")},t.prototype.updateSnippetDefinitions=function(e){qp(e,this,function(r){return r&&p0.indexOf(r)===-1})},t.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var r=this.trackPageView;this.trackPageView=function(o,a,s){r.apply(e,[null,o,a,s])}}var n="logPageView";typeof this.snippet[n]=="function"&&(this[n]=function(o,a,s){e.trackPageView(null,o,a,s)});var i="logEvent";return typeof this.snippet[i]=="function"&&(this[i]=function(o,a,s){e.trackEvent(o,a,s)}),this},t.prototype._processLegacyInitializers=function(e){return e.tags[ya]=this._queue,e},t}()}),m0,X_=Ne(()=>{Z_(),f0(),xt(),m0=function(){function t(){}return c(t,"t"),t.getAppInsights=function(e,r){var n=new Bh(e),i=r!==2;if(ma(),r===2)return n.updateSnippetDefinitions(e),n.loadAppInsights(i),n;var o=new g0(e,n);return o.updateSnippetDefinitions(e),n.loadAppInsights(i),o},t}()}),v0={};Xy(v0,{AppInsightsCore:()=>Wd,ApplicationAnalytics:()=>xh,ApplicationInsights:()=>Bh,ApplicationInsightsContainer:()=>m0,BaseCore:()=>Ud,BaseTelemetryPlugin:()=>bo,CoreUtils:()=>fl,DependenciesPlugin:()=>Mh,DistributedTracingModes:()=>In,Event:()=>kn,Exception:()=>Wr,LoggingSeverity:()=>We,Metric:()=>Gn,NotificationManager:()=>Hd,PageView:()=>Tn,PageViewPerformance:()=>_i,PerfEvent:()=>ha,PerfManager:()=>Sd,PropertiesPlugin:()=>kh,RemoteDependencyData:()=>Kn,Sender:()=>Ah,SeverityLevel:()=>As,Telemetry:()=>h0,Trace:()=>bi,Util:()=>ch,_InternalMessageId:()=>Be,doPerf:()=>da});var Y_=Ne(()=>{f0(),X_(),xt(),dr(),Km(),Nm(),s0(),u0()}),wr;(function(t){t.ON="on",t.ERROR="error",t.OFF="off"})(wr||(wr={}));function ka(){let t="telemetry",e="enableTelemetry";try{let r=h.env.telemetryConfiguration;return r.isUsageEnabled&&r.isErrorsEnabled&&r.isCrashEnabled?wr.ON:r.isErrorsEnabled&&r.isCrashEnabled?wr.ERROR:wr.OFF}catch(r){return h.env.isTelemetryEnabled!==void 0?h.env.isTelemetryEnabled?wr.ON:wr.OFF:h.workspace.getConfiguration(t).get(e)?wr.ON:wr.OFF}}c(ka,"At");var J_=c(class{constructor(t,e){this._isInstantiated=!1,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=e,this._key=t,ka()!==wr.OFF&&this.instantiateAppender()}logEvent(t,e){if(!this._telemetryClient){!this._isInstantiated&&ka()===wr.ON&&this._eventQueue.push({eventName:t,data:e});return}this._telemetryClient.logEvent(t,e)}logException(t,e){if(!this._telemetryClient){!this._isInstantiated&&ka()!==wr.OFF&&this._exceptionQueue.push({exception:t,data:e});return}this._telemetryClient.logException(t,e)}flush(){return Ku(this,null,function*(){this._telemetryClient&&(yield this._telemetryClient.flush(),this._telemetryClient=void 0)})}_flushQueues(){this._eventQueue.forEach(({eventName:t,data:e})=>this.logEvent(t,e)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:t,data:e})=>this.logException(t,e)),this._exceptionQueue=[]}instantiateAppender(){this._isInstantiated||this._clientFactory(this._key).then(t=>{this._telemetryClient=t,this._isInstantiated=!0,this._flushQueues()}).catch(t=>{console.error(t)})}},"Fi"),ex=c(class{constructor(t,e,r,n,i){this.extensionId=t,this.extensionVersion=e,this.telemetryAppender=r,this.osShim=n,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!i,this.updateUserOptStatus(),h.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(h.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(h.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(h.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let t=ka();this.userOptIn=t===wr.ON,this.errorOptIn=t===wr.ERROR||this.userOptIn,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(t){if(!t)return"none";let e="other";return["ssh-remote","dev-container","attached-container","wsl","codespaces"].forEach(r=>{t.indexOf(`${r}`)===0&&(e=r)}),e}get extension(){return this._extension===void 0&&(this._extension=h.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(t,e){if(t===null||typeof t!="object"||typeof e!="function")return t;let r={};for(let n in t)r[n]=e(n,t[n]);return r}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?!(h.env.remoteName&&this.cleanRemoteName(h.env.remoteName)==="other"):!0}getCommonProperties(){let t=Object.create(null);if(t["common.os"]=this.osShim.platform,t["common.nodeArch"]=this.osShim.architecture,t["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),t["common.extname"]=this.extensionId,t["common.extversion"]=this.extensionVersion,h&&h.env){switch(t["common.vscodemachineid"]=h.env.machineId,t["common.vscodesessionid"]=h.env.sessionId,t["common.vscodeversion"]=h.version,t["common.isnewappinstall"]=h.env.isNewAppInstall?h.env.isNewAppInstall.toString():"false",t["common.product"]=h.env.appHost,h.env.uiKind){case h.UIKind.Web:t["common.uikind"]="web";break;case h.UIKind.Desktop:t["common.uikind"]="desktop";break;default:t["common.uikind"]="unknown"}t["common.remotename"]=this.cleanRemoteName(h.env.remoteName)}return t}anonymizeFilePaths(t,e){let r;if(t==null)return"";let n=[];h.env.appRoot!==""&&n.push(new RegExp(h.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&n.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let i=t;if(e){let o=[];for(let u of n)for(;(r=u.exec(t))&&r;)o.push([r.index,u.lastIndex]);let a=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,s=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,l=0;for(i="";(r=s.exec(t))&&r;)r[0]&&!a.test(r[0])&&o.every(([u,d])=>r.index<u||r.index>=d)&&(i+=t.substring(l,r.index)+"<REDACTED: user-file-path>",l=s.lastIndex);l<t.length&&(i+=t.substr(l))}for(let o of n)i=i.replace(o,"");return i}removePropertiesWithPossibleUserInfo(t){if(typeof t!="object")return;let e=Object.create(null);for(let r of Object.keys(t)){let n=t[r];if(!n)continue;let i=/@[a-zA-Z0-9-.]+/,o=/(key|token|sig|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/,a=/xox[pbaors]-[a-zA-Z0-9]+-[a-zA-Z0-9-]+?/;o.test(n.toLowerCase())?e[r]="<REDACTED: secret>":i.test(n)?e[r]="<REDACTED: email>":a.test(n)?e[r]="<REDACTED: token>":e[r]=n}return e}get telemetryLevel(){switch(ka()){case wr.ON:return"all";case wr.ERROR:return"error";case wr.OFF:return"off"}}sendTelemetryEvent(t,e,r){if(this.userOptIn&&t!==""){e=an(an({},e),this.getCommonProperties());let n=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(n),measurements:r})}}sendRawTelemetryEvent(t,e,r){this.userOptIn&&t!==""&&(e=an(an({},e),this.getCommonProperties()),this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:e,measurements:r}))}sendTelemetryErrorEvent(t,e,r,n){if(this.errorOptIn&&t!==""){e=an(an({},e),this.getCommonProperties());let i=this.cloneAndChange(e,(o,a)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(a,this.firstParty):n===void 0||n.indexOf(o)!==-1?"REDACTED":this.anonymizeFilePaths(a,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${t}`,{properties:this.removePropertiesWithPossibleUserInfo(i),measurements:r})}}sendTelemetryException(t,e,r){if(this.shouldSendErrorTelemetry()&&this.errorOptIn&&t){e=an(an({},e),this.getCommonProperties());let n=this.cloneAndChange(e,(i,o)=>this.anonymizeFilePaths(o,this.firstParty));t.stack&&(t.stack=this.anonymizeFilePaths(t.stack,this.firstParty)),this.telemetryAppender.logException(t,{properties:this.removePropertiesWithPossibleUserInfo(n),measurements:r})}}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(t=>t.dispose()))}},"ki"),tx=c(t=>Ku(void 0,null,function*(){let e;try{let r=yield Promise.resolve().then(()=>(Y_(),v0)),n;t&&t.indexOf("AIF-")===0&&(n="https://vortex.data.microsoft.com/collect/v1"),e=new r.ApplicationInsights({config:{instrumentationKey:t,endpointUrl:n,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!0,disableInstrumentationKeyValidation:!0}}),e.loadAppInsights();let i=ka();n&&i!==wr.OFF&&fetch(n).catch(()=>e=void 0)}catch(r){return Promise.reject(r)}return{logEvent:(r,n)=>{e==null||e.trackEvent({name:r},an(an({},n==null?void 0:n.properties),n==null?void 0:n.measurements))},logException:(r,n)=>{e==null||e.trackException({exception:r,properties:an(an({},n==null?void 0:n.properties),n==null?void 0:n.measurements)})},flush:()=>Ku(void 0,null,function*(){e==null||e.flush()})}}),"Dl"),rx=c(class extends ex{constructor(t,e,r,n){let i=new J_(r,tx);r&&r.indexOf("AIF-")===0&&(n=!0);super(t,e,i,{release:navigator.appVersion,platform:"web",architecture:"web"},n)}},"xu");/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */const nx="Type of classified event does not match event properties",Oh=c(class{constructor(t){this.context=t,this.sharedProperties={},Oh._instance=this,this.reporter=new rx(t.extension.id,t.extension.packageJSON.version,Oh.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(t,e){e!==nx&&this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e})}sendEvent(t,e,r){this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e},r)}sendErrorEvent(t,e,r,n){this.reporter.sendTelemetryErrorEvent(t,{...this.sharedProperties,...e},r,n)}sendException(t,e,r){this.reporter.sendTelemetryException(t,{...this.sharedProperties,...e},r)}setSharedProperty(t,e){this.sharedProperties[t]=e}reportWorkbenchLoadResult(t){const e="_codespaces.webeditor.connectWorkspace";h.env.appHost==="github.dev"&&(te.debug(`Executing ${e}`),t={...t,errorDetail:t.errorDetail instanceof Error?t.errorDetail.name:void 0},h.commands.executeCommand(e,t).then(r=>{},r=>{te.debug(`Failed to execute ${e}`,r)}))}},"_TelemetryService");let Ns=Oh;Ns.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function ix(t,e){return t.reduce((n,i)=>{const o=e(i),a=n.get(o);return a===void 0?n.set(o,[i]):a.push(i),n},new Map)}c(ix,"groupBy");function ox(t){let e=0;for(const r of t){if(r===0)return!0;if(e++,e>8e3)break}return!1}c(ox,"isBinary");function Uh(t,e,r=n=>n){return[...t.reduce((i,o)=>{const a=e(o),s=i.get(a);if(s===void 0)i.set(a,o);else{const l=r(s,o);l!==void 0&&i.set(a,l)}return i},new Map).values()]}c(Uh,"uniqueBy");const en=(0,m.loadMessageBundle)(),Ms=c(class{constructor(t,e,r,n){this.providerService=t,this.storageService=e,this.changeStore=r,this.workspaceId=n,this._onDidChange=new h.EventEmitter,this.cache=new Map,this.lock=new _r("WorkspaceRepositories"),this.disposable=h.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const t=await h.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void h.window.showTextDocument(t)}onChangeStoreChanged(t){const e=Uh(t.map(r=>r.rootUri),r=>E(r)).map(r=>this.providerService.getRepository(r)).filter(r=>Boolean(r));this.addOrUpdate(e)}onRepositoriesChanged(t){this.addOrUpdate(t.added)}onRepositoryChanged(t){this.addOrUpdate([t.repository])}async get(t){let e=await this.lock.synchronizeRead(async()=>{let r=this.cache.get("workspaceRepositories");return r===void 0&&(r=[...(await this.getCore()).values()].sort((n,i)=>i.timestamp-n.timestamp),this.cache.set("workspaceRepositories",r)),r},"WorkspaceRepositories.get");if(t){const r=E(t);e=e.filter(n=>E(n.canonicalUri)===r)}return e}async getCore(){return this.fromStorage(await this.storageService.get(Ms.storageKey))}async getRecents(t=10){return(await this.get()).slice(0,t)}async getRemoteWorkspaceSourceProvider(t){const e=await this.getRecents();if(e.length!==0)return e.filter(r=>r.provider.id===t)}refresh(){this.cache.clear()}async remove(t){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),r=`${t.workspaceId}/${E(t.uri)}`,n=e.get(r);if(n===void 0)return;const i=this.changeStore.getScopedChangeStore(n),o=await i.getChanges(n.uri);if(o.length!==0){const a={title:en("remove remote repo prompt confirm","Yes")},s={title:en("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await h.window.showWarningMessage(o.length===1?en("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):en("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0,useCustom:!0},a,s)!==a)return;await i.discardAll(n.uri)}this.cache.clear(),e.delete(r);try{await this.storageService.store(Ms.storageKey,this.toStorage(e))}catch(a){throw te.error(a,"Failed to save workspace repositories"),a}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(t){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const r of t){const[{HEAD:n,pullRequest:i},o]=await Promise.all([r.getMetadata(),r.getIndexMetadata()]),a=await this.changeStore.getChanges(r.uri);e.set(`${this.workspaceId}/${E(r.uri)}`,{workspaceId:this.workspaceId,uri:r.uri,canonicalUri:r.canonicalUri,name:r.name,provider:r.provider,ref:{type:n.type,name:n.name},idx:(o==null?void 0:o.type)&&Pe.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:sx(a),timestamp:Date.now()})}try{await this.storageService.store(Ms.storageKey,this.toStorage(e))}catch(r){throw te.error(r,"Failed to save workspace repositories"),r}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(t){if(!t)return new Map;try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&S(n)?h.Uri.from(n):n);return new Map(e.workspaceRepositories)}catch(e){return te.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(t){const e={schemaVersion:Ms.storageSchemaVersion,workspaceRepositories:[...t]};return JSON.stringify(e)}},"_WorkspaceRepositories");let Hh=Ms;Hh.storageKey="workspaceRepositories",Hh.storageSchemaVersion=1;function w0(t){return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}c(w0,"hasChanges");function ax(t){return w0(t.changes)}c(ax,"hasUncommittedChanges");function sx(t){let e=0,r=0,n=0;for(const i of t)switch(i.type){case q.Created:e++;break;case q.Changed:r++;break;case q.Deleted:n++;break}return e||r||n?{added:e,changed:r,deleted:n,timestamp:Date.now()}:void 0}c(sx,"toChangesSummary");function y0(t,{compact:e=!0,preamble:r,separator:n=", ",short:i=!1,single:o=!1}={}){if(!w0(t))return en("no changes","Everything up to date");const{added:a,changed:s,deleted:l}=t;if(o){const d=a+s+l;return d===1?en("summary change","{0} change",d):en("changes changes","{0} changes",d)}let u=`${r!=null?r:""}`;return(a||!e)&&(u+=i?`+${a}`:a===1?en("file added","{0} file added",a):en("files added","{0} files added",a),(s||l||!e)&&(u+=n)),(s||!e)&&(u+=i?`~${s}`:s===1?en("file changed","{0} file changed",s):en("files changed","{0} files changed",s),(l||!e)&&(u+=n)),(l||!e)&&(u+=i?`-${l}`:l===1?en("file deleted","{0} file deleted",l):en("files deleted","{0} files deleted",l)),u}c(y0,"formatChangesSummary");class b0{constructor(e){this.providerService=e,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepositories(r=>{for(const n of r.added)this.repositoryOpened(n);for(const n of r.removed)this.repositoryClosed(n)}),fe.onDidChange(r=>{for(const n of this.services.values()){const i=n.service.getRepository();r.affectsConfiguration("remoteHub.richNavigation.indexMode",i.uri)&&n.service.updateIndexMode().catch(o=>{te.error(o)})}}));for(const r of this.providerService.repositories)this.repositoryOpened(r)}dispose(){this.disposable.dispose()}register(e){const r=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(r,1)}}async repositoryOpened(e){const r=E(e.uri);if(!this.handledRepositories.has(r)){this.handledRepositories.add(r);for(const n of this.providers){const i=await n.createNavigationService(this.providerService,e);if(i!==void 0){const o=i();this.services.set(r,{service:o});break}}}}repositoryClosed(e){const r=E(e.uri);this.handledRepositories.delete(r);const n=this.services.get(r);n!==void 0&&(n.service.dispose(),this.services.delete(E(e.uri)))}}c(b0,"CodeNavigationServices");const Ls=globalThis.fetch;async function _0(t,e,r){const n=new AbortController;r.onCancellationRequested(()=>n.abort());try{return await globalThis.fetch(t,{...e,signal:n.signal})}catch(i){throw r.isCancellationRequested?new h.CancellationError:i}}c(_0,"fetchWithCancellation");async function x0(t,e,r,n,i){if(r===0)throw new h.CancellationError;const o=new h.CancellationTokenSource;n.onCancellationRequested(()=>o.cancel());try{const a=await _0(t,e,o.token);if(a.body){const s=[];let l=0;const u=a.body.getReader();let d=3;for(;;){let{done:f,value:p}=await u.read();if(f){const _=s.reduce((x,C)=>x+C.length,0),b=new Uint8Array(_);let y=0;for(const x of s)b.set(x,y),y+=x.length;return b}p&&(s.push(p),l+=p.length);const g=Math.floor(l/(1024*1024));if(d<g){d=g;const _={message:g+" MB"};i.report(_)}if(r!==void 0&&l>r)throw u.cancel(),o.cancel(),new Error("LIMIT_HIT")}}}catch(a){throw n.isCancellationRequested?new h.CancellationError:a}throw new h.CancellationError}c(x0,"fetchUInt8ArrayWithMaxSizeAndCancellation");/*! (c) Andrea Giammarchi - ISC */var Nl={};try{(function(t,e){if(new t("q=%2B").get("q")!==e||new t({q:e}).get("q")!==e||new t([["q",e]]).get("q")!==e||new t(`q=
`).toString()!=="q=%0A"||new t({q:" &"}).toString()!=="q=+%26"||new t({q:"%zx"}).toString()!=="q=%25zx")throw t;Nl.URLSearchParams=t})(URLSearchParams,"+")}catch(t){(function(e,r,n){"use strict";var i=e.create,o=e.defineProperty,a=/[!'\(\)~]|%20|%00/g,s=/%(?![0-9a-fA-F]{2})/g,l=/\+/g,u={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},d={append:function(C,k){_(this._ungap,C,k)},delete:function(C){delete this._ungap[C]},get:function(C){return this.has(C)?this._ungap[C][0]:null},getAll:function(C){return this.has(C)?this._ungap[C].slice(0):[]},has:function(C){return C in this._ungap},set:function(C,k){this._ungap[C]=[r(k)]},forEach:function(C,k){var T=this;for(var O in T._ungap)T._ungap[O].forEach(ne,O);function ne(ae){C.call(k,ae,r(O),T)}c(ne,"invoke")},toJSON:function(){return{}},toString:function(){var C=[];for(var k in this._ungap)for(var T=y(k),O=0,ne=this._ungap[k];O<ne.length;O++)C.push(T+"="+y(ne[O]));return C.join("&")}};for(var f in d)o(p.prototype,f,{configurable:!0,writable:!0,value:d[f]});Nl.URLSearchParams=p;function p(C){var k=i(null);switch(o(this,"_ungap",{value:k}),!0){case!C:break;case typeof C=="string":C.charAt(0)==="?"&&(C=C.slice(1));for(var T=C.split("&"),O=0,ne=T.length;O<ne;O++){var ae=T[O],Y=ae.indexOf("=");-1<Y?_(k,b(ae.slice(0,Y)),b(ae.slice(Y+1))):ae.length&&_(k,b(ae),"")}break;case n(C):for(var O=0,ne=C.length;O<ne;O++){var ae=C[O];_(k,ae[0],ae[1])}break;case"forEach"in C:C.forEach(g,k);break;default:for(var me in C)_(k,me,C[me])}}c(p,"URLSearchParams");function g(C,k){_(this,k,C)}c(g,"addEach");function _(C,k,T){var O=n(T)?T.join(","):T;k in C?C[k].push(O):C[k]=[O]}c(_,"appendTo");function b(C){return decodeURIComponent(C.replace(s,"%25").replace(l," "))}c(b,"decode");function y(C){return encodeURIComponent(C).replace(a,x)}c(y,"encode");function x(C){return u[C]}c(x,"replacer")})(Object,String,Array.isArray)}(function(t){var e=!1;try{e=!!Symbol.iterator}catch(n){}"forEach"in t||(t.forEach=c(function(i,o){var a=this,s=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(l){!l.length||l in s||(s[l]=a.getAll(l)).forEach(function(u){i.call(o,u,l,a)})})},"forEach")),"keys"in t||(t.keys=c(function(){return r(this,function(i,o){this.push(o)})},"keys")),"values"in t||(t.values=c(function(){return r(this,function(i,o){this.push(i)})},"values")),"entries"in t||(t.entries=c(function(){return r(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=c(function(){for(var i=this.entries(),o=i.next(),a=o.done,s=[],l=Object.create(null),u,d,f;!a;)f=o.value,d=f[0],s.push(d),d in l||(l[d]=[]),l[d].push(f[1]),o=i.next(),a=o.done;for(s.sort(),u=0;u<s.length;u++)this.delete(s[u]);for(u=0;u<s.length;u++)d=s[u],this.append(d,l[d].shift())},"sort"));function r(n,i){var o=[];return n.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var a=o.shift();return{done:a===void 0,value:a}}}}c(r,"iterator"),function(n){var i=n.defineProperty,o=n.getOwnPropertyDescriptor,a=c(function(f){function p(b,y){t.append.call(this,b,y),b=this.toString(),f.set.call(this._usp,b?"?"+b:"")}c(p,"append");function g(b){t.delete.call(this,b),b=this.toString(),f.set.call(this._usp,b?"?"+b:"")}c(g,"del");function _(b,y){t.set.call(this,b,y),b=this.toString(),f.set.call(this._usp,b?"?"+b:"")}return c(_,"set"),function(b,y){return b.append=p,b.delete=g,b.set=_,i(b,"_usp",{configurable:!0,writable:!0,value:y})}},"createSearchParamsPollute"),s=c(function(f){return function(p,g){return i(p,"_searchParams",{configurable:!0,writable:!0,value:f(g,p)}),g}},"createSearchParamsCreate"),l=c(function(f){var p=f.append;f.append=t.append,URLSearchParams.call(f,f._usp.search.slice(1)),f.append=p},"updateSearchParams"),u=c(function(f,p){if(!(f instanceof p))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+p.name)},"verifySearchParams"),d=c(function(f){var p=f.prototype,g=o(p,"searchParams"),_=o(p,"href"),b=o(p,"search"),y;!g&&b&&b.set&&(y=s(a(b)),n.defineProperties(p,{href:{get:function(){return _.get.call(this)},set:function(x){var C=this._searchParams;_.set.call(this,x),C&&l(C)}},search:{get:function(){return b.get.call(this)},set:function(x){var C=this._searchParams;b.set.call(this,x),C&&l(C)}},searchParams:{get:function(){return u(this,f),this._searchParams||y(this,new URLSearchParams(this.search.slice(1)))},set:function(x){u(this,f),y(this,x)}}}))},"upgradeClass");try{d(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&d(URL)}catch(f){}}(Object)})(Nl.URLSearchParams.prototype,Object);const S0=Nl.URLSearchParams;var Ml,cx=new Uint8Array(16);function lx(){if(!Ml&&(Ml=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Ml))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ml(cx)}c(lx,"rng");const ux=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function dx(t){return typeof t=="string"&&ux.test(t)}c(dx,"validate");const hx=dx;for(var Sr=[],Wh=0;Wh<256;++Wh)Sr.push((Wh+256).toString(16).substr(1));function fx(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(Sr[t[e+0]]+Sr[t[e+1]]+Sr[t[e+2]]+Sr[t[e+3]]+"-"+Sr[t[e+4]]+Sr[t[e+5]]+"-"+Sr[t[e+6]]+Sr[t[e+7]]+"-"+Sr[t[e+8]]+Sr[t[e+9]]+"-"+Sr[t[e+10]]+Sr[t[e+11]]+Sr[t[e+12]]+Sr[t[e+13]]+Sr[t[e+14]]+Sr[t[e+15]]).toLowerCase();if(!hx(r))throw TypeError("Stringified UUID is invalid");return r}c(fx,"stringify");const px=fx;function gx(t,e,r){t=t||{};var n=t.random||(t.rng||lx)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return px(n)}c(gx,"v4");const C0=gx;var mx=__webpack_require__(6822);const nt=(0,m.loadMessageBundle)(),zh=60,qh=zh*60,$s=qh*24,E0=$s*7,R0=$s*30,A0=$s*365;function Bs(t,e){typeof t!="number"&&(t=t.getTime());const r=Math.round((new Date().getTime()-t)/1e3);if(r<-30)return nt("date.fromNow.in","in {0}",Bs(new Date().getTime()+r*1e3,{ago:!1,short:e==null?void 0:e.short}));if(r<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?nt("date.fromNow.seconds.short.ago","secs ago"):nt("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?nt("date.fromNow.now.short","now"):nt("date.fromNow.now","Just now");let n;return r<zh?(n=r,(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.seconds.singular.short.ago","{0} sec ago",n):nt("date.fromNow.seconds.singular.ago","{0} second ago",n):(e==null?void 0:e.short)?nt("date.fromNow.seconds.plural.short.ago","{0} secs ago",n):nt("date.fromNow.seconds.plural.ago","{0} seconds ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.seconds.singular.short","{0} sec",n):nt("date.fromNow.seconds.singular","{0} second",n):(e==null?void 0:e.short)?nt("date.fromNow.seconds.plural.short","{0} secs",n):nt("date.fromNow.seconds.plural","{0} seconds",n)):r<qh?(n=Math.floor(r/zh),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.minutes.singular.short.ago","{0} min ago",n):nt("date.fromNow.minutes.singular.ago","{0} minute ago",n):(e==null?void 0:e.short)?nt("date.fromNow.minutes.plural.short.ago","{0} mins ago",n):nt("date.fromNow.minutes.plural.ago","{0} minutes ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.minutes.singular.short","{0} min",n):nt("date.fromNow.minutes.singular","{0} minute",n):(e==null?void 0:e.short)?nt("date.fromNow.minutes.plural.short","{0} mins",n):nt("date.fromNow.minutes.plural","{0} minutes",n)):r<$s?(n=Math.floor(r/qh),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.hours.singular.short.ago","{0} hr ago",n):nt("date.fromNow.hours.singular.ago","{0} hour ago",n):(e==null?void 0:e.short)?nt("date.fromNow.hours.plural.short.ago","{0} hrs ago",n):nt("date.fromNow.hours.plural.ago","{0} hours ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.hours.singular.short","{0} hr",n):nt("date.fromNow.hours.singular","{0} hour",n):(e==null?void 0:e.short)?nt("date.fromNow.hours.plural.short","{0} hrs",n):nt("date.fromNow.hours.plural","{0} hours",n)):r<E0?(n=Math.floor(r/$s),(e==null?void 0:e.ago)?n===1?nt("date.fromNow.days.singular.ago","{0} day ago",n):nt("date.fromNow.days.plural.ago","{0} days ago",n):n===1?nt("date.fromNow.days.singular","{0} day",n):nt("date.fromNow.days.plural","{0} days",n)):r<R0?(n=Math.floor(r/E0),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.weeks.singular.short.ago","{0} wk ago",n):nt("date.fromNow.weeks.singular.ago","{0} week ago",n):(e==null?void 0:e.short)?nt("date.fromNow.weeks.plural.short.ago","{0} wks ago",n):nt("date.fromNow.weeks.plural.ago","{0} weeks ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.weeks.singular.short","{0} wk",n):nt("date.fromNow.weeks.singular","{0} week",n):(e==null?void 0:e.short)?nt("date.fromNow.weeks.plural.short","{0} wks",n):nt("date.fromNow.weeks.plural","{0} weeks",n)):r<A0?(n=Math.floor(r/R0),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.months.singular.short.ago","{0} mo ago",n):nt("date.fromNow.months.singular.ago","{0} month ago",n):(e==null?void 0:e.short)?nt("date.fromNow.months.plural.short.ago","{0} mos ago",n):nt("date.fromNow.months.plural.ago","{0} months ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.months.singular.short","{0} mo",n):nt("date.fromNow.months.singular","{0} month",n):(e==null?void 0:e.short)?nt("date.fromNow.months.plural.short","{0} mos",n):nt("date.fromNow.months.plural","{0} months",n)):(n=Math.floor(r/A0),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?nt("date.fromNow.years.singular.short.ago","{0} yr ago",n):nt("date.fromNow.years.singular.ago","{0} year ago",n):(e==null?void 0:e.short)?nt("date.fromNow.years.plural.short.ago","{0} yrs ago",n):nt("date.fromNow.years.plural.ago","{0} years ago",n):n===1?(e==null?void 0:e.short)?nt("date.fromNow.years.singular.short","{0} yr",n):nt("date.fromNow.years.singular","{0} year",n):(e==null?void 0:e.short)?nt("date.fromNow.years.plural.short","{0} yrs",n):nt("date.fromNow.years.plural","{0} years",n))}c(Bs,"fromNow");var I0,Fr;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Fr||(Fr={}));class k0{constructor(){this[I0]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,r=Fr.None){const n=this._map.get(e);if(!!n)return r!==Fr.None&&this.touch(n,r),n.value}set(e,r,n=Fr.None){let i=this._map.get(e);if(i)i.value=r,n!==Fr.None&&this.touch(i,n);else{switch(i={key:e,value:r,next:void 0,previous:void 0},n){case Fr.None:this.addItemLast(i);break;case Fr.First:this.addItemFirst(i);break;case Fr.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const r=this._map.get(e);if(!!r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){const n=this._state;let i=this._head;for(;i;){if(r?e.bind(r)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.key,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.value,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:[r.key,r.value],done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}[(I0=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==Fr.First&&r!==Fr.Last)){if(r===Fr.First){if(e===this._head)return;const n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===Fr.Last){if(e===this._tail)return;const n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(const[r,n]of e)this.set(r,n)}}c(k0,"LinkedMap");class Ci extends k0{constructor(e,r=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=Fr.AsNew){return super.get(e,r)}peek(e){return super.get(e,Fr.None)}set(e,r){return super.set(e,r,Fr.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}c(Ci,"LRUCache");class T0{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await h.commands.executeCommand(this.menuItem.command,e)}}c(T0,"ContinueOnCommandQuickPickItem");var jh;(function(t){async function e(r,n,i){const o=vx(r).map(l=>new T0(l)),a=h.window.createQuickPick(),s=[];try{return await new Promise(u=>{s.push(a.onDidHide(()=>u(void 0)),a.onDidAccept(()=>{if(a.activeItems.length!==0){const[d]=a.activeItems;u(d)}})),a.title=i,a.placeholder=n,a.items=o,a.show()})}finally{a.dispose(),s.forEach(l=>void l.dispose())}}c(e,"show"),t.show=e})(jh||(jh={}));function vx(t){var e,r,n,i,o;const a=new Map,[,s]=t.split(".");for(const u of h.extensions.all){const{name:d,displayName:f,contributes:p}=u.packageJSON;if(!p)continue;const g=(r=(e=p.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:r.continueOn;if(g==null?void 0:g.length){const _=new Map(((n=p.commands)!=null?n:[]).map(b=>[b.command,b]));for(const b of g){if(!b.command)continue;if(a.has(b.command)){te.warn(`Duplicate 'continueOn' menu command: ${b.command}`);continue}const y=_.get(b.command);if(!y){te.warn(`Unable to find 'continueOn' menu command: ${b.command}`);continue}if(!wx(b.when))continue;const x=(o=(i=b.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;a.set(b.command,{extension:{id:d,name:f,builtin:d===s},command:y.command,title:y.title,icon:typeof y.icon=="string"?y.icon:void 0,group:x>0?b.group.substr(0,x):b.group,order:x>0?Number(b.group.substr(x+1)):0,category:y.category})}}}function l(u,d){const f=u.group,p=d.group;if(f!==p){if(!f)return 1;if(!p||f==="navigation")return-1;if(p==="navigation")return 1;const g=f.localeCompare(p);if(g!==0)return g}return u.order<d.order?-1:u.order>d.order?1:u.title.localeCompare(d.title)}return c(l,"compareMenuItems"),[...a.values()].sort(l)}c(vx,"getContinueOnContributions");function wx(t){return t?t.split("&&").every(e=>{const r=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!r)return!0;const[,n,i,o,a,s]=r;if(i){if(i==="false")return!1;if(!ra(i))return!0;const l=ta(i);return n?!l:l}if(o&&a&&s)switch(a){case"==":return!ra(o)||!ra(s)||ta(o)==ta(s);case"!=":return!ra(o)||!ra(s)||ta(o)!=ta(s);case"=~":{if(!ra(o))return!0;const l=ta(o);try{return new RegExp(s.slice(1,-1)).test(String(l!=null?l:""))}catch{return!1}}}return!0}):!0}c(wx,"evaluateWhenClause");class Ll{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,r=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,i)=>{this.resolver=n,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const n=this.task;return this.task=void 0,n()}})),this.timeout=setTimeout(()=>{var n;this.timeout=void 0,(n=this.resolver)==null||n.call(this,void 0)},r),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}c(Ll,"TaskDebouncer");const Zn=(0,m.loadMessageBundle)(),Vh=Symbol("QuickPickGoBack");var Gh;(function(t){async function e(r,n,i,o,a){const s=[],l=r.getRemoteWorkspaceSourceProviders();s.push(...l.map(g=>new Kh(g)));const u=await r.getRecentWorkspaceSourceProviders();if(u){const g=await u.provideSources();if(g){const _=g.reduce((b,y)=>("providerId"in y&&b.push({label:`${y.icon?`${y.icon} `:""}${y.name}`,description:y.description,detail:y.detail,url:y.url,workspace:y.url?void 0:y.workspace,buttons:[Dn.OpenInNewWindow],showMore:void 0}),b),[]);s.push({label:Zn("remote url picker separator recently opened","recently opened"),kind:h.QuickPickItemKind.Separator},..._)}}const d=h.window.createQuickPick();d.ignoreFocusOut=!0;const f=[];let p=n;try{for(;;){const g=await new Promise(_=>{f.push(d.onDidHide(()=>_(void 0)),d.onDidChangeValue(b=>{b=b.trim(),b.length===0?d.items=s:d.activeItems.length===0||d.activeItems[0]instanceof Ta?d.items=[new Ta(r,b),...s]:d.items=s}),d.onDidAccept(()=>{if(d.activeItems.length!==0){const[b]=d.activeItems;(!(b instanceof Ta)||b.validate())&&_(b)}}),d.onDidChangeActive(()=>{if(p!==void 0||!(a==null?void 0:a.allowAddToWorkspace))return;const[b]=d.activeItems;let y=!0;if(b===void 0?y=Boolean(d.value):y=b instanceof Ta,y){if(d.buttons.length===1)return;d.buttons=[Dn.AddToWorkspace]}else{if(d.buttons.length===0)return;d.buttons=[]}}),d.onDidTriggerButton(b=>{if(b===Dn.AddToWorkspace){const[y]=d.activeItems;if(!(y instanceof Ta))return;y.validate()&&(p=ve.AddToWorkspace,_(y))}}),d.onDidTriggerItemButton(b=>{switch(b.button){case Dn.OpenInNewWindow:p=ve.NewWindow,_(b.item);break;default:break}})),d.title=o,d.placeholder=i,d.matchOnDescription=!0,d.items=s,d.sortByLabel=!1,d.show()});if(g instanceof Kh){const _=await g.show(p,g.placeholder,o,a);if(_===Vh)continue;const[b,y]=_;if(b&&"showMore"in b&&b.showMore!==void 0)continue;return[b,y]}if(!(g&&"showMore"in g&&g.showMore!==void 0))return[g,p]}}finally{d.dispose(),f.forEach(g=>void g.dispose())}}c(e,"show"),t.show=e})(Gh||(Gh={}));class Kh{constructor(e){this.provider=e}get label(){return`${this.provider.icon?`${this.provider.icon} `:""}${this.provider.label}`}get placeholder(){return this.provider.placeholder}async show(e,r,n,i){const o=h.window.createQuickPick(),a=new Ll(500),s=[a];async function l(y,x,C,k,T){const O=await y.provideSources(x,C,k,T);return O==null?void 0:O.map(ne=>"showMore"in ne?{label:ne.label,showMore:ne.showMore}:"kind"in ne?ne:{label:`${ne.icon?`${ne.icon} `:""}${ne.name}`,description:ne.description,detail:ne.detail,url:ne.url,workspace:ne.workspace,buttons:[Dn.OpenInNewWindow]})}c(l,"getItems");async function u(y){var x;g=void 0;const C=o.activeItems;o.items=(x=y!=null?y:await b)!=null?x:[],p&&C.length!==0&&(o.activeItems=o.items.filter(k=>C.some(T=>T.url===k.url))),o.busy=!1}c(u,"setItems");let d,f;if(this.provider.provideOrganization&&this.provider.provideProject){if(d=await this.provider.provideOrganization(),!d)return[void 0,void 0];if(f=await this.provider.provideProject(d),!f)return[void 0,void 0]}let p=!1,g,_=e,b=l(this.provider,d,f,void 0,{sort:"updated"});try{const y=await new Promise(x=>{s.push(o.onDidHide(()=>x(void 0)),o.onDidChangeValue(C=>{p=!1,C=C.trim(),o.busy=!0;const k=a.debounce(C?()=>l(this.provider,d,f,C,{sort:"stars"}):()=>b);g===void 0&&(g=k.then(T=>u(T)))}),o.onDidAccept(async()=>{var C;if(o.activeItems.length!==0){const[k]=o.activeItems;if("showMore"in k){await((C=k.showMore)==null?void 0:C.call(k)),b=l(this.provider,d,f,void 0,{sort:"updated"}),await u(await b);return}x(k)}}),o.onDidChangeActive(()=>{if(p=o.activeItems.length!==0,_!==void 0||!(i==null?void 0:i.allowAddToWorkspace))return;const[C]=o.activeItems;if(C===void 0){if(o.buttons.length===1)return;o.buttons=[h.QuickInputButtons.Back]}else{if(o.buttons.length===2)return;o.buttons=[h.QuickInputButtons.Back,Dn.AddToWorkspace]}}),o.onDidTriggerButton(C=>{if(C===h.QuickInputButtons.Back){x(Vh);return}if(C===Dn.AddToWorkspace){const[k]=o.activeItems;if(k===void 0)return;_=ve.AddToWorkspace,x(k)}}),o.onDidTriggerItemButton(C=>{switch(C.button){case Dn.OpenInNewWindow:_=ve.NewWindow,x(C.item);break;default:break}})),o.title=n,o.placeholder=r,o.matchOnDetail=!0,o.ignoreFocusOut=!0,o.sortByLabel=!1,o.buttons=[h.QuickInputButtons.Back],o.busy=!0,o.show(),g=a.debounce(()=>b,0).then(C=>u(C))});return y===Vh?y:[y,_]}finally{o.dispose(),s.forEach(y=>void y.dispose())}}}c(Kh,"RemoteSourceProviderPickerItem");class Ta{constructor(e,r){this.url=r,this.alwaysShow=!0,this.canOpenResult=e.canOpenRemoteUrl(r)}get buttons(){return[Dn.OpenInNewWindow]}get label(){if(this.canOpenResult){const{provider:e,urlType:r}=this.canOpenResult;switch(r){case je.Branch:return Zn("remote url picker open branch","Open Branch from {0} Repository",e.name);case je.Tag:return Zn("remote url picker open tag","Open Tag from {0} Repository",e.name);case je.Commit:return Zn("remote url picker open commit","Open Commit from {0} Repository",e.name);case je.File:return Zn("remote url picker open file","Open File from {0} Repository",e.name);case je.PullRequest:return Zn("remote url picker open pull request","Open Pull Request from {0} Repository",e.name);default:return Zn("remote url picker open repository","Open {0} Repository",e.name)}}return Zn("remote url picker open unknown","Enter a Remote Url")}get description(){return this.url}validate(){return this.canOpenResult!==void 0}}c(Ta,"RemoteUrlQuickPickItem");var Dn;(function(t){t.AddToWorkspace={iconPath:new h.ThemeIcon("plus"),tooltip:Zn("remote url picker button add to workspace","Add to Workspace")},t.OpenInNewWindow={iconPath:new h.ThemeIcon("empty-window"),tooltip:Zn("remote picker open in new window","Open in New Window")}})(Dn||(Dn={}));var yx=Object.defineProperty,bx=Object.getOwnPropertyDescriptor,Xn=c((t,e,r,n)=>{for(var i=n>1?void 0:n?bx(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&yx(e,r,i),i},"messages_decorateClass");const Qt=(0,m.loadMessageBundle)();class un{showGitHubStatus500Message(){return h.window.showErrorMessage(Qt("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),Qt("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void h.window.showErrorMessage(Qt("401 error notification","The provided credentials are either invalid or expired."),Qt("ok","OK"));const r=Qt("401 error notification confirm","Reauthenticate");await h.window.showErrorMessage(Qt("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),r)===r&&e()}async showStatus403Message(e){if(!e)return void h.window.showErrorMessage(Qt("403 error notification","The provided credentials do not have the required access."),Qt("ok","OK"));const r=Qt("403 error notification confirm","Reauthenticate"),n=Qt("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?");await h.window.showErrorMessage(n,r)===r&&e()}async showRepositoryEmptyMessage(e){const r=Qt("repository empty open","Open Repository");await h.window.showErrorMessage(Qt("repository empty","Repository '{0}' is empty and cannot be opened. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestNotFoundMessage(e,r){const n=Qt("pull request not found open","Open Pull Request");await h.window.showErrorMessage(Qt("pull request not found","Unable to find pull request {1} on repository '{0}'. Would you like to open another pull request?",e,r),n)===n&&h.commands.executeCommand("remoteHub.openRepository")}async showPullRequestHeadNotFoundMessage(e,r){const n=Qt("pull request head not found ok","OK");await h.window.showWarningMessage(Qt("pull request head not found","Unable to find the source branch for pull request {1} on repository '{0}'.",e,r),n)}async showRepositoryForbiddenMessage(e){const r=Qt("repository forbidden open","Open Repository");await h.window.showErrorMessage(Qt("repository forbidden","You don't have access to repository '{0}'. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showRepositoryNotFoundMessage(e){const r=Qt("repository not found confirm","Open Repository");await h.window.showErrorMessage(Qt("repository not found","Unable to find repository '{0}'. Would you like to open another repository?",e),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showUnableToOpenRepositoryMessage(e){const r=Qt("unable to open repo confirm","Open Repository");await h.window.showErrorMessage(Qt("unable to open repo","Unable to open repository. {0}. Would you like to open another repository?",String(e)),r)===r&&h.commands.executeCommand("remoteHub.openRepository")}async showProviderNotFoundMessage(e){if(e.id==="azurerepos"&&h.extensions.getExtension("ms-vscode.azure-repos")===void 0){const r=Qt("azure repos install extension","Install");if(await h.window.showInformationMessage(Qt("azure repos not installed","Extension 'Azure Repos' is not installed. Would you like to install the extension and reload the window to open this workspace?"),{modal:!0},r)!==r)return;await h.commands.executeCommand("workbench.extensions.installExtension","ms-vscode.azure-repos"),await h.commands.executeCommand("workbench.action.reloadWindow")}}}c(un,"Messages"),Xn([le(()=>"")],un.prototype,"showGitHubStatus500Message",1),Xn([le(()=>"")],un.prototype,"showStatus401Message",1),Xn([le(()=>"")],un.prototype,"showStatus403Message",1),Xn([le()],un.prototype,"showRepositoryEmptyMessage",1),Xn([le()],un.prototype,"showPullRequestNotFoundMessage",1),Xn([le()],un.prototype,"showPullRequestHeadNotFoundMessage",1),Xn([le()],un.prototype,"showRepositoryForbiddenMessage",1),Xn([le()],un.prototype,"showRepositoryNotFoundMessage",1),Xn([le()],un.prototype,"showUnableToOpenRepositoryMessage",1),Xn([le()],un.prototype,"showProviderNotFoundMessage",1);const Pr=new un,$l=(0,m.loadMessageBundle)();async function dn(t,e){var r,n,i,o,a;if(Ns.instance.sendEvent("openWorkspace",{location:t.location}),t.location===ve.AddToWorkspace){const l=(n=(r=h.workspace.workspaceFolders)==null?void 0:r.length)!=null?n:0;return void h.workspace.updateWorkspaceFolders(l,0,{uri:t.uri,name:t.name})}if(t.location===ve.CurrentWindow&&!(e==null?void 0:e.skipChangesPrompt)){const l=await ss.instance.getWorkspaceProvidersWithChanges();if(l.length){const u={title:$l("continue","Continue")},d={title:$l("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(Cn?$l("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(p=>p.name).join(", ")):$l("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,l.map(p=>p.name).join(", ")),{modal:!0,useCustom:!0},u,d)!==u){Ns.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const s=h.env.remoteName?!0:void 0;return t.filesToOpen&&(t.location===ve.CurrentWindow&&s===void 0&&((i=h.workspace.workspaceFolders)==null?void 0:i.length)===1&&h.workspace.workspaceFolders[0].uri.toString()===t.uri.toString()?await((o=Cu())==null?void 0:o.openPendingFiles(t.uri,t.filesToOpen)):await((a=Cu())==null?void 0:a.setPendingFilesToOpen(t.uri,t.filesToOpen))),Ns.instance.sendEvent("openWorkspace.success",{location:t.location,forceLocalWindow:String(s)}),void h.commands.executeCommand("vscode.openFolder",t.uri,{forceNewWindow:t.location===ve.NewWindow,forceLocalWindow:s})}c(dn,"openWorkspace");const fr=(0,m.loadMessageBundle)();function _x(t,e,r){async function n(o){const[a,s]=await Gh.show(t,o,fr("open repo placeholder","Enter a remote url, or select a remote provider"),o===ve.AddToWorkspace?fr("open repo title add to workspace","Add Remote Repository to Workspace"):fr("open repo title current window","Open Remote Repository"),{allowAddToWorkspace:!1});if(!a){r.sendEvent("openRepository.abort",{reason:"abandoned"});return}try{let l;if(a.workspace)l=a.workspace,l.location=s!=null?s:l.location;else if(l=await t.createWorkspaceForRemoteUrl(a.url,void 0,s!=null?s:o),!l){r.sendEvent("openRepository.abort",{reason:"aborted invalid url"});return}await dn(l)}catch(l){if(r.sendException(l),Z.asVirtualProviderErrorCode(l)===Ve.InvalidCredentialsError){const{action:u}=l;if(u){Pr.showStatus401Message(()=>u());return}}if(l instanceof at){Pr.showRepositoryNotFoundMessage(l.name);return}if(l instanceof Qe){Pr.showRepositoryForbiddenMessage(l.name);return}if(l instanceof we){Pr.showRepositoryEmptyMessage(l.name);return}if(l instanceof vt){Pr.showPullRequestNotFoundMessage(l.name,l.id);return}te.error(l)}}c(n,"openRepository");async function i(o,a,s){if(s==null?void 0:s.workspaceFolder){const u=t.getRepository(s.workspaceFolder,a);if(u!==void 0)return u}const l=a?t.repositories.filter(u=>u.provider.id===a):t.repositories;if(l.length!==0){if(l.length>1){const u=await h.window.showQuickPick(l.map(d=>({label:d.name,description:d.provider.name,repository:d})),{placeHolder:o});return u?u.repository:void 0}return l[0]}}return c(i,"getRepository"),[h.commands.registerCommand("remoteHub.openRepository",()=>(r.sendEvent("command.openRepository"),n())),h.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(r.sendEvent("command.continueOn.openRepository"),n())),h.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{r.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{r.sendEvent("command.continueOn.openRepository")}),h.commands.registerCommand("remoteHub.continueOn",async()=>{const o=await i(fr("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(o===void 0)return;r.sendEvent("command.continueOn");const a=await jh.show(e,fr("continue on placeholder","Choose how you would like to continue working"),fr("continue on title","Continue '{0}' on",o.name));if(!a){r.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await t.changeStoreHasChanges(o.uri)){const u={title:fr("continue","Continue")},d={title:fr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(fr("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0,useCustom:!0},u,d)!==u){r.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const s=t.getRemoteUri(o.provider.id,{repo:o.id}),{HEAD:l}=await o.getMetadata();await a.execute({provider:o.provider,workspaceFolder:o.uri,name:o.name,url:s==null?void 0:s.toString(!0),ref:l.name})}),h.commands.registerCommand("remoteHub.openOnDesktop",async o=>{if(!Cn)return;const a=await i(fr("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,o);if(a===void 0)return;const s=await t.getBestRemoteUri(a.uri);s!==void 0&&(r.sendEvent("command.openOnDesktop"),h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://${e}/open?url=${encodeURIComponent(s.toString(!0))}`)))}),h.commands.registerCommand("remoteHub.openOnWeb",async o=>{if(Cn)return;const a=await i(fr("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,o);if(a===void 0)return;const s=await t.getBestRemoteUri(a.uri);s!==void 0&&(r.sendEvent("command.openOnWeb"),h.env.openExternal(s))}),h.commands.registerCommand("remoteHub.goToRepository",async()=>{var o,a;r.sendEvent("command.goToRepository");const s=await i(fr("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!s)return;const l=await t.getMetadata(s.uri);let u;const d={provider:s.provider,repo:s.id,path:((o=h.window.activeTextEditor)==null?void 0:o.document.uri)&&h.window.activeTextEditor.document.uri.scheme===B.scheme?t.getRelativeFilePath(h.window.activeTextEditor.document.uri):void 0};return l.HEAD.type===Q.Branch&&(((a=h.window.activeTextEditor)==null?void 0:a.document)||l.defaultBranch.name!==l.HEAD.name)?u={...d,branch:l.HEAD.name}:l.HEAD.type===Q.Tag?u={...d,tag:l.HEAD.name}:l.HEAD.type===Q.Commit?u={...d,sha:l.HEAD.sha}:u={...d},h.commands.executeCommand("remoteHub.openOnRemote",u)}),h.commands.registerCommand("remoteHub.openOnRemote",async o=>{r.sendEvent("command.openOnRemote");const{provider:a,...s}=o,l=t.getRemoteUri(a.id,s);if(l){await h.env.openExternal(l);return}h.window.showErrorMessage(fr("open on remote command provider not supported","Unable to open the resource on {0}",o.provider.name))}),h.commands.registerCommand("remoteHub.clone",async o=>{const a=await i(fr("clone placeholder","Choose which repository to clone"),void 0,o);if(a!==void 0){if(r.sendEvent("command.clone"),o===void 0&&await t.changeStoreHasChanges(a.uri)){const s={title:fr("continue","Continue")},l={title:fr("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showWarningMessage(fr("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0,useCustom:!0},s,l)!==s){r.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await t.clone(a.uri)}}),h.commands.registerCommand("remoteHub.refresh",()=>void t.refresh()),h.commands.registerCommand("remoteHub.enableDebugLogging",()=>fe.updateEffective("logLevel",Ce.Debug)),h.commands.registerCommand("remoteHub.disableDebugLogging",()=>fe.updateEffective("logLevel",Ce.Warn)),h.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{t.changeStoreExportDebugInfo()}),h.commands.registerCommand("remoteHub.setContext",async(o,a)=>{if(!o.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await hi(o,a)}),h.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const o={title:fr("continue on","Continue Working On...")};await h.window.showInformationMessage(fr("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},o)===o&&await h.commands.executeCommand("remoteHub.continueOn")}),h.commands.registerCommand("remoteHub.remoteHelp.getStarted",()=>Cn?"https://aka.ms/vscode-web-docs":"https://aka.ms/vscode-remote/remote-repositories/getting-started")]}c(_x,"registerCommands");function Fn(t){return t}c(Fn,"command");async function D0(t,e){return h.commands.executeCommand(t,e)}c(D0,"executeCommand");function Qh(t,e){switch(t){case Q.Branch:case Q.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case Q.Tag:return"$(tag)";case Q.Commit:return"$(git-commit)"}}c(Qh,"headTypeToCodicon");function xx(t){switch(t){case Pe.Active:return"$(layers-active)";case Pe.Match:return"$(layers-dot)";case Pe.Indexed:return"$(layers)"}}c(xx,"indexTypeToCodicon");function Sx(t,e){switch(t){case Q.Branch:case Q.RemoteBranch:return e?new h.ThemeIcon("git-pull-request"):new h.ThemeIcon("git-branch");case Q.Tag:return new h.ThemeIcon("tag");case Q.Commit:return new h.ThemeIcon("git-commit")}}c(Sx,"headTypeToThemeIcon");function*F0(t,e){for(const r of t)yield*e(r)}c(F0,"flatMap");function*Cx(t,e){for(const r of t)e(r)&&(yield r)}c(Cx,"filter");function*Bl(t,e){for(const r of t){const n=e(r);n!=null&&(yield n)}}c(Bl,"filterMap");function Ex(t,e){for(const r of t)if(e(r))return r}c(Ex,"find");function Rx(t,e){let r="";const n=t[Symbol.iterator]();let i=n.next();if(i.done)return r;for(;;){const o=i.value.toString();if(i=n.next(),i.done){r+=o;break}r+=o,r+=e}return r}c(Rx,"join");function*Os(t,e){for(const r of t)yield e(r)}c(Os,"map");function iR(t,e){for(const r of t)if(e(r))return!0;return!1}c(iR,"some");function*Ax(...t){for(const e of t)for(const r of e)yield r}c(Ax,"union");function*Ix(t){const e=new Set;for(const r of t)e.has(r)||(e.add(r),yield r)}c(Ix,"unique");const kx="";function Tx(...t){if(t.length===1){const e=t[0];return e===void 0?kx:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof h.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}c(Tx,"serialize_defaultResolver");function Io(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${r}`;n.value=function(...a){const s=a.length===0?o:`${o}$${(t!=null?t:Tx)(...a)}`;Object.prototype.hasOwnProperty.call(this,s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let l=this[s];const u=c(()=>i.apply(this,a),"run");return l===void 0?l=u():l=l.then(u,u),this[s]=l,l}}}c(Io,"serialize");class qr extends Error{constructor(e){var r;const n=typeof e=="string"?e:Nr.getProviderId(e);super(`No provider registered with ${n}`);this.id=n,(r=Error.captureStackTrace)==null||r.call(Error,this,qr)}}c(qr,"ProviderNotFoundError");class P0{constructor(e,r,n,i,o){this.providerService=e,this.uri=r,this.id=n,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}c(P0,"VirtualRepository");var tn;(function(t){t[t.Clone=-1]="Clone",t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.Tag=4]="Tag"})(tn||(tn={}));var Ft;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(Ft||(Ft={})),function(t){function e(r){return r!==void 0&&(r===t.Indexed||r===t.Match||r===t.Active)}c(e,"hasIndex"),t.hasIndex=e}(Ft||(Ft={}));var Ol;(function(t){function e(r){return r!==void 0&&r.type===3}c(e,"isActive"),t.isActive=e})(Ol||(Ol={}));var rn;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(rn||(rn={}));var ko;(function(t){function e(r){const n=B.decodeAuthority(r).metadata;if(!(n===void 0||n.idx===void 0)){if(n.idx==="latest")return{type:1};if(z(n.idx))return{type:2,sha:n.idx}}}c(e,"decode"),t.decode=e})(ko||(ko={}));var oR=__webpack_require__(5102),Dx=Object.defineProperty,Fx=Object.getOwnPropertyDescriptor,Px=c((t,e,r,n)=>{for(var i=n>1?void 0:n?Fx(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&Dx(e,r,i),i},"providers_decorateClass");const Nx=(0,m.loadMessageBundle)(),Zr=c(class{constructor(t){this.telemetryService=t,this._providers=new Map,this._indexProviders=new Map,this._onDidChangeProviders=new h.EventEmitter,this._onDidChangeChangeStore=new h.EventEmitter,this._onDidChangeWorkspaceRepositories=new h.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new h.EventEmitter,this._onDidChangeRepository=new h.EventEmitter,this._onDidSyncRepository=new h.EventEmitter,this._onDidRefresh=new h.EventEmitter,this._onWillRefresh=new h.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=h.Disposable.from(h.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeChangeStore(){return this._onDidChangeChangeStore.event}get onDidChangeWorkspaceRepositories(){return this._onDidChangeWorkspaceRepositories.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(t){const e=this._repositories.get(E(t.uri));!e||(te.log(`VirtualProviderService.onMetadataChanged(${t.uri.toString()}, reason=${t.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:t.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(t){if(t.added.length)for(const e of t.added){const r=E(e.uri);if(e.uri.scheme!==Zr.scheme||this._repositories.has(r))continue;const n=this.getProvider(e.uri);if(!n)continue;this._repositories.set(r,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),a=new P0(this,e.uri,i,o,n);this._repositories.set(r,a),this._onDidChangeRepositories.fire({added:[a],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:n.id,repositories:this._repositories.size.toString()})}if(t.removed.length)for(const e of t.removed){const r=E(e.uri);if(e.uri.scheme!==Zr.scheme||!this._repositories.has(r))continue;const n=this._repositories.get(r);this._repositories.delete(r),n&&(this._onDidChangeRepositories.fire({added:[],removed:[n]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}hi(Un.HasVirtualFolders,this._repositories.size!==0),hi(Un.VirtualFolderProviders,Rx(Ix(Os(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...Os(this._providers.values(),t=>({id:t.id,name:t.name}))]}get repositories(){return[...this.getRepositories()]}registerVirtualIndexProvider(t,e){if(this._indexProviders.has(t))throw new Error(`Virtual index provider '${t}' has already been registered`);return this._indexProviders.set(t,e),{dispose:()=>{this._indexProviders.delete(t)}}}register(t,e,r,n,i,o,a,s){var l;if(this._providers.has(t))throw new Error(`Provider '${t}' has already been registered`);const u={id:t,name:e,provider:r,fs:n,storage:i,changeStore:o,metadataStore:a,workspaceRepositories:s};this._providers.set(t,u);const d=h.Disposable.from(u.metadataStore.onDidChange(f=>this.onMetadataChanged(f)),u.changeStore.onDidChange(f=>this._onDidChangeChangeStore.fire(f)),u.workspaceRepositories.onDidChange(async()=>{const f=await this.workspaceRepositoriesGetRepositories();hi(Un.HasRecentRepositories,f.length>0),this._onDidChangeWorkspaceRepositories.fire()}));return this._onDidChangeProviders.fire({added:[u],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:t}),this.onWorkspaceFoldersChanged({added:(l=h.workspace.workspaceFolders)!=null?l:[],removed:[]}),{dispose:()=>{this._providers.delete(t);const f=[];for(const[p,g]of[...this._repositories])(g==null?void 0:g.provider.id)===t&&(this._repositories.delete(p),f.push(g));this._onDidChangeRepositories.fire({added:[],removed:f}),this._onDidChangeProviders.fire({added:[],removed:[u]}),d.dispose()}}}refresh(){if(this._providers.size===0)return;const t=[],e=[];for(const r of this._providers.values()){t.push(...Os(this.getRepositories(r.id),i=>i.uri));const n=this._indexProviders.get(r.id);n!==void 0&&e.push(n)}this._onWillRefresh.fire(t),t.forEach(r=>this.getMetadataStore(r).refresh()),e.forEach(r=>r.refresh(t)),this._onDidRefresh.fire(t)}getRegisteredProvider(t){const e=this.getProvider(t);return e?{id:e.id,name:e.name}:void 0}getRepository(t,e){const r=h.workspace.getWorkspaceFolder(t);if(!r||r.uri.scheme!==Zr.scheme)return;const n=this._repositories.get(E(r.uri));if(!(e!==void 0&&(n==null?void 0:n.provider.id)!==e))return n!=null?n:void 0}getRepositories(t){return Cx(this._repositories.values(),e=>e!==null&&(!t||e.provider.id===t))}hasProvider(t,e){const r=typeof t=="string"?t:Zr.getProviderId(t),n=this._providers.get(r);return e!==void 0&&(n==null?void 0:n.id)!==e?!1:n!==void 0}isReadonly(t){var e;return Boolean((e=this.getProvider(t))==null?void 0:e.provider.isReadonly)}getProvider(t){const e=typeof t=="string"?t:Zr.getProviderId(t);return this._providers.get(e)}getRepositoryProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.provider;if(r)return r;throw new qr(t)}getChangeStore(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.changeStore;if(r)return r;throw new qr(t)}getMetadataStore(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.metadataStore;if(r)return r;throw new qr(t)}getWorkspaceRepositories(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.workspaceRepositories;if(r)return r;throw new qr(t)}getFileSystemProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.fs;if(r)return r;throw new qr(t)}getStorageService(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.storage;if(r)return r;throw new qr(t)}async getRecentWorkspaceSourceProviders(){const t=[];for(const[,e]of this._providers.entries()){const r=await e.workspaceRepositories.getRemoteWorkspaceSourceProvider(e.id);t.push(...r!=null?r:[])}if(t.length!==0)return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:Nx("pick","Choose a recent repository"),provideSources:function(e,r,n,i){return t.sort((o,a)=>a.timestamp-o.timestamp).map(o=>({providerId:o.provider.id,name:o.name,icon:"$(repo)",description:Bs(o.timestamp,{ago:!0}),detail:`${o.provider.name}${o.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${o.pullRequest.id}`:""}${B.isCanonicalUri(o.uri)?"":`\xA0\xA0\u2022\xA0\xA0${Qh(o.ref.type)} ${o.ref.name}`}\xA0\xA0\u2022\xA0\xA0${y0(o.changes)}${o.idx?`\xA0\xA0\u2022\xA0\xA0${xx(o.idx.type)}`:""}`,workspace:{uri:o.uri,name:o.name,location:ve.CurrentWindow}}))}}}getRemoteWorkspaceSourceProviders(t){var e,r,n,i;return t?(i=(n=(e=this.getProvider(t))==null?void 0:(r=e.provider).getRemoteWorkspaceSourceProviders)==null?void 0:n.call(r))!=null?i:[]:[...F0(this._providers.values(),o=>{var a,s,l;return(l=(s=(a=o.provider).getRemoteWorkspaceSourceProviders)==null?void 0:s.call(a))!=null?l:[]})]}isInWorkspace(t){return this.getVirtualWorkspaceUri(t)!==void 0}getAuthentication(t){const e=this.getProvider(t);if(!e)throw new qr(t);return e==null?void 0:e.provider.getAuthentication(t)}canOpenRemoteUrl(t,e){if(e){const r=this.getProvider(e),n=r==null?void 0:r.provider.canOpenRemoteUrl(t);return n!==void 0?{provider:r,urlType:n}:void 0}for(const r of this._providers.values()){const n=r.provider.canOpenRemoteUrl(t);if(n!==void 0)return{provider:r,urlType:n}}}async createWorkspaceForRemoteUrl(t,e,r=ve.CurrentWindow){var n;const i=this.canOpenRemoteUrl(t,e);return(n=i==null?void 0:i.provider)==null?void 0:n.provider.createWorkspaceForRemoteUrl(t,r)}createProviderUri(t,e,r){return B.getProviderUri(this.getRepositoryProvider(t).createVirtualUri(Zr.baseVirtualWorkspaceUri,e,r))}createRelativeProviderUri(t,e){return B.getProviderUri(this.createRelativeUri(t,e))}createRelativeUri(t,e){const r=this.getProviderRootUri(t);let n=`${r.path}/`;n.endsWith("/")&&(n=n.slice(0,-1));const i=r.with({path:`${r.path}/${e.startsWith("/")?e.substr(1):e}`});return t.scheme===Zr.scheme?B.getVirtualUri(i):i}createRelativeVirtualUri(t,e){return B.getVirtualUri(this.createRelativeUri(t,e))}createVirtualUri(t,e,r){return this.getRepositoryProvider(t).createVirtualUri(Zr.baseVirtualWorkspaceUri,e,r)}async getBestRemoteUri(t,e){const{provider:r,repo:n,ref:i}=this.getVirtualUriMetadata(t);if(e===tn.Repository)return this.getRemoteUri(r.id,{repo:n});if(e===tn.Clone)return this.getRemoteUri(r.id,{repo:n,clone:!0});if(e===tn.PullRequest||e===void 0&&(i==null?void 0:i.type)===De.PullRequest){if((i==null?void 0:i.type)===De.PullRequest)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(t);if(e===tn.PullRequest&&o)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:o.id}})}if(e===tn.Branch||e===void 0&&(i==null?void 0:i.type)===De.Branch){if((i==null?void 0:i.type)===De.Branch)return this.getRemoteUri(r.id,{repo:n,branch:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===Q.Branch||o.type===Q.RemoteBranch&&e===tn.Branch)return this.getRemoteUri(r.id,{repo:n,branch:o.branch.name})}if(e===tn.Tag||e===void 0&&(i==null?void 0:i.type)===De.Tag){if((i==null?void 0:i.type)===De.Tag)return this.getRemoteUri(r.id,{repo:n,tag:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===Q.Tag)return this.getRemoteUri(r.id,{repo:n,tag:o.detached.name})}if(e===tn.Commit||e===void 0&&((i==null?void 0:i.type)===De.Commit||(i==null?void 0:i.type)===De.Tree&&z(i.id))){if((i==null?void 0:i.type)===De.Commit||(i==null?void 0:i.type)===De.Tree&&z(i.id))return this.getRemoteUri(r.id,{repo:n,sha:i.id});const{HEAD:o}=await this.getMetadata(t);if(e===tn.Commit||o.type===Q.Commit)return this.getRemoteUri(r.id,{repo:n,sha:o.sha})}if(e===void 0)return this.getRemoteUri(r.id,{repo:n})}getCanonicalUri(t){let{authority:e}=t;const r=e.indexOf(Zr.authoritySeparator);return r!==-1&&(e=e.substr(0,r)),t.with({authority:e})}getRemoteUri(t,e){var r,n;return(n=(r=this.getRepositoryProvider(t)).getRemoteUri)==null?void 0:n.call(r,e)}getProviderRootUri(t){return t=B.getProviderUri(t),this.getRepositoryProvider(t).getProviderRootUri(t)}getRelativeFilePath(t,e){return e=B.getProviderUri(e!=null?e:t),this.getRepositoryProvider(e).getRelativeFilePath(t,e)}getVirtualUriMetadata(t){return this.getRepositoryProvider(t).getVirtualUriMetadata(t)}getVirtualCanonicalRootUri(t){const e=B.getVirtualUri(this.getProviderRootUri(t));let{authority:r}=e;const n=r.indexOf(Zr.authoritySeparator);return n!==-1&&(r=r.substr(0,n)),e.with({authority:r})}getVirtualRootUri(t){return B.getVirtualUri(this.getProviderRootUri(t))}getVirtualWorkspaceUri(t){var e;return(e=h.workspace.getWorkspaceFolder(B.getVirtualUri(t)))==null?void 0:e.uri}createIGitRepository(t,e,r){var n,i;const o=this.getChangeStore(t);return(i=(n=this.getRepositoryProvider(t)).createIGitRepository)==null?void 0:i.call(n,t,e,r,o)}async getCommitOperations(t,e){const r=this.getChangeStore(t);let n;return(e==null?void 0:e.staged)?(n=await r.getStagedChanges(t),n.length===0&&e.staged==="auto"&&(n=await r.getChanges(t))):n=await r.getChanges(t),n.map(o=>{const a=this.getRelativeFilePath(t,o.uri);switch(o.type){case q.Created:return{type:o.type,path:a,fileType:o.fileType,content:r.readFile(o.uri).then(s=>s!=null?s:new Uint8Array)};case q.Changed:return{type:o.type,path:a,fileType:o.fileType,content:r.readFile(o.uri).then(async s=>{if(!s)throw new Error("No working content for created or changed commit operation");if(await Br(s)!==o.hash)throw new Error("Working file content hash does not match expected file content hash");return s})};case q.Deleted:return{type:o.type,path:a,fileType:o.fileType,content:void 0}}})}async getMetadata(t){return{...await this.getMetadataCore(this.getVirtualRootUri(t)),path:this.getRelativeFilePath(t,t)}}async getIndexMetadata(t){const e=this.getIndexProvider(t);return e?e.getIndexMetadata(t):void 0}getModeConfig(t,e,r){return fe.getMode(this.getVirtualRootUri(t),e,Boolean(r))}async getModeRefType(t,e){return t=this.getVirtualRootUri(t),this.getRepositoryProvider(t).getModeRefType(t,e)}getIndexProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.id;return r?this._indexProviders.get(r):void 0}async getMetadataCore(t){const e=E(t);let r=this.pendingMetadataRequests.get(e);if(r)return r;let{revision:n,cachedMetadata:i}=await this.getMetadataStore(t).get(t);if(i!==void 0)return i;const o=this.getProvider(t);if(!o)throw new qr(t);const a=ko.decode(t);(a==null?void 0:a.type)===rn.SHA&&(n=a.sha),r=o.provider.createMetadata(t,n),this.pendingMetadataRequests.set(e,r);try{const s=await r;return await this.updateMetadataCore(t,s,{silent:!0}),s}finally{this.pendingMetadataRequests.delete(e)}}async updateMetadata(t,e){const r=new Fe(`VirtualProviderService.updateMetadata(${t.toString()})`,{},e.HEAD.sha);try{await this.getMetadataStore(t).set(B.getVirtualUri(t),e.HEAD.sha,e)}finally{r.stop()}}updateMetadataCore(t,e,r){return this.getMetadataStore(t).set(B.getVirtualUri(t),e.HEAD.sha,e,r)}async clone(t){const e=await this.getBestRemoteUri(t,tn.Clone);if(!e)throw new Error("No url found for clone");if(Cn)return void h.env.openExternal(h.Uri.parse(`${h.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(e.toString(!0))}`));const r=c(async n=>{try{await n.activate(),await h.commands.executeCommand("git.clone",e.toString(!0))}catch(i){te.error(i,"Unable to clone repository")}},"cloneRepository");if(h.workspace.isTrusted){const n=h.extensions.getExtension("vscode.git");if(n)await r(n);else throw new Error("Git extension not found")}else{const n=h.extensions.onDidChange(async()=>{const o=h.extensions.getExtension("vscode.git");o&&(await r(o),n.dispose())});await h.workspace.requestWorkspaceTrust()||n.dispose()}}createBranch(t,e,r,n){return this.getRepositoryProvider(t).createBranch(t,e,r,n)}createCommit(t,e,r,n){return this.getRepositoryProvider(t).createCommit(t,e,r,n)}createAndPushCommit(t,e,r,n,i,o){return this.getRepositoryProvider(t).createAndPushCommit(t,e,r,n,i,o)}createPullRequest(t,e,r,n,i){return this.getRepositoryProvider(t).createPullRequest(t,e,r,n,i)}fetch(t,e){return this.getRepositoryProvider(t).fetch(t,e)}async fetchOrSync(t){await this.getChangeStore(t).hasChanges(t)?await this.fetch(t):await this.sync(t,{reason:"invoked"})}fork(t){return this.getRepositoryProvider(t).fork(t)}getBranches(t,e){return this.getRepositoryProvider(t).getBranches(t,e)}getCommit(t,e){return this.getRepositoryProvider(t).getCommit(t,e)}getCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.getCommits(t,e)}compareCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.compareCommits(t,e)}getFileContent(t,e,r){return this.getRepositoryProvider(t).getFileContent(t,e,r)}getFork(t){return this.getRepositoryProvider(t).getFork(t)}async getIncomingChanges(t){var e,r,n;return(n=(r=(e=this.getRepositoryProvider(t)).getIncomingChanges)==null?void 0:r.call(e,t))!=null?n:[]}getPullRequest(t,e){return this.getRepositoryProvider(t).getPullRequest(t,e)}getTags(t,e){return this.getRepositoryProvider(t).getTags(t,e)}getSnapshots(t,e){var r,n;return(n=(r=this.getIndexProvider(t))==null?void 0:r.getSnapshots(t,e))!=null?n:Promise.resolve([])}async getTarGz(t,e){var r,n;return(n=(r=this.getRepositoryProvider(t)).getTarGz)==null?void 0:n.call(r,t,e)}pushCommit(t,e,r,n){return this.getRepositoryProvider(t).pushCommit(t,e,r,n)}switchTo(t,e,r){return this.getRepositoryProvider(t).switchTo(t,e,r)}async sync(t,e){const r=this._repositories.get(E(t));r&&this._onDidSyncRepository.fire({repository:r,syncing:!0});try{const n=this.getProvider(t),i=this.getIndexProvider(t);if(n===void 0)throw new qr(t);let{to:o,reason:a,...s}=e!=null?e:{};return o===void 0&&i&&(o=await i.resolveIndexRef(t,a==="user")),await n.provider.sync(t,this.getChangeStore(t),{conflictResolution:ot.Abort,...s,to:o})}finally{r&&this._onDidSyncRepository.fire({repository:r,syncing:!1})}}stat(t){return this.getFileSystemProvider(t).stat(t)}readDirectory(t){return this.getFileSystemProvider(t).readDirectory(t)}readFile(t){return this.getFileSystemProvider(t).readFile(t)}watch(t,e){return this.getFileSystemProvider(t).watch(t,e)}changeStoreApplyChangeset(t,e,r){return this.getChangeStore(t).applyChangeset(t,e,r)}changeStoreCreateFile(t,e){return this.getChangeStore(t).createFile(t,e)}changeStoreCreateDirectory(t){return this.getChangeStore(t).createDirectory(t)}changeStoreDeleteDirectory(t){return this.getChangeStore(t).deleteDirectory(t)}changeStoreDeleteFile(t){return this.getChangeStore(t).deleteFile(t)}changeStoreExportDebugInfo(){var t;for(const e of(t=h.workspace.workspaceFolders)!=null?t:[])this.getChangeStore(e.uri).exportDebugInfo(e.uri)}changeStoreGetChange(t){return this.getChangeStore(t).getChange(t)}changeStoreGetChanges(t,e){return this.getChangeStore(t).getChanges(this.stripUriScope(t),e)}changeStoreGetScopedChangeStore(t,e){const r=typeof e=="string"?e:e.workspaceId;return this.getChangeStore(t).getScopedChangeStore(r)}changeStoreGetScopedUri(t,e){const r=typeof e=="string"?e:e.workspaceId;return this.getChangeStore(t).getScopedUri(t,r)}changeStoreHasChanges(t){return this.getChangeStore(t).hasChanges(this.stripUriScope(t))}changeStoreMaybeHasChanges(t,e){return this.getChangeStore(t).maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}changeStoreReadFile(t){return this.getChangeStore(t).readFile(t)}changeStoreResolveDiffCommand(t,e,r,n){return this.getChangeStore(t).resolveDiffCommand(t,e,r,n)}changeStoreStat(t){return this.getChangeStore(t).stat(t)}changeStoreUpdateDirectoryEntries(t,e){return this.getChangeStore(t).updateDirectoryEntries(t,e)}changeStoreWriteFile(t,e,r,n){return this.getChangeStore(t).writeFile(t,e,r,n)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}getFromStorage(t,e){return this.getStorageService(t).get(e)}async storeInStorage(t,e,r){return this.getStorageService(t).store(e,r)}async deleteFromStorage(t,e){return this.getStorageService(t).delete(e)}async workspaceRepositoriesGetRepositoriesByCanonicalUri(){const t=await this.workspaceRepositoriesGetRepositories();return ix(t.sort((e,r)=>r.timestamp-e.timestamp),e=>E(e.canonicalUri))}workspaceRepositoriesRemoveRepository(t){return this.getWorkspaceRepositories(t.uri).remove(t)}workspaceRepositoriesRefresh(){for(const[,t]of this._providers.entries())t.workspaceRepositories.refresh()}async workspaceRepositoriesGetRepositories(){const t=[];for(const[,e]of this._providers.entries()){const r=await e.workspaceRepositories.get();t.push(...r.filter(n=>n.provider.id===e.id))}return t}provideFileSearchResults(t,e,r){return this.getFileSystemProvider(e.folder).provideFileSearchResults(t,e,r)}provideTextSearchResults(t,e,r,n){return this.getFileSystemProvider(e.folder).provideTextSearchResults(t,e,r,n)}static getProviderId(t){const{authority:e}=t,r=e.indexOf(Zr.authoritySeparator);return r!==-1?e.substr(0,r):e}static isCanonicalUri(t){return t.authority.indexOf(Zr.authoritySeparator)===-1}},"_VirtualProviderService");let Nr=Zr;Nr.scheme="vscode-vfs",Nr.authoritySeparator="+",Nr.baseVirtualWorkspaceUri=h.Uri.parse(`${Zr.scheme}://`),Px([Io()],Nr.prototype,"getMetadataCore",1);function Mx(t,e,r){return new ji(new Zh(t),new Zh(e)).ComputeDiff(r).changes}c(Mx,"stringDiff");class Ei{constructor(e,r,n,i){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}c(Ei,"DiffChange");var N0;(function(t){t[t.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",t[t.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",t[t.MAX_UINT_8=255]="MAX_UINT_8",t[t.MAX_UINT_16=65535]="MAX_UINT_16",t[t.MAX_UINT_32=4294967295]="MAX_UINT_32",t[t.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(N0||(N0={}));function M0(t,e){return(e<<5)-e+t|0}c(M0,"numberHash");function Lx(t,e){e=M0(149417,e);for(let r=0,n=t.length;r<n;r++)e=M0(t.charCodeAt(r),e);return e}c(Lx,"stringHash");class Zh{constructor(e){this.source=e}getElements(){const e=this.source,r=new Int32Array(e.length);for(let n=0,i=e.length;n<i;n++)r[n]=e.charCodeAt(n);return r}}c(Zh,"StringDiffSequence");class To{static Assert(e,r){if(!e)throw new Error(r)}}c(To,"Debug");class Do{static Copy(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}static Copy2(e,r,n,i,o){for(let a=0;a<o;a++)n[i+a]=e[r+a]}}c(Do,"MyArray");var L0;(function(t){t[t.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(L0||(L0={}));class Xh{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Ei(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}c(Xh,"DiffChangeHelper");class ji{constructor(e,r,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=r;const[i,o,a]=ji._getElements(e),[s,l,u]=ji._getElements(r);this._hasStrings=a&&u,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const r=e.getElements();if(ji._isStringArray(r)){const n=new Int32Array(r.length);for(let i=0,o=r.length;i<o;i++)n[i]=Lx(r[i],0);return[r,n,!0]}return r instanceof Int32Array?[[],r,!1]:[[],new Int32Array(r),!1]}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[r]:!0}ElementsAreStrictEqual(e,r){if(!this.ElementsAreEqual(e,r))return!1;const n=ji._getStrictElement(this._originalSequence,e),i=ji._getStrictElement(this._modifiedSequence,r);return n===i}static _getStrictElement(e,r){return typeof e.getStrictElement=="function"?e.getStrictElement(r):null}OriginalElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[r]:!0}ModifiedElementsAreEqual(e,r){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[r]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,r,n,i,o){const a=[!1];let s=this.ComputeDiffRecursive(e,r,n,i,a);return o&&(s=this.PrettifyChanges(s)),{quitEarly:a[0],changes:s}}ComputeDiffRecursive(e,r,n,i,o){for(o[0]=!1;e<=r&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&i>=n&&this.ElementsAreEqual(r,i);)r--,i--;if(e>r||n>i){let f;return n<=i?(To.Assert(e===r+1,"originalStart should only be one more than originalEnd"),f=[new Ei(e,0,n,i-n+1)]):e<=r?(To.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),f=[new Ei(e,r-e+1,n,0)]):(To.Assert(e===r+1,"originalStart should only be one more than originalEnd"),To.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),f=[]),f}const a=[0],s=[0],l=this.ComputeRecursionPoint(e,r,n,i,a,s,o),u=a[0],d=s[0];if(l!==null)return l;if(!o[0]){const f=this.ComputeDiffRecursive(e,u,n,d,o);let p=[];return o[0]?p=[new Ei(u+1,r-(u+1)+1,d+1,i-(d+1)+1)]:p=this.ComputeDiffRecursive(u+1,r,d+1,i,o),this.ConcatenateChanges(f,p)}return[new Ei(e,r-e+1,n,i-n+1)]}WALKTRACE(e,r,n,i,o,a,s,l,u,d,f,p,g,_,b,y,x,C){let k=null,T=null,O=new Xh,ne=r,ae=n,Y=g[0]-y[0]-i,me=-1073741824,ce=this.m_forwardHistory.length-1;do{const pe=Y+e;pe===ne||pe<ae&&u[pe-1]<u[pe+1]?(f=u[pe+1],_=f-Y-i,f<me&&O.MarkNextChange(),me=f,O.AddModifiedElement(f+1,_),Y=pe+1-e):(f=u[pe-1]+1,_=f-Y-i,f<me&&O.MarkNextChange(),me=f-1,O.AddOriginalElement(f,_+1),Y=pe-1-e),ce>=0&&(u=this.m_forwardHistory[ce],e=u[0],ne=1,ae=u.length-1)}while(--ce>=-1);if(k=O.getReverseChanges(),C[0]){let pe=g[0]+1,Ae=y[0]+1;if(k!==null&&k.length>0){const Ye=k[k.length-1];pe=Math.max(pe,Ye.getOriginalEnd()),Ae=Math.max(Ae,Ye.getModifiedEnd())}T=[new Ei(pe,p-pe+1,Ae,b-Ae+1)]}else{O=new Xh,ne=a,ae=s,Y=g[0]-y[0]-l,me=1073741824,ce=x?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const pe=Y+o;pe===ne||pe<ae&&d[pe-1]>=d[pe+1]?(f=d[pe+1]-1,_=f-Y-l,f>me&&O.MarkNextChange(),me=f+1,O.AddOriginalElement(f+1,_+1),Y=pe+1-o):(f=d[pe-1],_=f-Y-l,f>me&&O.MarkNextChange(),me=f,O.AddModifiedElement(f+1,_+1),Y=pe-1-o),ce>=0&&(d=this.m_reverseHistory[ce],o=d[0],ne=1,ae=d.length-1)}while(--ce>=-1);T=O.getChanges()}return this.ConcatenateChanges(k,T)}ComputeRecursionPoint(e,r,n,i,o,a,s){let l=0,u=0,d=0,f=0,p=0,g=0;e--,n--,o[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const _=r-e+(i-n),b=_+1,y=new Int32Array(b),x=new Int32Array(b),C=i-n,k=r-e,T=e-n,O=r-i,ae=(k-C)%2==0;y[C]=e,x[k]=r,s[0]=!1;for(let Y=1;Y<=_/2+1;Y++){let me=0,ce=0;d=this.ClipDiagonalBound(C-Y,Y,C,b),f=this.ClipDiagonalBound(C+Y,Y,C,b);for(let Ae=d;Ae<=f;Ae+=2){Ae===d||Ae<f&&y[Ae-1]<y[Ae+1]?l=y[Ae+1]:l=y[Ae-1]+1,u=l-(Ae-C)-T;const Ye=l;for(;l<r&&u<i&&this.ElementsAreEqual(l+1,u+1);)l++,u++;if(y[Ae]=l,l+u>me+ce&&(me=l,ce=u),!ae&&Math.abs(Ae-k)<=Y-1&&l>=x[Ae])return o[0]=l,a[0]=u,Ye<=x[Ae]&&1447>0&&Y<=1447+1?this.WALKTRACE(C,d,f,T,k,p,g,O,y,x,l,r,o,u,i,a,ae,s):null}const pe=(me-e+(ce-n)-Y)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(me,pe))return s[0]=!0,o[0]=me,a[0]=ce,pe>0&&1447>0&&Y<=1447+1?this.WALKTRACE(C,d,f,T,k,p,g,O,y,x,l,r,o,u,i,a,ae,s):(e++,n++,[new Ei(e,r-e+1,n,i-n+1)]);p=this.ClipDiagonalBound(k-Y,Y,k,b),g=this.ClipDiagonalBound(k+Y,Y,k,b);for(let Ae=p;Ae<=g;Ae+=2){Ae===p||Ae<g&&x[Ae-1]>=x[Ae+1]?l=x[Ae+1]-1:l=x[Ae-1],u=l-(Ae-k)-O;const Ye=l;for(;l>e&&u>n&&this.ElementsAreEqual(l,u);)l--,u--;if(x[Ae]=l,ae&&Math.abs(Ae-C)<=Y&&l<=y[Ae])return o[0]=l,a[0]=u,Ye>=y[Ae]&&1447>0&&Y<=1447+1?this.WALKTRACE(C,d,f,T,k,p,g,O,y,x,l,r,o,u,i,a,ae,s):null}if(Y<=1447){let Ae=new Int32Array(f-d+2);Ae[0]=C-d+1,Do.Copy2(y,d,Ae,1,f-d+1),this.m_forwardHistory.push(Ae),Ae=new Int32Array(g-p+2),Ae[0]=k-p+1,Do.Copy2(x,p,Ae,1,g-p+1),this.m_reverseHistory.push(Ae)}}return this.WALKTRACE(C,d,f,T,k,p,g,O,y,x,l,r,o,u,i,a,ae,s)}PrettifyChanges(e){for(let r=0;r<e.length;r++){const n=e[r],i=r<e.length-1?e[r+1].originalStart:this._originalElementsOrHash.length,o=r<e.length-1?e[r+1].modifiedStart:this._modifiedElementsOrHash.length,a=n.originalLength>0,s=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<o&&(!a||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!s||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){const u=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!u)break;n.originalStart++,n.modifiedStart++}let l=[null];if(r<e.length-1&&this.ChangesOverlap(e[r],e[r+1],l)){e[r]=l[0],e.splice(r+1,1),r--;continue}}for(let r=e.length-1;r>=0;r--){const n=e[r];let i=0,o=0;if(r>0){const f=e[r-1];i=f.originalStart+f.originalLength,o=f.modifiedStart+f.modifiedLength}const a=n.originalLength>0,s=n.modifiedLength>0;let l=0,u=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let f=1;;f++){const p=n.originalStart-f,g=n.modifiedStart-f;if(p<i||g<o||a&&!this.OriginalElementsAreEqual(p,p+n.originalLength)||s&&!this.ModifiedElementsAreEqual(g,g+n.modifiedLength))break;const b=(p===i&&g===o?5:0)+this._boundaryScore(p,n.originalLength,g,n.modifiedLength);b>u&&(u=b,l=f)}n.originalStart-=l,n.modifiedStart-=l;const d=[null];if(r>0&&this.ChangesOverlap(e[r-1],e[r],d)){e[r-1]=d[0],e.splice(r,1),r++;continue}}if(this._hasStrings)for(let r=1,n=e.length;r<n;r++){const i=e[r-1],o=e[r],a=o.originalStart-i.originalStart-i.originalLength,s=i.originalStart,l=o.originalStart+o.originalLength,u=l-s,d=i.modifiedStart,f=o.modifiedStart+o.modifiedLength,p=f-d;if(a<5&&u<20&&p<20){const g=this._findBetterContiguousSequence(s,u,d,p,a);if(g){const[_,b]=g;(_!==i.originalStart+i.originalLength||b!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=_-i.originalStart,i.modifiedLength=b-i.modifiedStart,o.originalStart=_+a,o.modifiedStart=b+a,o.originalLength=l-o.originalStart,o.modifiedLength=f-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,r,n,i,o){if(r<o||i<o)return null;const a=e+r-o+1,s=n+i-o+1;let l=0,u=0,d=0;for(let f=e;f<a;f++)for(let p=n;p<s;p++){const g=this._contiguousSequenceScore(f,p,o);g>0&&g>l&&(l=g,u=f,d=p)}return l>0?[u,d]:null}_contiguousSequenceScore(e,r,n){let i=0;for(let o=0;o<n;o++){if(!this.ElementsAreEqual(e+o,r+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,r){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,r){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,r,n,i){const o=this._OriginalRegionIsBoundary(e,r)?1:0,a=this._ModifiedRegionIsBoundary(n,i)?1:0;return o+a}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){const i=new Array(e.length+r.length-1);return Do.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Do.Copy(r,1,i,e.length,r.length-1),i}else{const i=new Array(e.length+r.length);return Do.Copy(e,0,i,0,e.length),Do.Copy(r,0,i,e.length,r.length),i}}ChangesOverlap(e,r,n){if(To.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),To.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){const i=e.originalStart;let o=e.originalLength;const a=e.modifiedStart;let s=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(o=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(s=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new Ei(i,o,a,s),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,i){if(e>=0&&e<i)return e;const o=n,a=i-n-1,s=r%2==0;if(e<0){const l=o%2==0;return s===l?0:1}else{const l=a%2==0;return s===l?i-1:i-2}}}c(ji,"LcsDiff");var Yh;(function(t){function e(n,i){return n instanceof Da?i:new h.Position(i.line,i.character)}c(e,"makePosition"),t.makePosition=e;function r(n,i){return n instanceof Da?i:new h.Range(i.start.line,i.start.character,i.end.line,i.end.character)}c(r,"makeRange"),t.makeRange=r})(Yh||(Yh={}));var $0;(function(t){t[t.index2code=1]="index2code",t[t.code2Index=2]="code2Index"})($0||($0={}));const B0=c(class{constructor(t,e,r,n){this.diffCache=new Ci(32),this.indexDocumentCache=new Ci(32),this.codeDocumentCache=new Ci(32),this.providerService=t,this.rootUri=e,this.index=r,this.code=n,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const t=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return t===void 0?new Map:new Map(t.map(e=>[e.uri.toString(),e.type]))}async needsMapping(t){const e=t.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,t).length!==0}async mapPositionFromCodeToIndex(t,e){const r=t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===q.Created||i===q.Deleted)return;const o=await this.getIndexDocument(r);if(o===void 0)return;const a=this.getDiff(2,o,t);if(a.length===0)return e;const s=t.offsetAt(new h.Position(e.line,e.character));let l=s;for(const p of a){if(p.modifiedStart<=s&&s<p.modifiedStart+p.modifiedLength)return;if(l<p.modifiedStart)break;l=l-(p.modifiedLength-p.originalLength)}const u=o.positionAt(l),d=this.getWordAtOffset(o.lineAt(u.line).text,u.character),f=this.getWordAtOffset(t.lineAt(e.line).text,e.character);if(!(d===void 0||f===void 0||d!==f))return new h.Position(u.line,u.character)}async mapRangeFromIndexToCode(t,e){const r=t instanceof h.Uri?t:t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===q.Created||i===q.Deleted)return;const[o,a]=await Promise.all([this.getIndexDocument(r),this.getCodeDocument(t)]);if(o===void 0||a===void 0)return;const s=this.getDiff(1,o,a);if(s.length===0)return e;const l=o.offsetAt(e.start);let u=l;const d=o.offsetAt(e.end);let f=d;for(const y of s){if(f<y.originalStart)break;const x=y.modifiedLength-y.originalLength;if(y.originalStart<=l){if(l<y.originalStart+y.originalLength)return;u+=x}else if(d<y.originalStart+y.originalLength)return;if(y.originalStart<=d){if(d<y.originalStart+y.originalLength)return;f+=x}}const p=a.positionAt(u),g=a.positionAt(f),_=o.getText(e),b=a.getText(Yh.makeRange(a,{start:p,end:g}));if(_===b)return new h.Range(p.line,p.character,g.line,g.character)}async getIndexDocument(t){return this.getDocument(this.indexDocumentCache,t,this.index)}async getCodeDocument(t){return t instanceof h.Uri?this.getDocument(this.codeDocumentCache,t,this.code):t}async getDocument(t,e,r){let n=t.get(e.toString());if(n!==null)return n!==void 0||(n=this._getDocument(e,r),t.set(e.toString(),n),n.then(i=>{i===void 0&&t.set(e.toString(),null)},void 0)),n}async _getDocument(t,e){const r=t.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,r).then(n=>new Da(t,Number.MAX_VALUE,B0.textDecoder.decode(n)),()=>{})}getDiff(t,e,r){if(e.uri.toString()!==r.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${r.uri.toString()}) are pointing to a different document`);const n=`${t}${e.uri.toString()}`;let i=this.diffCache.get(n);return i!==void 0&&i.original===e.version&&i.modified===r.version||(i={original:e.version,modified:r.version,changes:Mx(e.getText(),r.getText(),!0)},this.diffCache.set(n,i)),i.changes}getWordAtOffset(t,e){let r="findStart",n=0,i=t.length,o=0;for(;o<t.length&&r!=="endFound";){switch(o===e&&(r="findEnd"),t[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(r){case"findStart":n=o+1;break;case"findEnd":i=o,r="endFound";break}break}o++}return r==="endFound"?t.substring(n,i):void 0}},"_DiffMapper");let O0=B0;O0.textDecoder=new TextDecoder("utf8");var U0;(function(t){t[t.LineFeed=10]="LineFeed",t[t.CarriageReturn=13]="CarriageReturn"})(U0||(U0={}));class Da{static computeLineOffsets(e,r,n=0){const i=r?[n]:[];for(let o=0;o<e.length;o++){const a=e.charCodeAt(o);(a===13||a===10)&&(a===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}constructor(e,r,n){this._content=n,this.uri=e,this.version=r,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Da.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}lineAt(e){const r=this.getLineOffsets();if(e>=r.length)return{lineNumber:e,text:""};const n=r[e],i=r[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(n)};const o=this._content.substring(n,i);let a=o.length-1;for(;a>=0&&(o[a]===`
`||o[a]==="\r");)a--;return{lineNumber:e,text:o.substr(0,a+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const r=this.getLineOffsets();let n=0,i=r.length;if(i===0)return{line:0,character:e};for(;n<i;){const a=Math.floor((n+i)/2);r[a]>e?i=a:n=a+1}const o=n-1;return{line:o,character:e-r[o]}}offsetAt(e){const r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;const n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}}c(Da,"TextDocument");var H0;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647})(H0||(H0={}));var Ul;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647})(Ul||(Ul={}));var Yn;(function(t){function e(n,i){return n===Number.MAX_VALUE&&(n=Ul.MAX_VALUE),i===Number.MAX_VALUE&&(i=Ul.MAX_VALUE),{line:n,character:i}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.objectLiteral(i)&&ge.uinteger(i.line)&&ge.uinteger(i.character)}c(r,"is"),t.is=r})(Yn||(Yn={}));var Cr;(function(t){function e(n,i,o,a){if(ge.uinteger(n)&&ge.uinteger(i)&&ge.uinteger(o)&&ge.uinteger(a))return{start:Yn.create(n,i),end:Yn.create(o,a)};if(Yn.is(n)&&Yn.is(i))return{start:n,end:i};throw new Error("Range#create called with invalid arguments["+n+", "+i+", "+o+", "+a+"]")}c(e,"create"),t.create=e;function r(n){var i=n;return ge.objectLiteral(i)&&Yn.is(i.start)&&Yn.is(i.end)}c(r,"is"),t.is=r})(Cr||(Cr={}));var Jh;(function(t){function e(n,i){return{uri:n,range:i}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&Cr.is(i.range)&&(ge.string(i.uri)||ge.undefined(i.uri))}c(r,"is"),t.is=r})(Jh||(Jh={}));var Hl;(function(t){function e(n,i,o,a){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:a}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&Cr.is(i.targetRange)&&ge.string(i.targetUri)&&(Cr.is(i.targetSelectionRange)||ge.undefined(i.targetSelectionRange))&&(Cr.is(i.originSelectionRange)||ge.undefined(i.originSelectionRange))}c(r,"is"),t.is=r})(Hl||(Hl={}));var ef;(function(t){function e(n,i,o,a){return{red:n,green:i,blue:o,alpha:a}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.numberRange(i.red,0,1)&&ge.numberRange(i.green,0,1)&&ge.numberRange(i.blue,0,1)&&ge.numberRange(i.alpha,0,1)}c(r,"is"),t.is=r})(ef||(ef={}));var W0;(function(t){function e(n,i){return{range:n,color:i}}c(e,"create"),t.create=e;function r(n){var i=n;return Cr.is(i.range)&&ef.is(i.color)}c(r,"is"),t.is=r})(W0||(W0={}));var z0;(function(t){function e(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.string(i.label)&&(ge.undefined(i.textEdit)||Vi.is(i))&&(ge.undefined(i.additionalTextEdits)||ge.typedArray(i.additionalTextEdits,Vi.is))}c(r,"is"),t.is=r})(z0||(z0={}));var Us;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Us||(Us={}));var q0;(function(t){function e(n,i,o,a,s){var l={startLine:n,endLine:i};return ge.defined(o)&&(l.startCharacter=o),ge.defined(a)&&(l.endCharacter=a),ge.defined(s)&&(l.kind=s),l}c(e,"create"),t.create=e;function r(n){var i=n;return ge.uinteger(i.startLine)&&ge.uinteger(i.startLine)&&(ge.undefined(i.startCharacter)||ge.uinteger(i.startCharacter))&&(ge.undefined(i.endCharacter)||ge.uinteger(i.endCharacter))&&(ge.undefined(i.kind)||ge.string(i.kind))}c(r,"is"),t.is=r})(q0||(q0={}));var tf;(function(t){function e(n,i){return{location:n,message:i}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&Jh.is(i.location)&&ge.string(i.message)}c(r,"is"),t.is=r})(tf||(tf={}));var Fa;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(Fa||(Fa={}));var Wl;(function(t){t.Unnecessary=1,t.Deprecated=2})(Wl||(Wl={}));var rf;(function(t){function e(r){var n=r;return n!=null&&ge.string(n.href)}c(e,"is"),t.is=e})(rf||(rf={}));var zl;(function(t){function e(n,i,o,a,s,l){var u={range:n,message:i};return ge.defined(o)&&(u.severity=o),ge.defined(a)&&(u.code=a),ge.defined(s)&&(u.source=s),ge.defined(l)&&(u.relatedInformation=l),u}c(e,"create"),t.create=e;function r(n){var i,o=n;return ge.defined(o)&&Cr.is(o.range)&&ge.string(o.message)&&(ge.number(o.severity)||ge.undefined(o.severity))&&(ge.integer(o.code)||ge.string(o.code)||ge.undefined(o.code))&&(ge.undefined(o.codeDescription)||ge.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(ge.string(o.source)||ge.undefined(o.source))&&(ge.undefined(o.relatedInformation)||ge.typedArray(o.relatedInformation,tf.is))}c(r,"is"),t.is=r})(zl||(zl={}));var Hs;(function(t){function e(n,i){for(var o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];var s={title:n,command:i};return ge.defined(o)&&o.length>0&&(s.arguments=o),s}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&ge.string(i.title)&&ge.string(i.command)}c(r,"is"),t.is=r})(Hs||(Hs={}));var Vi;(function(t){function e(o,a){return{range:o,newText:a}}c(e,"replace"),t.replace=e;function r(o,a){return{range:{start:o,end:o},newText:a}}c(r,"insert"),t.insert=r;function n(o){return{range:o,newText:""}}c(n,"del"),t.del=n;function i(o){var a=o;return ge.objectLiteral(a)&&ge.string(a.newText)&&Cr.is(a.range)}c(i,"is"),t.is=i})(Vi||(Vi={}));var Pa;(function(t){function e(n,i,o){var a={label:n};return i!==void 0&&(a.needsConfirmation=i),o!==void 0&&(a.description=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&ge.objectLiteral(i)&&ge.string(i.label)&&(ge.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(ge.string(i.description)||i.description===void 0)}c(r,"is"),t.is=r})(Pa||(Pa={}));var Mr;(function(t){function e(r){var n=r;return typeof n=="string"}c(e,"is"),t.is=e})(Mr||(Mr={}));var Gi;(function(t){function e(o,a,s){return{range:o,newText:a,annotationId:s}}c(e,"replace"),t.replace=e;function r(o,a,s){return{range:{start:o,end:o},newText:a,annotationId:s}}c(r,"insert"),t.insert=r;function n(o,a){return{range:o,newText:"",annotationId:a}}c(n,"del"),t.del=n;function i(o){var a=o;return Vi.is(a)&&(Pa.is(a.annotationId)||Mr.is(a.annotationId))}c(i,"is"),t.is=i})(Gi||(Gi={}));var Ws;(function(t){function e(n,i){return{textDocument:n,edits:i}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&jl.is(i.textDocument)&&Array.isArray(i.edits)}c(r,"is"),t.is=r})(Ws||(Ws={}));var Na;(function(t){function e(n,i,o){var a={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="create"&&ge.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||ge.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||ge.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Mr.is(i.annotationId))}c(r,"is"),t.is=r})(Na||(Na={}));var Ma;(function(t){function e(n,i,o,a){var s={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(s.options=o),a!==void 0&&(s.annotationId=a),s}c(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="rename"&&ge.string(i.oldUri)&&ge.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||ge.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||ge.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Mr.is(i.annotationId))}c(r,"is"),t.is=r})(Ma||(Ma={}));var La;(function(t){function e(n,i,o){var a={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(a.options=i),o!==void 0&&(a.annotationId=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="delete"&&ge.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||ge.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||ge.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Mr.is(i.annotationId))}c(r,"is"),t.is=r})(La||(La={}));var nf;(function(t){function e(r){var n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(function(i){return ge.string(i.kind)?Na.is(i)||Ma.is(i)||La.is(i):Ws.is(i)}))}c(e,"is"),t.is=e})(nf||(nf={}));var ql=function(){function t(e,r){this.edits=e,this.changeAnnotations=r}return c(t,"TextEditChangeImpl"),t.prototype.insert=function(e,r,n){var i,o;if(n===void 0?i=Vi.insert(e,r):Mr.is(n)?(o=n,i=Gi.insert(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Gi.insert(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.replace=function(e,r,n){var i,o;if(n===void 0?i=Vi.replace(e,r):Mr.is(n)?(o=n,i=Gi.replace(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Gi.replace(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.delete=function(e,r){var n,i;if(r===void 0?n=Vi.del(e):Mr.is(r)?(i=r,n=Gi.del(e,r)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(r),n=Gi.del(e,i)),this.edits.push(n),i!==void 0)return i},t.prototype.add=function(e){this.edits.push(e)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),j0=function(){function t(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return c(t,"ChangeAnnotations"),t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(e,r){var n;if(Mr.is(e)?n=e:(n=this.nextId(),r=e),this._annotations[n]!==void 0)throw new Error("Id "+n+" is already in use.");if(r===void 0)throw new Error("No annotation provided for id "+n);return this._annotations[n]=r,this._size++,n},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),aR=function(){function t(e){var r=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new j0(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(n){if(Ws.is(n)){var i=new ql(n.edits,r._changeAnnotations);r._textEditChanges[n.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(n){var i=new ql(e.changes[n]);r._textEditChanges[n]=i})):this._workspaceEdit={}}return c(t,"WorkspaceChange"),Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(e){if(jl.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r={uri:e.uri,version:e.version},n=this._textEditChanges[r.uri];if(!n){var i=[],o={textDocument:r,edits:i};this._workspaceEdit.documentChanges.push(o),n=new ql(i,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[e];if(!n){var i=[];this._workspaceEdit.changes[e]=i,n=new ql(i),this._textEditChanges[e]=n}return n}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new j0,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Pa.is(r)||Mr.is(r)?i=r:n=r;var o,a;if(i===void 0?o=Na.create(e,n):(a=Mr.is(i)?i:this._changeAnnotations.manage(i),o=Na.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t.prototype.renameFile=function(e,r,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;Pa.is(n)||Mr.is(n)?o=n:i=n;var a,s;if(o===void 0?a=Ma.create(e,r,i):(s=Mr.is(o)?o:this._changeAnnotations.manage(o),a=Ma.create(e,r,i,s)),this._workspaceEdit.documentChanges.push(a),s!==void 0)return s},t.prototype.deleteFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;Pa.is(r)||Mr.is(r)?i=r:n=r;var o,a;if(i===void 0?o=La.create(e,n):(a=Mr.is(i)?i:this._changeAnnotations.manage(i),o=La.create(e,n,a)),this._workspaceEdit.documentChanges.push(o),a!==void 0)return a},t}(),V0;(function(t){function e(n){return{uri:n}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&ge.string(i.uri)}c(r,"is"),t.is=r})(V0||(V0={}));var G0;(function(t){function e(n,i){return{uri:n,version:i}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&ge.string(i.uri)&&ge.integer(i.version)}c(r,"is"),t.is=r})(G0||(G0={}));var jl;(function(t){function e(n,i){return{uri:n,version:i}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&ge.string(i.uri)&&(i.version===null||ge.integer(i.version))}c(r,"is"),t.is=r})(jl||(jl={}));var K0;(function(t){function e(n,i,o,a){return{uri:n,languageId:i,version:o,text:a}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&ge.string(i.uri)&&ge.string(i.languageId)&&ge.integer(i.version)&&ge.string(i.text)}c(r,"is"),t.is=r})(K0||(K0={}));var Ri;(function(t){t.PlainText="plaintext",t.Markdown="markdown"})(Ri||(Ri={})),function(t){function e(r){var n=r;return n===t.PlainText||n===t.Markdown}c(e,"is"),t.is=e}(Ri||(Ri={}));var of;(function(t){function e(r){var n=r;return ge.objectLiteral(r)&&Ri.is(n.kind)&&ge.string(n.value)}c(e,"is"),t.is=e})(of||(of={}));var Q0;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Q0||(Q0={}));var Z0;(function(t){t.PlainText=1,t.Snippet=2})(Z0||(Z0={}));var X0;(function(t){t.Deprecated=1})(X0||(X0={}));var Y0;(function(t){function e(n,i,o){return{newText:n,insert:i,replace:o}}c(e,"create"),t.create=e;function r(n){var i=n;return i&&ge.string(i.newText)&&Cr.is(i.insert)&&Cr.is(i.replace)}c(r,"is"),t.is=r})(Y0||(Y0={}));var J0;(function(t){t.asIs=1,t.adjustIndentation=2})(J0||(J0={}));var ev;(function(t){function e(r){return{label:r}}c(e,"create"),t.create=e})(ev||(ev={}));var tv;(function(t){function e(r,n){return{items:r||[],isIncomplete:!!n}}c(e,"create"),t.create=e})(tv||(tv={}));var Vl;(function(t){function e(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}c(e,"fromPlainText"),t.fromPlainText=e;function r(n){var i=n;return ge.string(i)||ge.objectLiteral(i)&&ge.string(i.language)&&ge.string(i.value)}c(r,"is"),t.is=r})(Vl||(Vl={}));var rv;(function(t){function e(r){var n=r;return!!n&&ge.objectLiteral(n)&&(of.is(n.contents)||Vl.is(n.contents)||ge.typedArray(n.contents,Vl.is))&&(r.range===void 0||Cr.is(r.range))}c(e,"is"),t.is=e})(rv||(rv={}));var nv;(function(t){function e(r,n){return n?{label:r,documentation:n}:{label:r}}c(e,"create"),t.create=e})(nv||(nv={}));var iv;(function(t){function e(r,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var a={label:r};return ge.defined(n)&&(a.documentation=n),ge.defined(i)?a.parameters=i:a.parameters=[],a}c(e,"create"),t.create=e})(iv||(iv={}));var zs;(function(t){t.Text=1,t.Read=2,t.Write=3})(zs||(zs={}));var ov;(function(t){function e(r,n){var i={range:r};return ge.number(n)&&(i.kind=n),i}c(e,"create"),t.create=e})(ov||(ov={}));var af;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(af||(af={}));var sf;(function(t){t.Deprecated=1})(sf||(sf={}));var av;(function(t){function e(r,n,i,o,a){var s={name:r,kind:n,location:{uri:o,range:i}};return a&&(s.containerName=a),s}c(e,"create"),t.create=e})(av||(av={}));var sv;(function(t){function e(n,i,o,a,s,l){var u={name:n,detail:i,kind:o,range:a,selectionRange:s};return l!==void 0&&(u.children=l),u}c(e,"create"),t.create=e;function r(n){var i=n;return i&&ge.string(i.name)&&ge.number(i.kind)&&Cr.is(i.range)&&Cr.is(i.selectionRange)&&(i.detail===void 0||ge.string(i.detail))&&(i.deprecated===void 0||ge.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}c(r,"is"),t.is=r})(sv||(sv={}));var Jn;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(Jn||(Jn={}));var cv;(function(t){function e(n,i){var o={diagnostics:n};return i!=null&&(o.only=i),o}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&ge.typedArray(i.diagnostics,zl.is)&&(i.only===void 0||ge.typedArray(i.only,ge.string))}c(r,"is"),t.is=r})(cv||(cv={}));var lv;(function(t){function e(n,i,o){var a={title:n},s=!0;return typeof i=="string"?(s=!1,a.kind=i):Hs.is(i)?a.command=i:a.edit=i,s&&o!==void 0&&(a.kind=o),a}c(e,"create"),t.create=e;function r(n){var i=n;return i&&ge.string(i.title)&&(i.diagnostics===void 0||ge.typedArray(i.diagnostics,zl.is))&&(i.kind===void 0||ge.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Hs.is(i.command))&&(i.isPreferred===void 0||ge.boolean(i.isPreferred))&&(i.edit===void 0||nf.is(i.edit))}c(r,"is"),t.is=r})(lv||(lv={}));var uv;(function(t){function e(n,i){var o={range:n};return ge.defined(i)&&(o.data=i),o}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&Cr.is(i.range)&&(ge.undefined(i.command)||Hs.is(i.command))}c(r,"is"),t.is=r})(uv||(uv={}));var dv;(function(t){function e(n,i){return{tabSize:n,insertSpaces:i}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&ge.uinteger(i.tabSize)&&ge.boolean(i.insertSpaces)}c(r,"is"),t.is=r})(dv||(dv={}));var hv;(function(t){function e(n,i,o){return{range:n,target:i,data:o}}c(e,"create"),t.create=e;function r(n){var i=n;return ge.defined(i)&&Cr.is(i.range)&&(ge.undefined(i.target)||ge.string(i.target))}c(r,"is"),t.is=r})(hv||(hv={}));var fv;(function(t){function e(n,i){return{range:n,parent:i}}c(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&Cr.is(i.range)&&(i.parent===void 0||t.is(i.parent))}c(r,"is"),t.is=r})(fv||(fv={}));var sR=null,pv;(function(t){function e(o,a,s,l){return new $x(o,a,s,l)}c(e,"create"),t.create=e;function r(o){var a=o;return!!(ge.defined(a)&&ge.string(a.uri)&&(ge.undefined(a.languageId)||ge.string(a.languageId))&&ge.uinteger(a.lineCount)&&ge.func(a.getText)&&ge.func(a.positionAt)&&ge.func(a.offsetAt))}c(r,"is"),t.is=r;function n(o,a){for(var s=o.getText(),l=i(a,function(_,b){var y=_.range.start.line-b.range.start.line;return y===0?_.range.start.character-b.range.start.character:y}),u=s.length,d=l.length-1;d>=0;d--){var f=l[d],p=o.offsetAt(f.range.start),g=o.offsetAt(f.range.end);if(g<=u)s=s.substring(0,p)+f.newText+s.substring(g,s.length);else throw new Error("Overlapping edit");u=p}return s}c(n,"applyEdits"),t.applyEdits=n;function i(o,a){if(o.length<=1)return o;var s=o.length/2|0,l=o.slice(0,s),u=o.slice(s);i(l,a),i(u,a);for(var d=0,f=0,p=0;d<l.length&&f<u.length;){var g=a(l[d],u[f]);g<=0?o[p++]=l[d++]:o[p++]=u[f++]}for(;d<l.length;)o[p++]=l[d++];for(;f<u.length;)o[p++]=u[f++];return o}c(i,"mergeSort")})(pv||(pv={}));var $x=function(){function t(e,r,n,i){this._uri=e,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}return c(t,"FullTextDocument"),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(e){if(e){var r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content},t.prototype.update=function(e,r){this._content=e.text,this._version=r,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],r=this._content,n=!0,i=0;i<r.length;i++){n&&(e.push(i),n=!1);var o=r.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<r.length&&r.charAt(i+1)===`
`&&i++}n&&r.length>0&&e.push(r.length),this._lineOffsets=e}return this._lineOffsets},t.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return Yn.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);r[o]>e?i=o:n=o+1}var a=n-1;return Yn.create(a,e-r[a])},t.prototype.offsetAt=function(e){var r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;var n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),ge;(function(t){var e=Object.prototype.toString;function r(g){return typeof g!="undefined"}c(r,"defined"),t.defined=r;function n(g){return typeof g=="undefined"}c(n,"undefined"),t.undefined=n;function i(g){return g===!0||g===!1}c(i,"boolean"),t.boolean=i;function o(g){return e.call(g)==="[object String]"}c(o,"string"),t.string=o;function a(g){return e.call(g)==="[object Number]"}c(a,"number"),t.number=a;function s(g,_,b){return e.call(g)==="[object Number]"&&_<=g&&g<=b}c(s,"numberRange"),t.numberRange=s;function l(g){return e.call(g)==="[object Number]"&&-2147483648<=g&&g<=2147483647}c(l,"integer"),t.integer=l;function u(g){return e.call(g)==="[object Number]"&&0<=g&&g<=2147483647}c(u,"uinteger"),t.uinteger=u;function d(g){return e.call(g)==="[object Function]"}c(d,"func"),t.func=d;function f(g){return g!==null&&typeof g=="object"}c(f,"objectLiteral"),t.objectLiteral=f;function p(g,_){return Array.isArray(g)&&g.every(_)}c(p,"typedArray"),t.typedArray=p})(ge||(ge={}));var qs;(function(t){function e(n){return typeof n=="string"||n instanceof String}c(e,"string"),t.string=e;function r(n){return typeof n=="number"||n instanceof Number}c(r,"number"),t.number=r})(qs||(qs={}));var cf;(function(t){function e(r){const n=r;return n!=null&&(qs.number(n.value)||qs.string(n.value))&&qs.string(n.target)}c(e,"is"),t.is=e})(cf||(cf={}));class gv extends h.Diagnostic{constructor(e,r,n,i){super(e,r,n);this.data=i,this.hasDiagnosticCode=!1}}c(gv,"ProtocolDiagnostic");var ei;(function(t){const e=Object.prototype.toString;function r(d){return typeof d!="undefined"}c(r,"defined"),t.defined=r;function n(d){return d===!0||d===!1}c(n,"boolean"),t.boolean=n;function i(d){return e.call(d)==="[object String]"}c(i,"string"),t.string=i;function o(d){return e.call(d)==="[object Number]"}c(o,"number"),t.number=o;function a(d){return d!==null&&typeof d=="object"}c(a,"objectLiteral"),t.objectLiteral=a;function s(d){return Array.isArray(d)}c(s,"array"),t.array=s;function l(d){return s(d)&&d.every(f=>i(f))}c(l,"stringArray"),t.stringArray=l;function u(d,f){return Array.isArray(d)&&d.every(f)}c(u,"typedArray"),t.typedArray=u})(ei||(ei={}));var Gl;(function(t){function e(r){const n=r;return n&&ei.string(n.language)&&ei.string(n.value)}c(e,"is"),t.is=e})(Gl||(Gl={}));function Bx(t){const e=c(H=>h.Uri.parse(H),"nullConverter"),r=t!=null?t:e;function n(H){return r(H)}c(n,"asUri");function i(H){return H.map(o)}c(i,"asDiagnostics");function o(H){const Le=new gv(f(H.range),H.message,g(H.severity),H.data);return H.code!==void 0&&(rf.is(H.codeDescription)?Le.code={value:H.code,target:n(H.codeDescription.href)}:cf.is(H.code)?(Le.hasDiagnosticCode=!0,Le.code={value:H.code.value,target:n(H.code.target)}):Le.code=H.code),H.source&&(Le.source=H.source),H.relatedInformation&&(Le.relatedInformation=a(H.relatedInformation)),Array.isArray(H.tags)&&(Le.tags=l(H.tags)),Le}c(o,"asDiagnostic");function a(H){return H.map(s)}c(a,"asRelatedInformation");function s(H){return new h.DiagnosticRelatedInformation(Y(H.location),H.message)}c(s,"asDiagnosticRelatedInformation");function l(H){if(!H)return;const Le=[];for(const mt of H){const Rr=u(mt);Rr!==void 0&&Le.push(Rr)}return Le.length>0?Le:void 0}c(l,"asDiagnosticTags");function u(H){switch(H){case Wl.Unnecessary:return h.DiagnosticTag.Unnecessary;case Wl.Deprecated:return h.DiagnosticTag.Deprecated;default:return}}c(u,"asDiagnosticTag");function d(H){if(!!H)return new h.Position(H.line,H.character)}c(d,"asPosition");function f(H){if(!!H)return new h.Range(d(H.start),d(H.end))}c(f,"asRange");function p(H){return H.map(Le=>f(Le))}c(p,"asRanges");function g(H){if(H==null)return h.DiagnosticSeverity.Error;switch(H){case Fa.Error:return h.DiagnosticSeverity.Error;case Fa.Warning:return h.DiagnosticSeverity.Warning;case Fa.Information:return h.DiagnosticSeverity.Information;case Fa.Hint:return h.DiagnosticSeverity.Hint}return h.DiagnosticSeverity.Error}c(g,"asDiagnosticSeverity");function _(H){if(ei.string(H))return new h.MarkdownString(H);if(Gl.is(H))return new h.MarkdownString().appendCodeblock(H.value,H.language);if(Array.isArray(H)){const mt=[];for(const Rr of H){const _c=new h.MarkdownString;Gl.is(Rr)?_c.appendCodeblock(Rr.value,Rr.language):_c.appendMarkdown(Rr),mt.push(_c)}return mt}let Le;switch(H.kind){case Ri.Markdown:return new h.MarkdownString(H.value);case Ri.PlainText:return Le=new h.MarkdownString,Le.appendText(H.value),Le;default:return Le=new h.MarkdownString,Le.appendText(`Unsupported Markup content received. Kind is: ${H.kind}`),Le}}c(_,"asHoverContent");function b(H){if(ei.string(H))return H;switch(H.kind){case Ri.Markdown:return new h.MarkdownString(H.value);case Ri.PlainText:return H.value;default:return`Unsupported Markup content received. Kind is: ${H.kind}`}}c(b,"asDocumentation");function y(H){if(!!H)return new h.Hover(_(H.contents),f(H.range))}c(y,"asHover");function x(H){if(!!H)return new h.TextEdit(f(H.range),H.newText)}c(x,"asTextEdit");function C(H){if(!!H)return H.map(x)}c(C,"asTextEdits");function k(H){if(!H)return;const Le=new h.SignatureHelp;return ei.number(H.activeSignature)?Le.activeSignature=H.activeSignature:Le.activeSignature=0,ei.number(H.activeParameter)?Le.activeParameter=H.activeParameter:Le.activeParameter=0,H.signatures&&(Le.signatures=T(H.signatures)),Le}c(k,"asSignatureHelp");function T(H){return H.map(O)}c(T,"asSignatureInformations");function O(H){const Le=new h.SignatureInformation(H.label);return H.documentation!==void 0&&(Le.documentation=b(H.documentation)),H.parameters!==void 0&&(Le.parameters=ne(H.parameters)),H.activeParameter!==void 0&&(Le.activeParameter=H.activeParameter),Le}c(O,"asSignatureInformation");function ne(H){return H.map(ae)}c(ne,"asParameterInformations");function ae(H){const Le=new h.ParameterInformation(H.label);return H.documentation&&(Le.documentation=b(H.documentation)),Le}c(ae,"asParameterInformation");function Y(H){if(!!H)return new h.Location(r(H.uri),f(H.range))}c(Y,"asLocation");function me(H){if(!!H)return Ae(H)}c(me,"asDeclarationResult");function ce(H){if(!!H)return Ae(H)}c(ce,"asDefinitionResult");function pe(H){if(!H)return;const Le={targetUri:r(H.targetUri),targetRange:f(H.targetSelectionRange),originSelectionRange:f(H.originSelectionRange),targetSelectionRange:f(H.targetSelectionRange)};if(!Le.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return Le}c(pe,"asLocationLink");function Ae(H){if(!!H)return ei.array(H)?H.length===0?[]:Hl.is(H[0])?H.map(Rr=>pe(Rr)):H.map(mt=>Y(mt)):Hl.is(H)?[pe(H)]:Y(H)}c(Ae,"asLocationResult");function Ye(H){if(!!H)return H.map(Le=>Y(Le))}c(Ye,"asReferences");function ue(H){if(!!H)return H.map(Ie)}c(ue,"asDocumentHighlights");function Ie(H){const Le=new h.DocumentHighlight(f(H.range));return ei.number(H.kind)&&(Le.kind=Oe(H.kind)),Le}c(Ie,"asDocumentHighlight");function Oe(H){switch(H){case zs.Text:return h.DocumentHighlightKind.Text;case zs.Read:return h.DocumentHighlightKind.Read;case zs.Write:return h.DocumentHighlightKind.Write}return h.DocumentHighlightKind.Text}c(Oe,"asDocumentHighlightKind");function $e(H,Le){if(!!H)return H.map(mt=>St(mt,Le))}c($e,"asSymbolInformations");function et(H){return H<=af.TypeParameter?H-1:h.SymbolKind.Property}c(et,"asSymbolKind");function it(H){switch(H){case sf.Deprecated:return h.SymbolTag.Deprecated;default:return}}c(it,"asSymbolTag");function ht(H){if(H==null)return;const Le=[];for(const mt of H){const Rr=it(mt);Rr!==void 0&&Le.push(Rr)}return Le.length===0?void 0:Le}c(ht,"asSymbolTags");function St(H,Le){const mt=new h.SymbolInformation(H.name,et(H.kind),f(H.location.range),H.location.uri?r(H.location.uri):Le);return Re(mt,H),H.containerName&&(mt.containerName=H.containerName),mt}c(St,"asSymbolInformation");function Bt(H){if(H!=null)return H.map(vn)}c(Bt,"asDocumentSymbols");function vn(H){var Le;const mt=new h.DocumentSymbol(H.name,(Le=H.detail)!=null?Le:"",et(H.kind),f(H.range),f(H.selectionRange));if(Re(mt,H),H.children!==void 0&&H.children.length>0){const Rr=[];for(const _c of H.children)Rr.push(vn(_c));mt.children=Rr}return mt}c(vn,"asDocumentSymbol");function Re(H,Le){H.tags=ht(Le.tags),Le.deprecated&&(H.tags?H.tags.includes(h.SymbolTag.Deprecated)||(H.tags=H.tags.concat(h.SymbolTag.Deprecated)):H.tags=[h.SymbolTag.Deprecated])}c(Re,"fillTags");function Ue(H){const Le={title:H.title,command:H.command};return H.arguments&&(Le.arguments=H.arguments),Le}c(Ue,"asCommand");function Ke(H){if(!!H)return H.map(Ue)}c(Ke,"asCommands");const qe=new Map;qe.set(Jn.Empty,h.CodeActionKind.Empty),qe.set(Jn.QuickFix,h.CodeActionKind.QuickFix),qe.set(Jn.Refactor,h.CodeActionKind.Refactor),qe.set(Jn.RefactorExtract,h.CodeActionKind.RefactorExtract),qe.set(Jn.RefactorInline,h.CodeActionKind.RefactorInline),qe.set(Jn.RefactorRewrite,h.CodeActionKind.RefactorRewrite),qe.set(Jn.Source,h.CodeActionKind.Source),qe.set(Jn.SourceOrganizeImports,h.CodeActionKind.SourceOrganizeImports);function tt(H){if(H==null)return;let Le=qe.get(H);if(Le)return Le;const mt=H.split(".");Le=h.CodeActionKind.Empty;for(const Rr of mt)Le=Le.append(Rr);return Le}c(tt,"asCodeActionKind");function lt(H){if(H!=null)return H.map(Le=>tt(Le))}c(lt,"asCodeActionKinds");function ct(H){if(H==null)return;const Le=new h.CodeAction(H.title);return H.kind!==void 0&&(Le.kind=tt(H.kind)),H.diagnostics&&(Le.diagnostics=i(H.diagnostics)),H.edit&&(Le.edit=Ct(H.edit)),H.command&&(Le.command=Ue(H.command)),H.isPreferred!==void 0&&(Le.isPreferred=H.isPreferred),Le}c(ct,"asCodeAction");function Ct(H){if(!H)return;const Le=new h.WorkspaceEdit;return H.documentChanges?H.documentChanges.forEach(mt=>{if(Na.is(mt))Le.createFile(r(mt.uri),mt.options);else if(Ma.is(mt))Le.renameFile(r(mt.oldUri),r(mt.newUri),mt.options);else if(La.is(mt))Le.deleteFile(r(mt.uri),mt.options);else if(Ws.is(mt))Le.set(r(mt.textDocument.uri),C(mt.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(mt,void 0,4)}`)}):H.changes&&Object.keys(H.changes).forEach(mt=>{Le.set(r(mt),C(H.changes[mt]))}),Le}c(Ct,"asWorkspaceEdit");function qt(H){return new h.Color(H.red,H.green,H.blue,H.alpha)}c(qt,"asColor");function Jt(H){return new h.ColorInformation(f(H.range),qt(H.color))}c(Jt,"asColorInformation");function $r(H){if(Array.isArray(H))return H.map(Jt)}c($r,"asColorInformations");function Fi(H){const Le=new h.ColorPresentation(H.label);return Le.additionalTextEdits=C(H.additionalTextEdits),H.textEdit&&(Le.textEdit=x(H.textEdit)),Le}c(Fi,"asColorPresentation");function Eu(H){if(Array.isArray(H))return H.map(Fi)}c(Eu,"asColorPresentations");function Va(H){if(H)switch(H){case Us.Comment:return h.FoldingRangeKind.Comment;case Us.Imports:return h.FoldingRangeKind.Imports;case Us.Region:return h.FoldingRangeKind.Region}}c(Va,"asFoldingRangeKind");function wn(H){return new h.FoldingRange(H.startLine,H.endLine,Va(H.kind))}c(wn,"asFoldingRange");function fp(H){if(Array.isArray(H))return H.map(wn)}c(fp,"asFoldingRanges");function pp(H){return new h.SelectionRange(f(H.range),H.parent?pp(H.parent):void 0)}c(pp,"asSelectionRange");function rR(H){if(!Array.isArray(H))return[];const Le=[];for(const mt of H)Le.push(pp(mt));return Le}return c(rR,"asSelectionRanges"),{asUri:n,asDiagnostics:i,asDiagnostic:o,asRange:f,asRanges:p,asPosition:d,asDiagnosticSeverity:g,asDiagnosticTag:u,asHover:y,asTextEdit:x,asTextEdits:C,asSignatureHelp:k,asSignatureInformations:T,asSignatureInformation:O,asParameterInformations:ne,asParameterInformation:ae,asDeclarationResult:me,asDefinitionResult:ce,asLocation:Y,asReferences:Ye,asDocumentHighlights:ue,asDocumentHighlight:Ie,asDocumentHighlightKind:Oe,asSymbolKind:et,asSymbolTag:it,asSymbolTags:ht,asSymbolInformations:$e,asSymbolInformation:St,asDocumentSymbols:Bt,asDocumentSymbol:vn,asCommand:Ue,asCommands:Ke,asCodeAction:ct,asCodeActionKind:tt,asCodeActionKinds:lt,asWorkspaceEdit:Ct,asFoldingRangeKind:Va,asFoldingRange:wn,asFoldingRanges:fp,asColor:qt,asColorInformation:Jt,asColorInformations:$r,asColorPresentation:Fi,asColorPresentations:Eu,asSelectionRange:pp,asSelectionRanges:rR}}c(Bx,"createConverter");const sr=(0,mx.loadMessageBundle)();var ti;(function(t){function e(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}c(e,"externalUri"),t.externalUri=e;function r(n,i){const{provider:o,repo:a}=i instanceof h.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:a})}c(r,"externalIndexUri"),t.externalIndexUri=r})(ti||(ti={}));var Ki;(function(t){function e(i){if(i.HEAD.type===Q.Branch||i.HEAD.type===Q.RemoteBranch)return i.HEAD.name}c(e,"getBranchName"),t.getBranchName=e;function r(i){if(i.HEAD.type!==Q.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}c(r,"getIndexBranchName"),t.getIndexBranchName=r;async function n(i,o,a=pr.timeout){const s=await i.getMetadata(o),l=ti.externalIndexUri(i,s),u=t.getIndexBranchName(s);if(!(l===void 0||u===void 0))return pr.getIndexedTip(l,u,{authentication:i.getAuthentication(o)},a)}c(n,"getIndexedTip"),t.getIndexedTip=n})(Ki||(Ki={}));var js;(function(t){const e=new Ci(1024);function r(a,s,l){let u=e.get(l);return u!==void 0||(u=a.getCommit(s,l),e.set(l,u)),u}c(r,"get"),t.get=r;async function n(a,s,l){const u=[];for(const f of l)u.push(r(a,s,f));const d=[];for(const f of await Promise.all(u))f!==void 0&&d.push(f);return d}c(n,"all"),t.all=n;function i(a,s){const l=a.commitDate,u=s.commitDate;return l===void 0&&u===void 0?0:l===void 0?1:u===void 0?-1:l<u?1:l>u?-1:0}c(i,"sort"),t.sort=i;function o(a){const s=a.authorName!==void 0?`  \u2022  ${a.authorName}`:"",l=a.commitDate!==void 0?`  \u2022  ${Bs(a.commitDate,{ago:!0})}`:"",u=a.branchName!==void 0?` - ${a.branchName}`:"",d=a.tags!==void 0?typeof a.tags=="string"?`  \u2022  ${a.tags}`:`  \u2022  ${a.tags.join(" ")}`:"";return{author:s,date:l,branch:u,tag:d}}c(o,"getCommitInfo"),t.getCommitInfo=o})(js||(js={}));var mv;(function(t){t[t.Unknown=0]="Unknown",t[t.New=1]="New",t[t.Failed=2]="Failed",t[t.Partial=3]="Partial",t[t.InProgress=4]="InProgress",t[t.Complete=5]="Complete",t[t.PartialIndex=6]="PartialIndex",t[t.CompleteIndex=7]="CompleteIndex"})(mv||(mv={}));var Kl;(function(t){function e(n){return{workspaceId:n.WorkspaceId,snapshotId:n.SnapshotId,state:n.State,commitId:n.commitId.toLowerCase(),branchName:r(n.BranchName),creationDate:new Date(n._ts*1e3)}}c(e,"asWorkspaceSnapshot"),t.asWorkspaceSnapshot=e;function r(n){if(n!==null)return n.startsWith("refs/heads/")?n.substr(11):n}c(r,"getBranchName")})(Kl||(Kl={}));var pr;(function(t){t.timeout=5*60*1e3;const e=new Ci(32),r=new Ci(32);async function n(d,f,p,g=t.timeout){const _=await i(d,f,p,g);if(!(_===void 0||_.length===0))return _[0]}c(n,"getIndexedTip"),t.getIndexedTip=n;async function i(d,f,p,g=t.timeout){const _=a(d,f);let b=e.get(_);if(b===void 0||b!==void 0&&Date.now()-b.time>g){const y=hn.getAllWorkspaceSnapshots(d,p,f);b={time:Date.now(),promise:y,snapshots:void 0},e.set(_,b)}if(b.snapshots!==null){if(b.snapshots===void 0){let y=await b.promise;if(y===void 0){b.snapshots=null;return}y.sort((x,C)=>C.creationDate.getTime()-x.creationDate.getTime()),y=y.filter(x=>x.state===5||x.state===3),b.snapshots=y}return b.snapshots}}c(i,"all"),t.all=i;async function o(d,f,p,g,_=t.timeout){const b=d.toString();let y=r.get(b);if(y===null)return;if(y!==void 0)return y;const x=a(d,p),C=e.get(x);if(C!==void 0&&Date.now()-C.time<=_){if(C.snapshots===null)return;const k=C.snapshots!==void 0?C.snapshots:await i(d,p,g);if(k!==void 0){for(const T of k)if(T.commitId===f)return T}return}if(y=await hn.getWorkspaceSnapshot(f,g),y===void 0){r.set(b,null);return}return r.set(b,y),y}c(o,"single"),t.single=o;function a(d,f){return f!==void 0?`${f}\\${d.toString()}`:d.toString()}c(a,"getAllCacheKey");async function s(d,f,p,g=t.timeout){return await o(d,f,void 0,p,g)!==void 0}c(s,"exists"),t.exists=s;async function l(d,f,p,g=t.timeout){return await i(d,f,p,g)!==void 0}c(l,"branch"),t.branch=l;async function u(d,f,p){const g=new Map(p.map(y=>[y.commitId,y])),_=await js.all(d,f.uri,p.map(y=>y.commitId));if(_.length===0)return;const b=[];for(const y of _){const x=g.get(y.hash);x!==void 0&&b.push({...x,commit:y})}if(b.length!==0)return b}c(u,"resolve"),t.resolve=u})(pr||(pr={}));var ri;(function(t){function e(r=!1){return{hoverProvider:r,declarationProvider:r,definitionProvider:r,typeDefinitionProvider:r,referencesProvider:r,documentSymbolProvider:r,foldingRangeProvider:r,diagnosticProvider:r}}c(e,"create"),t.create=e})(ri||(ri={}));var hn;(function(t){const e="v0.1",r="https://prod.richnav.vsengsaas.visualstudio.com/api";async function n(x,C,k){var T;const O=await Ls(x,{method:"POST",body:JSON.stringify(C),headers:{"Content-Type":"application/json",...(await k.authentication).getRichNavigationHeaders(),"x-correlation-id":(T=k.correlationId)!=null?T:C0()}});if(!!O.ok)return O.json()}c(n,"postRequest");async function i(x,C,k){const T=await Ls(x,{method:"POST",body:C,headers:(await k.authentication).getRichNavigationHeaders()});if(!!T.ok)return await T.json()}c(i,"postForm");function o(x,C){return`${r}/${e}/HttpLanguageService/${x}/${C}`}c(o,"makeRequestUrl");async function a(x,C){const k=await Ls(`${r}/${e}/WorkspaceSnapshot?commitId=${x}`,{headers:(await C.authentication).getRichNavigationHeaders()});if(k.ok){const T=await k.json();return{workspaceId:T.workspaceId,snapshotId:T.snapshotId,state:T.state,commitId:x.toLowerCase(),branchName:void 0,creationDate:new Date}}}c(a,"getWorkspaceSnapshot"),t.getWorkspaceSnapshot=a;async function s(x,C,k){const T=new S0;T.append("uriString",x.toString(!0)),k!==void 0&&T.append("branchName",k);try{const O=await i(`${r}/${e}/WorkspaceSnapshot/all`,T,C);return O===void 0?void 0:O.map(Kl.asWorkspaceSnapshot)}catch(O){te.error(O);return}}c(s,"getAllWorkspaceSnapshots"),t.getAllWorkspaceSnapshots=s;async function l(x,C,k){const T=new S0;T.append("uriString",x.toString(!0)),k!==void 0&&T.append("branchName",k);try{const O=await i(`${r}/${e}/WorkspaceSnapshot/latest`,T,C);return O===void 0?void 0:Kl.asWorkspaceSnapshot(O)}catch(O){te.error(O);return}}c(l,"getLatestWorkspaceSnapshot"),t.getLatestWorkspaceSnapshot=l;async function u(x,C,k){try{return n(o(x,"textDocument/capabilities"),C,k)}catch(T){te.error(T);return}}c(u,"capabilities"),t.capabilities=u;async function d(x,C,k){try{return n(o(x,"textDocument/hover"),C,k)}catch(T){te.error(T);return}}c(d,"provideHover"),t.provideHover=d;async function f(x,C,k){try{return n(o(x,"textDocument/definition"),C,k)}catch(T){te.error(T);return}}c(f,"provideDefinition"),t.provideDefinition=f;async function p(x,C,k){try{return n(o(x,"textDocument/declaration"),C,k)}catch(T){te.error(T);return}}c(p,"provideDeclaration"),t.provideDeclaration=p;async function g(x,C,k){try{return n(o(x,"textDocument/typeDefinition"),C,k)}catch(T){te.error(T);return}}c(g,"provideTypeDefinition"),t.provideTypeDefinition=g;async function _(x,C,k){try{return n(o(x,"textDocument/references"),C,k)}catch(T){te.error(T);return}}c(_,"provideReferences"),t.provideReferences=_;async function b(x,C,k){try{return n(o(x,"textDocument/foldingRange"),C,k)}catch(T){te.error(T);return}}c(b,"providerFoldingRanges"),t.providerFoldingRanges=b;async function y(x,C,k){const T=h.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${x}/${C}/assets/designtime`,query:`id=${k}`});try{const O=await Ls(T.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return O.ok?O.text():void 0}catch(O){te.error(O);return}}c(y,"getDesignTimeFileContent"),t.getDesignTimeFileContent=y})(hn||(hn={}));class vv{constructor(e,r){this.providerService=e,this.telemetryService=r,this.metadata=new Map;const n=[];n.push(this.providerService.onDidChangeRepositories(i=>{var o;for(const a of i.added){const s=a.uri,l=fe.getIndexMemento(s);if(l!==void 0){const u=ti.externalIndexUri(this.providerService,s);u!==void 0&&(typeof((o=l.branch)==null?void 0:o.name)=="string"?pr.all(u,l.branch.name,{authentication:this.providerService.getAuthentication(s)}).catch(void 0):typeof l.ref=="string"&&z(l.ref)&&pr.single(u,l.ref,void 0,{authentication:this.providerService.getAuthentication(s)}).catch(void 0))}this.providerService.getMetadata(s).then(u=>{const d={},f=u.pullRequest===void 0?Ki.getIndexBranchName(u):void 0;f!==void 0?d.branch={name:f}:d.ref=u.HEAD.sha,fe.setIndexMemento(s,d).then(void 0,void 0)},void 0)}})),n.push(this.providerService.onDidChangeRepository(i=>{const o=i.repository.uri,a=E(o);this.metadata.delete(a),this.getIndexMetadata(o).catch(void 0)})),this.disposable=h.Disposable.from(...n)}dispose(){this.disposable.dispose()}async resolveIndexRef(e,r){const n=await this.providerService.getModeRefType(e),i=ko.decode(e);if(i!==void 0){if(i.type===rn.Latest)return n===Ee.Branch?this.getIndexedTip(e,r?0:pr.timeout):void 0;if(i.type===rn.SHA){const a=ti.externalIndexUri(this.providerService,e);return a===void 0?void 0:await pr.exists(a,i.sha,{authentication:this.providerService.getAuthentication(e)},r?0:pr.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,n).index===Me.Latest)return this.getIndexedTip(e,r?0:pr.timeout)}refresh(e){for(const r of e)this.metadata.delete(r.toString())}getIndexMetadata(e){const r=this.providerService.getVirtualRootUri(e),n=E(r);let i=this.metadata.get(n);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(n,i)),i}async getIndexedTip(e,r=pr.timeout){const n=await Ki.getIndexedTip(this.providerService,e,r);return n!==void 0?n.commitId:void 0}async createIndexMetadata(e){const r=new Fe(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const n=ti.externalIndexUri(this.providerService,e);if(n===void 0)return;r.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),a=await i;r.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const s=this.providerService.getAuthentication(e),l=a.pullRequest===void 0?Ki.getIndexBranchName(a):void 0,u=await pr.single(n,a.HEAD.sha,l,{authentication:this.providerService.getAuthentication(e)});if(a.HEAD.type===Q.Branch||a.HEAD.type===Q.RemoteBranch){const g=ko.decode(e);if(g!==void 0)return r.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),u===void 0?g.type===rn.Latest?(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),l!==void 0&&await pr.branch(n,l,{authentication:this.providerService.getAuthentication(e)})?{type:Ft.Indexed}:{type:Ft.NotIndexed}):{type:Ft.NotIndexed}:g.type===rn.Latest||g.type===rn.SHA?{type:Ft.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}}:{type:Ft.Match,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}}}r.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const f=this.providerService.getModeConfig(e,await o),p=this.providerService.getVirtualUriMetadata(e);if((f.index===Me.Latest||f.index===Me.Match)&&u!==void 0)return{type:Ft.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}};if(f.index===Me.TipPlusLatest&&p.provider.id==="github"){if(u!==void 0&&u.commitId===a.HEAD.sha)return{type:Ft.Active,sha:Promise.resolve(u.commitId),branch:{name:u.branchName}};if(a.HEAD.type===Q.Branch&&l!==void 0){r.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const g=await pr.all(n,l,{authentication:s});if(g!==void 0&&g.length>0)return{type:Ft.Active,sha:this.computeClosestIndex(e,a.HEAD.sha,g),branch:{name:l}}}}return u!==void 0?{type:Ft.Indexed}:a.HEAD.type===Q.Branch&&(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),l!==void 0&&await pr.branch(n,l,{authentication:s}))?{type:Ft.Indexed}:{type:Ft.NotIndexed}}finally{r.stop()}}async computeClosestIndex(e,r,n){if(n.length===0)throw new Error("At least on snapshot should exist");const i=new Set(n.map(d=>d.commitId)),o=await this.providerService.getCommits(e,{ref:r,limit:100});if(o===void 0)return;let a;for(const d of o.commits)if(d.hash===r){a=d;break}if(a===void 0)return;const s=new Map(o.commits.map(d=>[d.hash,d])),l=[a];let u;for(;l.length>0;){for(u=l.shift();u!==void 0&&!i.has(u.hash);)if(u.parents.length>0){for(let d=1;d<u.parents.length;d++){const f=s.get(u.parents[d]);f!==void 0&&l.push(f)}u=s.get(u.parents[0])}if(u!==void 0)break}return u!==void 0?u.hash:void 0}async getSnapshots(e,r){const n=ti.externalIndexUri(this.providerService,e);if(n===void 0)return[];const i=await pr.all(n,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const a of i)a.branchName!==void 0&&o.push({workspaceId:a.workspaceId,snapshotId:a.snapshotId,hash:a.commitId,branch:{name:a.branchName}});return o}async getStatusBarContributions(e){const r=await this.providerService.getMetadata(e),[n,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,r)]),o=this.providerService.getModeConfig(e,i);if(n===void 0)return[];const{HEAD:a}=r,s=[];if(n!==void 0){let l;const u=[`${W(a.sha)}`];if(n.type===Ft.Active){const d=await n.sha;o.index===Me.Latest||o.index===Me.Match?(l=o.display===Xe.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",u.push(sr("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===Me.TipPlusLatest&&(l="$(layers-dot)",d!==r.HEAD.sha?u.push(sr("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):u.push(sr("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else n.type===Ft.Match?(l="$(layers)",u.push(sr("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):n.type===Ft.Indexed&&(l="$(layers)",u.push(sr("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));l&&s.push(Fn({command:"remoteHub.indexMode.select",title:l,tooltip:u.join(`
`),arguments:[{uri:e}]}))}return s}}c(vv,"RichNavIndexProvider");var Fo;(function(t){let e;function r(){return e=h.window.createStatusBarItem(h.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,h.window.onDidChangeActiveTextEditor(()=>{l()}),h.commands.registerCommand("remoteHub.indexMode.select",d=>{u(d).catch(f=>te.log("Selecting index mode failed.",f))})]}c(r,"create"),t.create=r;const n=new Map;function i(d){n.set(d.key(),d)}c(i,"addService"),t.addService=i;function o(d){n.delete(d.key())}c(o,"removeService"),t.removeService=o;function a(d){return n.get(E(d))}c(a,"getService");async function s(d){for(const f of n.values())if(await f.handles(d))return f}c(s,"getServiceForDocument");async function l(){try{let d=c(function(_){const b=_.lastIndexOf("/");return b<=0?_:_.substr(b+1)},"basename");const f=h.window.activeTextEditor;if(f===void 0){e.hide();return}const p=await s(f.document);if(p===void 0){e.hide();return}const g=await p.isDocumentIndexed(f.document);g===Ql.Indexed?(e.text="$(compass)",e.tooltip=new h.MarkdownString(sr("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",d(f.document.uri.path))),e.show()):g===Ql.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new h.MarkdownString(sr("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",d(f.document.uri.path))),e.show()):e.hide()}catch(d){e.hide()}}c(l,"updateStatusBarItem"),t.updateStatusBarItem=l;async function u(d){var f;const p=d.uri,g=a(p);if(g===void 0)return;const[_,b,y,x]=await Promise.all([g.getBranchName(),g.getMetadata(),g.getIndexMetadata(),g.getModeRefType(p)]);if(y===void 0||!Ft.hasIndex(y.type))return;let C,k=!1;const T=ko.decode(p);(T==null?void 0:T.type)===rn.Latest||(T==null?void 0:T.type)===rn.SHA?(k=!0,C={display:Xe.Browse,index:T.type===rn.Latest?Me.Latest:Me.Match}):C=(f=g.getCurrentIndexMode())!=null?f:g.getModeConfig(p,x);const O=g.getUriMetadata(),ne=sr("current item","{0} current","$(check)"),ae={indexKind:"disable",label:sr("RichNavStatus.disable.label","Disable"),description:C.index===Me.None?`  \u2022  ${ne}`:void 0,detail:sr("RichNavStatus.disable.detail","Disable rich navigation. {0}",O.provider.id==="github"?"Files will be writable.":"Files will be read-only.")};let Y,me;if(x===Ee.PullRequestBranch||x===Ee.PullRequestRemoteBranch||x===Ee.Commit||x===Ee.Tag){const ce={indexKind:"match",label:sr("RichNavStatus.match.label","Current indexed commit - readonly"),description:C.index===Me.Match&&C.display===Xe.Browse?`  \u2022  ${ne}`:void 0,detail:sr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},pe={indexKind:"match+writeable",label:sr("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:C.index===Me.Match&&C.display===Xe.Edit?`  \u2022  ${ne}`:void 0,detail:sr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let Ae=O.provider.id==="github";Ae&&(Ae=b.HEAD.type===Q.RemoteBranch?b.HEAD.branch.remote.accessLevel>=ie.Write:!0);const Ye=Ae?[ce,pe,ae]:[ce,ae];me=await h.window.showQuickPick(Ye,{placeHolder:"Pick a rich navigation mode"})}else if(x===Ee.Branch||x===Ee.RemoteBranch){const ce={indexKind:"latest",label:sr("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:C.index===Me.Latest?`  \u2022  ${ne}`:void 0,detail:sr("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},pe={indexKind:"tip+latest",label:sr("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:C.index===Me.TipPlusLatest?`  \u2022  ${ne}`:void 0,detail:sr("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},Ae=O.provider.id==="github"?[ce,pe,ae]:[ce,ae];me=await h.window.showQuickPick(Ae,{placeHolder:sr("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",_)})}if(me!==void 0&&(me.indexKind==="disable"?Y={display:Xe.Edit,index:Me.None}:me.indexKind==="match"?Y={display:Xe.Browse,index:Me.Match}:me.indexKind==="match+writeable"?Y={display:Xe.Edit,index:Me.Match}:me.indexKind==="tip+latest"?Y={display:Xe.Edit,index:Me.TipPlusLatest}:me.indexKind==="latest"&&(Y={display:Xe.Browse,index:Me.Latest}),Y!==void 0&&!Xt.equals(C,Y))){if(await g.hasChanges()&&Y.display===Xe.Browse){await h.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0,useCustom:!0});return}if(await g.updateIndexMode(Y),k){const ce=await g.getNonIndexedWorkspaceDescriptor();ce!==void 0&&dn(ce)}}}c(u,"toggleIndexMode")})(Fo||(Fo={}));class lf{constructor(e){this.telemetryService=e}static createStatus(){return Fo.create()}async createNavigationService(e,r){const n=await e.getIndexMetadata(r.uri);if(!(n===void 0||n.type===Ft.NotIndexed))return()=>new df(e,r,this.telemetryService)}}c(lf,"RichNavServiceProvider");var Vs;(function(t){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function r(i){const o=e.exec(i);if(o===null||o.length!==5)return;const a={v:1,w:o[1],s:o[2],a:o[3]};return h.Uri.from({scheme:Ai.scheme,authority:X(JSON.stringify(a)),path:o[4]})}c(r,"toVSCode"),t.toVSCode=r;function n(i){if(i.scheme!==Ai.scheme)return;let o;try{return o=JSON.parse(se(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}c(n,"toRichNavComponents"),t.toRichNavComponents=n})(Vs||(Vs={}));const uf=c(class{constructor(){this._onDidChangeFile=new h.EventEmitter,this.cache=new Ci(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(t,e){return uf.emptyDisposable}async stat(t){const e=await this.getFile(t);if(e===void 0)throw h.FileSystemError.FileNotFound();return{type:h.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:h.FilePermission.Readonly}}readDirectory(t){return[]}createDirectory(t){throw h.FileSystemError.NoPermissions()}async readFile(t){const e=await this.getFile(t);if(e===void 0)throw h.FileSystemError.FileNotFound();return e.content}writeFile(t,e,r){throw h.FileSystemError.NoPermissions()}delete(t,e){throw h.FileSystemError.NoPermissions()}rename(t,e,r){throw h.FileSystemError.NoPermissions()}async getFile(t){let e=this.cache.get(t.toString());if(e!==void 0)return e;if(t.scheme!==uf.scheme)return;const r=Vs.toRichNavComponents(t);if(r===void 0)return;const n=await hn.getDesignTimeFileContent(r.workspaceId,r.snapshotId,r.assetId);if(n!==void 0)return e={content:this.textEncoder.encode(n),time:Date.now()},this.cache.set(t.toString(),e),e}},"_RichNavFileSystemProvider");let Ai=uf;Ai.scheme="vsck-fs",Ai.emptyDisposable={dispose:()=>{}};var Ql;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.IndexMapped=1]="IndexMapped",t[t.Indexed=2]="Indexed"})(Ql||(Ql={}));const ni=c(class{static registerCapability(t,e,r){var n;const i=this.disabledCapabilities.get(t);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(t);return(o==null?void 0:o[e])?!1:(n=r[e])!=null?n:!1}constructor(t,e,r){this.providerService=t,this.repository=e,this.telemetryService=r,this.repositoryRoot=`${e.uri.toString()}/`;const n=c((o=!1)=>{const a=this.repository.uri;o||(this.metadata=this.providerService.getMetadata(a),this.indexMetadata=this.providerService.getIndexMetadata(a)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(a,this.metadata)]).then(async s=>{var l,u;const[d,f,p]=this.currentlyResolved,[g,_,b]=s,y=this.providerService.getModeConfig(a,b);if(d!==void 0&&f!==void 0&&p!==void 0&&d.HEAD.sha===g.HEAD.sha&&_!==void 0&&f.type===_.type&&p.index===y.index&&p.display===y.display){const C=(f==null?void 0:f.type)===Ft.Active?await f.sha:void 0,k=(_==null?void 0:_.type)===Ft.Active?await _.sha:void 0;if(C===k)return}const x={newDisplayMode:y.display,newIndexMode:y.index,newIndexType:(_==null?void 0:_.type)===void 0?"undefined":Ft[_==null?void 0:_.type],currentDisplayMode:(l=p==null?void 0:p.display)!=null?l:"undefined",currentIndexMode:(u=p==null?void 0:p.index)!=null?u:"undefined",currentIndexType:(f==null?void 0:f.type)===void 0?"undefined":Ft[f==null?void 0:f.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",x),this.currentlyResolved=[g,_,y];for(const C of this.registeredFeatures.values())C.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,Ol.isActive(_)){const C=ti.externalIndexUri(this.providerService,g),k=await _.sha;if(C!==void 0&&k!==void 0){const T=await pr.single(C,k,Ki.getIndexBranchName(g),{authentication:this.providerService.getAuthentication(a)});T!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:T.snapshotId}),this.workspaceSnapshot=T,this.documentListeners=this.installDocumentListeners(),((y==null?void 0:y.display)===Xe.Edit||g.HEAD.sha!==k)&&(this.mapper=new O0(this.providerService,a,k,g.HEAD.sha)))}}await Fo.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new Ci(2048),this.knownDesignTimeFiles=new Set;const i=[];i.push(this.providerService.onDidChangeRepository(o=>{E(o.repository.uri)===E(this.repository.uri)&&n()})),i.push(this.providerService.onDidRefresh(o=>{for(const a of o)if(E(a)===E(this.repository.uri)){n();break}})),this.environmentListeners=h.Disposable.from(...i),n(!0),Fo.addService(this),this.indexMetadata.then(async o=>{var a;const s=this.repository.uri;let l=!1;const u=ko.decode(this.repository.uri);if(u!==void 0&&o!==void 0&&(u.type===rn.Latest&&o.type!==Ft.Active||u.type===rn.SHA&&(o.type!==Ft.Active||await o.sha!==u.sha))&&(l=!0),!l){await this.metadata;const d=await this.providerService.getModeRefType(s,this.metadata),f=(a=this.currentlyResolved[2])!=null?a:this.providerService.getModeConfig(s,d,!0);f!==void 0&&f.display===Xe.Browse&&o!==void 0&&f.index!==Me.None&&o.type!==Ft.Active?l=!0:(o==null?void 0:o.type)===Ft.Active&&await o.sha===void 0&&((f==null?void 0:f.display)===Xe.Browse,l=!0)}l&&h.window.showWarningMessage(sr("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),ni.fileSystemProvider===void 0&&(ni.fileSystemProvider=new Ai,h.workspace.registerFileSystemProvider(Ai.scheme,ni.fileSystemProvider))}getRepository(){return this.repository}async updateIndexMode(t){const e=this.currentlyResolved[2],r=t!==void 0;if(t===void 0){const n=this.repository.uri,i=await this.providerService.getModeRefType(n,this.metadata);t=this.providerService.getModeConfig(n,i),await new Promise(o=>setTimeout(o,1e3))}if(e===void 0||e.index!==t.index||e.display!==t.display){if(t.index===Me.Latest){await Promise.all([this.metadata,this.indexMetadata]);const n=await this.getIndexedTip();if(n===void 0)return;await this.sync(n.hash)}else t.index===Me.TipPlusLatest&&(await Promise.all([this.metadata,this.indexMetadata]),await this.sync());r&&await fe.setMode(this.repository.uri,t),this.refresh()}}getCurrentIndexMode(){return this.currentlyResolved[2]}key(){return E(this.repository.uri)}dispose(){for(const t of this.registeredFeatures.values())t.dispose();this.registeredFeatures.clear(),Fo.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(t){return t.uri.scheme!==Nr.scheme?Promise.resolve(!1):Promise.resolve(t.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return Ki.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(t,e){return this.providerService.getModeConfig(t,e)}getModeRefType(t){return this.providerService.getModeRefType(t)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:t,repo:e}=await this.metadata,{ref:r}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:t,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:r}),location:ve.CurrentWindow}}async isDocumentIndexed(t){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===Ft.NotIndexed||this.workspaceSnapshot===void 0)return 0;const r=this.pendingCapabilitiesRequests.get(t.uri.toString());return r!==void 0&&await r,this.registeredFeatures.has(t.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(t)?1:2:0}async getIndexedTip(){const t=await this.metadata,e=ti.externalIndexUri(this.providerService,t),r=Ki.getIndexBranchName(t);if(e===void 0||r===void 0)return;const n=await pr.getIndexedTip(e,r,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(n===void 0)return;const i=await js.get(this.providerService,this.repository.uri,n.commitId);if(i!==void 0)return{...i,branchName:r}}hasChanges(){return this.providerService.getChangeStore(this.repository.uri).hasChanges(this.repository.uri)}sync(t){return this.providerService.sync(this.repository.uri,{to:t,reason:"user"})}async getCommit(t){const e=await this.metadata,r=ti.externalIndexUri(this.providerService,e);if(r===void 0)return;const[n,i]=await Promise.all([js.get(this.providerService,this.repository.uri,t),pr.single(r,t,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(n===void 0||i===void 0))return{...n,branchName:i.branchName}}installDocumentListeners(){const t=[],e=c(async r=>{const n=r.uri.scheme;if(Nr.scheme!==n&&Ai.scheme!==n)return;const i=r.uri.toString();if(n===Nr.scheme&&!i.startsWith(this.repositoryRoot)||n===Ai.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let a=this.capabilitiesCache.get(i);if(a!==null){if(a===void 0){const s=this.capabilities(r.uri);this.pendingCapabilitiesRequests.set(i,s),a=await s,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,a===void 0?null:a)}a===void 0||!h.workspace.textDocuments.some(s=>s===r)||this.registerProviders(r,a,o)}},"openHandler");return t.push(h.workspace.onDidOpenTextDocument(e)),h.workspace.textDocuments.forEach(e),t.push(h.workspace.onDidCloseTextDocument(r=>{const n=r.uri.toString(),i=this.registeredFeatures.get(n);i!==void 0&&(this.registeredFeatures.delete(r.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(n)})),h.Disposable.from(...t)}registerProviders(t,e,r){if(this.workspaceSnapshot===void 0)return;const n=this.workspaceSnapshot,i=t.languageId,a=[{scheme:this.repository.uri.scheme,pattern:t.uri.fsPath,language:t.languageId,exclusive:!0}],s=[],l=new Promise((b,y)=>{const x=`/${n.snapshotId}/source/`;this.metadata.then(C=>{b(Bx(k=>{const T=h.Uri.parse(k);if(C===void 0)return T;try{if(T.scheme==="vsck"&&T.authority===n.workspaceId&&T.path.startsWith(x))return this.repository.createRelativeUri(T.path.substr(x.length));const O=Vs.toVSCode(k);return O!==void 0?(this.knownDesignTimeFiles.add(O.toString()),O):T}catch(O){return T}}))},y)}),u=new RegExp(`^vsck:\\/\\/${n.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function d(b){const y=u.exec(b);return y===null||y.length===2}c(d,"designTimeFilter");function f(b){if(b==null)return b;if(Array.isArray(b)){if(b.length===0)return[];const y=b[0];return typeof y.uri=="string"?b.filter(k=>d(k.uri)):typeof y.targetUri=="string"?b.filter(k=>d(k.targetUri)):[]}return u.exec(b.uri)===null?b:void 0}c(f,"filterDesignTimeFiles");async function p(b,y,x){var C,k,T;if(x==null||b===void 0)return x;const O=new Map(h.workspace.textDocuments.map(ae=>[ae.uri.toString(!0),ae]));if(Array.isArray(x)){const ae=[],Y=[];if(x.length===0)return[];for(const me of x){const ce=me;if(ce.uri instanceof h.Uri){const pe=await b.mapRangeFromIndexToCode((C=O.get(ce.uri.toString()))!=null?C:ce.uri,ce.range);pe!==void 0&&ae.push(new h.Location(ce.uri,pe))}else{const pe=me,Ae=(k=O.get(pe.targetUri.toString()))!=null?k:pe.targetUri,Ye=pe.originSelectionRange?await b.mapRangeFromIndexToCode(y,pe.originSelectionRange):void 0;if(Ye!==void 0||pe.originSelectionRange===void 0){const ue=await b.mapRangeFromIndexToCode(Ae,pe.targetRange);if(ue!==void 0){const Ie=pe.targetSelectionRange?await b.mapRangeFromIndexToCode(Ae,pe.targetSelectionRange):void 0;(Ie!==void 0||pe.targetSelectionRange===void 0)&&Y.push({targetUri:pe.targetUri,targetRange:ue,targetSelectionRange:Ie,originSelectionRange:Ye})}}}}return ae.length>0?ae:Y}const ne=await b.mapRangeFromIndexToCode((T=O.get(x.uri.toString()))!=null?T:x.uri,x.range);if(ne!==void 0)return new h.Location(x.uri,ne)}c(p,"mapLocations");const g=c(b=>({authentication:this.providerService.getAuthentication(b.uri),correlationId:C0()}),"getRestApiOptions"),_=c((b,y)=>{const x={method:b,correlationId:y.correlationId};this.telemetryService.publicLog2("codex.restAPICall",x)},"sendTelemetry");ni.registerCapability(i,"hoverProvider",e)&&s.push(h.languages.registerHoverProvider(a,{provideHover:async(b,y)=>{const x=await this.createTextDocumentPositionParams(b,y);if(x===void 0)return;const C=g(b);return _("codex.provideHover",C),(await l).asHover(await hn.provideHover(r,x,C))}})),ni.registerCapability(i,"definitionProvider",e)&&s.push(h.languages.registerDefinitionProvider(a,{provideDefinition:async(b,y)=>{const x=await this.createTextDocumentPositionParams(b,y);if(x===void 0)return;const C=g(b);return _("codex.provideDefinition",C),p(this.mapper,b,(await l).asDefinitionResult(f(await hn.provideDefinition(r,x,C))))}})),ni.registerCapability(i,"declarationProvider",e)&&s.push(h.languages.registerDeclarationProvider(a,{provideDeclaration:async(b,y)=>{const x=await this.createTextDocumentPositionParams(b,y);if(x===void 0)return;const C=g(b);return _("codex.provideDeclaration",C),p(this.mapper,b,(await l).asDeclarationResult(f(await hn.provideDeclaration(r,x,C))))}})),ni.registerCapability(i,"typeDefinitionProvider",e)&&s.push(h.languages.registerTypeDefinitionProvider(a,{provideTypeDefinition:async(b,y)=>{const x=await this.createTextDocumentPositionParams(b,y);if(x===void 0)return;const C=g(b);return _("codex.provideTypeDefinition",C),p(this.mapper,b,(await l).asDefinitionResult(f(await hn.provideTypeDefinition(r,x,C))))}})),ni.registerCapability(i,"referencesProvider",e)&&s.push(h.languages.registerReferenceProvider(a,{provideReferences:async(b,y,x)=>{const C=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(b,y):y;if(C===void 0)return;const k={position:{line:C.line,character:C.character},textDocument:{uri:this.createRichNavDocumentUri(b.uri).toString(!0)},context:{includeDeclaration:x.includeDeclaration}},T=g(b);return _("codex.provideReferences",T),p(this.mapper,b,(await l).asReferences(f(await hn.provideReferences(r,k,T))))}})),ni.registerCapability(i,"foldingRangeProvider",e)&&s.push(h.languages.registerFoldingRangeProvider(a,{provideFoldingRanges:async b=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(b))return;const y=g(b);return _("codex.provideFoldingRanges",y),(await l).asFoldingRanges(await hn.providerFoldingRanges(r,this.createTextDocumentParams(b.uri),y))}})),this.registeredFeatures.set(t.uri.toString(),h.Disposable.from(...s)),Fo.updateStatusBarItem()}async capabilities(t){var e;const r=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(r!==void 0)return(e=await hn.capabilities(r,this.createTextDocumentParams(t),{authentication:this.providerService.getAuthentication(t)}))!=null?e:void 0}createTextDocumentParams(t){return{textDocument:{uri:this.createRichNavDocumentUri(t).toString(!0)}}}async createTextDocumentPositionParams(t,e){const r=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(t,e):e;if(r!==void 0)return{position:{line:r.line,character:r.character},textDocument:{uri:this.createRichNavDocumentUri(t.uri).toString(!0)}}}createRichNavDocumentUri(t){if(t.scheme===Ai.scheme){const n=Vs.toRichNavComponents(t);return n===void 0?t:h.Uri.file(n.assetId)}const e=this.repository.uri.toString(!0),r=t.toString(!0);return h.Uri.file(r.substr(e.length))}},"_RichNavService");let df=ni;df.localCapabilities=new Map([["javascript",Object.assign(ri.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(ri.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(ri.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(ri.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),df.disabledCapabilities=new Map([["javascript",Object.assign(ri.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(ri.create(),{declarationProvider:!0})],["typescript",Object.assign(ri.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(ri.create(),{declarationProvider:!0})]]);var wv=c((t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},"__accessCheck"),Qi=c((t,e,r)=>(wv(t,e,"read from private field"),r?r.call(t):e.get(t)),"__privateGet"),yv=c((t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},"__privateAdd"),bv=c((t,e,r,n)=>(wv(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),"__privateSet"),ii,Zl;class _v{constructor(e,r){yv(this,ii,void 0),yv(this,Zl,void 0),bv(this,ii,e),bv(this,Zl,r)}async loadWorkspaceContents(e){if(e.scheme!==B.scheme)return!1;const r=Qi(this,ii).getProviderRootUri(e);if(r.scheme!=="github")return!1;try{return await Qi(this,Zl).getTar(r,!1),!0}catch(n){return te.error(n),!1}}async getMetadata(e){const r=Qi(this,ii).getVirtualUriMetadata(e);if(r===void 0)return;const{provider:n,repo:i}=r;return{provider:{id:n.id,name:n.name},repo:i,getRevision:async()=>{const{HEAD:o}=await Qi(this,ii).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return Qi(this,ii).getRegisteredProvider(e)}getProviderUri(e){return B.getProviderUri(e)}getProviderRootUri(e){return Qi(this,ii).getProviderRootUri(e)}isProviderUri(e,r){return e.scheme!==Nr.scheme&&Qi(this,ii).hasProvider(e,r)}getVirtualUri(e){return B.getVirtualUri(e)}getVirtualWorkspaceUri(e){return Qi(this,ii).getVirtualWorkspaceUri(e)}}c(_v,"ExtensionApi"),ii=new WeakMap,Zl=new WeakMap;var Ox=Object.defineProperty,Ux=Object.getOwnPropertyDescriptor,hf=c((t,e,r,n)=>{for(var i=n>1?void 0:n?Ux(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&Ox(e,r,i),i},"fs_decorateClass");const ff=h.FileSystemError.FileNotFound().code;class Gs{constructor(e){this.providerService=e,this._onDidChangeFile=new h.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(r=>{r.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([r.repository.uri])}),e.onDidRefresh(r=>this.onRefreshOrRepositoryChanged(r)),e.onDidChangeChangeStore(r=>{const n=r.map(i=>{switch(i.type){case q.Created:return{type:h.FileChangeType.Created,uri:i.uri};case q.Changed:return{type:h.FileChangeType.Changed,uri:i.uri};case q.Deleted:return{type:h.FileChangeType.Deleted,uri:i.uri}}});setTimeout(()=>this._onDidChangeFile.fire(n),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return Nr.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>r.scheme===this.scheme),e.length!==0&&(te.log(`fs.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const r=B.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>A(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));te.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(E(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{te.debug(`fs.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=E(e);this.watchedUris.set(n,e);const i=this.providerService.watch(B.getProviderUri(e),r);return{dispose:()=>{this.watchedUris.delete(n),i.dispose()}}}async stat(e){const r=new Fe(`fs.stat(${e.toString()})`);let n;try{if(this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(r.logStep("ChangeStore query"),n=await this.providerService.changeStoreStat(e),n!==void 0)return n;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(E(e),e);return n=await this.providerService.stat(B.getProviderUri(e)),n}finally{n===void 0&&this.implicitlyWatchedUris.delete(E(e)),r.stop()}}async readDirectory(e){const r=new Fe(`fs.readDirectory(${e.toString()})`);this.implicitlyWatchedUris.set(E(e),e);try{r.logStep("Provider query");let n=await this.providerService.readDirectory(B.getProviderUri(e));return this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(r.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),n=await this.providerService.changeStoreUpdateDirectoryEntries(e,n)),n}finally{r.stop()}}async createDirectory(e){const r=new Fe(`fs.createDirectory(${e.toString()})`);try{await this.providerService.changeStoreCreateDirectory(e)}catch(n){throw te.error(n,r.context),n}finally{r.stop()}}async readFile(e){const r=new Fe(`fs.readFile(${e.toString()})`),n=E(e);let i;try{if(this.providerService.changeStoreMaybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){r.logStep("ChangeStore query");const o=await this.providerService.changeStoreReadFile(e);if(o!==void 0)return o;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(n,e);return i=await this.providerService.readFile(B.getProviderUri(e)),i}catch(o){throw o instanceof qr&&Pr.showProviderNotFoundMessage(o),o}finally{i===void 0&&this.implicitlyWatchedUris.delete(n),r.stop()}}async writeFile(e,r,n){const i=new Fe(`fs.writeFile(${e.toString()})`,{},r.length,n);try{let o;try{if(o=await this.stat(e),!n.overwrite)throw h.FileSystemError.FileExists()}catch(a){if(a instanceof h.FileSystemError&&a.code===ff){if(!n.create)throw h.FileSystemError.FileNotFound(e)}else throw a}try{if(o===void 0)await this.providerService.changeStoreCreateFile(e,r);else{i.logStep("Provider original query");let a;try{a=await this.providerService.readFile(B.getProviderUri(e))}catch(s){if(s instanceof h.FileSystemError&&s.code===ff)a=new Uint8Array;else throw s}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.providerService.changeStoreWriteFile(e,r,a)}}catch(a){throw te.error(a,i.context),a}}catch(o){throw o instanceof qr&&Pr.showProviderNotFoundMessage(o),o}finally{i.stop()}}async delete(e,r){const n=new Fe(`fs.delete(${e.toString()})`,{},r);try{switch((await this.stat(e)).type){case h.FileType.File:await this.providerService.changeStoreDeleteFile(e);break;case h.FileType.Directory:{await this.deleteDirectory(e,r);break}default:throw h.FileSystemError.NoPermissions()}}catch(i){throw te.error(i,n.context),i}finally{n.stop()}}async deleteDirectory(e,r){const n=new Fe(`fs.deleteDirectory(${e.toString()})`,{},r);try{const i=await this.readDirectory(e);if(i.length!==0){if(!r.recursive&&i.some(([,o])=>o===h.FileType.Directory))throw h.FileSystemError.NoPermissions();for(const[o,a]of i)a===h.FileType.Directory?await this.deleteDirectory(h.Uri.joinPath(e,o),r):await this.providerService.changeStoreDeleteFile(h.Uri.joinPath(e,o))}await this.providerService.changeStoreDeleteDirectory(e)}catch(i){throw te.error(i,n.context),i}finally{n.stop()}}async rename(e,r,n){const i=new Fe(`fs.rename(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite}),await this.delete(e,{recursive:!1});break}case h.FileType.Directory:{await this.renameDirectory(e,r,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw te.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,r,n){const i=new Fe(`fs.renameDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{await this.copyDirectory(e,r,n),await this.delete(e,{recursive:!0})}catch(o){throw te.error(o,i.context),o}finally{i.stop()}}async copy(e,r,n){const i=new Fe(`fs.copy(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case h.FileType.File:{const a=await this.readFile(e);await this.writeFile(r,a,{create:!0,overwrite:n.overwrite});break}case h.FileType.Directory:{await this.copyDirectory(e,r,n);break}default:throw h.FileSystemError.NoPermissions()}}catch(o){throw te.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,r,n){const i=new Fe(`fs.copyDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{if(await this.exists(r))throw h.FileSystemError.FileExists();try{await this.createDirectory(r);const o=await this.readDirectory(e);for(const[a,s]of o)s===h.FileType.Directory?await this.copyDirectory(h.Uri.joinPath(e,a),h.Uri.joinPath(r,a),n):await this.copy(h.Uri.joinPath(e,a),h.Uri.joinPath(r,a),n)}catch(o){throw te.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(r){if(r instanceof h.FileSystemError&&r.code===ff)return!1;throw r}}async provideFileSearchResults(e,r,n){var i;const o=new Fe(`fs.provideFileSearchResults(${e.pattern}, ${r.folder.toString()})`,{logLevel:Ce.Debug});let a;try{return a=await this.providerService.provideFileSearchResults(e,{...r,folder:B.getProviderUri(r.folder)},n),a==null?void 0:a.map(s=>B.getVirtualUri(s))}catch(s){throw te.error(s,o.context),s}finally{o.stop({suffix:` \u2022 ${(i=a==null?void 0:a.length)!=null?i:0} results found`})}}provideTextSearchResults(e,r,n,i){return this.providerService.provideTextSearchResults(e,{...r,folder:B.getProviderUri(r.folder)},{report:o=>n.report({...o,uri:B.getVirtualUri(o.uri)})},i)}}c(Gs,"ChangeTrackingFileSystem"),hf([Io()],Gs.prototype,"stat",1),hf([Io()],Gs.prototype,"readDirectory",1),hf([Io()],Gs.prototype,"readFile",1);var pf=__webpack_require__(7360),Hx=__webpack_require__(919),gf=__webpack_require__.n(Hx);function xv(t,e,r){if(!(e==null?void 0:e.length)&&!(r==null?void 0:r.length))return new Set(t);let n;if(e==null?void 0:e.length){const i=new Set([...e,...e.map(a=>`${a}/**`)]),o=gf()(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}if(r==null?void 0:r.length){const i=new Set([...r,...r.map(o=>`${o}/**`)]);if(n===void 0){const o=gf().not(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}else gf()(t,[...i],{dot:!0,nocase:!0}).forEach(n.delete,n)}return n}c(xv,"globFilter");function Wx(t){return t.replace(/[\\{}*+?|^$.[\]()]/g,"\\$&")}c(Wx,"escapeRegExpCharacters");function zx(t,e,r={}){if(!t)throw new Error("Cannot create regex from empty string");e||(t=Wx(t)),r.wholeWord&&(/\B/.test(t.charAt(0))||(t=`\\b${t}`),/\B/.test(t.charAt(t.length-1))||(t=`${t}\\b`));let n="gmu";return r.matchCase||(n+="i"),new RegExp(t,n)}c(zx,"createRegExp");let Sv,Cv,mf;const qx=c((t,e,r,n)=>{const i=`${e.join("--")};;;;${r.join("--")}`,o=t.map(s=>s.path).join("::");if(Sv===o&&i==Cv&&mf)return mf;const a=xv((n?t.filter(s=>s.size<n):t).map(s=>s.path),e,r);return Sv=o,Cv=i,mf=a,a},"generateIncludeSet"),jx=c((t,e,r,n)=>{var i;const o=[];let a;if(typeof t=="string")a=t;else{const d=t;if(d[0]==255&&d[1]==254)a=new TextDecoder("utf-16le").decode(d);else if(d[0]==254&&d[1]==255)a=new TextDecoder("utf-16be").decode(d);else if(a=new TextDecoder("utf8").decode(d),a.slice(0,1e3).includes("\uFFFD")&&d.includes(0))return[]}const s=[];let l=null,u=n.remainingResultQuota;for(;(u===void 0||u>=0)&&(l=r.exec(a));)s.push({matchStartIndex:l.index,matchedText:l[0]}),u!==void 0&&u--;if(s.length){const d=new Set,f=new Set,p=[],g=c(C=>a.slice(p[C].start,p[C].end),"readLine");let _=0,b=null;const y=/\r?\n/g;for(;b=y.exec(a);)p.push({start:_,end:b.index}),_=b.index+b[0].length;_<a.length&&p.push({start:_,end:a.length});let x=0;for(const{matchStartIndex:C,matchedText:k}of s){if(u!==void 0&&u<0)break;for(;Boolean(p[x+1])&&C>p[x].end;)x++;let T=x;for(;Boolean(p[T+1])&&C+k.length>p[T].end;)T++;if(n.beforeContext)for(let ce=Math.max(0,x-n.beforeContext);ce<x;ce++)d.add(ce);let O="",ne=0;for(let ce=x;ce<=T;ce++){let pe=g(ce);((i=n.previewOptions)==null?void 0:i.charsPerLine)&&pe.length>n.previewOptions.charsPerLine&&(ne=Math.max(C-p[x].start-20,0),pe=pe.substr(ne,n.previewOptions.charsPerLine)),O+=`${pe}
`,f.add(ce)}const ae=new h.Range(x,C-p[x].start,T,C+k.length-p[T].start),Y=new h.Range(0,C-p[x].start-ne,T-x,C+k.length-p[T].start-(T===x?ne:0)),me={uri:h.Uri.file(e),ranges:ae,preview:{text:O,matches:Y}};if(o.push(me),n.afterContext)for(let ce=T+1;ce<=Math.min(T+n.afterContext,p.length-1);ce++)d.add(ce)}for(const C of d)f.has(C)||o.push({uri:h.Uri.file(e),text:g(C),lineNumber:C+1})}return o},"getFileResults");/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Vx=4,Ev=0,Rv=1,Gx=2;function $a(t){let e=t.length;for(;--e>=0;)t[e]=0}c($a,"zero$1");const Kx=0,Av=1,Qx=2,Zx=3,Xx=258,vf=29,Ks=256,Qs=Ks+1+vf,Ba=30,wf=19,Iv=2*Qs+1,Po=15,yf=16,Yx=7,bf=256,kv=16,Tv=17,Dv=18,_f=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Xl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Jx=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Fv=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eS=512,Ii=new Array((Qs+2)*2);$a(Ii);const Zs=new Array(Ba*2);$a(Zs);const Xs=new Array(eS);$a(Xs);const Ys=new Array(Xx-Zx+1);$a(Ys);const xf=new Array(vf);$a(xf);const Yl=new Array(Ba);$a(Yl);function Sf(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}c(Sf,"StaticTreeDesc");let Pv,Nv,Mv;function Cf(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}c(Cf,"TreeDesc");const Lv=c(t=>t<256?Xs[t]:Xs[256+(t>>>7)],"d_code"),Js=c((t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},"put_short"),Xr=c((t,e,r)=>{t.bi_valid>yf-r?(t.bi_buf|=e<<t.bi_valid&65535,Js(t,t.bi_buf),t.bi_buf=e>>yf-t.bi_valid,t.bi_valid+=r-yf):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},"send_bits"),oi=c((t,e,r)=>{Xr(t,r[e*2],r[e*2+1])},"send_code"),$v=c((t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},"bi_reverse"),tS=c(t=>{t.bi_valid===16?(Js(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},"bi_flush"),rS=c((t,e)=>{const r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,s=e.stat_desc.extra_base,l=e.stat_desc.max_length;let u,d,f,p,g,_,b=0;for(p=0;p<=Po;p++)t.bl_count[p]=0;for(r[t.heap[t.heap_max]*2+1]=0,u=t.heap_max+1;u<Iv;u++)d=t.heap[u],p=r[r[d*2+1]*2+1]+1,p>l&&(p=l,b++),r[d*2+1]=p,!(d>n)&&(t.bl_count[p]++,g=0,d>=s&&(g=a[d-s]),_=r[d*2],t.opt_len+=_*(p+g),o&&(t.static_len+=_*(i[d*2+1]+g)));if(b!==0){do{for(p=l-1;t.bl_count[p]===0;)p--;t.bl_count[p]--,t.bl_count[p+1]+=2,t.bl_count[l]--,b-=2}while(b>0);for(p=l;p!==0;p--)for(d=t.bl_count[p];d!==0;)f=t.heap[--u],!(f>n)&&(r[f*2+1]!==p&&(t.opt_len+=(p-r[f*2+1])*r[f*2],r[f*2+1]=p),d--)}},"gen_bitlen"),Bv=c((t,e,r)=>{const n=new Array(Po+1);let i=0,o,a;for(o=1;o<=Po;o++)n[o]=i=i+r[o-1]<<1;for(a=0;a<=e;a++){let s=t[a*2+1];s!==0&&(t[a*2]=$v(n[s]++,s))}},"gen_codes"),nS=c(()=>{let t,e,r,n,i;const o=new Array(Po+1);for(r=0,n=0;n<vf-1;n++)for(xf[n]=r,t=0;t<1<<_f[n];t++)Ys[r++]=n;for(Ys[r-1]=n,i=0,n=0;n<16;n++)for(Yl[n]=i,t=0;t<1<<Xl[n];t++)Xs[i++]=n;for(i>>=7;n<Ba;n++)for(Yl[n]=i<<7,t=0;t<1<<Xl[n]-7;t++)Xs[256+i++]=n;for(e=0;e<=Po;e++)o[e]=0;for(t=0;t<=143;)Ii[t*2+1]=8,t++,o[8]++;for(;t<=255;)Ii[t*2+1]=9,t++,o[9]++;for(;t<=279;)Ii[t*2+1]=7,t++,o[7]++;for(;t<=287;)Ii[t*2+1]=8,t++,o[8]++;for(Bv(Ii,Qs+1,o),t=0;t<Ba;t++)Zs[t*2+1]=5,Zs[t*2]=$v(t,5);Pv=new Sf(Ii,_f,Ks+1,Qs,Po),Nv=new Sf(Zs,Xl,0,Ba,Po),Mv=new Sf(new Array(0),Jx,0,wf,Yx)},"tr_static_init"),Ov=c(t=>{let e;for(e=0;e<Qs;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Ba;e++)t.dyn_dtree[e*2]=0;for(e=0;e<wf;e++)t.bl_tree[e*2]=0;t.dyn_ltree[bf*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},"init_block"),Uv=c(t=>{t.bi_valid>8?Js(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},"bi_windup"),iS=c((t,e,r,n)=>{Uv(t),n&&(Js(t,r),Js(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},"copy_block"),Hv=c((t,e,r,n)=>{const i=e*2,o=r*2;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},"smaller"),Ef=c((t,e,r)=>{const n=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&Hv(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!Hv(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},"pqdownheap"),Wv=c((t,e,r)=>{let n,i,o=0,a,s;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+o*2]<<8|t.pending_buf[t.d_buf+o*2+1],i=t.pending_buf[t.l_buf+o],o++,n===0?oi(t,i,e):(a=Ys[i],oi(t,a+Ks+1,e),s=_f[a],s!==0&&(i-=xf[a],Xr(t,i,s)),n--,a=Lv(n),oi(t,a,r),s=Xl[a],s!==0&&(n-=Yl[a],Xr(t,n,s)));while(o<t.last_lit);oi(t,bf,e)},"compress_block"),Rf=c((t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let a,s,l=-1,u;for(t.heap_len=0,t.heap_max=Iv,a=0;a<o;a++)r[a*2]!==0?(t.heap[++t.heap_len]=l=a,t.depth[a]=0):r[a*2+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=l<2?++l:0,r[u*2]=1,t.depth[u]=0,t.opt_len--,i&&(t.static_len-=n[u*2+1]);for(e.max_code=l,a=t.heap_len>>1;a>=1;a--)Ef(t,r,a);u=o;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Ef(t,r,1),s=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=s,r[u*2]=r[a*2]+r[s*2],t.depth[u]=(t.depth[a]>=t.depth[s]?t.depth[a]:t.depth[s])+1,r[a*2+1]=r[s*2+1]=u,t.heap[1]=u++,Ef(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],rS(t,e),Bv(r,l,t.bl_count)},"build_tree"),zv=c((t,e,r)=>{let n,i=-1,o,a=e[0*2+1],s=0,l=7,u=4;for(a===0&&(l=138,u=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)o=a,a=e[(n+1)*2+1],!(++s<l&&o===a)&&(s<u?t.bl_tree[o*2]+=s:o!==0?(o!==i&&t.bl_tree[o*2]++,t.bl_tree[kv*2]++):s<=10?t.bl_tree[Tv*2]++:t.bl_tree[Dv*2]++,s=0,i=o,a===0?(l=138,u=3):o===a?(l=6,u=3):(l=7,u=4))},"scan_tree"),qv=c((t,e,r)=>{let n,i=-1,o,a=e[0*2+1],s=0,l=7,u=4;for(a===0&&(l=138,u=3),n=0;n<=r;n++)if(o=a,a=e[(n+1)*2+1],!(++s<l&&o===a)){if(s<u)do oi(t,o,t.bl_tree);while(--s!=0);else o!==0?(o!==i&&(oi(t,o,t.bl_tree),s--),oi(t,kv,t.bl_tree),Xr(t,s-3,2)):s<=10?(oi(t,Tv,t.bl_tree),Xr(t,s-3,3)):(oi(t,Dv,t.bl_tree),Xr(t,s-11,7));s=0,i=o,a===0?(l=138,u=3):o===a?(l=6,u=3):(l=7,u=4)}},"send_tree"),oS=c(t=>{let e;for(zv(t,t.dyn_ltree,t.l_desc.max_code),zv(t,t.dyn_dtree,t.d_desc.max_code),Rf(t,t.bl_desc),e=wf-1;e>=3&&t.bl_tree[Fv[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},"build_bl_tree"),aS=c((t,e,r,n)=>{let i;for(Xr(t,e-257,5),Xr(t,r-1,5),Xr(t,n-4,4),i=0;i<n;i++)Xr(t,t.bl_tree[Fv[i]*2+1],3);qv(t,t.dyn_ltree,e-1),qv(t,t.dyn_dtree,r-1)},"send_all_trees"),sS=c(t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return Ev;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return Rv;for(r=32;r<Ks;r++)if(t.dyn_ltree[r*2]!==0)return Rv;return Ev},"detect_data_type");let jv=!1;const cS=c(t=>{jv||(nS(),jv=!0),t.l_desc=new Cf(t.dyn_ltree,Pv),t.d_desc=new Cf(t.dyn_dtree,Nv),t.bl_desc=new Cf(t.bl_tree,Mv),t.bi_buf=0,t.bi_valid=0,Ov(t)},"_tr_init$1"),Vv=c((t,e,r,n)=>{Xr(t,(Kx<<1)+(n?1:0),3),iS(t,e,r,!0)},"_tr_stored_block$1"),lS=c(t=>{Xr(t,Av<<1,3),oi(t,bf,Ii),tS(t)},"_tr_align$1"),uS=c((t,e,r,n)=>{let i,o,a=0;t.level>0?(t.strm.data_type===Gx&&(t.strm.data_type=sS(t)),Rf(t,t.l_desc),Rf(t,t.d_desc),a=oS(t),i=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&e!==-1?Vv(t,e,r,n):t.strategy===Vx||o===i?(Xr(t,(Av<<1)+(n?1:0),3),Wv(t,Ii,Zs)):(Xr(t,(Qx<<1)+(n?1:0),3),aS(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),Wv(t,t.dyn_ltree,t.dyn_dtree)),Ov(t),n&&Uv(t)},"_tr_flush_block$1"),dS=c((t,e,r)=>(t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Ys[r]+Ks+1)*2]++,t.dyn_dtree[Lv(e)*2]++),t.last_lit===t.lit_bufsize-1),"_tr_tally$1");var hS=cS,fS=Vv,pS=uS,gS=dS,mS=lS,vS={_tr_init:hS,_tr_stored_block:fS,_tr_flush_block:pS,_tr_tally:gS,_tr_align:mS},ec=c((t,e,r,n)=>{let i=t&65535|0,o=t>>>16&65535|0,a=0;for(;r!==0;){a=r>2e3?2e3:r,r-=a;do i=i+e[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0},"adler32");const wS=c(()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},"makeTable"),yS=new Uint32Array(wS());var yr=c((t,e,r,n)=>{const i=yS,o=n+r;t^=-1;for(let a=n;a<o;a++)t=t>>>8^i[(t^e[a])&255];return t^-1},"crc32"),No={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Mo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:bS,_tr_stored_block:_S,_tr_flush_block:xS,_tr_tally:Zi,_tr_align:SS}=vS,{Z_NO_FLUSH:Lo,Z_PARTIAL_FLUSH:CS,Z_FULL_FLUSH:ES,Z_FINISH:Xi,Z_BLOCK:Gv,Z_OK:ai,Z_STREAM_END:Kv,Z_STREAM_ERROR:fn,Z_DATA_ERROR:RS,Z_BUF_ERROR:Af,Z_DEFAULT_COMPRESSION:AS,Z_FILTERED:IS,Z_HUFFMAN_ONLY:Jl,Z_RLE:kS,Z_FIXED:TS,Z_DEFAULT_STRATEGY:DS,Z_UNKNOWN:FS,Z_DEFLATED:eu}=Mo,PS=9,NS=15,MS=8,LS=29,If=256+1+LS,$S=30,BS=19,OS=2*If+1,US=15,Rt=3,Yi=258,Pn=Yi+Rt+1,HS=32,tu=42,kf=69,ru=73,nu=91,iu=103,$o=113,tc=666,gr=1,rc=2,Bo=3,Oa=4,WS=3,Ji=c((t,e)=>(t.msg=No[e],e),"err"),Qv=c(t=>(t<<1)-(t>4?9:0),"rank"),eo=c(t=>{let e=t.length;for(;--e>=0;)t[e]=0},"zero");let to=c((t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,"HASH_ZLIB");const ro=c(t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},"flush_pending"),Er=c((t,e)=>{xS(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ro(t.strm)},"flush_block_only"),Pt=c((t,e)=>{t.pending_buf[t.pending++]=e},"put_byte"),nc=c((t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},"putShortMSB"),zS=c((t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),t.state.wrap===1?t.adler=ec(t.adler,e,i,r):t.state.wrap===2&&(t.adler=yr(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},"read_buf"),Zv=c((t,e)=>{let r=t.max_chain_length,n=t.strstart,i,o,a=t.prev_length,s=t.nice_match;const l=t.strstart>t.w_size-Pn?t.strstart-(t.w_size-Pn):0,u=t.window,d=t.w_mask,f=t.prev,p=t.strstart+Yi;let g=u[n+a-1],_=u[n+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do if(i=e,!(u[i+a]!==_||u[i+a-1]!==g||u[i]!==u[n]||u[++i]!==u[n+1])){n+=2,i++;do;while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<p);if(o=Yi-(p-n),n=p-Yi,o>a){if(t.match_start=e,a=o,o>=s)break;g=u[n+a-1],_=u[n+a]}}while((e=f[e&d])>l&&--r!=0);return a<=t.lookahead?a:t.lookahead},"longest_match"),Oo=c(t=>{const e=t.w_size;let r,n,i,o,a;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Pn)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do i=t.head[--r],t.head[r]=i>=e?i-e:0;while(--n);n=e,r=n;do i=t.prev[--r],t.prev[r]=i>=e?i-e:0;while(--n);o+=e}if(t.strm.avail_in===0)break;if(n=zS(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=Rt)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=to(t,t.ins_h,t.window[a+1]);t.insert&&(t.ins_h=to(t,t.ins_h,t.window[a+Rt-1]),t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<Rt)););}while(t.lookahead<Pn&&t.strm.avail_in!==0)},"fill_window"),qS=c((t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Oo(t),t.lookahead===0&&e===Lo)return gr;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,Er(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Pn&&(Er(t,!1),t.strm.avail_out===0))return gr}return t.insert=0,e===Xi?(Er(t,!0),t.strm.avail_out===0?Bo:Oa):(t.strstart>t.block_start&&(Er(t,!1),t.strm.avail_out===0),gr)},"deflate_stored"),Tf=c((t,e)=>{let r,n;for(;;){if(t.lookahead<Pn){if(Oo(t),t.lookahead<Pn&&e===Lo)return gr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Rt&&(t.ins_h=to(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Pn&&(t.match_length=Zv(t,r)),t.match_length>=Rt)if(n=Zi(t,t.strstart-t.match_start,t.match_length-Rt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Rt){t.match_length--;do t.strstart++,t.ins_h=to(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=to(t,t.ins_h,t.window[t.strstart+1]);else n=Zi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Er(t,!1),t.strm.avail_out===0))return gr}return t.insert=t.strstart<Rt-1?t.strstart:Rt-1,e===Xi?(Er(t,!0),t.strm.avail_out===0?Bo:Oa):t.last_lit&&(Er(t,!1),t.strm.avail_out===0)?gr:rc},"deflate_fast"),Ua=c((t,e)=>{let r,n,i;for(;;){if(t.lookahead<Pn){if(Oo(t),t.lookahead<Pn&&e===Lo)return gr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Rt&&(t.ins_h=to(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Rt-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Pn&&(t.match_length=Zv(t,r),t.match_length<=5&&(t.strategy===IS||t.match_length===Rt&&t.strstart-t.match_start>4096)&&(t.match_length=Rt-1)),t.prev_length>=Rt&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-Rt,n=Zi(t,t.strstart-1-t.prev_match,t.prev_length-Rt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=to(t,t.ins_h,t.window[t.strstart+Rt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=Rt-1,t.strstart++,n&&(Er(t,!1),t.strm.avail_out===0))return gr}else if(t.match_available){if(n=Zi(t,0,t.window[t.strstart-1]),n&&Er(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return gr}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Zi(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Rt-1?t.strstart:Rt-1,e===Xi?(Er(t,!0),t.strm.avail_out===0?Bo:Oa):t.last_lit&&(Er(t,!1),t.strm.avail_out===0)?gr:rc},"deflate_slow"),jS=c((t,e)=>{let r,n,i,o;const a=t.window;for(;;){if(t.lookahead<=Yi){if(Oo(t),t.lookahead<=Yi&&e===Lo)return gr;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Rt&&t.strstart>0&&(i=t.strstart-1,n=a[i],n===a[++i]&&n===a[++i]&&n===a[++i])){o=t.strstart+Yi;do;while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);t.match_length=Yi-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Rt?(r=Zi(t,1,t.match_length-Rt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Zi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Er(t,!1),t.strm.avail_out===0))return gr}return t.insert=0,e===Xi?(Er(t,!0),t.strm.avail_out===0?Bo:Oa):t.last_lit&&(Er(t,!1),t.strm.avail_out===0)?gr:rc},"deflate_rle"),VS=c((t,e)=>{let r;for(;;){if(t.lookahead===0&&(Oo(t),t.lookahead===0)){if(e===Lo)return gr;break}if(t.match_length=0,r=Zi(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Er(t,!1),t.strm.avail_out===0))return gr}return t.insert=0,e===Xi?(Er(t,!0),t.strm.avail_out===0?Bo:Oa):t.last_lit&&(Er(t,!1),t.strm.avail_out===0)?gr:rc},"deflate_huff");function si(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}c(si,"Config");const ic=[new si(0,0,0,0,qS),new si(4,4,8,4,Tf),new si(4,5,16,8,Tf),new si(4,6,32,32,Tf),new si(4,4,16,16,Ua),new si(8,16,32,32,Ua),new si(8,16,128,128,Ua),new si(8,32,128,256,Ua),new si(32,128,258,1024,Ua),new si(32,258,258,4096,Ua)],GS=c(t=>{t.window_size=2*t.w_size,eo(t.head),t.max_lazy_match=ic[t.level].max_lazy,t.good_match=ic[t.level].good_length,t.nice_match=ic[t.level].nice_length,t.max_chain_length=ic[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Rt-1,t.match_available=0,t.ins_h=0},"lm_init");function KS(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=eu,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(OS*2),this.dyn_dtree=new Uint16Array((2*$S+1)*2),this.bl_tree=new Uint16Array((2*BS+1)*2),eo(this.dyn_ltree),eo(this.dyn_dtree),eo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(US+1),this.heap=new Uint16Array(2*If+1),eo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*If+1),eo(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}c(KS,"DeflateState");const Xv=c(t=>{if(!t||!t.state)return Ji(t,fn);t.total_in=t.total_out=0,t.data_type=FS;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?tu:$o,t.adler=e.wrap===2?0:1,e.last_flush=Lo,bS(e),ai},"deflateResetKeep"),Yv=c(t=>{const e=Xv(t);return e===ai&&GS(t.state),e},"deflateReset"),QS=c((t,e)=>!t||!t.state||t.state.wrap!==2?fn:(t.state.gzhead=e,ai),"deflateSetHeader"),Jv=c((t,e,r,n,i,o)=>{if(!t)return fn;let a=1;if(e===AS&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>PS||r!==eu||n<8||n>15||e<0||e>9||o<0||o>TS)return Ji(t,fn);n===8&&(n=9);const s=new KS;return t.state=s,s.strm=t,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+Rt-1)/Rt),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=(1+2)*s.lit_bufsize,s.level=e,s.strategy=o,s.method=r,Yv(t)},"deflateInit2"),ZS=c((t,e)=>Jv(t,e,eu,NS,MS,DS),"deflateInit"),XS=c((t,e)=>{let r,n;if(!t||!t.state||e>Gv||e<0)return t?Ji(t,fn):fn;const i=t.state;if(!t.output||!t.input&&t.avail_in!==0||i.status===tc&&e!==Xi)return Ji(t,t.avail_out===0?Af:fn);i.strm=t;const o=i.last_flush;if(i.last_flush=e,i.status===tu)if(i.wrap===2)t.adler=0,Pt(i,31),Pt(i,139),Pt(i,8),i.gzhead?(Pt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Pt(i,i.gzhead.time&255),Pt(i,i.gzhead.time>>8&255),Pt(i,i.gzhead.time>>16&255),Pt(i,i.gzhead.time>>24&255),Pt(i,i.level===9?2:i.strategy>=Jl||i.level<2?4:0),Pt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Pt(i,i.gzhead.extra.length&255),Pt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=yr(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=kf):(Pt(i,0),Pt(i,0),Pt(i,0),Pt(i,0),Pt(i,0),Pt(i,i.level===9?2:i.strategy>=Jl||i.level<2?4:0),Pt(i,WS),i.status=$o);else{let a=eu+(i.w_bits-8<<4)<<8,s=-1;i.strategy>=Jl||i.level<2?s=0:i.level<6?s=1:i.level===6?s=2:s=3,a|=s<<6,i.strstart!==0&&(a|=HS),a+=31-a%31,i.status=$o,nc(i,a),i.strstart!==0&&(nc(i,t.adler>>>16),nc(i,t.adler&65535)),t.adler=1}if(i.status===kf)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=yr(t.adler,i.pending_buf,i.pending-r,r)),ro(t),r=i.pending,i.pending===i.pending_buf_size));)Pt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=yr(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=ru)}else i.status=ru;if(i.status===ru)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=yr(t.adler,i.pending_buf,i.pending-r,r)),ro(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,Pt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=yr(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=nu)}else i.status=nu;if(i.status===nu)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=yr(t.adler,i.pending_buf,i.pending-r,r)),ro(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,Pt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=yr(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=iu)}else i.status=iu;if(i.status===iu&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&ro(t),i.pending+2<=i.pending_buf_size&&(Pt(i,t.adler&255),Pt(i,t.adler>>8&255),t.adler=0,i.status=$o)):i.status=$o),i.pending!==0){if(ro(t),t.avail_out===0)return i.last_flush=-1,ai}else if(t.avail_in===0&&Qv(e)<=Qv(o)&&e!==Xi)return Ji(t,Af);if(i.status===tc&&t.avail_in!==0)return Ji(t,Af);if(t.avail_in!==0||i.lookahead!==0||e!==Lo&&i.status!==tc){let a=i.strategy===Jl?VS(i,e):i.strategy===kS?jS(i,e):ic[i.level].func(i,e);if((a===Bo||a===Oa)&&(i.status=tc),a===gr||a===Bo)return t.avail_out===0&&(i.last_flush=-1),ai;if(a===rc&&(e===CS?SS(i):e!==Gv&&(_S(i,0,0,!1),e===ES&&(eo(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),ro(t),t.avail_out===0))return i.last_flush=-1,ai}return e!==Xi?ai:i.wrap<=0?Kv:(i.wrap===2?(Pt(i,t.adler&255),Pt(i,t.adler>>8&255),Pt(i,t.adler>>16&255),Pt(i,t.adler>>24&255),Pt(i,t.total_in&255),Pt(i,t.total_in>>8&255),Pt(i,t.total_in>>16&255),Pt(i,t.total_in>>24&255)):(nc(i,t.adler>>>16),nc(i,t.adler&65535)),ro(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?ai:Kv)},"deflate$2"),YS=c(t=>{if(!t||!t.state)return fn;const e=t.state.status;return e!==tu&&e!==kf&&e!==ru&&e!==nu&&e!==iu&&e!==$o&&e!==tc?Ji(t,fn):(t.state=null,e===$o?Ji(t,RS):ai)},"deflateEnd"),JS=c((t,e)=>{let r=e.length;if(!t||!t.state)return fn;const n=t.state,i=n.wrap;if(i===2||i===1&&n.status!==tu||n.lookahead)return fn;if(i===1&&(t.adler=ec(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){i===0&&(eo(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(e.subarray(r-n.w_size,r),0),e=l,r=n.w_size}const o=t.avail_in,a=t.next_in,s=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Oo(n);n.lookahead>=Rt;){let l=n.strstart,u=n.lookahead-(Rt-1);do n.ins_h=to(n,n.ins_h,n.window[l+Rt-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--u);n.strstart=l,n.lookahead=Rt-1,Oo(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Rt-1,n.match_available=0,t.next_in=a,t.input=s,t.avail_in=o,n.wrap=i,ai},"deflateSetDictionary");var eC=ZS,tC=Jv,rC=Yv,nC=Xv,iC=QS,oC=XS,aC=YS,sC=JS,cC="pako deflate (from Nodeca project)",oc={deflateInit:eC,deflateInit2:tC,deflateReset:rC,deflateResetKeep:nC,deflateSetHeader:iC,deflate:oC,deflateEnd:aC,deflateSetDictionary:sC,deflateInfo:cC};const lC=c((t,e)=>Object.prototype.hasOwnProperty.call(t,e),"_has");var uC=c(function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)lC(r,n)&&(t[n]=r[n])}}return t},"pako_esm_assign"),dC=c(t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,o=t.length;n<o;n++){let a=t[n];r.set(a,i),i+=a.length}return r},"flattenChunks"),ou={assign:uC,flattenChunks:dC};let ew=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){ew=!1}const ac=new Uint8Array(256);for(let t=0;t<256;t++)ac[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ac[254]=ac[254]=1;var hC=c(t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,o,a=t.length,s=0;for(i=0;i<a;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(s),o=0,i=0;o<s;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<a&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|r&63):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|r&63):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|r&63);return e},"string2buf");const fC=c((t,e)=>{if(e<65534&&t.subarray&&ew)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r},"buf2binstring");var pC=c((t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const o=new Array(r*2);for(i=0,n=0;n<r;){let a=t[n++];if(a<128){o[i++]=a;continue}let s=ac[a];if(s>4){o[i++]=65533,n+=s-1;continue}for(a&=s===2?31:s===3?15:7;s>1&&n<r;)a=a<<6|t[n++]&63,s--;if(s>1){o[i++]=65533;continue}a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|a&1023)}return fC(o,i)},"buf2string"),gC=c((t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+ac[t[r]]>e?r:e},"utf8border"),sc={string2buf:hC,buf2string:pC,utf8border:gC};function mC(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}c(mC,"ZStream");var tw=mC;const rw=Object.prototype.toString,{Z_NO_FLUSH:vC,Z_SYNC_FLUSH:wC,Z_FULL_FLUSH:yC,Z_FINISH:bC,Z_OK:au,Z_STREAM_END:_C,Z_DEFAULT_COMPRESSION:xC,Z_DEFAULT_STRATEGY:SC,Z_DEFLATED:CC}=Mo;function cc(t){this.options=ou.assign({level:xC,method:CC,chunkSize:16384,windowBits:15,memLevel:8,strategy:SC},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tw,this.strm.avail_out=0;let r=oc.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==au)throw new Error(No[r]);if(e.header&&oc.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=sc.string2buf(e.dictionary):rw.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=oc.deflateSetDictionary(this.strm,n),r!==au)throw new Error(No[r]);this._dict_set=!0}}c(cc,"Deflate$1"),cc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?bC:vC,typeof t=="string"?r.input=sc.string2buf(t):rw.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===wC||o===yC)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=oc.deflate(r,o),i===_C)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=oc.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===au;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0},cc.prototype.onData=function(t){this.chunks.push(t)},cc.prototype.onEnd=function(t){t===au&&(this.result=ou.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Df(t,e){const r=new cc(e);if(r.push(t,!0),r.err)throw r.msg||No[r.err];return r.result}c(Df,"deflate$1");function EC(t,e){return e=e||{},e.raw=!0,Df(t,e)}c(EC,"deflateRaw$1");function RC(t,e){return e=e||{},e.gzip=!0,Df(t,e)}c(RC,"gzip$1");var AC=cc,IC=Df,kC=EC,TC=RC,DC=Mo,FC={Deflate:AC,deflate:IC,deflateRaw:kC,gzip:TC,constants:DC};const su=30,PC=12;var NC=c(function(e,r){let n,i,o,a,s,l,u,d,f,p,g,_,b,y,x,C,k,T,O,ne,ae,Y,me,ce;const pe=e.state;n=e.next_in,me=e.input,i=n+(e.avail_in-5),o=e.next_out,ce=e.output,a=o-(r-e.avail_out),s=o+(e.avail_out-257),l=pe.dmax,u=pe.wsize,d=pe.whave,f=pe.wnext,p=pe.window,g=pe.hold,_=pe.bits,b=pe.lencode,y=pe.distcode,x=(1<<pe.lenbits)-1,C=(1<<pe.distbits)-1;e:do{_<15&&(g+=me[n++]<<_,_+=8,g+=me[n++]<<_,_+=8),k=b[g&x];t:for(;;){if(T=k>>>24,g>>>=T,_-=T,T=k>>>16&255,T===0)ce[o++]=k&65535;else if(T&16){O=k&65535,T&=15,T&&(_<T&&(g+=me[n++]<<_,_+=8),O+=g&(1<<T)-1,g>>>=T,_-=T),_<15&&(g+=me[n++]<<_,_+=8,g+=me[n++]<<_,_+=8),k=y[g&C];r:for(;;){if(T=k>>>24,g>>>=T,_-=T,T=k>>>16&255,T&16){if(ne=k&65535,T&=15,_<T&&(g+=me[n++]<<_,_+=8,_<T&&(g+=me[n++]<<_,_+=8)),ne+=g&(1<<T)-1,ne>l){e.msg="invalid distance too far back",pe.mode=su;break e}if(g>>>=T,_-=T,T=o-a,ne>T){if(T=ne-T,T>d&&pe.sane){e.msg="invalid distance too far back",pe.mode=su;break e}if(ae=0,Y=p,f===0){if(ae+=u-T,T<O){O-=T;do ce[o++]=p[ae++];while(--T);ae=o-ne,Y=ce}}else if(f<T){if(ae+=u+f-T,T-=f,T<O){O-=T;do ce[o++]=p[ae++];while(--T);if(ae=0,f<O){T=f,O-=T;do ce[o++]=p[ae++];while(--T);ae=o-ne,Y=ce}}}else if(ae+=f-T,T<O){O-=T;do ce[o++]=p[ae++];while(--T);ae=o-ne,Y=ce}for(;O>2;)ce[o++]=Y[ae++],ce[o++]=Y[ae++],ce[o++]=Y[ae++],O-=3;O&&(ce[o++]=Y[ae++],O>1&&(ce[o++]=Y[ae++]))}else{ae=o-ne;do ce[o++]=ce[ae++],ce[o++]=ce[ae++],ce[o++]=ce[ae++],O-=3;while(O>2);O&&(ce[o++]=ce[ae++],O>1&&(ce[o++]=ce[ae++]))}}else if((T&64)==0){k=y[(k&65535)+(g&(1<<T)-1)];continue r}else{e.msg="invalid distance code",pe.mode=su;break e}break}}else if((T&64)==0){k=b[(k&65535)+(g&(1<<T)-1)];continue t}else if(T&32){pe.mode=PC;break e}else{e.msg="invalid literal/length code",pe.mode=su;break e}break}}while(n<i&&o<s);O=_>>3,n-=O,_-=O<<3,g&=(1<<_)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=o<s?257+(s-o):257-(o-s),pe.hold=g,pe.bits=_},"inflate_fast");const Ha=15,nw=852,iw=592,ow=0,Ff=1,aw=2,MC=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),LC=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),$C=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),BC=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var lc=c((t,e,r,n,i,o,a,s)=>{const l=s.bits;let u=0,d=0,f=0,p=0,g=0,_=0,b=0,y=0,x=0,C=0,k,T,O,ne,ae,Y=null,me=0,ce;const pe=new Uint16Array(Ha+1),Ae=new Uint16Array(Ha+1);let Ye=null,ue=0,Ie,Oe,$e;for(u=0;u<=Ha;u++)pe[u]=0;for(d=0;d<n;d++)pe[e[r+d]]++;for(g=l,p=Ha;p>=1&&pe[p]===0;p--);if(g>p&&(g=p),p===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,s.bits=1,0;for(f=1;f<p&&pe[f]===0;f++);for(g<f&&(g=f),y=1,u=1;u<=Ha;u++)if(y<<=1,y-=pe[u],y<0)return-1;if(y>0&&(t===ow||p!==1))return-1;for(Ae[1]=0,u=1;u<Ha;u++)Ae[u+1]=Ae[u]+pe[u];for(d=0;d<n;d++)e[r+d]!==0&&(a[Ae[e[r+d]]++]=d);if(t===ow?(Y=Ye=a,ce=19):t===Ff?(Y=MC,me-=257,Ye=LC,ue-=257,ce=256):(Y=$C,Ye=BC,ce=-1),C=0,d=0,u=f,ae=o,_=g,b=0,O=-1,x=1<<g,ne=x-1,t===Ff&&x>nw||t===aw&&x>iw)return 1;for(;;){Ie=u-b,a[d]<ce?(Oe=0,$e=a[d]):a[d]>ce?(Oe=Ye[ue+a[d]],$e=Y[me+a[d]]):(Oe=32+64,$e=0),k=1<<u-b,T=1<<_,f=T;do T-=k,i[ae+(C>>b)+T]=Ie<<24|Oe<<16|$e|0;while(T!==0);for(k=1<<u-1;C&k;)k>>=1;if(k!==0?(C&=k-1,C+=k):C=0,d++,--pe[u]==0){if(u===p)break;u=e[r+a[d]]}if(u>g&&(C&ne)!==O){for(b===0&&(b=g),ae+=f,_=u-b,y=1<<_;_+b<p&&(y-=pe[_+b],!(y<=0));)_++,y<<=1;if(x+=1<<_,t===Ff&&x>nw||t===aw&&x>iw)return 1;O=C&ne,i[O]=g<<24|_<<16|ae-o|0}}return C!==0&&(i[ae+C]=u-b<<24|64<<16|0),s.bits=g,0},"inflate_table");const OC=0,sw=1,cw=2,{Z_FINISH:lw,Z_BLOCK:UC,Z_TREES:cu,Z_OK:Uo,Z_STREAM_END:HC,Z_NEED_DICT:WC,Z_STREAM_ERROR:pn,Z_DATA_ERROR:uw,Z_MEM_ERROR:dw,Z_BUF_ERROR:zC,Z_DEFLATED:hw}=Mo,fw=1,pw=2,gw=3,mw=4,vw=5,ww=6,yw=7,bw=8,_w=9,xw=10,lu=11,ki=12,Pf=13,Sw=14,Nf=15,Cw=16,Ew=17,Rw=18,Aw=19,uu=20,du=21,Iw=22,kw=23,Tw=24,Dw=25,Fw=26,Mf=27,Pw=28,Nw=29,Zt=30,Mw=31,qC=32,jC=852,VC=592,GC=15,Lw=c(t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24),"zswap32");function KC(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}c(KC,"InflateState");const $w=c(t=>{if(!t||!t.state)return pn;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=fw,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(jC),e.distcode=e.distdyn=new Int32Array(VC),e.sane=1,e.back=-1,Uo},"inflateResetKeep"),Bw=c(t=>{if(!t||!t.state)return pn;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,$w(t)},"inflateReset"),Ow=c((t,e)=>{let r;if(!t||!t.state)return pn;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?pn:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Bw(t))},"inflateReset2"),Uw=c((t,e)=>{if(!t)return pn;const r=new KC;t.state=r,r.window=null;const n=Ow(t,e);return n!==Uo&&(t.state=null),n},"inflateInit2"),QC=c(t=>Uw(t,GC),"inflateInit");let Hw=!0,Lf,$f;const ZC=c(t=>{if(Hw){Lf=new Int32Array(512),$f=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(lc(sw,t.lens,0,288,Lf,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;lc(cw,t.lens,0,32,$f,0,t.work,{bits:5}),Hw=!1}t.lencode=Lf,t.lenbits=9,t.distcode=$f,t.distbits=5},"fixedtables"),Ww=c((t,e,r,n)=>{let i;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},"updatewindow"),XC=c((t,e)=>{let r,n,i,o,a,s,l,u,d,f,p,g,_,b,y=0,x,C,k,T,O,ne,ae,Y;const me=new Uint8Array(4);let ce,pe;const Ae=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return pn;r=t.state,r.mode===ki&&(r.mode=Pf),a=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,s=t.avail_in,u=r.hold,d=r.bits,f=s,p=l,Y=Uo;e:for(;;)switch(r.mode){case fw:if(r.wrap===0){r.mode=Pf;break}for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.wrap&2&&u===35615){r.check=0,me[0]=u&255,me[1]=u>>>8&255,r.check=yr(r.check,me,2,0),u=0,d=0,r.mode=pw;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=Zt;break}if((u&15)!==hw){t.msg="unknown compression method",r.mode=Zt;break}if(u>>>=4,d-=4,ae=(u&15)+8,r.wbits===0)r.wbits=ae;else if(ae>r.wbits){t.msg="invalid window size",r.mode=Zt;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=u&512?xw:ki,u=0,d=0;break;case pw:for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==hw){t.msg="unknown compression method",r.mode=Zt;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Zt;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(me[0]=u&255,me[1]=u>>>8&255,r.check=yr(r.check,me,2,0)),u=0,d=0,r.mode=gw;case gw:for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&(me[0]=u&255,me[1]=u>>>8&255,me[2]=u>>>16&255,me[3]=u>>>24&255,r.check=yr(r.check,me,4,0)),u=0,d=0,r.mode=mw;case mw:for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(me[0]=u&255,me[1]=u>>>8&255,r.check=yr(r.check,me,2,0)),u=0,d=0,r.mode=vw;case vw:if(r.flags&1024){for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(me[0]=u&255,me[1]=u>>>8&255,r.check=yr(r.check,me,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=ww;case ww:if(r.flags&1024&&(g=r.length,g>s&&(g=s),g&&(r.head&&(ae=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+g),ae)),r.flags&512&&(r.check=yr(r.check,n,g,o)),s-=g,o+=g,r.length-=g),r.length))break e;r.length=0,r.mode=yw;case yw:if(r.flags&2048){if(s===0)break e;g=0;do ae=n[o+g++],r.head&&ae&&r.length<65536&&(r.head.name+=String.fromCharCode(ae));while(ae&&g<s);if(r.flags&512&&(r.check=yr(r.check,n,g,o)),s-=g,o+=g,ae)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=bw;case bw:if(r.flags&4096){if(s===0)break e;g=0;do ae=n[o+g++],r.head&&ae&&r.length<65536&&(r.head.comment+=String.fromCharCode(ae));while(ae&&g<s);if(r.flags&512&&(r.check=yr(r.check,n,g,o)),s-=g,o+=g,ae)break e}else r.head&&(r.head.comment=null);r.mode=_w;case _w:if(r.flags&512){for(;d<16;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Zt;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ki;break;case xw:for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}t.adler=r.check=Lw(u),u=0,d=0,r.mode=lu;case lu:if(r.havedict===0)return t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,WC;t.adler=r.check=1,r.mode=ki;case ki:if(e===UC||e===cu)break e;case Pf:if(r.last){u>>>=d&7,d-=d&7,r.mode=Mf;break}for(;d<3;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=Sw;break;case 1:if(ZC(r),r.mode=uu,e===cu){u>>>=2,d-=2;break e}break;case 2:r.mode=Ew;break;case 3:t.msg="invalid block type",r.mode=Zt}u>>>=2,d-=2;break;case Sw:for(u>>>=d&7,d-=d&7;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if((u&65535)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Zt;break}if(r.length=u&65535,u=0,d=0,r.mode=Nf,e===cu)break e;case Nf:r.mode=Cw;case Cw:if(g=r.length,g){if(g>s&&(g=s),g>l&&(g=l),g===0)break e;i.set(n.subarray(o,o+g),a),s-=g,o+=g,l-=g,a+=g,r.length-=g;break}r.mode=ki;break;case Ew:for(;d<14;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Zt;break}r.have=0,r.mode=Rw;case Rw:for(;r.have<r.ncode;){for(;d<3;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.lens[Ae[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[Ae[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,ce={bits:r.lenbits},Y=lc(OC,r.lens,0,19,r.lencode,0,r.work,ce),r.lenbits=ce.bits,Y){t.msg="invalid code lengths set",r.mode=Zt;break}r.have=0,r.mode=Aw;case Aw:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],x=y>>>24,C=y>>>16&255,k=y&65535,!(x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(k<16)u>>>=x,d-=x,r.lens[r.have++]=k;else{if(k===16){for(pe=x+2;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u>>>=x,d-=x,r.have===0){t.msg="invalid bit length repeat",r.mode=Zt;break}ae=r.lens[r.have-1],g=3+(u&3),u>>>=2,d-=2}else if(k===17){for(pe=x+3;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=x,d-=x,ae=0,g=3+(u&7),u>>>=3,d-=3}else{for(pe=x+7;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=x,d-=x,ae=0,g=11+(u&127),u>>>=7,d-=7}if(r.have+g>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Zt;break}for(;g--;)r.lens[r.have++]=ae}}if(r.mode===Zt)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Zt;break}if(r.lenbits=9,ce={bits:r.lenbits},Y=lc(sw,r.lens,0,r.nlen,r.lencode,0,r.work,ce),r.lenbits=ce.bits,Y){t.msg="invalid literal/lengths set",r.mode=Zt;break}if(r.distbits=6,r.distcode=r.distdyn,ce={bits:r.distbits},Y=lc(cw,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,ce),r.distbits=ce.bits,Y){t.msg="invalid distances set",r.mode=Zt;break}if(r.mode=uu,e===cu)break e;case uu:r.mode=du;case du:if(s>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,NC(t,p),a=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,s=t.avail_in,u=r.hold,d=r.bits,r.mode===ki&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],x=y>>>24,C=y>>>16&255,k=y&65535,!(x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(C&&(C&240)==0){for(T=x,O=C,ne=k;y=r.lencode[ne+((u&(1<<T+O)-1)>>T)],x=y>>>24,C=y>>>16&255,k=y&65535,!(T+x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=T,d-=T,r.back+=T}if(u>>>=x,d-=x,r.back+=x,r.length=k,C===0){r.mode=Fw;break}if(C&32){r.back=-1,r.mode=ki;break}if(C&64){t.msg="invalid literal/length code",r.mode=Zt;break}r.extra=C&15,r.mode=Iw;case Iw:if(r.extra){for(pe=r.extra;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=kw;case kw:for(;y=r.distcode[u&(1<<r.distbits)-1],x=y>>>24,C=y>>>16&255,k=y&65535,!(x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if((C&240)==0){for(T=x,O=C,ne=k;y=r.distcode[ne+((u&(1<<T+O)-1)>>T)],x=y>>>24,C=y>>>16&255,k=y&65535,!(T+x<=d);){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}u>>>=T,d-=T,r.back+=T}if(u>>>=x,d-=x,r.back+=x,C&64){t.msg="invalid distance code",r.mode=Zt;break}r.offset=k,r.extra=C&15,r.mode=Tw;case Tw:if(r.extra){for(pe=r.extra;d<pe;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Zt;break}r.mode=Dw;case Dw:if(l===0)break e;if(g=p-l,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Zt;break}g>r.wnext?(g-=r.wnext,_=r.wsize-g):_=r.wnext-g,g>r.length&&(g=r.length),b=r.window}else b=i,_=a-r.offset,g=r.length;g>l&&(g=l),l-=g,r.length-=g;do i[a++]=b[_++];while(--g);r.length===0&&(r.mode=du);break;case Fw:if(l===0)break e;i[a++]=r.length,l--,r.mode=du;break;case Mf:if(r.wrap){for(;d<32;){if(s===0)break e;s--,u|=n[o++]<<d,d+=8}if(p-=l,t.total_out+=p,r.total+=p,p&&(t.adler=r.check=r.flags?yr(r.check,i,p,a-p):ec(r.check,i,p,a-p)),p=l,(r.flags?u:Lw(u))!==r.check){t.msg="incorrect data check",r.mode=Zt;break}u=0,d=0}r.mode=Pw;case Pw:if(r.wrap&&r.flags){for(;d<32;){if(s===0)break e;s--,u+=n[o++]<<d,d+=8}if(u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Zt;break}u=0,d=0}r.mode=Nw;case Nw:Y=HC;break e;case Zt:Y=uw;break e;case Mw:return dw;case qC:default:return pn}return t.next_out=a,t.avail_out=l,t.next_in=o,t.avail_in=s,r.hold=u,r.bits=d,(r.wsize||p!==t.avail_out&&r.mode<Zt&&(r.mode<Mf||e!==lw))&&Ww(t,t.output,t.next_out,p-t.avail_out),f-=t.avail_in,p-=t.avail_out,t.total_in+=f,t.total_out+=p,r.total+=p,r.wrap&&p&&(t.adler=r.check=r.flags?yr(r.check,i,p,t.next_out-p):ec(r.check,i,p,t.next_out-p)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ki?128:0)+(r.mode===uu||r.mode===Nf?256:0),(f===0&&p===0||e===lw)&&Y===Uo&&(Y=zC),Y},"inflate$2"),YC=c(t=>{if(!t||!t.state)return pn;let e=t.state;return e.window&&(e.window=null),t.state=null,Uo},"inflateEnd"),JC=c((t,e)=>{if(!t||!t.state)return pn;const r=t.state;return(r.wrap&2)==0?pn:(r.head=e,e.done=!1,Uo)},"inflateGetHeader"),e1=c((t,e)=>{const r=e.length;let n,i,o;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==lu)?pn:n.mode===lu&&(i=1,i=ec(i,e,r,0),i!==n.check)?uw:(o=Ww(t,e,r,r),o?(n.mode=Mw,dw):(n.havedict=1,Uo))},"inflateSetDictionary");var t1=Bw,r1=Ow,n1=$w,i1=QC,o1=Uw,a1=XC,s1=YC,c1=JC,l1=e1,u1="pako inflate (from Nodeca project)",Ti={inflateReset:t1,inflateReset2:r1,inflateResetKeep:n1,inflateInit:i1,inflateInit2:o1,inflate:a1,inflateEnd:s1,inflateGetHeader:c1,inflateSetDictionary:l1,inflateInfo:u1};function d1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}c(d1,"GZheader");var h1=d1;const zw=Object.prototype.toString,{Z_NO_FLUSH:f1,Z_FINISH:p1,Z_OK:uc,Z_STREAM_END:Bf,Z_NEED_DICT:Of,Z_STREAM_ERROR:g1,Z_DATA_ERROR:qw,Z_MEM_ERROR:m1}=Mo;function dc(t){this.options=ou.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new tw,this.strm.avail_out=0;let r=Ti.inflateInit2(this.strm,e.windowBits);if(r!==uc)throw new Error(No[r]);if(this.header=new h1,Ti.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=sc.string2buf(e.dictionary):zw.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Ti.inflateSetDictionary(this.strm,e.dictionary),r!==uc)))throw new Error(No[r])}c(dc,"Inflate$1"),dc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(e===~~e?a=e:a=e===!0?p1:f1,zw.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Ti.inflate(r,a),o===Of&&i&&(o=Ti.inflateSetDictionary(r,i),o===uc?o=Ti.inflate(r,a):o===qw&&(o=Of));r.avail_in>0&&o===Bf&&r.state.wrap>0&&t[r.next_in]!==0;)Ti.inflateReset(r),o=Ti.inflate(r,a);switch(o){case g1:case qw:case Of:case m1:return this.onEnd(o),this.ended=!0,!1}if(s=r.avail_out,r.next_out&&(r.avail_out===0||o===Bf))if(this.options.to==="string"){let l=sc.utf8border(r.output,r.next_out),u=r.next_out-l,d=sc.buf2string(r.output,l);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(l,l+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===uc&&s===0)){if(o===Bf)return o=Ti.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},dc.prototype.onData=function(t){this.chunks.push(t)},dc.prototype.onEnd=function(t){t===uc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ou.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Uf(t,e){const r=new dc(e);if(r.push(t),r.err)throw r.msg||No[r.err];return r.result}c(Uf,"inflate$1");function v1(t,e){return e=e||{},e.raw=!0,Uf(t,e)}c(v1,"inflateRaw$1");var w1=dc,y1=Uf,b1=v1,_1=Uf,x1=Mo,S1={Inflate:w1,inflate:y1,inflateRaw:b1,ungzip:_1,constants:x1};const{Deflate:C1,deflate:E1,deflateRaw:R1,gzip:A1}=FC,{Inflate:I1,inflate:k1,inflateRaw:T1,ungzip:D1}=S1;var F1=C1,P1=E1,N1=R1,M1=A1,L1=I1,$1=k1,B1=T1,jw=D1,O1=Mo,pR={Deflate:F1,deflate:P1,deflateRaw:N1,gzip:M1,Inflate:L1,inflate:$1,inflateRaw:B1,ungzip:jw,constants:O1};class Hf{constructor(e){this.bytes=e,this.byteIndexCurrent=0}hasMoreBytes(){return this.byteIndexCurrent<this.bytes.length}readBytes(e){const r=this.byteIndexCurrent;return this.byteIndexCurrent+=e,this.bytes.slice(r,this.byteIndexCurrent)}readByte(){const e=this.bytes[this.byteIndexCurrent];return this.byteIndexCurrent++,e}readString(e){const r=[],n=this.byteIndexCurrent+e;let i=this.byteIndexCurrent;for(;i<n;){const o=this.bytes[i++];if(o===0)break;let a=0,s=0;if((o&128)==0)a=o,s=0;else if((o&224)==192)a=o&31,s=1;else if((o&240)==224)a=o&15,s=2;else if((o&248)==240)a=o&7,s=3;else throw Error(`Invalid unicode, unknown multibyte encoding header ${o.toString(2)} at offset ${i}`);for(;s>0;){const l=this.bytes[i++];if((l&192)!=128)throw Error(`Invalid unicode, unexpected multibyte encoding trailer ${l.toString(2)} at offset ${i}`);a=a<<6|l&63,s--}r.push(String.fromCodePoint(a))}return this.byteIndexCurrent=n,r.join("")}}c(Hf,"ByteStream");class Lr{constructor(e,r){this.value=e,this.id=`_${this.value}`,this.name=r}static Instances(){return Lr._instances==null&&(Lr._instances=new Vw),Lr._instances}}c(Lr,"TarFileTypeFlag");class Vw{constructor(){this.Normal=new Lr("0","Normal"),this.HardLink=new Lr("1","Hard Link"),this.SymbolicLink=new Lr("2","Symbolic Link"),this.CharacterSpecial=new Lr("3","Character Special"),this.BlockSpecial=new Lr("4","Block Special"),this.Directory=new Lr("5","Directory"),this.FIFO=new Lr("6","FIFO"),this.ContiguousFile=new Lr("7","Contiguous File"),this.LongFilePath=new Lr("L","././@LongLink"),this._All=[this.Normal,this.HardLink,this.SymbolicLink,this.CharacterSpecial,this.BlockSpecial,this.Directory,this.FIFO,this.ContiguousFile,this.LongFilePath];for(let e=0;e<this._All.length;e++){const r=this._All[e];this._All[r.id]=r}}}c(Vw,"TarFileTypeFlag_Instances");class hu{constructor(e,r,n,i,o,a,s,l,u,d,f,p,g,_,b,y){this.fileName=e,this.fileMode=r,this.userIDOfOwner=n,this.userIDOfGroup=i,this.fileSizeInBytes=o,this.timeModifiedInUnixFormat=a,this.checksum=s,this.typeFlag=l,this.nameOfLinkedFile=u,this.uStarIndicator=d,this.uStarVersion=f,this.userNameOfOwner=p,this.groupNameOfOwner=g,this.deviceNumberMajor=_,this.deviceNumberMinor=b,this.filenamePrefix=y,this.fullFileName=y.length?y.endsWith("/")?y+e:`${y}/${e}`:e}static fromBytes(e){const r=new Hf(e),n=r.readString(100).trim(),i=r.readString(8),o=r.readString(8),a=r.readString(8),s=r.readString(12),l=r.readBytes(12),u=r.readString(8),d=r.readString(1),f=r.readString(100),p=r.readString(6),g=r.readString(2),_=r.readString(32),b=r.readString(32),y=r.readString(8),x=r.readString(8),C=r.readString(155),k=r.readBytes(12),T=parseInt(s.trim(),8),O=parseInt(u,8),ne=Lr.Instances()._All,ae=`_${d}`,Y=ne[ae];return new hu(n,i,o,a,T,l,O,Y,f,p,g,_,b,y,x,C)}}c(hu,"TarFileEntryHeader");const Gw=512;class fu{constructor(e,r){this.header=e,this.dataAsBytes=r}static fromBytes(e,r){const n=Gw,i=hu.fromBytes(e),o=i.fileSizeInBytes,s=Math.ceil(o/n)*n,l=r.readBytes(s).slice(0,o);return new fu(i,l)}}c(fu,"TarFileEntry");class pu{constructor(e){var r;this.entries=e,this.consolidateLongPathEntries();for(const n of this.entries)((r=n.header.typeFlag)==null?void 0:r.name)==="Normal"&&(n.header.fullFileName=n.header.fullFileName.replace(/^[^/]+\/?/,""));this.entryMap=new Map;for(const n of this.entries)this.entryMap.set(n.header.fullFileName,n)}static async fromBytes(e){const r=new Hf(e),n=[],i=Gw;let o=0,a=0;for(;r.hasMoreBytes()==!0;){++o%1e3==0&&await new Promise(u=>setTimeout(u,10));const s=r.readBytes(i);let l=!0;for(let u=0;u<s.length;u++)if(s[u]!=0){l=!1;break}if(l==!0){if(a++,a==2)break}else{a=0;const u=fu.fromBytes(s,r);n.push(u)}}return new pu(n)}consolidateLongPathEntries(){var e;const r=Lr.Instances().LongFilePath.name,n=this.entries;for(let i=0;i<n.length;i++){const o=n[i];if(((e=o.header.typeFlag)==null?void 0:e.name)==r){const a=n[i+1];a.header.fileName=o.dataAsBytes.reduce((s,l)=>s+=String.fromCharCode(l),""),a.header.fileName=a.header.fileName.replace(/\0/g,""),n.splice(i,1),i--}}}}c(pu,"TarFile");const U1=c(t=>pu.fromBytes(t),"readTar"),gn=(0,m.loadMessageBundle)(),gu=new TextDecoder,Wf=new TextEncoder;class Kw{constructor(e,r=0){this.retainFor=r;try{this.weakRef=new WeakRef(e)}catch{}this.retain(e)}retain(e){this.retainTimeout&&clearTimeout(this.retainTimeout),this.strongRef=e,this.retainTimeout=setTimeout(()=>{this.strongRef=void 0,this.retainTimeout=void 0},this.retainFor)}deref(){var e,r;const n=(r=this.strongRef)!=null?r:(e=this.weakRef)==null?void 0:e.deref();return n&&this.retain(n),n}}c(Kw,"TimedRetainingRef");class Qw{constructor(e,r){this.root=e,this.providerService=r,this._onDidChangeIndexingEnablement=new h.EventEmitter,this._onDidDownloadTar=new h.EventEmitter,this.ongoingDiskRequests=new Map,this.ongoingNetworkRequests=new Map,this.indexingDisabled=!1,this.usageFile=h.Uri.joinPath(this.root,"usageHistory.json"),this.indexingAllowanceFile=h.Uri.joinPath(this.root,"indexAllowances.json"),this._disposable=h.Disposable.from(...this.registerCommands()),this.updateContext()}get onDidChangeIndexingEnablement(){return this._onDidChangeIndexingEnablement.event}get onDidDownloadTar(){return this._onDidDownloadTar.event}async updateContext(){await hi(Un.HasSearchIndexes,(await this.listTars()).length>0);const e=this.providerService.repositories.map(i=>i.name),r=await this.getIndexingEnabledRepos(),n=r.has("*")||e.every(i=>r.has(i));await hi(Un.EnabledSomeSearchIndexes,r.size>0),await hi(Un.EnabledAllSearchIndexes,n)}dispose(){this._disposable.dispose()}registerCommands(){return[h.commands.registerCommand("remoteHub.configureIndexingAllowedRepos",async()=>{await this.configureIndexingAllowedRepos()}),h.commands.registerCommand("remoteHub.disableIndexingForSession",()=>(this.temporarilyDisableIndexing(),{triggerSearch:!0})),h.commands.registerCommand("remoteHub.enableIndexing",async()=>(await this.markIndexingEnablementForRepos(!0),{triggerSearch:!0})),h.commands.registerCommand("remoteHub.deleteLocalRepositoryData",async()=>{const e=c(i=>{const o=[{power:9,name:"GB"},{power:6,name:"MB"},{power:3,name:"kB"},{power:0,name:"B"}];for(const a of o)if(i>10**a.power)return`${Math.round(i/10**a.power)} ${a.name}`;return"Unknown size"},"humanReadableSize"),r=await this.listTars();if(r.length===0){await h.window.showInformationMessage("No Repository Indexes Found");return}const n=h.window.createQuickPick();n.canSelectMany=!0,n.items=r.map(({name:i,size:o,path:a})=>({label:i,path:a,description:o?e(o):void 0})),n.show(),n.onDidAccept(async()=>{n.hide();for(const{label:i,path:o}of n.selectedItems){const a=h.workspace.fs.delete(o),s=h.window.setStatusBarMessage(`$(loading) Deleting ${i}`,a);await a,s.dispose()}this.updateContext()}),n.onDidHide(()=>n.dispose())}),h.commands.registerCommand("remoteHub.deleteAllLocalRepositoryData",()=>h.window.withProgress({location:h.ProgressLocation.Notification,title:"Deleting Repository Indexes..."},async()=>{this.lastReadKey=void 0,this.lastReadValue=void 0;try{await Promise.all([h.workspace.fs.delete(this.root,{recursive:!0})])}catch(e){te.error(e)}finally{this.updateContext()}}))]}getTarFromMemory(e){var r;if(e===this.lastReadKey){const n=(r=this.lastReadValue)==null?void 0:r.deref();if(n)return n;te.log("Weakref deallocated.")}}async getTarFromDisk(e){try{const r=await h.workspace.fs.readFile(e);return!r||!r.length?void 0:r}catch(r){(!(r instanceof h.FileSystemError)||r.code!==h.FileSystemError.FileNotFound.name)&&(h.window.showWarningMessage(gn("diskReadUnexpectedError","Unexpected error reading index from disk, attempting to reload from network")),te.error(r,"Unexpected error reading tarball from disk"));return}}async getTarFromNetwork(e,r){try{const n=await this.isIndexingEnabledForRepo(e);try{if(n){const i=await this.providerService.getTarGz(e);if(i)return i}else if(n===void 0){const i=fe.get("indexing.maxIndexSize");if(i===null)throw new h.CancellationError;if(i){const o=await this.providerService.getTarGz(e,i*1024*1024);if(o)return o}}}catch(i){if(i instanceof h.CancellationError)throw await this.markIndexingEnablementForRepos(!1),i;if(i instanceof Error&&i.message==="LIMIT_HIT")await this.markIndexingEnablementForRepos(!1);else throw i}if(!r){const i={id:"configure",title:gn("configure","Configure Limit")},o={id:"continue",title:gn("continue","Continue"),isCloseAffordance:!0};h.window.showInformationMessage(gn("bigRepo","Repository exceeds download size limit! Continuing with partial text services."),i,o).then(async a=>{a===i&&await h.commands.executeCommand("workbench.action.openSettings","remoteHub.indexing")})}if(r){const i={id:"no",title:gn("cancel","Use Partial Services"),isCloseAffordance:!0},o={id:"configure",title:gn("configure","Configure")},a={id:"repo",title:gn("continue","Download Full Contents")},s=fe.get("indexing.maxIndexSize"),l=s?`${s.toString()}\xA0MB`:"null";switch(await h.window.showWarningMessage(gn("bigRepo","This repository exceeds the download size limit ({0}).",l),{modal:!0,useCustom:!0,detail:gn("downloadUse","Continue using a partial version of text services like workspace search and global references, or ignore the limit and download this repository's full contents.",l)},i,a,o)){case a:{await this.markIndexingEnablementForRepos(!0);try{const d=await this.providerService.getTarGz(e);if(d)return d}catch(d){d instanceof h.CancellationError&&await this.markIndexingEnablementForRepos(!1)}break}case o:await h.commands.executeCommand("workbench.action.openSettings","remoteHub.indexing");break;case i:await this.markIndexingEnablementForRepos(!1)}}throw new h.CancellationError}finally{this.updateContext()}}async getTar(e,r,n){n===void 0&&({HEAD:{sha:n}}=await this.providerService.getMetadata(e));const i=this.getTarStorageUri(e,n),o=await this.getTarCacheKey(e,n);try{let a=this.ongoingNetworkRequests.get(o);return a===void 0&&(a=this.getTarCore(e,n,i,{blocking:r}),this.ongoingNetworkRequests.set(o,a),this.ongoingDiskRequests.set(o,a)),await a}finally{this.ongoingNetworkRequests.delete(o),this.ongoingDiskRequests.delete(o)}}async getInMemoryTar(e){return this.getTarFromMemory(await this.getTarCacheKey(e))}async getCachedTar(e,r){var n;const i=await this.getTarCacheKey(e,r),o=this.getTarStorageUri(e,r);try{let a=(n=this.ongoingDiskRequests.get(i))!=null?n:this.ongoingNetworkRequests.get(i);return a===void 0&&(a=this.getTarCore(e,r,o,{skipDownload:!0,blocking:!1}),this.ongoingDiskRequests.set(i,a)),await a}finally{this.ongoingDiskRequests.delete(i)}}async getTarCore(e,r,n,i){const o=this.providerService.getCanonicalUri(e),a=`${L(o,{excludeScheme:!0})}/${r}`,s=new Fe(`TarPit.getTar(${a})`),l=await this.getTarCacheKey(e,r),u=Date.now();let d,f;try{if(s.logStep("Getting .tar from memory",{suffix:" \u2022 Getting .tar from memory..."}),f=this.getTarFromMemory(l),f)return d=" \u2022 Got .tar from memory",f;s.logStep("Getting .tar from disk",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from disk..."});let p=!1,g=await this.getTarFromDisk(n);if(g==null?void 0:g.length)d=" \u2022 Got .tar from disk";else{if(i==null?void 0:i.skipDownload){d=" \u2022 Skipped download";return}if(await this.isIndexingEnabledForRepo(e)===!1)throw d=" \u2022 Downloading disabled",new h.CancellationError;s.logStep("Getting .tar from network",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from network..."}),g=await this.getTarFromNetwork(e,i.blocking),p=!0,d=" \u2022 Got .tar from network",h.workspace.fs.writeFile(n,g).then(()=>te.debug(`Sucessfully wrote tarball to disk in ${Date.now()-u}ms`),b=>te.error(b,`Error writing tarball to disk in ${Date.now()-u}ms`))}if(!(g==null?void 0:g.length))throw new Error("Internal Error: Invalid repository index. Try deleting repository data and running operation again: `GitHub Repositories: Delete Local Repository Data...`");s.logStep("Unzipping .tar",{suffix:" \u2022 Unzipping .tar..."});const _=jw(g);return f=await U1(_),s.stop({message:"Finished getting tar"}),this.lastReadValue=new Kw(f,10*(Date.now()-u)),this.lastReadKey=l,p&&setTimeout(()=>this._onDidDownloadTar.fire({rootUri:e,sha:r}),0),f}catch(p){throw d=` \u2022 Failed; ${String(p)}`,p}finally{f&&(this.markCacheEntryUsed(`${a}`).catch(p=>te.log(`Error marking entry used: ${p}`)),this.cleanUpCache().catch(p=>te.log(`Error cleaning cache: ${p}`))),s.stop(d?{suffix:d}:void 0)}}async getTarCacheKey(e,r){return r===void 0&&({HEAD:{sha:r}}=await this.providerService.getMetadata(e)),this.getTarStorageUri(e,r).toString()}getTarStorageUri(e,r){return h.Uri.joinPath(this.root,"tars",L(this.providerService.getCanonicalUri(e),{excludeScheme:!0}),r)}async readDir(e){try{return(await h.workspace.fs.readDirectory(e)).map(r=>h.Uri.joinPath(e,r[0]))}catch{return[]}}temporarilyDisableIndexing(){this.indexingDisabled=!0}async isIndexingEnabledForRepo(e){if(this.indexingDisabled)return!1;const r=await this.getIndexingEnabledRepos();if(r.has("*"))return!0;const{name:n}=this.providerService.getVirtualUriMetadata(e);if(!!n){if(r.has(n))return!0;if(r.has(`-${n}`))return!1}}async configureIndexingAllowedRepos(){const e=[...(await this.getIndexingEnabledRepos()).values()],r=await h.window.showQuickPick(e.map(n=>({picked:!0,label:n.startsWith("-")?`${gn("disallowed","Disallowed:")} ${n.slice(1)}`:`${gn("disallowed","Allowed:")} ${n}`})),{canPickMany:!0,title:gn("select repos where indexing is allowed","Repository index allowance overrides")});r&&await this.writeIndexEnablementData(r.map(n=>n.label))}async getIndexingEnabledRepos(){let e;try{e=JSON.parse(gu.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(r){r instanceof h.FileSystemError&&r.code!==h.FileSystemError.FileNotFound().code&&te.error(r,"Error reading index allowance data."),e=[]}return new Set(e)}async listTars(){const e=await this.readDir(h.Uri.joinPath(this.root,"tars")).catch(()=>[]),r=(await Promise.all(e.map(o=>this.readDir(o)))).flat(),n=(await Promise.all(r.map(o=>this.readDir(o)))).flat(),i=(await Promise.all(n.map(o=>this.readDir(o)))).flat();return Promise.all(i.map(async o=>({name:o.path.replace(/^.*\/tars\//,""),path:o,size:(await h.workspace.fs.stat(o)).size})))}async markIndexingEnablementForRepos(e){let r;try{r=JSON.parse(gu.decode(await h.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(o){o instanceof h.FileSystemError&&o.code!==h.FileSystemError.FileNotFound().code&&te.error(o,"Error reading index allowance data."),r=[]}const n=e?this.providerService.repositories.map(o=>o.name):[],i=e?[]:this.providerService.repositories.map(o=>o.name);r=[...r,...n].filter(o=>o.startsWith("-")?!n.includes(o.slice(1)):!i.includes(o));for(const o of i)r.push(`-${o}`);this.indexingDisabled=!1,await this.writeIndexEnablementData(r)}async writeIndexEnablementData(e){await h.workspace.fs.writeFile(this.indexingAllowanceFile,Wf.encode(JSON.stringify(e))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markCacheEntryUsed(e){let r;try{r=JSON.parse(gu.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(n){n instanceof h.FileSystemError&&n.code!==h.FileSystemError.FileNotFound().code&&te.error(n,"Error reading usage data."),r={}}r[e]=Number(Date.now()),await h.workspace.fs.writeFile(this.usageFile,Wf.encode(JSON.stringify(r)))}async cleanUpCache(){var e,r;te.log("Cleaning up search cache...");const n=await this.listTars();let i;try{i=JSON.parse(gu.decode(await h.workspace.fs.readFile(this.usageFile)))}catch(g){g instanceof h.FileSystemError&&g.code!==h.FileSystemError.FileNotFound().code&&te.error(g,"Error reading usage data. All existing indexes will be discarded."),i={}}const o=[];n.forEach(g=>{var _;const b=/^([^/]*\/[^/]*)\//.exec(g.name);if(!b)throw Error("Unexpected repo entry");const y=b[1],x=(_=i[g.name])!=null?_:0;o.push({...g,lastUsed:x,repo:y})}),o.sort((g,_)=>_.lastUsed-g.lastUsed);let a=0;const s=[],l=new Map,u=(e=fe.get("indexing.cacheSizeLimit"))!=null?e:fe.get("search.download.sizeLimit"),d=(r=fe.get("indexing.cacheRepoLimit"))!=null?r:fe.get("search.download.repoLimit"),f=(u!=null?u:100)*1024*1024,p=d!=null?d:4;o.forEach(g=>{var _,b;(g.lastUsed===0||a>f||((_=l.get(g.repo))!=null?_:0)>p)&&s.push(g),a+=g.size,l.set(g.repo,((b=l.get(g.repo))!=null?b:0)+1)}),await Promise.all(s.map(async g=>{try{await h.workspace.fs.delete(g.path,{recursive:!0}),delete i[g.name],te.log(`Deleted cache entry for ${g.name}`)}catch(_){te.log(`Deleting cache entry for ${g.name} failed; ${String(_)}`)}})),await h.workspace.fs.writeFile(this.usageFile,Wf.encode(JSON.stringify(i))),await this.updateContext()}}c(Qw,"TarPit");const H1=(0,m.loadMessageBundle)();async function W1(t,e,r,n,i,o,a){return zf("provideTextSearchResults",async()=>{const s=zx(n.pattern,Boolean(n.isRegExp),{matchCase:n.isCaseSensitive,wholeWord:n.isWordMatch,multiline:n.isMultiline,global:!0});let l;try{l=await zf("fetch tarball",()=>r.getTar(i.folder,!0))}catch(y){if(y instanceof h.CancellationError)throw y;return{limitHit:!1,message:{type:h.TextSearchCompleteMessageType.Warning,trusted:!0,text:H1("indexNotAvailable","Repository index not available. [Retry with indexing disabled]({0}).","command:remoteHub.disableIndexingForSession")}}}if(a.isCancellationRequested)return{limitHit:!1};const{maxResults:u,maxFileSize:d,includes:f,excludes:p}=i,g=await z1(i.folder,t,l,e);if(a.isCancellationRequested)return{limitHit:!0};let _=u;const b=qx(g,f,p,d);return zf("searchFiles",async()=>{var y,x;let C=0;for(const k of g){if(!b.has(k.path))continue;const T=jx(k.contents,k.path,s,{beforeContext:(y=i.beforeContext)!=null?y:0,afterContext:(x=i.afterContext)!=null?x:0,previewOptions:i.previewOptions,remainingResultQuota:_});for(const O of T)o.report({...O,uri:h.Uri.joinPath(i.folder,O.uri.path)});if(_!==void 0&&(_-=T.length,_<=0))return{limitHit:!0};if(C++,C%1e4==0&&(await new Promise(O=>setTimeout(O,0)),a.isCancellationRequested))return{limitHit:!1}}return{limitHit:!1}})})}c(W1,"provideTextSearchResults");async function z1(t,e,r,n){const i=r.entries,o=e.getVirtualRootUri(t),a=await n.getChanges(o,{predicate:f=>f.fileType===h.FileType.File});if(a.length===0)return i.map(f=>({contents:f.dataAsBytes,path:f.header.fullFileName,size:f.dataAsBytes.byteLength}));const s=await Promise.all(Bl(a,f=>{if(f.type===q.Created)return n.getContent(f.uri).then(p=>({path:e.getRelativeFilePath(o,f.uri),size:p.length,contents:p}))})),l=await Promise.all(Bl(a,f=>{if(f.type===q.Changed)return n.getContent(f.uri).then(p=>({path:e.getRelativeFilePath(o,f.uri),size:p.length,contents:p}))})),u=new Set(Ax(Os(l,f=>f.path),Bl(a,f=>{if(f.type===q.Deleted)return e.getRelativeFilePath(o,f.uri)})));return[...Bl(i,f=>{if(!u.has(f.header.fullFileName))return{contents:f.dataAsBytes,path:f.header.fullFileName,size:f.dataAsBytes.byteLength}}),...s,...l]}c(z1,"listAllFiles");function gR(t,e){const r=Date.now(),n=e();return Logger.log(`${t} time: ${Date.now()-r}`),n}c(gR,"timeSync");async function zf(t,e){const r=Date.now(),n=await e();return te.log(`${t} time: ${Date.now()-r}`),n}c(zf,"time");var q1=Object.defineProperty,j1=Object.getOwnPropertyDescriptor,qf=c((t,e,r,n)=>{for(var i=n>1?void 0:n?j1(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&q1(e,r,i),i},"github_fs_decorateClass");const jf=(0,m.loadMessageBundle)(),V1=h.FileSystemError.FileNotFound().code,G1=/(\/|\\)/g,Zw=".vscode/.github-pull-request.rec";class hc{constructor(e,r,n,i,o){this.providerService=e,this.github=r,this.changeStore=n,this.tarPit=i,this.telemetryService=o,this._onDidChangeFile=new h.EventEmitter,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=h.Disposable.from(h.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),h.workspace.registerFileSearchProvider(this.scheme,this),h.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(a=>{a.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([a.repository.uri])}),e.onDidRefresh(a=>this.onRefreshOrRepositoryChanged(a)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.github.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Nr.getProviderId(r)===this.scheme).map(r=>B.getProviderUri(r)),e.length!==0){te.log(`GitHubFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>A(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);this.updateOpenOrWatchedUris(e)}}updateOpenOrWatchedUris(e){const r=B.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(a=>A(o,a))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));te.debug(`GitHubFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(E(i),i);const n=[...r.values()].map(i=>({type:h.FileChangeType.Changed,uri:i}));setTimeout(()=>{te.debug(`GitHubFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=E(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){var r,n;const i=E(e);this.implicitlyWatchedUris.set(i,e);const o=this.providerService.getRelativeFilePath(e),a={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${i}`,a);const s=await this.github.getFileTree(e),l=await s.get(o);if(l==null?void 0:l.stat)return l==null?void 0:l.stat;if(this.implicitlyWatchedUris.delete(i),e.query==="~")return{type:h.FileType.File,size:0,ctime:0,mtime:(r=s.timestamp)!=null?r:Date.now(),permissions:h.FilePermission.Readonly};if(o===Zw){const{ref:u}=this.providerService.getVirtualUriMetadata(e);if((u==null?void 0:u.type)===De.PullRequest)return{type:h.FileType.File,size:0,ctime:0,mtime:(n=s.timestamp)!=null?n:Date.now(),permissions:h.FilePermission.Readonly}}throw h.FileSystemError.FileNotFound(e)}finally{this.pendingUriRequests.delete(`stat:${i}`),(a==null?void 0:a.outdated)&&setTimeout(()=>{te.log(`GitHubFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async readDirectory(e,r){var n;this.implicitlyWatchedUris.set(E(e),e);let i;const o=this.providerService.getRelativeFilePath(e);let a;try{return i=await this.github.getFileTree(e),(await i.getChildren(o,r)).map(([l,{stat:{type:u}}])=>[l,u])}catch(s){throw a=s,o===""&&s instanceof Error&&this.telemetryService.sendErrorEvent("fs.readRootDirectory.error",{errorName:s.name,errorMessage:s.message,errorStack:(n=s.stack)!=null?n:""},void 0,[]),s}finally{o===""&&(Fe.stop("Time to root directory"),this.telemetryService.reportWorkbenchLoadResult({result:a===void 0?"Success":"Failure",errorMessage:(i==null?void 0:i.hasEntireTree)?"":"Unable to load entire tree",errorDetail:a}))}}createDirectory(e){throw h.FileSystemError.NoPermissions()}async readFile(e){const r=E(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{return this.pendingUriRequests.set(r,n),await this.github.getFileContent(e)}catch(i){if(this.implicitlyWatchedUris.delete(r),i instanceof h.FileSystemError&&i.code===V1){if(e.query==="~")return new Uint8Array(0);if(this.providerService.getRelativeFilePath(e)===Zw){const{ref:a}=this.providerService.getVirtualUriMetadata(e);if((a==null?void 0:a.type)===De.PullRequest)return new Uint8Array(0)}}throw i}finally{this.pendingUriRequests.delete(r),(n==null?void 0:n.outdated)&&setTimeout(()=>{te.log(`GitHubFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:h.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw h.FileSystemError.NoPermissions()}delete(e,r){throw h.FileSystemError.NoPermissions()}rename(e,r,n){throw h.FileSystemError.NoPermissions()}copy(e,r,n){throw h.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},a){const s=`${E(r)}|${JSON.stringify({includes:i,excludes:o})}`;let l=this.fileSearchCache.get(s);if(l===void 0){const d=this.providerService.getRelativeFilePath(r);let f;await this.github.hasFileTree(r)&&(f=await this.github.getFileTree(r));let p;if(f===void 0||f.loading||!f.hasEntireTree?p=await this.github.getFileList(r,d):p=(await f.getChildren(d,{filter:h.FileType.File,recursive:!0})).map(([g])=>g),p.length===0||a.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(p=[...xv(p,i,o)]),l=p.map(g=>pf.prepareSlow(g)),this.fileSearchCache.set(s,l)}let u;return e.pattern===""?u=l.map(d=>h.Uri.joinPath(r,d.target)):(u=pf.go(e.pattern.replace(G1,"/"),l,{allowTypo:!0,limit:n}).map(d=>h.Uri.joinPath(r,d.target)),pf.cleanup()),n!==void 0&&n!==0&&n<u.length&&(u=u.slice(0,n)),u}async provideTextSearchResults(e,r,n,i){const o=[];if(await this.tarPit.isIndexingEnabledForRepo(r.folder)!==!1)try{return await W1(this.providerService,this.changeStore,this.tarPit,e,r,n,i)}catch(l){l instanceof h.CancellationError||o.push({text:jf("index error","Error searching index, falling back to GitHub search. Try [deleting this repo's data]({0}) or [deleting all local data]({1}) to rebuild the index.","command:remoteHub.deleteLocalRepositoryData","command:remoteHub.deleteAllLocalRepositoryData"),type:h.TextSearchCompleteMessageType.Warning})}e.isCaseSensitive||e.isRegExp||e.isWordMatch?o.push({text:jf("flags not supported","Search flags are not supported by GitHub search. [Download full index]({0}) for full search features and exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Warning,trusted:!0}):o.push({text:jf("enable index","Partial results shown. [Download full index]({0}) for exact text searches.","command:remoteHub.enableIndexing"),type:h.TextSearchCompleteMessageType.Information,trusted:!0});const a=await this.github.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(a.warnings&&a.warnings.forEach(l=>{o.push({text:l,trusted:!0,type:h.TextSearchCompleteMessageType.Warning})}),a===void 0)return{limitHit:!0,message:o};let s;for(const l of a.matches)s=h.Uri.joinPath(r.folder,l.path),n.report({uri:s,ranges:l.ranges,preview:{text:l.preview,matches:l.matches}});return{limitHit:!1,message:o}}}c(hc,"GitHubFS"),qf([Io()],hc.prototype,"stat",1),qf([Io()],hc.prototype,"readDirectory",1),qf([Io()],hc.prototype,"readFile",1);var K1=__webpack_require__(6470),fc=__webpack_require__(4155);function mu(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof fc=="object"&&"version"in fc?`Node.js/${fc.version.substr(1)} (${fc.platform}; ${fc.arch})`:"<environment undetectable>"}c(mu,"getUserAgent");var Q1=__webpack_require__(5186);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Xw(t){return Object.prototype.toString.call(t)==="[object Object]"}c(Xw,"isObject");function Yw(t){var e,r;return Xw(t)===!1?!1:(e=t.constructor,e===void 0?!0:(r=e.prototype,!(Xw(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}c(Yw,"isPlainObject");function Z1(t){return t?Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{}):{}}c(Z1,"lowercaseKeys");function Jw(t,e){const r=Object.assign({},t);return Object.keys(e).forEach(n=>{Yw(e[n])?n in t?r[n]=Jw(t[n],e[n]):Object.assign(r,{[n]:e[n]}):Object.assign(r,{[n]:e[n]})}),r}c(Jw,"mergeDeep");function ey(t){for(const e in t)t[e]===void 0&&delete t[e];return t}c(ey,"removeUndefinedProperties");function Vf(t,e,r){if(typeof e=="string"){let[i,o]=e.split(" ");r=Object.assign(o?{method:i,url:o}:{url:i},r)}else r=Object.assign({},e);r.headers=Z1(r.headers),ey(r),ey(r.headers);const n=Jw(t||{},r);return t&&t.mediaType.previews.length&&(n.mediaType.previews=t.mediaType.previews.filter(i=>!n.mediaType.previews.includes(i)).concat(n.mediaType.previews)),n.mediaType.previews=n.mediaType.previews.map(i=>i.replace(/-preview/,"")),n}c(Vf,"dist_web_merge");function X1(t,e){const r=/\?/.test(t)?"&":"?",n=Object.keys(e);return n.length===0?t:t+r+n.map(i=>i==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${i}=${encodeURIComponent(e[i])}`).join("&")}c(X1,"addQueryParameters");const Y1=/\{[^}]+\}/g;function J1(t){return t.replace(/^\W+|\W+$/g,"").split(/,/)}c(J1,"removeNonChars");function eE(t){const e=t.match(Y1);return e?e.map(J1).reduce((r,n)=>r.concat(n),[]):[]}c(eE,"extractUrlVariableNames");function ty(t,e){return Object.keys(t).filter(r=>!e.includes(r)).reduce((r,n)=>(r[n]=t[n],r),{})}c(ty,"omit");function ry(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}c(ry,"encodeReserved");function Wa(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}c(Wa,"encodeUnreserved");function pc(t,e,r){return e=t==="+"||t==="#"?ry(e):Wa(e),r?Wa(r)+"="+e:e}c(pc,"encodeValue");function za(t){return t!=null}c(za,"isDefined");function Gf(t){return t===";"||t==="&"||t==="?"}c(Gf,"isKeyOperator");function tE(t,e,r,n){var i=t[r],o=[];if(za(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),n&&n!=="*"&&(i=i.substring(0,parseInt(n,10))),o.push(pc(e,i,Gf(e)?r:""));else if(n==="*")Array.isArray(i)?i.filter(za).forEach(function(a){o.push(pc(e,a,Gf(e)?r:""))}):Object.keys(i).forEach(function(a){za(i[a])&&o.push(pc(e,i[a],a))});else{const a=[];Array.isArray(i)?i.filter(za).forEach(function(s){a.push(pc(e,s))}):Object.keys(i).forEach(function(s){za(i[s])&&(a.push(Wa(s)),a.push(pc(e,i[s].toString())))}),Gf(e)?o.push(Wa(r)+"="+a.join(",")):a.length!==0&&o.push(a.join(","))}else e===";"?za(i)&&o.push(Wa(r)):i===""&&(e==="&"||e==="?")?o.push(Wa(r)+"="):i===""&&o.push("");return o}c(tE,"getValues");function rE(t){return{expand:nE.bind(null,t)}}c(rE,"parseUrl");function nE(t,e){var r=["+","#",".","/",";","?","&"];return t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,i,o){if(i){let s="";const l=[];if(r.indexOf(i.charAt(0))!==-1&&(s=i.charAt(0),i=i.substr(1)),i.split(/,/g).forEach(function(u){var d=/([^:\*]*)(?::(\d+)|(\*))?/.exec(u);l.push(tE(e,s,d[1],d[2]||d[3]))}),s&&s!=="+"){var a=",";return s==="?"?a="&":s!=="#"&&(a=s),(l.length!==0?s:"")+l.join(a)}else return l.join(",")}else return ry(o)})}c(nE,"expand");function ny(t){let e=t.method.toUpperCase(),r=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},t.headers),i,o=ty(t,["method","baseUrl","url","headers","request","mediaType"]);const a=eE(r);r=rE(r).expand(o),/^http/.test(r)||(r=t.baseUrl+r);const s=Object.keys(t).filter(d=>a.includes(d)).concat("baseUrl"),l=ty(o,s);if(!/application\/octet-stream/i.test(n.accept)&&(t.mediaType.format&&(n.accept=n.accept.split(/,/).map(d=>d.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${t.mediaType.format}`)).join(",")),t.mediaType.previews.length)){const d=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=d.concat(t.mediaType.previews).map(f=>{const p=t.mediaType.format?`.${t.mediaType.format}`:"+json";return`application/vnd.github.${f}-preview${p}`}).join(",")}return["GET","HEAD"].includes(e)?r=X1(r,l):"data"in l?i=l.data:Object.keys(l).length?i=l:n["content-length"]=0,!n["content-type"]&&typeof i!="undefined"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof i=="undefined"&&(i=""),Object.assign({method:e,url:r,headers:n},typeof i!="undefined"?{body:i}:null,t.request?{request:t.request}:null)}c(ny,"parse");function iE(t,e,r){return ny(Vf(t,e,r))}c(iE,"endpointWithDefaults");function iy(t,e){const r=Vf(t,e),n=iE.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:iy.bind(null,r),merge:Vf.bind(null,r),parse:ny})}c(iy,"withDefaults");const oE=`octokit-endpoint.js/6.0.12 ${mu()}`,aE=iy(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":oE},mediaType:{format:"",previews:[]}});var sE=__webpack_require__(3300),cE=__webpack_require__.n(sE);class Kf extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}c(Kf,"Deprecation");var lE=__webpack_require__(447),oy=__webpack_require__.n(lE);const uE=oy()(t=>console.warn(t)),dE=oy()(t=>console.warn(t));class ci extends Error{constructor(e,r,n){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=r;let i;"headers"in n&&typeof n.headers!="undefined"&&(i=n.headers),"response"in n&&(this.response=n.response,i=n.response.headers);const o=Object.assign({},n.request);n.request.headers.authorization&&(o.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),o.url=o.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=o,Object.defineProperty(this,"code",{get(){return uE(new Kf("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),r}}),Object.defineProperty(this,"headers",{get(){return dE(new Kf("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),i||{}}})}}c(ci,"RequestError");const hE="5.6.1";function fE(t){return t.arrayBuffer()}c(fE,"getBufferResponse");function ay(t){const e=t.request&&t.request.log?t.request.log:console;(Yw(t.body)||Array.isArray(t.body))&&(t.body=JSON.stringify(t.body));let r={},n,i;return(t.request&&t.request.fetch||cE())(t.url,Object.assign({method:t.method,body:t.body,headers:t.headers,redirect:t.redirect},t.request)).then(async a=>{i=a.url,n=a.status;for(const s of a.headers)r[s[0]]=s[1];if("deprecation"in r){const s=r.link&&r.link.match(/<([^>]+)>; rel="deprecation"/),l=s&&s.pop();e.warn(`[@octokit/request] "${t.method} ${t.url}" is deprecated. It is scheduled to be removed on ${r.sunset}${l?`. See ${l}`:""}`)}if(!(n===204||n===205)){if(t.method==="HEAD"){if(n<400)return;throw new ci(a.statusText,n,{response:{url:i,status:n,headers:r,data:void 0},request:t})}if(n===304)throw new ci("Not modified",n,{response:{url:i,status:n,headers:r,data:await Qf(a)},request:t});if(n>=400){const s=await Qf(a);throw new ci(pE(s),n,{response:{url:i,status:n,headers:r,data:s},request:t})}return Qf(a)}}).then(a=>({status:n,url:i,headers:r,data:a})).catch(a=>{throw a instanceof ci?a:new ci(a.message,500,{request:t})})}c(ay,"fetchWrapper");async function Qf(t){const e=t.headers.get("content-type");return/application\/json/.test(e)?t.json():!e||/^text\/|charset=utf-8$/.test(e)?t.text():fE(t)}c(Qf,"getResponseData");function pE(t){return typeof t=="string"?t:"message"in t?Array.isArray(t.errors)?`${t.message}: ${t.errors.map(JSON.stringify).join(", ")}`:t.message:`Unknown error: ${JSON.stringify(t)}`}c(pE,"toErrorMessage");function Zf(t,e){const r=t.defaults(e);return Object.assign(c(function(i,o){const a=r.merge(i,o);if(!a.request||!a.request.hook)return ay(r.parse(a));const s=c((l,u)=>ay(r.parse(r.merge(l,u))),"request");return Object.assign(s,{endpoint:r,defaults:Zf.bind(null,r)}),a.request.hook(s,a)},"newApi"),{endpoint:r,defaults:Zf.bind(null,r)})}c(Zf,"dist_web_withDefaults");const vu=Zf(aE,{headers:{"user-agent":`octokit-request.js/${hE} ${mu()}`}}),gE="4.8.0";function mE(t){return`Request failed due to following response errors:
`+t.errors.map(e=>` - ${e.message}`).join(`
`)}c(mE,"_buildMessageForResponseErrors");class no extends Error{constructor(e,r,n){super(mE(n));this.request=e,this.headers=r,this.response=n,this.name="GraphqlResponseError",this.errors=n.errors,this.data=n.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}c(no,"GraphqlResponseError");const vE=["method","baseUrl","url","headers","request","query","mediaType"],wE=["query","method","url"],sy=/\/api\/v3\/?$/;function yE(t,e,r){if(r){if(typeof e=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const a in r)if(!!wE.includes(a))return Promise.reject(new Error(`[@octokit/graphql] "${a}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},r):e,i=Object.keys(n).reduce((a,s)=>vE.includes(s)?(a[s]=n[s],a):(a.variables||(a.variables={}),a.variables[s]=n[s],a),{}),o=n.baseUrl||t.endpoint.DEFAULTS.baseUrl;return sy.test(o)&&(i.url=o.replace(sy,"/api/graphql")),t(i).then(a=>{if(a.data.errors){const s={};for(const l of Object.keys(a.headers))s[l]=a.headers[l];throw new no(i,s,a.data)}return a.data.data})}c(yE,"graphql");function Xf(t,e){const r=t.defaults(e);return Object.assign(c((i,o)=>yE(r,i,o),"newApi"),{defaults:Xf.bind(null,r),endpoint:vu.endpoint})}c(Xf,"graphql_dist_web_withDefaults");const wR=Xf(vu,{headers:{"user-agent":`octokit-graphql.js/${gE} ${mu()}`},method:"POST",url:"/graphql"});function bE(t){return Xf(t,{method:"POST",url:"/graphql"})}c(bE,"withCustomRequest");const _E=/^v1\./,xE=/^ghs_/,SE=/^ghu_/;async function CE(t){const e=t.split(/\./).length===3,r=_E.test(t)||xE.test(t),n=SE.test(t);return{type:"token",token:t,tokenType:e?"app":r?"installation":n?"user-to-server":"oauth"}}c(CE,"auth");function EE(t){return t.split(/\./).length===3?`bearer ${t}`:`token ${t}`}c(EE,"withAuthorizationPrefix");async function RE(t,e,r,n){const i=e.endpoint.merge(r,n);return i.headers.authorization=EE(t),e(i)}c(RE,"hook");const AE=c(function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(CE.bind(null,e),{hook:RE.bind(null,e)})},"createTokenAuth"),cy="3.5.1";class gc{constructor(e={}){const r=new Q1.Collection,n={baseUrl:vu.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=[e.userAgent,`octokit-core.js/${cy} ${mu()}`].filter(Boolean).join(" "),e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=vu.defaults(n),this.graphql=bE(this.request).defaults(n),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),this.hook=r,e.authStrategy){const{authStrategy:o,...a}=e,s=o(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:a},e.auth));r.wrap("request",s.hook),this.auth=s}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const o=AE(e.auth);r.wrap("request",o.hook),this.auth=o}this.constructor.plugins.forEach(o=>{Object.assign(this,o(this,e))})}static defaults(e){return c(class extends this{constructor(...n){const i=n[0]||{};if(typeof e=="function"){super(e(i));return}super(Object.assign({},e,i,i.userAgent&&e.userAgent?{userAgent:`${i.userAgent} ${e.userAgent}`}:null))}},"OctokitWithDefaults")}static plugin(...e){var r;const n=this.plugins;return r=c(class extends this{},"_a"),r.plugins=n.concat(e.filter(o=>!n.includes(o))),r}}c(gc,"Octokit"),gc.VERSION=cy,gc.plugins=[];var ly;(function(t){t[t.Force=0]="Force",t[t.ForceWithLease=1]="ForceWithLease"})(ly||(ly={}));var io;(function(t){t[t.Head=0]="Head",t[t.RemoteHead=1]="RemoteHead",t[t.Tag=2]="Tag"})(io||(io={}));var mc;(function(t){t[t.INDEX_MODIFIED=0]="INDEX_MODIFIED",t[t.INDEX_ADDED=1]="INDEX_ADDED",t[t.INDEX_DELETED=2]="INDEX_DELETED",t[t.INDEX_RENAMED=3]="INDEX_RENAMED",t[t.INDEX_COPIED=4]="INDEX_COPIED",t[t.MODIFIED=5]="MODIFIED",t[t.DELETED=6]="DELETED",t[t.UNTRACKED=7]="UNTRACKED",t[t.IGNORED=8]="IGNORED",t[t.INTENT_TO_ADD=9]="INTENT_TO_ADD",t[t.ADDED_BY_US=10]="ADDED_BY_US",t[t.ADDED_BY_THEM=11]="ADDED_BY_THEM",t[t.DELETED_BY_US=12]="DELETED_BY_US",t[t.DELETED_BY_THEM=13]="DELETED_BY_THEM",t[t.BOTH_ADDED=14]="BOTH_ADDED",t[t.BOTH_DELETED=15]="BOTH_DELETED",t[t.BOTH_MODIFIED=16]="BOTH_MODIFIED"})(mc||(mc={}));var uy;(function(t){t.BadConfigFile="BadConfigFile",t.AuthenticationFailed="AuthenticationFailed",t.NoUserNameConfigured="NoUserNameConfigured",t.NoUserEmailConfigured="NoUserEmailConfigured",t.NoRemoteRepositorySpecified="NoRemoteRepositorySpecified",t.NotAGitRepository="NotAGitRepository",t.NotAtRepositoryRoot="NotAtRepositoryRoot",t.Conflict="Conflict",t.StashConflict="StashConflict",t.UnmergedChanges="UnmergedChanges",t.PushRejected="PushRejected",t.RemoteConnectionError="RemoteConnectionError",t.DirtyWorkTree="DirtyWorkTree",t.CantOpenResource="CantOpenResource",t.GitNotFound="GitNotFound",t.CantCreatePipe="CantCreatePipe",t.PermissionDenied="PermissionDenied",t.CantAccessRemote="CantAccessRemote",t.RepositoryNotFound="RepositoryNotFound",t.RepositoryIsLocked="RepositoryIsLocked",t.BranchNotFullyMerged="BranchNotFullyMerged",t.NoRemoteReference="NoRemoteReference",t.InvalidBranchName="InvalidBranchName",t.BranchAlreadyExists="BranchAlreadyExists",t.NoLocalChanges="NoLocalChanges",t.NoStashFound="NoStashFound",t.LocalChangesOverwritten="LocalChangesOverwritten",t.NoUpstreamBranch="NoUpstreamBranch",t.IsInSubmodule="IsInSubmodule",t.WrongCase="WrongCase",t.CantLockRef="CantLockRef",t.CantRebaseMultipleBranches="CantRebaseMultipleBranches",t.PatchDoesNotApply="PatchDoesNotApply",t.NoPathFound="NoPathFound",t.UnknownPath="UnknownPath"})(uy||(uy={}));class Yf{constructor(e,r){this.path=e,this.relativePath=r}}c(Yf,"TrieNode");class dy{constructor(){this.root=new Yf("","")}get(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return;n=o}return n.path===e?n.data:void 0}getChildren(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;if(e)for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return[];n=o}return n.children===void 0?[]:[...n.children.values()].map(i=>[i.relativePath,i.data])}getDescendants(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;const i=[];if(e)for(const o of e.split("/")){const a=(r=n.children)==null?void 0:r.get(o);if(a===void 0)return i;n=a}if(n.children!==void 0){let o=c(function(a,s,l){for(const u of a.values()){const d=`${s?`${s}/`:""}${u.relativePath}`;u.data&&l.push([d,u.data]),u.children!==void 0&&o(u.children,d,l)}},"getDescendantsCore");o(n.children,"",i)}return i}has(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return!1;n=o}return n.path===e}set(e,r){var n;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let i=this.root,o="";for(const a of e.split("/")){let s=(n=i.children)==null?void 0:n.get(a);o=`${o?`${o}/`:""}${a}`,s===void 0&&(i.children===void 0&&(i.children=new Map),s=new Yf(o,a),i.children.set(a,s)),i=s}i.data=r}}c(dy,"Trie");var IE=__webpack_require__(5431),Jf=__webpack_require__.n(IE);class ep{constructor(e,r,n,i,o){if(this.rootUri=e,this.sha=r,this.timestamp=n,this.provider=i,this.trie=new dy,this._hasEntireTree=!1,this._isContentCached=!1,i===void 0)return;const a=[i];i.onDidTriggerContentCaching!==void 0&&i.tryCachingContent!==void 0&&a.push(i.onDidTriggerContentCaching(s=>{(!s||E(s.rootUri)===E(this.rootUri)&&s.sha===this.sha)&&!this.loading&&this.hasEntireTree&&!this.isContentCached&&i.tryCachingContent(this.trie.get.bind(this.trie)).then(l=>this._isContentCached=l,()=>this._isContentCached=!0)})),this._loading=this.load(o==null?void 0:o.path,o==null?void 0:o.recursive).then(s=>(this._hasEntireTree=(s==null?void 0:s.success)?s.recursive:!1,this._hasEntireTree&&setTimeout(()=>{var l;return void((l=i.tryCachingContent)==null?void 0:l.call(i,this.trie.get.bind(this.trie)).then(u=>this._isContentCached=u,()=>this._isContentCached=!0))},0),this._loading=void 0,this.preloading=void 0,this.treeSha=(s==null?void 0:s.success)?s.sha:void 0,this.treeSha)),(o==null?void 0:o.preload)&&(this.preloading=new Map([["",this.load("")],[".vscode",this.load(".vscode")]])),this.disposable=h.Disposable.from(...a)}get hasEntireTree(){return this._hasEntireTree}get isContentCached(){return this._isContentCached}get loading(){return this._loading!==void 0}get permissions(){var e;return(e=this.provider)==null?void 0:e.permissions}dispose(){var e;(e=this.disposable)==null||e.dispose()}async get(e){var r;if(e==="")return{mode:"040000",sha:this.treeSha,stat:{type:h.FileType.Directory,size:0,ctime:0,mtime:(r=this.timestamp)!=null?r:Date.now(),permissions:await this.permissions},getContent:void 0};let n=this.trie.get(e);return n!==void 0||(await this.ensureLoaded(e),n=this.trie.get(e)),n}async getChildren(e,r){await this.ensureLoaded(e,!0);const n=(r==null?void 0:r.recursive)?this.trie.getDescendants(e):this.trie.getChildren(e);return(r==null?void 0:r.filter)===void 0?n:n.filter(([,i])=>i.stat.type===r.filter)}async getTreeSha(){return await this.waitUntilLoaded(),this.treeSha}async waitUntilLoaded(){this._loading!==void 0&&await this._loading}async ensureLoaded(e,r=!1){if(this._loading!==void 0){let i;if(this.preloading!==void 0)if(r)i=this.preloading.get(e);else{const o=Ex(this.preloading,([a])=>e.startsWith(a)&&e.lastIndexOf("/")===(a?a.length:-1));i=o==null?void 0:o[1]}await(i!=null?i:this._loading)}if(this.hasEntireTree||e==="")return;let n=this.trie.get(e);if(n)return r&&(n==null?void 0:n.loadChildren)?n.loadChildren():void 0;if(await this.ensureLoaded(e.substr(0,e.lastIndexOf("/")),!0),n=this.trie.get(e),r&&(n==null?void 0:n.loadChildren))return n.loadChildren()}async load(e,r=!1){var n;if(((n=this.provider)==null?void 0:n.getTree)===void 0)return;const i=new Fe(`FileTree.load(${this.sha}:${e})`);let o;try{i.logStep("Tree query");const a=await this.provider.getTree(e,r);if(a.truncated){te.warn(`Loading file tree for path=${e} was truncated`),i.logStep("Fixing directories",{message:`: Tree=${a.sha};`,suffix:" \u2022 Fixing directories..."});for(const[l,u]of this.trie.getDescendants(""))u.stat.type===h.FileType.Directory&&(u.loadChildren=Jf()(()=>this.load(l).then(()=>u.loadChildren=void 0)));return o=` \u2022 Tree=${a.sha} \u2022 Truncated`,{sha:a.sha,recursive:!1,success:!0}}let s;this.permissions!==void 0&&(i.logStep("Permissions query",{message:`: Tree=${a.sha};`,suffix:" \u2022 Waiting for permissions..."}),s=await this.permissions),i.logStep("Filling trie",{suffix:" \u2022 Filling trie..."});for(let{path:l,item:u}of a.tree)if(l!==void 0){switch(l=e?`${e}/${l}`:l,u.stat.permissions=s,u.stat.type){case h.FileType.File:u.getContent=Jf()(()=>this.provider.getContent(u,l));break;case h.FileType.Directory:r||(u.loadChildren=Jf()(()=>this.load(l).then(()=>u.loadChildren=void 0)));break}this.trie.set(l,u)}return o=` \u2022 Tree=${a.sha}`,{sha:a.sha,recursive:r,success:!0}}catch(a){return o=`\u2022 Loading for path=${e} failed; ${String(a)}`,{error:a,success:!1}}finally{i.stop(o?{suffix:o}:void 0)}}}c(ep,"FileTree");var kE=__webpack_require__(7769);const TE="github-pr-owner-number";function DE(t){return`branch.${t}.${TE}`}c(DE,"getMetadataKeyForBranch");const FE=(0,m.loadMessageBundle)(),hy=new TextDecoder;class fy{constructor(e,r,n,i,o,a){this.providerService=e,this.rootUri=r,this.sourceControl=n,this.metadata=i,this.changeStore=o,this.github=a,this._onDidChangeSelection=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._objects=new Map,this.disposable=h.Disposable.from(this.sourceControl.onDidChangeSelection(()=>this._onDidChangeSelection.fire()),this.providerService.onDidRefresh(u=>{const d=E(this.rootUri);!u.some(f=>E(f)===d)||this.updateState(this.metadata)}),this.providerService.onDidChangeRepository(async({repository:u})=>{E(this.rootUri)===E(u.uri)&&this.updateState(await u.getMetadata())}),this.changeStore.onDidChange(()=>this.updateState(this.metadata)),this._onDidChangeSelection,this._onDidChangeState),this._inputBox={get value(){return n.inputBox.value},set value(u){n.inputBox.value=u}},this._ui={get selected(){return n.selected},onDidChange:this._onDidChangeSelection.event};const{repo:{owner:s,name:l}}=i;this.remote={name:"origin",fetchUrl:`https://github.com/${s}/${l}.git`,isReadOnly:i.accessLevel<ie.Write},this.remotes=[this.remote],this._state={HEAD:this.getHEADFromMetadata(i),mergeChanges:[],indexChanges:[],workingTreeChanges:[],onDidChange:this._onDidChangeState.event,rebaseCommit:void 0,refs:[],remotes:this.remotes,submodules:[]},this.updateState(i)}dispose(){this.disposable.dispose()}get inputBox(){return this._inputBox}get state(){return this._state}get ui(){return this._ui}getHEADFromMetadata(e){switch(e.HEAD.type){case Q.Branch:return{type:io.Head,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:this.remote.name}};case Q.RemoteBranch:{const r=e.HEAD.branch.remote.repo.owner,n=e.HEAD.branch.remote.accessLevel<ie.Write,i=this.remotes.findIndex(o=>o.name===r);return this.remotes.splice(i===-1?this.remotes.length:i,i===-1?0:1,{name:r,fetchUrl:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,pushUrl:n?void 0:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,isReadOnly:n}),{type:io.RemoteHead,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:e.HEAD.branch.remote.repo.owner}}}case Q.Tag:return{type:io.Tag,name:e.HEAD.detached.name,commit:e.HEAD.sha};case Q.Commit:return{type:io.Head,commit:e.HEAD.sha}}}async updateState(e){this.metadata=e;const r=await this.changeStore.getGroupedChanges(this.rootUri,{predicate:s=>s.fileType===h.FileType.File}),n=r.conflicts.map(s=>({uri:s.uri,status:tp(s.type),originalUri:s.uri,renameUri:s.uri})),i=r.staged.map(s=>({uri:s.uri,status:tp(s.type),originalUri:s.uri,renameUri:s.uri})),o=r.working.map(s=>({uri:s.uri,status:tp(s.type),originalUri:s.uri,renameUri:s.uri})),a=fe.get("staging.enabled");this._state={...this._state,HEAD:this.getHEADFromMetadata(e),mergeChanges:n,indexChanges:a?i:[],workingTreeChanges:a?o:[...i,...o]},this._onDidChangeState.fire()}getConfigs(){return Promise.resolve([])}getConfig(e){return this.metadata.HEAD.branch&&this.metadata.pullRequest&&e===DE(this.metadata.HEAD.branch.name)?Promise.resolve(`${this.metadata.repo.owner}#${this.metadata.repo.name}#${this.metadata.pullRequest.id}`):Promise.resolve("")}setConfig(e,r){return Promise.resolve("")}getGlobalConfig(e){throw new Error("Method not implemented.")}async getObjectDetails(e,r){const n=new Fe(`IGit.getObjectDetails(${e}, ${r})`);try{return await this.github.getObjectDetails(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async detectObjectType(e){var r;const n=new Fe(`IGit.detectObjectType(${e})`);try{const i=await this.github.getBlobContent(this.metadata.repo,e);if(!ox(i))return{mimetype:"text/plain"};const a=await(0,kE.fromBuffer)(i);return{mimetype:(r=a==null?void 0:a.mime)!=null?r:"application/octet-stream"}}finally{n.stop()}}async buffer(e,r){const n=new Fe(`IGit.buffer(${e}, ${r})`);try{return await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async show(e,r){const n=new Fe(`IGit.show(${e}, ${r})`);try{const i=await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r));return hy.decode(i)}finally{n.stop()}}async getCommit(e){const r=new Fe(`IGit.getCommit(${e})`);try{const n=await this.github.getCommit(this.rootUri,e);if(n===void 0)throw new Error(`Unable to find commit for ref "${e}"`);return n}finally{r.stop()}}clean(e){return this._objects.clear(),Promise.resolve()}async apply(e,r){const n=new Fe(`IGit.apply(reverse=${r})`);try{return await this.changeStore.applyPatch(this.rootUri,e,r?{reverse:!0}:void 0)}finally{n.stop()}}async diff(e){const r=new Fe(`IGit.diff(${e})`);try{return await this.changeStore.createPatch(this.rootUri,void 0,e?{staged:!0}:void 0)}finally{r.stop()}}diffWithHEAD(e){return e?this.diffBetween("","HEAD",e):this.diffBetween("","HEAD")}diffWith(e,r){return r?this.diffBetween("",e,r):this.diffBetween("",e)}diffIndexWithHEAD(e){return e?this.diffBetween("~","HEAD",e):this.diffBetween("~","HEAD")}diffIndexWith(e,r){return r?this.diffBetween("~",e,r):this.diffBetween("~",e)}async diffBetween(e,r,n){if(!n)throw new Error("Method not implemented.");const i=new Fe(`IGit.diffBetween(${e}, ${r}, ${n})`);try{const[o,a]=await Promise.all([this.getContent(e,n),this.getContent(r,n)]);return Mt(n,o,a)}finally{i.stop()}}async diffBlobs(e,r){const n=new Fe(`IGit.diffBlobs(${e}, ${r})`);try{const i=await this.getBlobContent(e),o=await this.getBlobContent(r),a=Mt("untitled",i,o);return Promise.resolve(a)}finally{n.stop()}}async getBlobContent(e){const r=new Fe(`IGit.getBlobContent(${e})`);try{const n=this._objects.get(e);if(n)return this._objects.delete(e),n;const{repo:i}=this.providerService.getVirtualUriMetadata(this.rootUri),o=await this.github.getBlobContent(i,e);return hy.decode(o)}finally{r.stop()}}async getContent(e,r){const n=new Fe(`IGit.getContent(${e}, ${r})`);try{const i=this.pathToRelativeUri(r);if(e===""||e==="~"){const o=await this.changeStore.getChange(i);if(o!==void 0&&(e===""||o.staged))return this.changeStore.getContent(i);e="HEAD"}return await this.show(e==="HEAD"?this.metadata.HEAD.sha:e,r)}finally{n.stop()}}async hashObject(e){const r=new Fe("IGit.hashObject");try{const n=X(await Br(e));return this._objects.set(n,e),n}finally{r.stop()}}async createBranch(e,r,n){const i=new Fe(`IGit.createBranch(${e}, ${r}, ${n})`);try{n||(n=this.metadata.HEAD.sha);const o=await this.github.createBranch(this.rootUri,e,n);r&&await this.checkout(o)}finally{i.stop()}}deleteBranch(e,r){throw new Error("Method not implemented.")}async getBranch(e){const r=new Fe(`IGit.getBranch(${e})`);try{const{branches:n}=await this.github.getBranches(this.rootUri,{query:e,limit:1}),[i]=n;if(i===void 0)throw new Error(`Unable to find branch named "${e}"`);return{type:i.type,name:i.name,commit:i.commit,remote:this.remote.name,upstream:{name:i.name,remote:this.remote.name}}}finally{r.stop()}}async getBranches(e){var r,n;const i=(n=(r=e.contains)!=null?r:e.pattern)!=null?n:"",o=new Fe(`IGit.getBranches(${i})`);try{const{branches:a}=await this.github.getBranches(this.rootUri,{query:i,limit:e.count});if(a.length===0)throw new Error(`Unable to find branches for "${i}"`);return a.map(s=>({type:s.type,name:s.name,commit:s.commit}))}finally{o.stop()}}setBranchUpstream(e,r){throw new Error("Method not implemented.")}getMergeBase(e,r){throw new Error("Method not implemented.")}async status(){}async checkout(e){const r=new Fe(`IGit.checkout(${e})`);try{if(await this.github.repositoryObjectExists(this.rootUri,e)){const i=await this.github.switchTo(this.rootUri,e,{openInNewWindow:!1});throw i!==void 0&&await dn(i),new Error("User aborted")}const n=/pr\/(?<remote>.+)\/(?<num>\d+)/.exec(e);if(n==null?void 0:n.groups){const{num:i}=n.groups,{provider:o,repo:a}=this.providerService.getVirtualUriMetadata(this.rootUri),s=this.providerService.getRemoteUri(o.id,{repo:a,pullRequest:{id:i}});if(s!==void 0){const l=await this.providerService.createWorkspaceForRemoteUrl(s.toString());l!==void 0&&await dn(l)}}throw new Error("User aborted")}finally{r.stop()}}addRemote(e,r){var n;let i;const o=this.remotes.findIndex(a=>a.name===e);return o!==-1&&([i]=this.remotes.splice(o,1)),this.remotes.push({name:e,fetchUrl:r,isReadOnly:(n=i==null?void 0:i.isReadOnly)!=null?n:!1}),Promise.resolve()}removeRemote(e){const r=this.remotes.findIndex(n=>n.name===e);return r!==-1&&this.remotes.splice(r,1),Promise.resolve()}renameRemote(e,r){const n=this.remotes.findIndex(o=>o.name===e);if(n===-1)return Promise.resolve();const[i]=this.remotes.splice(n,1);return this.remotes.push({...i,name:r}),Promise.resolve()}async fetch(e,r,n){const i=new Fe("IGit.fetch");try{return this.github.fetch(this.rootUri)}finally{i.stop()}}async pull(e){const r=new Fe("IGit.pull");try{return this.github.sync(this.rootUri,this.changeStore,{conflictResolution:ot.Merge})}finally{r.stop()}}push(e,r,n){return Promise.resolve()}blame(e){throw new Error("Method not implemented.")}async log(e){if((e==null?void 0:e.maxEntries)!==1||(e==null?void 0:e.path)!==void 0)throw new Error("The specified log options are not yet supported.");return[await this.getCommit(this.metadata.HEAD.sha)]}async commit(e,r){const n=new Fe("IGit.commit");try{if((r==null?void 0:r.amend)!==void 0||(r==null?void 0:r.empty)!==void 0||(r==null?void 0:r.signCommit)!==void 0||(r==null?void 0:r.signoff)!==void 0)throw new Error("The specified commit options are not yet supported.");const i=(await this.providerService.getCommitOperations(this.rootUri,{staged:(r==null?void 0:r.all)===!1})).filter(o=>o.fileType===h.FileType.File);if(!i.length){h.window.showInformationMessage(FE("no changes to commit","There are no changes to commit."));return}if(fe.getUseNewCommitApi())await this.github.createAndPushCommit(this.rootUri,e,i,void 0,r);else{const o=await this.github.createCommit(this.rootUri,e,i);await this.github.pushCommit(this.rootUri,o)}}finally{n.stop()}}pathToRelativePath(e){return this.providerService.getRelativeFilePath(this.rootUri,this.pathToRelativeUri(e))}pathToRelativeUri(e){return w(this.rootUri,ME(e))}}c(fy,"GitHubRepository");const PE=/^\/?([a-zA-Z])(?::\/)(.*)$/,NE=/\\/g;function ME(t){t=h.Uri.file(t).fsPath.replace(NE,"/");const e=PE.exec(t);return e!==null&&([,,t]=e),t.startsWith("/")?t:`/${t}`}c(ME,"normalizePath");function tp(t){switch(t){case q.Changed:return mc.MODIFIED;case q.Created:return mc.INTENT_TO_ADD;case q.Deleted:return mc.DELETED}}c(tp,"opTypeToStatus");var rp=__webpack_require__(4155),LE=Object.defineProperty,$E=Object.getOwnPropertyDescriptor,py=c((t,e,r,n)=>{for(var i=n>1?void 0:n?$E(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&LE(e,r,i),i},"provider_decorateClass");const li=(0,m.loadMessageBundle)(),gy=/^(?:https?:\/\/)?github\.(?:com|dev)\/(?<owner>[^/]+)\/(?<repo>[^/?#]+)(?:|\.git|\/tree\/(?<tree>[^?#]+)|\/blob\/(?<blob>[^?#]+)|\/commit\/(?<commit>[0-9a-f]{40})|\/pull\/(?<pull>[0-9]+))?(?<extra>[^?#]*)(?:\?(?<query>[^#]*))?(?:#(?<fragment>.*))?$/i,my=/(?<remoteOwner>[^/:]+)\/?(?<remoteRepo>[^/:]+)?:(?<remoteRef>.*)/,vc=["repo","workflow"],wu=1,np=Object.freeze({id:"github",name:"GitHub"});function Ho(t){const{scheme:e,metadata:r}=B.decodeAuthority(t,a=>{if(a.v!==void 0)return a;if(typeof a.pr=="string")return{v:wu,ref:{type:De.PullRequest,id:a.pr},idx:a.idx};if(typeof a.ref=="string")return{v:wu,ref:{type:De.Tree,id:a.ref},idx:a.idx}}),[,n,i,...o]=t.path.split("/");return{scheme:e,provider:np,name:`${n}/${i}`,repo:{owner:n,name:i},path:o.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}c(Ho,"getGitHubMetadata");function BE(t,e){const{repo:r}=e!=null?e:Ho(t);return t.with({path:`/${r.owner}/${r.name}`,query:"",fragment:""})}c(BE,"getGitHubRootUri");function ip(t,e,r){const{repo:{owner:n,name:i}}=t instanceof h.Uri?Ho(t):t;return h.Uri.parse(`github://${B.encodeAuthority("github",{v:wu,ref:{type:De.Commit,id:e}})}/${n}/${i}/${r}`)}c(ip,"getGitHubRevisionUri");class vy{constructor(e){if(this.scopes=e,this.id="github",this.account={id:"vscode-remotehub-test",label:"RemoteHub Test"},!rp.env.GITHUB_REMOTEHUB_TEST_PAT)throw new Error("Unable to initialize authentication for integration tests. Please set `process.env.GITHUB_REMOTEHUB_TEST_PAT`.");this.accessToken=rp.env.GITHUB_REMOTEHUB_TEST_PAT}}c(vy,"TestAuthenticationSession");class yu{constructor(e,r){this.providerService=e,this.tarPit=r,this.fileTreeCache=new Map,this.disposable=h.Disposable.from(e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n))),Cn&&(this.tarballProxyEndpoint=h.commands.executeCommand("_workbench.getTarballProxyEndpoints").then(n=>n==null?void 0:n["github.com"])),rp.env.GITHUB_REMOTEHUB_TEST_PAT&&(this._session=new vy(vc))}get isReadonly(){return!1}get scheme(){return"github"}get repositories(){return[...this.providerService.getRepositories(np.id)]}dispose(){this.disposable.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>Nr.getProviderId(r)===this.scheme),e.length!==0&&(this.fileTreeCache.forEach(r=>r.dispose()),this.fileTreeCache.clear())}async ensureAuthenticated(e=!1){const r=new Fe("GitHub.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return e?await h.authentication.getSession("github",vc,{forceNewSession:e}):await h.authentication.getSession("github",vc,{createIfNone:!0})}catch(o){te.error(o);try{const a=await h.authentication.getSession("github",vc,{createIfNone:!1});if(a!==void 0)return a}catch{}return new Promise(a=>{async function s(){const u=await h.authentication.getSession("github",vc,{createIfNone:!0});u!==void 0&&a(u)}c(s,"getSession");const l=h.authentication.onDidChangeSessions(async u=>{u.provider.id==="github"&&(l.dispose(),await s())})})}}c(n,"waitUntilAuthenticated"),this._session=await n();const i=h.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id==="github"&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:np,session:r,getRichNavigationHeaders:()=>({"X-Git-GitHub":`Bearer ${r.accessToken}`})}}clearAuthenticationSession(){this._session=void 0,this._octokit=void 0,this._octokitDefaults=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async octokit(e){if(this._octokitDefaults===void 0){const n=await this.ensureAuthenticated();if(Cn){async function i(o,a){if(a.headers!==void 0){const{"user-agent":s,...l}=a.headers;s&&(a.headers=l)}return Ls(o,a)}c(i,"fetchCore"),this._octokitDefaults=gc.defaults({auth:`token ${n.accessToken}`,request:{fetch:i}})}else this._octokitDefaults=gc.defaults({auth:`token ${n.accessToken}`})}const r=new this._octokitDefaults(e);return(te.logLevel===Ce.Debug||te.isDebugging)&&r.hook.wrap("request",async(n,i)=>{var o;const a=new Fe(`[GITHUB] ${i.method} ${i.url}`,{log:!1});try{return await n(i)}finally{let s;try{if(typeof i.query=="string"){const l=/(^[^({\n]+)/.exec(i.query);s=` ${(o=l==null?void 0:l[1].trim())!=null?o:i.query}`}}catch{}a.stop({message:s})}}),r}async graphql(e,r,n=!0){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.graphql(e,r)}catch(i){throw n||this.handleRequestErrors(i),te.error(i),i}}async request(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.request(e,r)}catch(n){throw this.handleRequestErrors(n),te.error(n),n}}handleRequestErrors(e){var r,n;if(e instanceof ci)switch(e.status){case 500:return e.response&&Pr.showGitHubStatus500Message(),!0;case 401:return Pr.showStatus401Message(()=>void this.reauthenticate()),!0;case 403:return Pr.showStatus403Message(()=>void this.reauthenticate()),!0}else if(e instanceof no&&((n=(r=e.errors)==null?void 0:r[0])==null?void 0:n.type)==="FORBIDDEN")return Pr.showStatus403Message(()=>void this.reauthenticate()),!0;return!1}createIGitRepository(e,r,n,i){return new fy(this.providerService,e,r,n,i,this)}async createMetadata(e,r){var n,i,o,a,s,l;const u=new Fe(`GitHub.createMetadata(${e.toString()}, ${r})`);let d;try{let{provider:f,name:p,repo:{owner:g,name:_},ref:b}=Ho(e);(!b||b.type===De.Commit&&/HEAD/i.test(b.id))&&(b={type:De.Commit,id:"HEAD"});const y=this.providerService.isInWorkspace(e),x=await this.getRepositoryInfo(g,_,y,b.type===De.PullRequest?{pr:Number(b.id)}:{ref:b.id});if(x===void 0)throw d=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let C;if(r)C=r;else if(b.type===De.Commit&&b.id!=="HEAD"||b.type===De.Tree&&x.ref===void 0)C=b.id;else if(C=(i=(n=x.ref)==null?void 0:n.sha)!=null?i:x.defaultBranch.sha,C===void 0)throw d=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository revision`);let k;if(((o=x.ref)==null?void 0:o.prefix)==="refs/heads/")k={type:Q.Branch,name:x.ref.name,sha:C,branch:{name:x.ref.name,sha:x.ref.sha}};else if(((a=x.ref)==null?void 0:a.prefix)==="refs/remotes/"){if(!x.ref.remote)throw d=" \u2022 Aborted; Unable to get remote info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get remote info`);k={type:Q.RemoteBranch,name:`${x.ref.remote.repo.owner}${x.ref.remote.repo.name!==_?`/${x.ref.remote.repo.name}`:""}:${x.ref.name}`,sha:C,branch:{name:x.ref.name,sha:x.ref.sha,remote:x.ref.remote}}}else((s=x.ref)==null?void 0:s.prefix)==="refs/tags/"?k={type:Q.Tag,name:x.ref.name,sha:C,detached:{type:Q.Tag,name:x.ref.name}}:k={type:Q.Commit,name:W(C),sha:C,detached:{type:Q.Commit,name:W(C)}};let T,O;if(fe.get("experimental.prefetch")&&y&&(T=C,u.log({suffix:` \u2022 Prefetching tree for ${T}...`}),this.getFileTree(e,void 0,{cache:!0,recursive:!0,prefetched:{metadata:new Promise(ae=>O=ae),repo:{owner:g,name:_},HEAD:{sha:T},timestamp:Date.now()}})),T!==void 0&&T!==k.sha){const ae=this.asFileTreeKey(e,T),Y=this.fileTreeCache.get(ae);Y&&!z(T)&&k.sha===((l=k.branch)==null?void 0:l.sha)?(u.log({suffix:` \u2022 Updating prefetched tree for ${T}, since HEAD was resolved; HEAD=${k.sha}`}),this.fileTreeCache.set(this.asFileTreeKey(e,k.sha),Y),this.fileTreeCache.delete(ae)):(u.log({suffix:` \u2022 Removing prefetched tree for ${T}, since the HEAD changed; HEAD=${k.sha}`}),this.fileTreeCache.delete(ae),Y==null||Y.dispose())}const ne={version:Nc.schemaVersion,timestamp:Date.now(),provider:f,name:p,repo:x.repo,accessLevel:x.accessLevel,HEAD:k,defaultBranch:x.defaultBranch,pullRequest:x.pullRequest};return d=` \u2022 HEAD=${k.sha}`,O==null||O(ne),ne}finally{u.stop(d?{suffix:d}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"GitHub",icon:"$(github)",label:li("open repo from","Open Repository from {0}","GitHub"),placeholder:li("pick repo","Choose a repository"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");a!==-1&&(o=n.substring(0,a),n=n.substr(a+1));const{results:s,hasSAMLProtectedResults:l}=await this.searchRepositoriesQuery(n,{...i,user:o}),u=[];if(l){const d={label:`$(lock) ${li("sso required repositories","Single sign-on to see repositories in organizations protected by SAML enforcement")}`,showMore:async()=>this.reauthenticate()};u.push(d)}return u.push({kind:h.QuickPickItemKind.Separator,label:li("repositories","repositories")},...s.map(d=>({providerId:"github",name:d.repoWithOwner,icon:"$(repo)",description:`${d.fork?`$(repo-forked) ${d.fork}`:""}${d.stars>0?`${d.fork?" \u2022 ":""}$(star-full) ${d.stars}`:""}`,detail:d.description,url:d.url}))),u}},{name:"GitHub",icon:"$(github)",label:li("open pr from","Open Pull Request from {0}","GitHub"),placeholder:li("pick pr","Choose a pull request"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const a=n==null?void 0:n.indexOf("/");a!==-1&&(o=n.substring(0,a),n=n.substr(a+1));const{results:s,hasSAMLProtectedResults:l}=await this.searchPullRequestsQuery(n,{user:o}),u=[];if(l){const d={label:`$(lock) ${li("sso required pull requests","Single sign-on to see pull requests in organizations protected by SAML enforcement")}`,showMore:async()=>this.reauthenticate()};u.push(d)}return u.push({kind:h.QuickPickItemKind.Separator,label:li("pull requests","pull requests")},...s.map(d=>({providerId:"azurerepos",name:d.title,icon:"$(git-pull-request)",description:d.reasons.length!==0?d.reasons.sort().join(", "):void 0,detail:`${d.repoWithOwner} #${d.number}`,url:d.url}))),u}}]}canOpenRemoteUrl(e){const r=gy.exec(e);if((r==null?void 0:r.groups)===void 0)return;const{blob:n,commit:i,pull:o,tree:a}=r.groups;return o?je.PullRequest:i?je.Commit:a?je.Branch:n?je.File:je.Repository}async createWorkspaceForRemoteUrl(e,r=ve.CurrentWindow){const n=gy.exec(e);if((n==null?void 0:n.groups)===void 0)return;let{owner:i,repo:o,blob:a,commit:s,pull:l,tree:u,fragment:d}=n.groups;o=o.endsWith(".git")?o.slice(0,o.length-4):o;const f=await this.validateOwnerAndRepoAndSplitRefFromPath(i,o,u!=null?u:a);if(f===void 0)return;let p,g;if({owner:i,repo:o,ref:g,path:p}=f,u||a){if(p&&d&&a){const y=/L(?<start>\d+)(?:-L(?<end>\d+))?/.exec(d);if(y==null?void 0:y.groups){const{start:x,end:C}=y.groups;p+=`:${x}${C!==void 0?`-${C}`:""}`}}}else s?g={type:De.Commit,id:s}:l&&(g={type:De.PullRequest,id:l});const _=this.providerService.createVirtualUri("github",{repo:{owner:i,name:o},ref:g}),{name:b}=Ho(B.getVirtualUri(this.getProviderRootUri(_)));return{name:b,uri:_,location:r,filesToOpen:p?[p]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){const a=n!==void 0||i!==void 0?{v:wu}:void 0;return a&&(n&&(a.ref={...n,type:n.type===De.Branch||n.type===De.Tag?De.Tree:n.type}),i&&(a.idx=i)),e.with({authority:B.encodeAuthority("github",a),path:`/${r.owner}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:o?`/${o}`:""}`})}getRemoteUri(e){const r=`https://github.com/${e.repo.owner}/${e.repo.name}`,n=e.path?"blob":"tree",i=e.path?`/${e.path}`:"";return e.clone?h.Uri.parse(`${r}.git`):e.pullRequest?h.Uri.parse(`${r}/pull/${e.pullRequest.id}`):e.branch?h.Uri.parse(`${r}/${n}/${e.branch}${i}`):e.tag?h.Uri.parse(`${r}/${n}/${e.tag}${i}`):e.sha?h.Uri.parse(`${r}/${n}/${e.sha}${i}`):h.Uri.parse(r)}getProviderRootUri(e){return BE(e)}getRelativeFilePath(e,r){const{path:n}=Ho(e),{path:i}=Ho(w(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=Ho(e);return{provider:r,name:n,repo:i,ref:o}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case Q.Branch:return i!==void 0?Ee.PullRequestBranch:Ee.Branch;case Q.RemoteBranch:return i!==void 0?Ee.PullRequestRemoteBranch:Ee.RemoteBranch;case Q.Tag:return Ee.Tag;case Q.Commit:return Ee.Commit}}async createBranch(e,r,n,i){try{const{repo:{owner:o,name:a}}=i!=null?i:await this.getMetadata(e);return r.startsWith("refs/heads/")||(r=`refs/heads/${r}`),(await this.request("POST /repos/{owner}/{repo}/git/refs",{owner:o,repo:a,ref:r,sha:n})).data.ref.substr(11)}catch(o){throw o instanceof ci&&o.status===422?o.message==="Reference already exists"?Z.InvalidBranchNameError(r.substring(11),!0):Z.InvalidBranchNameError(r.substring(11),!1):(te.error(o),o)}}async createAndPushCommit(e,r,n,i,o,a){var s;const l=new Fe(`GitHub.createAndPushCommit(${e.toString()}${a?`, fork=${a.repo.owner}/${a.repo.name}`:""})`);if(n=n.filter(d=>d.fileType===h.FileType.File),n.length===0&&!(o==null?void 0:o.empty))throw l.stop({message:"Aborted; No changes to commit"}),Z.NothingToCommitError("No changes to commit");let u;try{const d=await this.getMetadata(e);let f;if(i!==void 0)f=i;else{if(d.HEAD.detached&&!d.HEAD.branch)throw Z.DetachedHEADError("Unable to commit; no current branch");f=d.HEAD.branch.name}let p;if(a)p=`${a.repo.owner}/${a.repo.name}`;else if(d.HEAD.type===Q.RemoteBranch&&d.HEAD.branch.remote.accessLevel>=ie.Write){const{owner:C,name:k}=d.HEAD.branch.remote.repo;p=`${C}/${k}`}else p=`${d.repo.owner}/${d.repo.name}`;const g=[],_=[];for(const C of n)switch(C.type){case q.Created:case q.Changed:{try{const k=await C.content;g.push({path:C.path,contents:Rp(k)})}catch(k){throw te.error(k),Z.CommitFailedError()}break}case q.Deleted:_.push({path:C.path});break}const b={branch:{branchName:f,repositoryNameWithOwner:p},message:{headline:r},fileChanges:{additions:g,deletions:_},expectedHeadOid:d.HEAD.sha},y=`mutation($commitInput: CreateCommitOnBranchInput!) {
	createCommitOnBranch(input: $commitInput) {
		commit {
			oid
		}
		ref {
			name
		}
	}
}`,x=await this.graphql(y,{commitInput:b});if(u=x==null?void 0:x.createCommitOnBranch.commit.oid,!u)throw Z.CommitFailedError();return i===void 0&&!d.HEAD.detached&&u!==void 0&&await this.fastForwardTo(e,u,d),u}catch(d){if(d instanceof no){const f=(s=d.errors)==null?void 0:s[0];if((f==null?void 0:f.type)==="STALE_DATA"&&f.message.includes("Pull and try again"))throw Z.MergeConflictError(d)}throw te.error(d),d}finally{l.stop(u?{message:`: Created and pushed commit ${u}`}:void 0)}}async createCommit(e,r,n,i){const o=new Fe(`GitHub.createCommit(${e.toString()}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);if(n=n.filter(s=>s.fileType===h.FileType.File),n.length===0)throw o.stop({message:"Aborted; No changes to commit"}),Z.NothingToCommitError("No changes to commit");let a;try{const s=await this.getMetadata(e);let l,u,d;i?({repo:{owner:l,name:u}}=i,d=await this.getFileTree(this.createVirtualUri(e,i),s.HEAD.sha)):s.HEAD.type===Q.RemoteBranch&&s.HEAD.branch.remote.accessLevel>=ie.Write?({owner:l,name:u}=s.HEAD.branch.remote.accessLevel===ie.WriteToPullRequest?s.repo:s.HEAD.branch.remote.repo,d=await this.getFileTree(this.createVirtualUri(e,{repo:s.HEAD.branch.remote.repo}),s.HEAD.sha)):({repo:{owner:l,name:u}}=s,d=await this.getFileTree(e,s.HEAD.sha));const f=await d.getTreeSha();if(!z(f))throw new Error(`Unable to create commit based on tree sha ${f}`);o.logStep("Creating Blobs",{message:`: Committing ${n.length} changes onto commit ${s.HEAD.sha} based on tree ${f}`,suffix:" \u2022 Creating blobs..."});const p=[];async function g(x){var C;try{const k=await this.request("POST /repos/{owner}/{repo}/git/blobs",{owner:l,repo:u,encoding:"base64",content:Rp(await x.content),mediaType:{format:"raw"}});let T;if(x.type===q.Changed){const O=await d.get(x.path);T=(C=O==null?void 0:O.mode)!=null?C:"100644"}else T="100644";p.push({path:x.path,mode:T,type:"blob",sha:k.data.sha})}catch(k){throw te.error(k,`Failed to create blob for ${x.path}`),k}}c(g,"createOrUpdateBlob");const _=[];for(const x of n)switch(x.type){case q.Created:case q.Changed:{_.push(g.call(this,x));break}case q.Deleted:{p.push({path:x.path,mode:"100644",type:"blob",sha:null});break}}await Promise.all(_),o.logStep("Creating tree",{message:`: Created ${_.length} blobs;`,suffix:` \u2022 Creating tree based on ${f}...`});const b=await this.request("POST /repos/{owner}/{repo}/git/trees",{owner:l,repo:u,base_tree:f,tree:p});return o.logStep("Creating commit",{message:`: Created tree ${b.data.sha};`,suffix:" \u2022 Creating commit..."}),a=(await this.request("POST /repos/{owner}/{repo}/git/commits",{owner:l,repo:u,message:r,tree:b.data.sha,parents:[s.HEAD.sha]})).data.sha,a}catch(s){throw te.error(s),s}finally{o.stop(a?{message:`: Created commit ${a}`}:void 0)}}async createPullRequest(e,r,n,i,o){var a,s,l;const u=new Fe(`GitHub.createPullRequest(${e.toString()}, ${r}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);try{const{repo:{owner:d,name:f},HEAD:{branch:p},defaultBranch:g}=await this.getMetadata(e),_=await this.request("POST /repos/{owner}/{repo}/pulls",{owner:d,repo:f,base:`refs/heads/${(a=p==null?void 0:p.name)!=null?a:g.name}`,head:o?`${o.repo.owner}:${r}`:r,title:n,draft:(s=i==null?void 0:i.draft)!=null?s:!1,maintainer_can_modify:(l=i==null?void 0:i.canMaintainerModify)!=null?l:!0});return{id:_.data.number.toString(),uri:h.Uri.parse(_.data.html_url)}}catch(d){throw te.error(d),d}finally{u.stop()}}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,a,s,l,u,d,f,p;const{force:g,to:_}={...n,force:r||(n==null?void 0:n.force)},b=new Fe(`GitHub.fetch(${e.toString()}, force=${g}, to=${_})`);let y;try{const x=await this.getMetadata(e);if(x.HEAD.detached)return y=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:x};const C=await this.getBranchTips(e);if(!C)throw y=" \u2022 Unable to fetch branch tips",Z.SyncOrFetchError(r);if(!g&&!_&&((i=C.defaultBranch)==null?void 0:i.sha)!==void 0&&C.defaultBranch.sha===x.defaultBranch.sha&&((o=C.branch)==null?void 0:o.sha)!==void 0&&C.branch.sha===x.HEAD.branch.sha&&(x.HEAD.sha===x.HEAD.branch.sha||x.state!==void 0))return y=" \u2022 No changes detected",{fetched:!1,metadata:x};let k;if(((a=C.defaultBranch)==null?void 0:a.sha)!==void 0&&C.defaultBranch.sha!==x.defaultBranch.sha&&(k={defaultBranch:{...x.defaultBranch,sha:C.defaultBranch.sha}}),((s=C.branch)==null?void 0:s.sha)===void 0){if(y=" \u2022 Unable to find branch tip",g)throw Z.SyncOrFetchError(r);return k!==void 0?{fetched:!0,metadata:{...x,...k}}:{fetched:!1,metadata:x}}if(C.branch.sha!==x.HEAD.branch.sha&&(k={...k,HEAD:{...x.HEAD,branch:{...x.HEAD.branch,sha:C.branch.sha},detached:void 0}}),C.branch.sha===((l=n==null?void 0:n.to)!=null?l:x.HEAD.sha))return y=" \u2022 Up to date",x.state!==void 0||k!==void 0?{fetched:!0,metadata:{...x,...k,state:void 0}}:{fetched:!1,metadata:x};b.logStep("Fetching upstream changes");try{const T=await this.getAheadBehindState(e,x,{base:(u=n==null?void 0:n.to)!=null?u:x.HEAD.sha,head:(p=(f=(d=k==null?void 0:k.HEAD)==null?void 0:d.branch)==null?void 0:f.sha)!=null?p:x.HEAD.branch.sha});return y=` \u2022 Changes detected; ${T==null?void 0:T.behind} commits behind`,{fetched:!0,metadata:{...x,...k,state:T?{ahead:T.ahead,behind:T.behind,incomingChanges:T.incomingChanges}:void 0}}}catch(T){if(y=` \u2022 Failed fetching upstream changes; ${String(T)}`,g)throw Z.SyncOrFetchError(r);return k!==void 0?{fetched:!0,metadata:{...x,...k}}:{fetched:!1,metadata:x}}}finally{b.stop(y?{suffix:y}:void 0)}}async fork(e){try{const{repo:{owner:r,name:n}}=await this.getMetadata(e),i=await this.request("POST /repos/{owner}/{repo}/forks",{owner:r,repo:n});let o;for(;;){try{if(o=await this.getRepositoryInfo(i.data.owner.login,i.data.name,!1),o!==void 0)break}catch{}await new Promise(a=>setTimeout(a,250))}return{name:`${i.data.owner.login}/${i.data.name}`,repo:{owner:i.data.owner.login,name:i.data.name},url:i.data.url}}catch(r){throw te.error(r),r}}async getBranches(e,r){var n,i,o;try{const{repo:{owner:a,name:s}}=await this.getMetadata(e),l=`query getBranches(
	$owner: String!
	$repo: String!
	$branchQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
					commitUrl
				}
			}
		}
	}
}`,u=await this.graphql(l,{owner:a,repo:s,branchQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(u===void 0)return{branches:[]};const d=(o=u.repository)==null?void 0:o.refs;if(d===void 0)return{branches:[]};const f=d.nodes.map(p=>({type:io.Head,name:p.name,commit:p.target.oid,commitUrl:p.target.commitUrl}));return{paging:{cursor:d.pageInfo.endCursor,more:d.pageInfo.hasNextPage},branches:f}}catch(a){return{branches:[]}}}async getCommit(e,r){var n;try{const{HEAD:i,repo:{owner:o,name:a}}=await this.getMetadata(e),s=`query getCommit(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
) {
	repository(name: $repo owner: $owner) {
		object(oid: $ref) {
			...on Commit {
				oid
				message
				parents(first: 100) {
					nodes {
						oid
					}
				}
				author {
					date
					email
					name
				}
				committer {
					date
				}
			}
		}
	}
}`;r.toUpperCase()==="HEAD"&&(r=i.sha);const l=await this.graphql(s,{owner:o,repo:a,ref:r});if(l===void 0)return;const u=(n=l.repository)==null?void 0:n.object;return u===void 0?void 0:{hash:u.oid,message:u.message,parents:u.parents.nodes.map(d=>d.oid),authorDate:new Date(u.author.date),authorEmail:u.author.email,authorName:u.author.name,commitDate:new Date(u.committer.date)}}catch(i){return}}async getCommits(e,r){var n,i,o;try{const{HEAD:a,repo:{owner:s,name:l}}=await this.getMetadata(e),u=`query getCommits(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
	$path: String
	$cursor: String
	$limit: Int = 100
) {
	repository(name: $repo, owner: $owner) {
		object(oid: $ref) {
			... on Commit {
				history(first: $limit, path: $path, after: $cursor) {
					pageInfo {
						endCursor
						hasNextPage
					}
					nodes {
						... on Commit {
							...commit
						}
					}
				}
			}
		}
	}
}

fragment commit on Commit {
	oid
	message
	parents(first: 100) {
		nodes {
			oid
		}
	}
	author {
		date
		email
		name
	}
	committer {
		date
	}
}
`;let d=r==null?void 0:r.ref;(d==null?void 0:d.toUpperCase())==="HEAD"&&(d=a.sha);const f=await this.graphql(u,{owner:s,repo:l,ref:d,cursor:r==null?void 0:r.cursor,path:r==null?void 0:r.path,limit:Math.min(100,(n=r==null?void 0:r.limit)!=null?n:100)});if(f===void 0)return;const p=(o=(i=f.repository)==null?void 0:i.object)==null?void 0:o.history;if(p===void 0)return;const g=p.nodes.map(_=>({hash:_.oid,message:_.message,parents:_.parents.nodes.map(b=>b.oid),authorDate:new Date(_.author.date),authorEmail:_.author.email,authorName:_.author.name,commitDate:new Date(_.committer.date)}));return{paging:{cursor:p.pageInfo.endCursor,more:p.pageInfo.hasNextPage},commits:g}}catch(a){return}}async getBlobContent(e,r){try{const n=await this.request("GET /repos/{owner}/{repo}/git/blobs/{file_sha}",{owner:e.owner,repo:e.name,file_sha:r});return Ly(n.data.content)}catch(n){throw te.logLevel===Ce.Debug&&te.error(n),n}}async getFileContent(e,r,n){te.debug(`GitHub.getFileContent(${e.toString()}, ${r}, ${n})`);try{let i;if(r&&n&&!this.hasFileTree(e,r)){const o=this.providerService.getProviderRootUri(e);n.startsWith("/")&&(n=n.slice(1));let a=(0,K1.dirname)(n);(a==="."||a==="/")&&(a=""),te.debug(`GitHub.getFileContent: Loading file tree for path ${a}`),i=await(await this.getFileTree(o,r,{path:a,cache:!1,recursive:!1})).get(n)}else{te.debug("GitHub.getFileContent: Loading full file tree");const[o,{path:a}]=await Promise.all([this.getFileTree(e,r),n?{path:void 0}:this.providerService.getMetadata(e)]);te.debug(`GitHub.getFileContent: path: ${n}, uriPath: ${a}`),i=await o.get(n!=null?n:a)}if(te.debug(`GitHub.getFileContent: File SHA is ${i==null?void 0:i.sha}`),(i==null?void 0:i.sha)===void 0)throw h.FileSystemError.FileNotFound(e);return await i.getContent()}catch(i){throw te.logLevel===Ce.Debug&&te.error(i),i}}async getFileList(e,r,n){const i=new Fe(`GitHub.getFileList(${e.toString()}${n?`, ${n}`:""})`);try{const{repo:{owner:o,name:a},HEAD:{sha:s}}=await this.getMetadata(e),l=await this.request("GET /repos/{owner}/{repo}/git/tree-file-list/{treeish}",{owner:o,repo:a,treeish:`${n!=null?n:s}${r?`:${r}`:""}`});return l.status!==200?[]:l.data}catch(o){return te.error(o),[]}finally{i.stop()}}hasFileTree(e,r){return r?this.fileTreeCache.has(this.asFileTreeKey(e,r)):this.getMetadata(e).then(n=>this.fileTreeCache.has(this.asFileTreeKey(e,n.HEAD.sha)))}async getFileTree(e,r,n){var i,o,a,s,l;const u=this.providerService.isInWorkspace(e);let d=(i=n==null?void 0:n.cache)!=null?i:u,f,p,g;if(d||!r){const x=(a=(o=n==null?void 0:n.prefetched)==null?void 0:o.metadata)!=null?a:this.getMetadata(e);f=u?this.getFileTreePermissions(e,x):void 0;let C;({repo:p,HEAD:{sha:C},timestamp:g}=(s=n==null?void 0:n.prefetched)!=null?s:await x),r&&C!==r?(d=!1,g=Date.now()):r=C}else({repo:p}=(l=n==null?void 0:n.prefetched)!=null?l:this.providerService.getVirtualUriMetadata(e)),g=Date.now();const _=this.asFileTreeKey(e,r),b=this.providerService.getProviderRootUri(e),y=new Fe(`GitHub.getFileTree(${_}): ${e.toString()}`,{log:!1,logLevel:Ce.Debug});try{let x=c(function(){var k;const T=new Fe(`GitHub.createFileTree(${_})`);let O,ne;d&&u&&(O=new h.EventEmitter,ne=h.Disposable.from(this.tarPit.onDidChangeIndexingEnablement(()=>O.fire()),this.tarPit.onDidDownloadTar(Y=>O.fire({rootUri:this.providerService.getProviderRootUri(Y.rootUri),sha:Y.sha}))));const ae={dispose:()=>ne==null?void 0:ne.dispose(),permissions:f,getContent:async(Y,me)=>{const ce=new Fe("getFileContents"),pe=fe.get("experimental.fs.useTars");if(pe==="always"||pe==="ifAvailable"){const Ye=await this.tarPit.getInMemoryTar(b);if(Ye){const ue=Ye.entryMap.get(me);if(ue)return ce.stop({message:`Retrieved ${me} from memory`}),ue.dataAsBytes}}let Ae=!1;return new Promise((Ye,ue)=>{this.getBlobContent(p,Y.sha).then(Ie=>{Ae||(ce.stop({message:`Retrieved ${me} from web`}),Ae=!0,Ye(Ie))},Ie=>ue(Ie)),this.tarPit.getCachedTar(b,r).then(Ie=>Ie===void 0&&pe==="always"&&!Ae?this.tarPit.getTar(b,!1):Ie).then(Ie=>{var Oe;const $e=(Oe=Ie==null?void 0:Ie.entryMap.get(me))==null?void 0:Oe.dataAsBytes;$e&&!Ae&&(ce.stop({message:`Retrieved ${me} from tar`}),Ae=!0,Ye($e))},Ie=>{})})},getTree:async(Y,me)=>{const ce=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:p.owner,repo:p.name,recursive:me?"1":void 0,tree_sha:`${r}${Y?`:${Y}`:""}`});return ce.data.truncated?{sha:ce.data.sha,truncated:!0}:{sha:ce.data.sha,truncated:!1,tree:Os(ce.data.tree,pe=>{var Ae;return{path:pe.path,item:{mode:pe.mode,sha:pe.sha,stat:{type:UE(pe.type),size:(Ae=pe.size)!=null?Ae:0,ctime:0,mtime:g,permissions:void 0}}}})}},onDidTriggerContentCaching:O==null?void 0:O.event,tryCachingContent:d&&u?async Y=>{const me=fe.get("experimental.fs.useTars");if(me!=="always"&&me!=="ifAvailable")return!1;const ce=new Fe(`FileTree.loadAllContent(${r})`);let pe;try{let Ae;if(me==="ifAvailable"){if(ce.logStep("Tar cache query"),Ae=await this.tarPit.getCachedTar(b,r),Ae===void 0)return pe=" \u2022 No cached Tar",!1}else ce.logStep("Tar query"),Ae=await this.tarPit.getTar(b,!1,r);ce.logStep("Updating content",{suffix:" \u2022 Updating content..."});for(const Ye of Ae.entries){const ue=Y(Ye.header.fullFileName);if(ue===void 0)continue;const Ie=Ye.dataAsBytes;ue.getContent=()=>Ie}return!0}catch(Ae){return pe=` \u2022 Failed ${String(Ae)}`,!1}finally{ce.stop(pe?{suffix:pe}:void 0)}}:void 0};try{return new ep(b,r,g,ae,{path:n==null?void 0:n.path,recursive:(k=n==null?void 0:n.recursive)!=null?k:d,preload:d||(n==null?void 0:n.recursive)})}catch(Y){return te.error(Y),new ep(b,r,g,void 0)}finally{T.stop()}},"createFileTree"),C=this.fileTreeCache.get(_);return C!==void 0||(C=x.call(this),d&&this.fileTreeCache.set(_,C)),C}finally{y.stop()}}async getFileTreePermissions(e,r){if(this.providerService.getModeConfig(e,await this.getModeRefType(e,r)).display===Xe.Edit)return;const i=await this.providerService.getIndexMetadata(e);return Ol.isActive(i)?h.FilePermission.Readonly:void 0}async getFork(e){var r,n,i;try{const{repo:{owner:o,name:a}}=await this.getMetadata(e),s=`query getFork(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		forks(affiliations: OWNER, first: 1) {
			nodes {
				owner {
					login
				}
				name
				url
			}
		}
	}
}`,l=await this.graphql(s,{owner:o,repo:a});if(l===void 0)return;const[u]=(i=(n=(r=l.repository)==null?void 0:r.forks)==null?void 0:n.nodes)!=null?i:[];return u===void 0?void 0:{name:`${u.owner.login}/${u.name}`,repo:{owner:u.owner.login,name:u.name},url:u.url}}catch(o){return}}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){const n=await this.getMetadata(e),i=await this.getAheadBehindState(e,n,{base:r.base,head:r.compare});return i==null?void 0:i.incomingChanges}async getAheadBehindState(e,r,n){var i,o,a,s,l;const{base:u,head:d}={base:r.HEAD.sha,head:(i=r.HEAD.branch)==null?void 0:i.sha,...n},f=new Fe(`GitHub.getAheadBehindState(${e.toString()}, base=${u}, head=${d})`);let p,g;try{if(!d){p=` \u2022 Skipped; Unsupported HEAD type (${r.HEAD.type})`;return}const _=await this.request("GET /repos/{owner}/{repo}/compare/{base}...{head}",{owner:r.repo.owner,repo:r.repo.name,base:u,head:d}),b=[];for(const y of(o=_.data.files)!=null?o:[])switch(y.status){case"added":case"copied":b.push({uri:h.Uri.joinPath(e,y.filename),type:q.Created});break;case"removed":b.push({uri:h.Uri.joinPath(e,y.filename),type:q.Deleted});break;case"modified":b.push({uri:h.Uri.joinPath(e,y.filename),type:q.Changed});break;case"renamed":b.push({uri:h.Uri.joinPath(e,y.filename),type:q.Created}),b.push({uri:h.Uri.joinPath(e,y.previous_filename),type:q.Deleted});break;default:te.warn(`GitHub.getAheadBehindState(${e.toString()}, base=${u}, head=${d}): Unknown file status encountered '${y.status}'`);break}return g={ahead:(a=_.data.behind_by)!=null?a:0,behind:(s=_.data.ahead_by)!=null?s:0,incomingChanges:b},g}catch(_){throw p=` \u2022 Failed; ${String(_)}`,te.error(_),_}finally{f.stop({suffix:p!=null?p:` \u2022 ${(l=g==null?void 0:g.behind)!=null?l:0} commits behind`})}}async getObjectDetails(e,r,n){var i;try{const o=await this.getFileTree(e,r);n?n=this.providerService.getRelativeFilePath(e,this.providerService.createRelativeUri(e,n)):{path:n}=await this.providerService.getMetadata(e);const a=await o.get(n);if((a==null?void 0:a.mode)===void 0||(a==null?void 0:a.sha)===void 0)throw new Error(`Cannot get details of ${n} in ${r}`);return{mode:a.mode,object:a.sha,size:(i=a.stat.size)!=null?i:0}}catch(o){throw te.error(o),o}}async getPullRequest(e,r){const{repo:{owner:n,name:i}}=await this.getMetadata(e);return this.getPullRequestCore(n,i,r)}async getPullRequestCore(e,r,n){var i,o,a,s,l,u,d;try{const f=`query getPullRequest(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(name: $repo, owner: $owner) {
		pullRequest(number: $pr) {
			author {
				login
				avatarUrl
				url
			}
			permalink
			number
			title
			state
			updatedAt
			closedAt
			mergedAt
			repository {
				name
				owner {
					login
				}
			}
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
			}
			headRepositoryOwner {
				login
			}
		}
	}
}`,p=await this.graphql(f,{owner:e,repo:r,number:Number(n)}),g=(i=p==null?void 0:p.repository)==null?void 0:i.pullRequest;return g?{author:{name:g.author.login,avatarUrl:g.author.avatarUrl,url:g.author.url},closedAt:g.closedAt?new Date(g.closedAt):void 0,mergedAt:g.mergedAt?new Date(g.mergedAt):void 0,id:g.number.toString(),repo:{name:g.repository.name,owner:g.repository.owner.login},state:op(g.state),title:g.title,updatedAt:new Date(g.updatedAt),url:g.permalink,refs:{base:{owner:g.baseRepository.owner.login,repo:g.baseRepository.name,branch:g.baseRefName,sha:g.baseRefOid,exists:g.baseRef!=null},head:{owner:(l=(s=(o=g.headRepository)==null?void 0:o.owner.login)!=null?s:(a=g.headRepositoryOwner)==null?void 0:a.login)!=null?l:"<unknown>",repo:(d=(u=g.headRepository)==null?void 0:u.name)!=null?d:g.baseRepository.name,branch:g.headRefName,sha:g.headRefOid,exists:g.headRef!=null}}}:void 0}catch(f){te.error(f);return}}async getPullRequestForBranch(e,r,n){var i,o,a,s,l;try{const{repo:{owner:u,name:d}}=await this.getMetadata(e),f=`query getPullRequestForBranch(
	$owner: String!
	$repo: String!
	$branch: String!
	$maxCount: Int!
	$states: [PullRequestState!]
) {
	repository(name: $repo, owner: $owner) {
		refs(query: $branch, refPrefix: "refs/heads/", first: 1) {
			nodes {
				associatedPullRequests(first: $maxCount, orderBy: {field: UPDATED_AT, direction: DESC}, states: $states) {
					nodes {
						author {
							login
							avatarUrl
							url
						}
						permalink
						number
						title
						state
						updatedAt
						closedAt
						mergedAt
						repository {
							isFork
							name
							owner {
								login
							}
						}
					}
				}
			}
		}
	}
}`,p=await this.graphql(f,{owner:u,repo:d,branch:r,maxCount:(i=n==null?void 0:n.maxCount)!=null?i:1,states:OE(n==null?void 0:n.include)}),g=(l=(s=(a=(o=p==null?void 0:p.repository)==null?void 0:o.refs.nodes[0])==null?void 0:a.associatedPullRequests)==null?void 0:s.nodes)==null?void 0:l.filter(b=>!b.repository.isFork||b.repository.owner.login===u);if(g==null||g.length===0)return;g.length>1&&g.sort((b,y)=>(b.repository.owner.login===u?-1:1)-(y.repository.owner.login===u?-1:1)||(b.state==="OPEN"?-1:1)-(y.state==="OPEN"?-1:1)||new Date(y.updatedAt).getTime()-new Date(b.updatedAt).getTime());const[_]=g;return{author:{name:_.author.login,avatarUrl:_.author.avatarUrl,url:_.author.url},closedAt:_.closedAt?new Date(_.closedAt):void 0,mergedAt:_.mergedAt?new Date(_.mergedAt):void 0,id:_.number.toString(),repo:{name:_.repository.name,owner:_.repository.owner.login},state:op(_.state),title:_.title,updatedAt:new Date(_.updatedAt),url:_.permalink}}catch(u){te.error(u);return}}async getTags(e,r){var n,i,o;try{const{repo:{owner:a,name:s}}=await this.getMetadata(e),l=`query getTags(
	$owner: String!
	$repo: String!
	$tagQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,u=await this.graphql(l,{owner:a,repo:s,tagQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(u===void 0)return{tags:[]};const d=(o=u.repository)==null?void 0:o.refs;if(d===void 0)return{tags:[]};const f=d.nodes.map(p=>({type:io.Tag,name:p.name,commit:p.target.oid,commitUrl:p.target.commitUrl}));return{paging:{cursor:d.pageInfo.endCursor,more:d.pageInfo.hasNextPage},tags:f}}catch(a){return{tags:[]}}}async getTarGz(e,r){const{repo:{owner:n,name:i},HEAD:{sha:o}}=await this.getMetadata(e),a=await this.ensureAuthenticated(),s=fe.get("indexing.verboseDownloadNotification");return h.window.withProgress({location:s?h.ProgressLocation.Notification:h.ProgressLocation.Window,cancellable:!0,title:li("fetching index","Downloading repository index")},async(l,u)=>{try{if(Cn){let p;try{const y=await this.tarballProxyEndpoint;y!==void 0&&(p=y.replace("{owner}",n).replace("{repo}",i).replace("{sha}",o))}catch{}if(!p)throw new Error("Workbench embedder must set `_tarballProxyEndpoints` in workbench construction options to enable GitHub fulltext search.");const _=await(await _0(p,{headers:{"x-proxy-authorization":`Bearer ${a.accessToken}`},credentials:"include"},u)).text();return await x0(_,{},r,u,l)}const d=`https://api.github.com/repos/${n}/${i}/tarball/${o}`;return await x0(d,{headers:{Authorization:`Bearer ${a.accessToken}`}},r,u,l)}catch(d){throw te.error(d),d}})}async pushCommit(e,r,n,i){const o=new Fe(`GitHub.pushCommit(${e.toString()}, sha=${r}${n?`, ref=${n}`:""}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);let a;try{const s=await this.getMetadata(e);let l,u;if(i?{repo:{owner:l,name:u}}=i:s.HEAD.type===Q.RemoteBranch&&s.HEAD.branch.remote.accessLevel>=ie.Write?{owner:l,name:u}=s.HEAD.branch.remote.repo:{repo:{owner:l,name:u}}=s,n===void 0&&s.HEAD.detached)throw Z.DetachedHEADError("Unable to commit; no current branch");(n==null?void 0:n.startsWith("refs/heads/"))&&(n=n.substr(11));const d=await this.request("PATCH /repos/{owner}/{repo}/git/refs/{ref}",{owner:l,repo:u,ref:`heads/${n!=null?n:s.HEAD.branch.name}`,sha:r});return n===void 0&&!s.HEAD.detached&&await this.fastForwardTo(e,r,s),a=d.data.ref,a}catch(s){throw s instanceof ci&&s.status===422&&s.message.includes("Update is not a fast forward")?Z.MergeConflictError(s):(te.error(s),s)}finally{o.stop(a?{message:`: Pushed commit to ${a}`}:void 0)}}async queryRepositoryObject(e,r,n,i){var o,a;try{const{repo:{owner:s,name:l},HEAD:{sha:u},path:d}=await this.providerService.getMetadata(e),f=`query ${r}(
	$owner: String!
	$repo: String!
	$expression: String
) {
	repository(owner: $owner, name: $repo) {
		object(expression: $expression) {
			${n}
		}
	}
}`,p=await this.graphql(f,{owner:s,repo:l,expression:i!=null?i:`${u}:${d}`});return(a=(o=p==null?void 0:p.repository)==null?void 0:o.object)!=null?a:void 0}catch(s){te.error(s);return}}async repositoryObjectExists(e,r){return await this.queryRepositoryObject(e,"exists","			__typename",r)!==void 0}async searchPullRequestsQuery(e,r){var n,i;function o(a){function s(l,u){return{number:l.number,title:l.title,repoWithOwner:l.repository.nameWithOwner,reasons:u?[u]:[],url:l.url}}return c(s,"toResult"),Uh([...a.assigned.nodes.filter(l=>l!==null).map(l=>s(l,"assigned")),...a.reviewRequested.nodes.filter(l=>l!==null).map(l=>s(l,"review requested")),...a.mentioned.nodes.filter(l=>l!==null).map(l=>s(l,"mentioned")),...a.authored.nodes.filter(l=>l!==null).map(l=>s(l,"authored")),...F0(a.viewer.repositories.nodes,l=>l.pullRequests.nodes.map(u=>s(u)))],l=>l.url,(l,u)=>(u.reasons.length!==0&&l.reasons.push(...u.reasons),l))}c(o,"processQueryResults");try{const a=`query searchPullRequests(
	$authored: String!
	$assigned: String!
	$reviewRequested: String!
	$mentioned: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: STARGAZERS, direction: DESC }) {
			nodes {
				pullRequests(first: 100, states: OPEN, orderBy: { field: UPDATED_AT, direction: DESC }) {
					nodes {
						number
						title
						url
						repository {
							nameWithOwner
						}
					}
				}
			}
		}
	}
	authored: search(first: 100, query: $authored, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	assigned: search(first: 100, query: $assigned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	reviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	mentioned: search(first: 100, query: $mentioned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
}`;e=e.trim(),(r==null?void 0:r.user)&&(e+=` user:${r.user}`);const s=await this.graphql(a,{authored:(e?`${e} is:pr is:open archived:false author:@me`:"is:pr is:open archived:false author:@me").trim(),assigned:(e?`${e} is:pr is:open archived:false assignee:@me`:"is:pr is:open archived:false assignee:@me").trim(),reviewRequested:(e?`${e} is:pr is:open archived:false review-requested:@me`:"is:pr is:open archived:false review-requested:@me").trim(),mentioned:(e?`${e} is:pr is:open archived:false mentions:@me`:"is:pr is:open archived:false mentions:@me").trim()},!0);return s===void 0?{results:[],hasSAMLProtectedResults:!1}:{results:o(s),hasSAMLProtectedResults:!1}}catch(a){return a instanceof no&&((i=(n=a.errors)==null?void 0:n[0])==null?void 0:i.type)==="FORBIDDEN"?{results:o(a.data),hasSAMLProtectedResults:!0}:{results:[],hasSAMLProtectedResults:!1}}}async searchRepositoriesQuery(e,r){var n,i;function o(a){return Uh((r==null?void 0:r.user)?[...a.search.nodes,...a.viewer.repositories.nodes]:[...a.viewer.repositories.nodes,...a.search.nodes],l=>l.url).map(l=>{var u,d,f;return{repoWithOwner:l.nameWithOwner,description:(u=l.description)!=null?u:void 0,url:l.url,fork:(f=(d=l.parent)==null?void 0:d.nameWithOwner)!=null?f:void 0,stars:l.stargazerCount}})}c(o,"processQueryResults");try{const a=`query searchRepositories(
	$search: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: UPDATED_AT, direction: DESC }) {
			nodes {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
	search(first: 100, query: $search, type: REPOSITORY) {
		nodes {
			...on Repository {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
}`;(r==null?void 0:r.user)&&(e+=` user:${r.user}`),(r==null?void 0:r.sort)&&(e+=` sort:${r.sort}`),e+=" fork:true";const s=await this.graphql(a,{search:e.trim()},!0);return s===void 0?{results:[],hasSAMLProtectedResults:!1}:{results:o(s),hasSAMLProtectedResults:!1}}catch(a){return a instanceof no&&((i=(n=a.errors)==null?void 0:n[0])==null?void 0:i.type)==="FORBIDDEN"?{results:o(a.data),hasSAMLProtectedResults:!0}:{results:[],hasSAMLProtectedResults:!1}}}async searchCodeQuery(e,r,n){var i,o,a;const{repo:{owner:s,name:l},HEAD:u,defaultBranch:d}=await this.getMetadata(r),f=[];((i=u.branch)==null?void 0:i.name)!==d.name&&f.push(li("Cant search branch","Unable to search {0} without index, falling back to {1}.",(a=(o=u.branch)==null?void 0:o.name)!=null?a:u.detached.name,d.name));try{const g=await(await this.octokit({request:{headers:{authorization:`Bearer ${(await this.ensureAuthenticated()).accessToken}`,accept:"application/vnd.github.v3.text-match+json"}}})).request("GET /search/code",{q:`${e} repo:${s}/${l}`}),_=new h.Range(0,0,0,0),b=[];let y=0,x;for(const C of g.data.items)for(const k of C.text_matches){if(y++,n.maxResults!==void 0&&y>n.maxResults)return{matches:b,limitHit:!0};x={path:C.path,ranges:[],preview:k.fragment,matches:[]};for(const T of k.matches){let O=0,ne=0,ae=0;for(let Y=0;Y<T.indices[1];Y++)Y===T.indices[0]&&(ne=ae),k.fragment[Y]===`
`?(O++,ae=0):ae++;x.ranges.push(_),x.matches.push(new h.Range(O,ne,O,ae))}b.push(x)}return{matches:b,limitHit:!1,warnings:f}}catch(p){return{matches:[],limitHit:!0}}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:a}}=await this.getMetadata(e);let s;if(!(r!==void 0&&(typeof r=="string"?(r==null?void 0:r.startsWith("refs/heads/"))?(s={type:De.Tree,id:r.substr(11)},r=r.substr(11)):(r==null?void 0:r.startsWith("refs/tags/"))?s={type:De.Tree,id:r.substr(10)}:s={type:De.Tree,id:r}:s={...r,type:r.type===De.Branch||r.type===De.Tag?De.Tree:r.type},(a==null?void 0:a.name)===s.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:s}),location:(n==null?void 0:n.openInNewWindow)?ve.NewWindow:ve.CurrentWindow}}async sync(e,r,n){var i,o,a,s,l,u;const d=new Fe(`GitHub.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let f;try{const{metadata:p}=await this.fetchCore(e,!0,{to:n.to});if(p.HEAD.detached){f=" \u2022 Skipped; detached HEAD";return}if(((o=(i=p==null?void 0:p.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){d.logStep("Fetching upstream changes");const g=[],_=(s=(a=p.state)==null?void 0:a.incomingChanges)!=null?s:[];if(_.length>0){const b=await r.getChanges(e);for(const y of b){const x=this.providerService.getRelativeFilePath(e,y.uri),C=_.find(k=>this.providerService.getRelativeFilePath(e,k.uri)===x);C!==void 0&&g.push({path:x,current:y,incomingType:C.type})}}if(g.length>0)switch(n.conflictResolution){case ot.KeepCurrent:d.logStep("Syncing (keep) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const b of g)await r.keep(b.current.uri,{type:b.incomingType,providerUri:ip(p,p.HEAD.branch.sha,b.path)});break;case ot.DiscardCurrent:d.logStep("Syncing (discard) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const b of g)await r.discard(b.current.uri);break;case ot.Merge:d.logStep("Syncing (merge) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const b of g)await r.merge(b.current.uri,{type:b.incomingType,providerUri:ip(p,p.HEAD.branch.sha,b.path)},{providerUri:ip(p,p.HEAD.sha,b.path)},fe.get("experimental.useSimplifiedMerge"));break;case ot.Abort:default:throw d.logStep("Syncing (abort) upstream changes",{message:`: ${g.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,p),Z.SyncConflictsError()}}f=` \u2022 to=${(l=n.to)!=null?l:p.HEAD.branch.sha}`,await this.fastForwardTo(e,(u=n.to)!=null?u:p.HEAD.branch.sha,p)}finally{d.stop(f?{suffix:f}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw Z.DetachedHEADError("Unable to fast-forward; no current branch");if(n.HEAD.sha===r&&n.state===void 0)return;const i=this.asFileTreeKey(e,n.HEAD.sha),o=this.fileTreeCache.get(i);this.fileTreeCache.delete(i),o==null||o.dispose(),te.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:r!==n.HEAD.branch.sha?n.state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&n.state===void 0&&await this.fetchCore(e,!1,{to:r})}async getBranchTips(e,r){try{const{repo:{owner:n,name:i},HEAD:o}=await this.getMetadata(e);r===void 0&&(o.type===Q.RemoteBranch?r=`${o.branch.remote.repo.owner}/${o.branch.remote.repo.name}:refs/heads/${o.branch.name}`:r=o.branch?`refs/heads/${o.branch.name}`:"");const a=my.exec(r);if(a==null?void 0:a.groups)return this.getRemoteBranchTips(n,i,r);const s=`query getBranchTips(
	$owner: String!
	$repo: String!
	$ref: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			target {
				oid
			}
		}
	}
}`,l=await this.graphql(s,{owner:n,repo:i,ref:r});if((l==null?void 0:l.repository)==null)return;const{defaultBranchRef:u,ref:d}=l.repository;return!u&&!d?void 0:{defaultBranch:u?{sha:u.target.oid}:void 0,branch:d?{sha:d.target.oid}:void 0}}catch(n){return}}async getRemoteBranchTips(e,r,n){try{const i=my.exec(n);if((i==null?void 0:i.groups)==null)return;let{remoteOwner:o,remoteRepo:a,remoteRef:s}=i.groups;a||(a=r);const l=`query getRemoteBranchTips(
	$owner: String!
	$repo: String!
	$remoteOwner: String!
	$remoteRepo: String!
	$remoteRef: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
	}
	remote: repository(owner: $remoteOwner, name: $remoteRepo) {
		ref(qualifiedName: $remoteRef) {
			target {
				oid
			}
		}
	}
}`,u=await this.graphql(l,{owner:e,repo:r,remoteOwner:o,remoteRepo:a,remoteRef:s});if((u==null?void 0:u.repository)==null||(u==null?void 0:u.remote)==null)return;const{repository:{defaultBranchRef:d},remote:{ref:f}}=u;return!d&&!f?void 0:{defaultBranch:d?{sha:d.target.oid}:void 0,branch:f?{sha:f.target.oid}:void 0}}catch(i){return}}async getRepositoryInfo(e,r,n,i){var o,a,s,l,u,d,f,p,g,_,b,y,x,C,k,T;try{const O=`number
title
state
maintainerCanModify
baseRef { name }
baseRefName
baseRefOid
baseRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
headRef { name }
headRefName
headRefOid
headRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
mergeCommit { oid }
`,ne=`query getRepository(
	$owner: String!
	$repo: String!
	$ref: String = ""
	$has_pr: Boolean!
	$pr: Int = 0
) {
	viewer { login }
	repository(owner: $owner, name: $repo) {
		name
		owner { login }
		defaultBranchRef {
			name
			target { oid }
		}
		ref(qualifiedName: $ref) {
			name
			prefix
			target { oid }
		}
		viewerPermission
		pullRequest(number: $pr) @include(if: $has_pr) {
			${O}
		}
	}
}`;let ae,Y;try{const Ae=await this.graphql(ne,{owner:e,repo:r,ref:(i==null?void 0:i.ref)!=="HEAD"?i==null?void 0:i.ref:void 0,has_pr:Boolean(i==null?void 0:i.pr),pr:(o=i==null?void 0:i.pr)!=null?o:0});if((Ae==null?void 0:Ae.repository)==null)return;({repository:Y,viewer:{login:ae}}=Ae)}catch(Ae){if((i==null?void 0:i.pr)&&Ae instanceof no&&((s=(a=Ae.errors)==null?void 0:a[0])==null?void 0:s.type)==="NOT_FOUND"&&((l=Ae.errors[0])==null?void 0:l.message.includes("Could not resolve to a PullRequest"))){({repository:Y,viewer:{login:ae}}=Ae.data);try{const Ye=await this.graphql(`query getPullRequestFromParentRepository(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(owner: $owner, name: $repo) {
		parent {
			pullRequest(number: $pr) {
				${O}
			}
		}
	}
}`,{owner:e,repo:r,pr:i==null?void 0:i.pr});if(((d=(u=Ye==null?void 0:Ye.repository)==null?void 0:u.parent)==null?void 0:d.pullRequest)==null)throw Ae;Y.pullRequest=Ye.repository.parent.pullRequest}catch{throw Ae}}else throw Ae}const me=(f=Y.defaultBranchRef)!=null?f:void 0;if((me==null?void 0:me.name)==null)return;const ce=Y.pullRequest;let pe;if(Y==null?void 0:Y.ref)pe={prefix:Y.ref.prefix,name:Y.ref.name,sha:Y.ref.target.oid};else if(ce==null?void 0:ce.headRef){let Ae=ap(ce.headRepository.viewerPermission);Ae<ie.Write&&ce.maintainerCanModify&&ap(Y.viewerPermission)>=ie.Write&&(Ae=ie.WriteToPullRequest),pe=ce.headRepository.owner.login===e?{prefix:"refs/heads/",name:ce==null?void 0:ce.headRef.name,sha:(g=(p=ce.mergeCommit)==null?void 0:p.oid)!=null?g:ce==null?void 0:ce.headRefOid}:{prefix:"refs/remotes/",name:ce==null?void 0:ce.headRef.name,sha:(b=(_=ce.mergeCommit)==null?void 0:_.oid)!=null?b:ce==null?void 0:ce.headRefOid,remote:{name:`${ce.headRepository.owner.login}/${ce.headRepository.name}`,accessLevel:Ae,repo:{owner:ce.headRepository.owner.login,name:ce.headRepository.name}}}}else(ce==null?void 0:ce.baseRef)?(pe={prefix:"refs/heads/",name:ce==null?void 0:ce.baseRef.name,sha:(x=(y=ce.mergeCommit)==null?void 0:y.oid)!=null?x:ce==null?void 0:ce.baseRefOid},n&&(te.log("Did not find a headRef for PR, falling back to baseRef",ce.baseRef),Pr.showPullRequestHeadNotFoundMessage(`${e}/${r}`,`#${i==null?void 0:i.pr}`))):(i==null?void 0:i.ref)==="HEAD"&&(pe={prefix:"refs/heads/",name:me.name,sha:me.target.oid});return{user:ae,repo:{owner:Y.owner.login,name:Y.name},accessLevel:ap(Y.viewerPermission),ref:pe,defaultBranch:{name:me.name,sha:me.target.oid},pullRequest:ce?{id:ce.number.toString(),state:op(ce.state),title:ce.title}:void 0}}catch(O){if(O instanceof no)switch((k=(C=O.errors)==null?void 0:C[0])==null?void 0:k.type){case"NOT_FOUND":{if((i==null?void 0:i.pr)&&((T=O.errors[0])==null?void 0:T.message.includes("Could not resolve to a PullRequest"))){const ae=new vt(O,`${e}/${r}`,`#${i==null?void 0:i.pr}`);throw n&&Pr.showPullRequestNotFoundMessage(ae.name,ae.id),ae}const ne=new at(O,`${e}/${r}`);throw n&&Pr.showRepositoryNotFoundMessage(ne.name),ne}case"FORBIDDEN":{const ne=new Qe(O,`${e}/${r}`);throw n&&Pr.showRepositoryForbiddenMessage(ne.name),ne}}te.error(O,`Failed to get repository info for '${e}/${r}'`),!this.handleRequestErrors(O)&&n&&Pr.showUnableToOpenRepositoryMessage(O);return}}async validateOwnerAndRepoAndSplitRefFromPath(e,r,n){try{const i=await this.request(`GET /repos/{owner}/{repo}/git/extract-ref/${n!=null?n:"HEAD"}`,{owner:e,repo:r});return[e,r]=i.data.name_with_owner.split("/"),n?{owner:e,repo:r,ref:{type:De.Tree,id:i.data.ref},path:i.data.path}:{owner:e,repo:r}}catch(i){if(i instanceof ci)switch(i.status){case 401:throw Z.InvalidCredentialsError(i,()=>void this.reauthenticate());case 403:throw new Qe(i,`${e}/${r}`);case 404:throw new at(i,`${e}/${r}`);case 409:throw new we(i,`${e}/${r}`)}return}}asFileTreeKey(e,r){return`${N(this.providerService.getProviderRootUri(e))}:${r}`}}c(yu,"GitHubRepositoryProvider"),py([le()],yu.prototype,"ensureAuthenticated",1),py([le()],yu.prototype,"octokit",1);function op(t){switch(t){case"OPEN":return He.Open;case"CLOSED":return He.Closed;case"MERGED":return He.Merged}}c(op,"toPullRequestState");function OE(t){if(t!==void 0)return t.map(e=>{switch(e){case He.Open:return"OPEN";case He.Closed:return"CLOSED";case He.Merged:return"MERGED"}})}c(OE,"fromPullRequestStates");var Wo;(function(t){t.ADMIN="ADMIN",t.MAINTAIN="MAINTAIN",t.WRITE="WRITE",t.TRIAGE="TRIAGE",t.READ="READ",t.NONE="NONE"})(Wo||(Wo={}));function ap(t){switch(t){case Wo.ADMIN:return ie.Admin;case Wo.MAINTAIN:return ie.Maintain;case Wo.WRITE:return ie.Write;case Wo.TRIAGE:return ie.Triage;case Wo.READ:return ie.Read;default:return ie.None}}c(ap,"permissionToAccessLevel");function UE(t){switch(t&&(t=t.toLocaleLowerCase()),t){case"blob":return h.FileType.File;case"tree":return h.FileType.Directory;default:return h.FileType.Unknown}}c(UE,"typenameToFileType");const wy=c(class{constructor(t){this.providerService=t,this.lock=new _r("PendingRepositoryOpenActions"),this.disposable=h.Disposable.from(t.onDidChangeRepositories(e=>e.added.length&&this.onRepositoriesOpened(e.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(t){for(const e of t){const r=await this.getAndDelete(e);(r==null?void 0:r.applyChangeset)&&await this.applyPendingChangeset(e,r.applyChangeset),(r==null?void 0:r.filesToOpen)&&this.openPendingFiles(e.uri,r.filesToOpen),this.fetchOrSync(e)}}async fetchOrSync(t){await this.providerService.fetchOrSync(t.uri)}async get(t){return this.lock.synchronizeRead(()=>this.getCore(t.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(t){te.debug(`RepositoryOpenActionsService.getAndDelete(${t.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t.uri);if(r!==void 0)return await this.storeCore(t.uri,void 0),r},"PendingRepositoryOpenActions.getAndDelete")}catch(e){te.error(e,`Failed to get pending actions for ${t.uri.toString()}`);return}}async openPendingFiles(t,e){if(e.length!==0){te.log(`RepositoryOpenActionsService.openPendingFiles(${t.toString()})`,e.join(","));for(let r of e){const n=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(r);let i,o;(n==null?void 0:n.groups)!==void 0&&(i=Number(n.groups.start),isNaN(i)&&(i=void 0),o=Number(n.groups.end),isNaN(o)&&(o=void 0),r=r.substring(0,n.index));const a=h.Uri.joinPath(t,r);let s;try{s=await h.workspace.fs.stat(a)}catch{}if((s==null?void 0:s.type)===h.FileType.Directory)h.commands.executeCommand("revealInExplorer",a);else{let l;i!==void 0&&(l={selection:new h.Range(Number(i)-1,0,o!=null?o:i,0)}),h.commands.executeCommand("vscode.open",a,l)}}}}setChangesetToApply(t,e){return te.log(`RepositoryOpenActionsService.setChangesetToApply(${t.toString()})`),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(t,e){return te.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${t.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(t,e){te.log(`RepositoryOpenActionsService.applyPendingChangeset(${t.uri.toString()})`);const r=fe.get("experimental.useSimplifiedMerge");try{await this.providerService.changeStoreApplyChangeset(t.uri,e,{save:!0,useSimplifiedMerge:r})}catch(n){te.error(n,`Failed to apply pending changeset for ${t.uri.toString()}`)}}async getCore(t){return this.fromStorage(await this.providerService.getFromStorage(t,this.getStorageKey(t)))}storeCore(t,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.providerService.deleteFromStorage(t,this.getStorageKey(t)):this.providerService.storeInStorage(t,this.getStorageKey(t),this.toStorage(e))}getStorageKey(t){return`actions/${E(t)}`}fromStorage(t){if(!!t)try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&S(n)?h.Uri.from(n):n);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return te.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(t){const e={schemaVersion:wy.storageSchemaVersion,...t};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let yy=wy;yy.storageSchemaVersion=1;const mn=(0,m.loadMessageBundle)();class by{constructor(e){this.providerService=e,this._onDidChangeFileDecorations=new h.EventEmitter,this._decorations=new Map,this.disposable=h.Disposable.from(h.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),e.onDidChangeChangeStore(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const r=e.map(({uri:n})=>(this._decorations.delete(E(n)),n));setTimeout(()=>this._onDidChangeFileDecorations.fire(r),0)}async provideFileDecoration(e,r){if(e.scheme!==Nr.scheme)return;const n=E(e);let i=this._decorations.get(n);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let a;o.length>0&&(a=o.find(l=>E(l.uri)===n));const s=await this.providerService.changeStoreGetChange(e);if(s===void 0){if(a!==void 0)switch(a.type){case q.Created:i={badge:"\u2193A",color:new h.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:mn("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case q.Deleted:i={badge:"\u2193D",color:new h.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:mn("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case q.Changed:i={badge:"\u2193M",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:mn("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new h.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:mn("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(n,i!=null?i:null),i}if(s.conflicts)i={badge:"!",color:new h.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:mn("decoration tooltip conflicts","Merge Conflicts ({0})",jy(s.conflicts.status))};else if(a!==void 0)switch(a.type){case q.Created:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case q.Deleted:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case q.Changed:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new h.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:mn("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(s.type){case q.Created:i={badge:"A",color:new h.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:mn("decoration tooltip added","Added")};break;case q.Changed:i={badge:"M",color:new h.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:mn("decoration tooltip modified","Modified")};break;case q.Deleted:i={badge:"D",color:new h.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:mn("decoration tooltip deleted","Deleted")};break}return this._decorations.set(n,i!=null?i:null),i}}c(by,"ScmDecorationProvider");const HE=(0,m.loadMessageBundle)();class Di{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await h.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}c(Di,"CommandQuickPickItem");var bu;(function(t){async function e(r,n,i,o,a,s){let l;Array.isArray(a)?l=a:s===void 0&&(l=[],s=a);const u=h.window.createQuickPick(),d=new Ll(500),f=[d],{defaultBranch:p,HEAD:g}=await r.getMetadata(n);async function _(k){var T;const[O,ne,ae]=await Promise.all([r.getBranches(n,{query:k,limit:100}),r.getTags(n,{query:k,limit:100}),r.getSnapshots(n)]),Y=new Set,me=new Set;for(const Ye of ae)Y.add(Ye.hash),me.add(Ye.branch.name);const ce=((s==null?void 0:s.filterBranches)?O.branches.filter(s==null?void 0:s.filterBranches):O.branches).filter(Ye=>Ye.name!==p.name),pe=HE("indexedCommit","Open indexed commit"),Ae=[{iconPath:new h.ThemeIcon("layers-active"),tooltip:pe}];return[...l,...((T=g.branch)==null?void 0:T.name)!==p.name?[{label:`$(git-branch) ${p.name} (default)`,description:`\u2022$(git-commit) ${W(p.sha)}${me.has(p.name)||Y.has(p.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:De.Branch,name:void 0,sha:p.sha,buttons:me.has(p.name)||Y.has(p.sha)?Ae:void 0}]:[],...ce.map(Ye=>({label:`$(git-branch) ${Ye.name}`,description:`\u2022$(git-commit) ${W(Ye.commit)}${me.has(Ye.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:De.Branch,name:Ye.name,sha:Ye.commit,buttons:me.has(Ye.name)?Ae:void 0})),...ne.tags.map(Ye=>({label:`$(tag) ${Ye.name}`,description:`\u2022$(git-commit) ${W(Ye.commit)}${Y.has(Ye.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:De.Tag,name:Ye.name,sha:Ye.commit,buttons:Y.has(Ye.commit)?Ae:void 0}))]}c(_,"getItems");const b=_(void 0);let y,x=!1;async function C(k){y=void 0;const T=u.activeItems;u.items=k!=null?k:await b,x&&T.length!==0&&(u.activeItems=u.items.filter(O=>T.some(ne=>ne.label===O.label))),u.busy=!1}c(C,"setItems");try{return await new Promise(T=>{var O;f.push(u.onDidHide(()=>T(void 0)),u.onDidChangeValue(ne=>{if(x=!1,ne=ne.trim(),(s==null?void 0:s.allowResetToSha)&&g.branch&&z(ne)){C([{label:`Reset $(git-branch) ${g.branch.name} to $(git-commit) ${ne}`,name:g.branch.name,sha:ne,type:De.Branch}]);return}u.busy=!0;const ae=d.debounce(ne?()=>_(ne):()=>b);y===void 0&&(y=ae.then(async Y=>C(Y)))}),u.onDidAccept(()=>{if(u.activeItems.length!==0){const[ne]=u.activeItems;T(ne)}}),u.onDidTriggerItemButton(ne=>{const ae=ne.item;ae instanceof Di||(ae.useIndex=!0),T(ae)})),u.title=o,u.placeholder=i,u.matchOnDescription=!0,u.ignoreFocusOut=(O=s==null?void 0:s.ignoreFocusOut)!=null?O:!0,u.busy=!0,u.show(),y=d.debounce(async()=>b,0).then(ne=>C(ne))})}finally{u.dispose(),f.forEach(k=>void k.dispose())}}c(e,"show"),t.show=e})(bu||(bu={}));const _e=(0,m.loadMessageBundle)(),WE=new TextDecoder;class _y{constructor(e,r,n){this.providerService=e,this.openActionsService=r,this.telemetryService=n,this._onDidCloseRepository=new h.EventEmitter,this._onDidOpenRepository=new h.EventEmitter,this._onDidChangeState=new h.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=h.Disposable.from(fe.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:o})=>{const a=this.getScmProvider(B.getVirtualUri(o.uri));a!==void 0&&await this.updateStatusBarCommands(a,void 0)}),this.providerService.onDidSyncRepository(async({repository:o,syncing:a})=>{const s=this.getScmProvider(B.getVirtualUri(o.uri));s!==void 0&&await this.updateStatusBarCommands(s,{syncing:a})}),this.providerService.onDidRefresh(o=>{for(const a of o)this.update(a)}),this.providerService.onDidChangeChangeStore(o=>this.update(o[0].rootUri)),...this.registerCommands());const i=this.providerService.repositories;this.onRepositoriesChanged({added:i,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=fe.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){fe.changed(e,"staging")&&(this._staging=void 0,fe.changed(e,"staging.enabled")&&this.refresh()),fe.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const r of e.added){const n=await this.update(r.uri);(n==null?void 0:n.repository)&&this._onDidOpenRepository.fire(n.repository)}if(e.removed.length)for(const r of e.removed){const n=this._scmProviders.findIndex(i=>E(i.sourceControl.rootUri)===E(r.uri));if(n!==-1){const i=this._scmProviders[n];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(n,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state)),hi(Un.HasWriteableScmProvider,this._scmProviders.some(r=>!r.isReadonly))}registerCommands(){return[h.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(e)}),h.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),h.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(e,{empty:!1})}),h.commands.registerCommand("remoteHub.commitEmpty",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commitEmpty"),void this.commitChanges(e,{empty:!0})}),h.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(xy(e)){const o=e.resourceStates.filter(wc);if(o.length!==0){if(await cp(o))for(const a of o)await this.providerService.getChangeStore(a.resourceUri).discard(a.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const n=await this.providerService.getChangeStore(r.rootUri).getChanges(r.rootUri);await cp(n)?await this.providerService.getChangeStore(r.rootUri).discardAll(r.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),h.commands.registerCommand("remoteHub.discardChanges",async(...e)=>{for(const r of e)!wc(r)||(this.telemetryService.sendEvent("command.discardChanges"),await cp([r])?await this.providerService.getChangeStore(r.resourceUri).discard(r.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),h.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const r=this.getSourceControlFrom(e);(r==null?void 0:r.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.providerService.getChangeStore(r.rootUri).stageAll(r.rootUri))}),h.commands.registerCommand("remoteHub.stageChanges",async(...e)=>{for(const r of e)!wc(r)||(this.telemetryService.sendEvent("command.stageChanges"),await this.providerService.getChangeStore(r.resourceUri).stage(r.resourceUri))}),h.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.providerService.getChangeStore(r.rootUri).unstageAll(r.rootUri)}),h.commands.registerCommand("remoteHub.unstageChanges",async(...e)=>{for(const r of e)!wc(r)||(this.telemetryService.sendEvent("command.unstageChanges"),await this.providerService.getChangeStore(r.resourceUri).unstage(r.resourceUri))}),h.commands.registerCommand("remoteHub.keepChanges",async(...e)=>{for(const r of e)!wc(r)||(this.telemetryService.sendEvent("command.keepChanges"),await this.providerService.getChangeStore(r.resourceUri).keep(r.resourceUri))}),h.commands.registerCommand("remoteHub.openChanges",e=>{var r;const{command:n}=e;if(!!n)return this.telemetryService.sendEvent("command.openChanges"),void h.commands.executeCommand(n.command,...(r=n.arguments)!=null?r:[])}),h.commands.registerCommand("remoteHub.openFile",async(...e)=>{var r;for(const n of e)if(sp(n)){const i=n,o=this.providerService.getChangeStore(i.resourceUri).resolveOpenCommand(i.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:h.ViewColumn.Active});this.telemetryService.sendEvent("command.openFile"),await h.commands.executeCommand(o.command,...(r=o.arguments)!=null?r:[])}else if(n instanceof h.Uri){this.telemetryService.sendEvent("command.openFile");const i=n;await h.window.showTextDocument(i)}}),h.commands.registerCommand("remoteHub.createBranch",async e=>{await D0("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),h.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await yc(this._scmProviders,_e("choose repo for create branch placeholder","Choose which repository to create a new branch on"),_e("choose repo for create branch title","Create Branch"));if(n===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(n);if(i.accessLevel<ie.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),h.window.showErrorMessage(_e("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,a=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const g=await bu.show(this.providerService,n,_e("choose branch for create placeholder","Choose which branch to create the new branch from"),_e("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!g){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=g.sha,a=Boolean(g.useIndex)}let s;try{s=await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>_u(this.providerService,n,o,_e("create branch","Please provide a new branch name"),_e("create branch placeholder","New branch name"),_e("create branch title","Create Branch \u2022 {0}",i.name)))}catch(g){te.error(g),h.window.showErrorMessage(_e("unable to create branch","Unable to create the new branch."));return}if(!s){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const l=await this.providerService.switchTo(n,{type:De.Branch,id:s});if(!l)return;const u=await this.providerService.getChangeStore(n).createChangeset(n);u&&await this.openActionsService.setChangesetToApply(l.uri,u);const d=_e("switch to branch prompt open","Switch to Branch"),f=_e("switch to branch prompt open in new window","Open in New Window"),p=await h.window.showInformationMessage(_e("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,s),{modal:!0,useCustom:!0},d,f);!p||(l.location=p===f?ve.NewWindow:ve.CurrentWindow,a&&await fe.setMode(l.uri,_t.getIndexDefault(Ee.Branch)),await dn(l,{skipChangesPrompt:!0}))}),h.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let r;const n=h.window.activeTextEditor;if((n==null?void 0:n.document.languageId)!=="diff"){const i=await h.window.showOpenDialog({openLabel:_e("open patch","Open Patch"),title:_e("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;r=WE.decode(await h.workspace.fs.readFile(i[0]))}else r=n.document.getText();try{await this.providerService.getChangeStore(e.rootUri).applyPatch(e.rootUri,r)}catch{h.window.showErrorMessage(_e("invalid patch file","Invalid patch file"))}}),h.commands.registerCommand("remoteHub.exportPatch",async(...e)=>{const r=Array.isArray(e)?e:[e];for(const n of r){const i=this.getSourceControlFrom(n);if((i==null?void 0:i.rootUri)===void 0)return;let o;sp(n)&&(o=n.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const a=await this.providerService.getChangeStore(i.rootUri).createPatch(i.rootUri,o),s=await h.workspace.openTextDocument({language:"diff",content:a});await h.window.showTextDocument(s)}}),h.commands.registerCommand("remoteHub.switchToBranch",async e=>{var r,n;const i=(r=e==null?void 0:e.uri)!=null?r:await yc(this._scmProviders,_e("choose repo for switch branch placeholder","Choose which repository to switch branches on"),_e("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],a=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(a.accessLevel>=ie.Write&&o.push(new Di(Fn({command:"remoteHub.createBranch",title:_e("create branch command","$(add) Create New Branch..."),arguments:[{uri:i}]})),new Di(Fn({command:"remoteHub.createBranchFrom",title:_e("create branch from command","$(add) Create New Branch from..."),arguments:[{uri:i}]}))),a.HEAD.type){case Q.Branch:o.push(new Di(Fn({command:"remoteHub.openOnRemote",title:_e("open branch on remote command","$(globe) Open Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,branch:a.HEAD.branch.name}]})));break;case Q.RemoteBranch:o.push(new Di(Fn({command:"remoteHub.openOnRemote",title:_e("open remote branch on remote command","$(globe) Open Remote Branch on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.HEAD.branch.remote.repo,branch:a.HEAD.branch.name}]})));break;case Q.Tag:o.push(new Di(Fn({command:"remoteHub.openOnRemote",title:_e("open tag on remote command","$(globe) Open Tag on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,tag:a.HEAD.detached.name}]})));break;case Q.Commit:o.push(new Di(Fn({command:"remoteHub.openOnRemote",title:_e("open commit on remote command","$(globe) Open Commit on {0}...",a.provider.name),arguments:[{provider:a.provider,repo:a.repo,sha:a.HEAD.sha}]})));break}const s=(n=a.HEAD.branch)==null?void 0:n.name,l=Boolean(s&&!await this.providerService.getChangeStore(i).hasChanges(i)),u=await bu.show(this.providerService,i,_e("choose switch branch placeholder","Choose which branch to switch to"),_e("choose switch branch title","Switch to Branch or Tag \u2022 {0}",a.name),o,{allowResetToSha:l,filterBranches:s?d=>d.name!==s:void 0,ignoreFocusOut:!1});if(!u){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return u instanceof Di?void u.execute():l&&u.type===De.Branch&&u.name===s&&u.sha?h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,{to:u.sha})}catch(d){te.error(d),h.window.showErrorMessage(_e("reset failed","Unable to reset the repository to commit '{0}'.",W(u.sha)))}}):void h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const d=await this.providerService.switchTo(i,u.name?{type:u.type,id:u.name}:void 0);if(d!==void 0){if(u.useIndex){const f=await this.providerService.getModeRefType(d.uri);await fe.setMode(d.uri,_t.getIndexDefault(f))}return dn(d)}})}),h.commands.registerCommand("remoteHub.fetch",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await yc(this._scmProviders,_e("choose repo for fetch placeholder","Choose which repository to fetch"),_e("choose repo for fetch title","Fetch Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.fetch");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.fetch(n,{force:!0}))}catch(i){h.window.showErrorMessage(_e("fetch failed","Unable to fetch repository"))}}}),h.commands.registerCommand("remoteHub.fetchAll",async e=>{const r=this.providerService.repositories;if(r.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await h.window.withProgress({location:h.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of r)try{await this.providerService.fetch(o.uri)}catch(a){i.push(a)}return i})).length&&!(e==null?void 0:e.automated)&&h.window.showErrorMessage(r.length?_e("fetch all failed","Unable to fetch repositories"):_e("fetch failed","Unable to fetch repository"))}),h.commands.registerCommand("remoteHub.pull",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await yc(this._scmProviders,_e("choose repo for pull placeholder","Choose which repository to pull"),_e("choose repo for pull title","Pull Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.pull");try{await this.sync(n,{pull:!0})}catch{}}}),h.commands.registerCommand("remoteHub.sync",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await yc(this._scmProviders,_e("choose repo for sync placeholder","Choose which repository to sync"),_e("choose repo for sync title","Synchronize Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.sync");try{await this.sync(n)}catch{}}}),h.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.sendEvent("command.disableCommitDirectlyWarning"),fe.updateEffective("commitDirectlyWarning",Ge.Off)})]}async sync(e,{pull:r,...n}={pull:!1}){this.telemetryService.sendEvent("sync");try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,n))}catch(i){if(Z.asVirtualProviderErrorCode(i)===Ve.SyncConflictsError){const o={title:_e("sync confirm","Continue")},a={title:_e("sync cancel","Cancel"),isCloseAffordance:!0};await h.window.showWarningMessage(r?_e("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):_e("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0,useCustom:!0},o,a)===o?await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.providerService.sync(e,{conflictResolution:ot.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else throw te.error(i),this.telemetryService.sendException(i),h.window.showErrorMessage(_e("sync failed","Unable to sync the repository.")),i}}async commitChanges(e,r){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.commitChangesCore(e,r))}catch(n){if(Z.asVirtualProviderErrorCode(n)===Ve.NothingToCommitError){h.window.showInformationMessage(_e("no changes to commit","There are no changes to commit."));return}te.error(n),h.window.showErrorMessage(_e("commit unable","Unable to commit.")),this.telemetryService.sendException(n)}}async commitChangesCore(e,r){const n=e.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const i=new Fe(`VirtualSourceControl.commitChanges(${n.toString()})`);let o;try{const a=await this.providerService.getMetadata(n);let s,l;const u=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const f=e.inputBox.value;if(await this.providerService.getChangeStore(n).hasMergeConflicts(n)){e.inputBox.showValidationMessage(_e("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"}),o=": Aborted; Unresolved conflicts";return}const p=await this.providerService.getCommitOperations(n,{staged:u});if(p.length===0&&!r.empty){e.inputBox.showValidationMessage(this.staging.enabled?_e("commit no staged changes","There are no staged changes to commit."):_e("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),o=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!f){e.inputBox.showValidationMessage(_e("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"}),o=": Aborted; No message";return}let g,_;if(a.HEAD.type===Q.RemoteBranch?(_=a.HEAD.branch.remote.accessLevel<ie.Write,g=_&&a.accessLevel<ie.Write):(g=a.accessLevel<ie.Write,_=g),l===void 0&&g&&(l=await this.providerService.getFork(n),l===void 0)){const b={title:_e("fork confirm","Fork Repository")},y={title:_e("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(_e("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0,useCustom:!0},b,y)!==b){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"}),o=": Aborted; Abandoned fork prompt";return}if(l=await h.window.withProgress({location:h.ProgressLocation.Notification,title:_e("fork progress","Forking {0}...",a.name)},()=>this.providerService.fork(n)),l===void 0){h.window.showErrorMessage(_e("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"}),o=": Aborted; Fork failed";return}}if(l||_){if(l===void 0){const y={title:_e("remote branch create branch prompt confirm","Commit to New Branch")},x={title:_e("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(_e("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0,useCustom:!0},y,x)!==y){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned remote branch prompt"}),o=": Aborted; Abandoned commit to new branch prompt";return}}let b=0;try{const y=await this.providerService.getBranches(l?this.providerService.createVirtualUri(n,l):n,{query:"patch-"});for(const x of y.branches){const C=/^patch-(?<num>\d+)$/.exec(x.name);if(C==null?void 0:C.groups){const k=Number(C.groups.num);k>b&&(b=k)}}}catch{}if(s=await _u(this.providerService,n,a.HEAD.sha,_e("create new branch prompt","Create a new branch to commit your changes to"),_e("create new branch placeholder","New branch name"),_e("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:a.name),l,`patch-${b+1}`),!s){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned create branch prompt"}),o=": Aborted; Abandoned create branch prompt";return}}try{if(fe.getUseNewCommitApi())await this.providerService.createAndPushCommit(n,f,p,s,r,l);else{i.logStep("Creating commit");const b=await this.providerService.createCommit(n,f,p,l);i.logStep("Pushing",{message:`: Created commit ${b}`,suffix:" \u2022 Pushing..."}),await this.providerService.pushCommit(n,b,s,l)}}catch(b){const y=Z.asVirtualProviderErrorCode(b);if(y===Ve.DetachedHEADError){const x={title:_e("detached head prompt confirm","Commit to New Branch")},C={title:_e("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showErrorMessage(_e("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},x,C)!==x){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"}),o=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(s=await _u(this.providerService,n,a.HEAD.sha,_e("create new branch prompt","Create a new branch to commit your changes to"),_e("create new branch placeholder","New branch name"),_e("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:a.name),l),!s){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head create branch prompt"}),o=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if(y===Ve.MergeConflictError){const x={title:_e("push conflicts prompt pull","Pull")},C={title:_e("push conflicts prompt sync","Sync (Pull & Push)")},k={title:_e("cancel","Cancel"),isCloseAffordance:!0},T=await h.window.showErrorMessage(_e("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},x,C,k);if(T!==x&&T!==C){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"}),o=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(n,{pull:T===x,conflictResolution:ot.Merge}),T===x){o=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw te.error(b),o=`: Aborted; ${String(b)}`,b}break}if(e.inputBox.value="",l?await this.providerService.getChangeStore(n).discardAll(n,{staged:u}):await this.providerService.getChangeStore(n).acceptAll(n,{staged:u}),hp(qo.HasCommitted,!0),!l&&!s)return;async function d(){if(l){const _={title:_e("commit to fork confirm","Switch to Fork")},b={title:_e("cancel","Cancel"),isCloseAffordance:!0},y=await h.window.showInformationMessage(_e("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",a.name),{modal:!0,useCustom:!0},_,b);if(this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(y===_)}),y===_){let x;s!==void 0?x={type:De.Branch,id:s}:a.HEAD.branch!==void 0&&(x={type:De.Branch,id:a.HEAD.branch.name}),dn({name:l.name,uri:this.providerService.createVirtualUri(n,{repo:l.repo,ref:x}),location:ve.CurrentWindow})}return}const f={title:_e("commit to new branch confirm","Switch to Branch")},p={title:_e("cancel","Cancel"),isCloseAffordance:!0},g=await h.window.showInformationMessage(_e("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",s),{modal:!0,useCustom:!0},f,p);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(g===f)}),g===f&&dn({name:a.name,uri:this.providerService.createVirtualUri(n,{repo:a.repo,ref:s?{type:De.Branch,id:s}:void 0}),location:ve.CurrentWindow})}c(d,"showSwitchToPrompt"),d.call(this)}finally{i.stop(o?{message:o}:void 0)}}async createPullRequest(e,r){try{await h.window.withProgress({location:h.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,r))}catch(n){const i=Z.asVirtualProviderErrorCode(n);if(i===Ve.NothingToCommitError){h.window.showInformationMessage(_e("no changes to commit","There are no changes to commit."));return}if(i===Ve.CommitFailedError){h.window.showErrorMessage(_e("commit unable","Unable to commit."));return}te.error(n),h.window.showErrorMessage(_e("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(n)}}async createPullRequestCore(e,r){var n,i;const o=e.rootUri,a=(n=r==null?void 0:r.draft)!=null?n:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(a),staging:String(this.staging.enabled)});const s=new Fe(`VirtualSourceControl.createPullRequest(${o.toString()})`);let l;try{let u=c(function(){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"}),l=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),d;const f=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(r==null?void 0:r.sha)){if(await this.providerService.getChangeStore(o).hasMergeConflicts(o)){e.inputBox.showValidationMessage(_e("commit resolve conflicts","You must resolve any pending conflicts before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted conflicts"}),l=": Aborted; Unresolved conflicts";return}if(d=await this.providerService.getCommitOperations(o,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),d.length===0){e.inputBox.showValidationMessage(this.staging.enabled?_e("commit no staged changes","There are no staged changes to commit."):_e("commit no changes","There are no changes to commit."),h.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),l=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const p=e.inputBox.value;if(!p){e.inputBox.showValidationMessage(_e("specify commit message","You must specify a commit message before committing."),h.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"}),l=": Aborted; No message";return}const g=await this.providerService.getMetadata(o);let _,b;g.HEAD.type===Q.RemoteBranch?(b=g.HEAD.branch.remote.accessLevel<ie.Write,_=b&&g.accessLevel<ie.Write):(_=g.accessLevel<ie.Write,b=_);let y=r==null?void 0:r.fork;if(y===void 0&&_&&(y=await this.providerService.getFork(o),y===void 0)){const ne={title:_e("fork confirm","Fork Repository")},ae={title:_e("cancel","Cancel"),isCloseAffordance:!0};if(await h.window.showInformationMessage(_e("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0,useCustom:!0},ne,ae)!==ne){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"}),l=": Aborted; Abandoned fork prompt";return}if(y=await h.window.withProgress({location:h.ProgressLocation.Notification,title:_e("fork progress","Forking {0}...",g.name)},()=>this.providerService.fork(o)),y===void 0){h.window.showErrorMessage(_e("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"}),l=": Aborted; Fork failed";return}}const x=await h.window.showInputBox({ignoreFocusOut:!0,placeHolder:_e("create pr placeholder","Pull request title"),prompt:_e("create pr prompt","Enter a title for the new pull request"),title:_e("create pr title","New Pull Request"),value:p});if(!x){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"}),l=": Aborted; Abandoned title prompt";return}async function C(ne){let ae=0;try{const Y=await this.providerService.getBranches(y?this.providerService.createVirtualUri(o,y):o,{query:"patch-"});for(const me of Y.branches){const ce=/^patch-(?<num>\d+)$/.exec(me.name);if(ce==null?void 0:ce.groups){const pe=Number(ce.groups.num);pe>ae&&(ae=pe)}}}catch{}return _u(this.providerService,o,ne,_e("create pr branch prompt","Create a new branch for this pull request"),_e("create pr branch placeholder","New branch name"),_e("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",y?y.name:g.name),y,`patch-${ae+1}`)}c(C,"createBranch");let k;if(fe.getUseNewCommitApi()){if(k=await C.call(this,g.HEAD.sha),!k){u.call(this);return}(d==null?void 0:d.length)&&await this.providerService.createAndPushCommit(o,p,d,k,void 0,y)}else{let ne;if((d==null?void 0:d.length)?(ne=await this.providerService.createCommit(o,p,d,y),s.log({message:`: Created commit ${ne}`})):(ne=(i=r==null?void 0:r.sha)!=null?i:g.HEAD.sha,s.log({message:`: Using commit ${ne}`})),k=await C.call(this,ne),!k){u.call(this);return}}const T=await this.providerService.createPullRequest(o,k,x,{draft:a},y);e.inputBox.value="",(d==null?void 0:d.length)&&(y?await this.providerService.getChangeStore(o).discardAll(o,{staged:f}):await this.providerService.getChangeStore(o).acceptAll(o,{staged:f}));async function O(){const ne={title:_e("created pr notification confirm","Switch to Pull Request")},ae={title:_e("cancel","Cancel"),isCloseAffordance:!0},Y=await h.window.showInformationMessage(_e("created pr notification",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Do you want to switch to the new pull request?',T.id,T.uri.toString(!0),g.provider.name,g.name),{modal:!0,useCustom:!0},ne,ae);this.telemetryService.sendEvent("createPullRequest.switchToPullRequest",{confirm:String(Y===ne)}),Y===ne&&dn({name:g.name,uri:this.providerService.createVirtualUri(o,{repo:g.repo,ref:{type:De.PullRequest,id:T.id}}),location:ve.CurrentWindow})}c(O,"showSwitchToPrompt"),O.call(this)}finally{s.stop(l?{message:l}:void 0)}}async update(e){const r=h.workspace.getWorkspaceFolder(e);if(r===void 0)return;const n=await this.createOrUpdateScmProvider(e,r.name),i=await this.providerService.getChangeStore(e).getGroupedChanges(e,{predicate:l=>l.fileType===h.FileType.File}),o=await Promise.all(i.conflicts.map(async l=>({type:l.type,resourceUri:l.uri,command:await this.providerService.getChangeStore(l.uri).resolveDiffCommand(l.uri,l.conflicts.incomingUri,_e("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",V(l.uri)))}))),a=await Promise.all(i.staged.map(async l=>({type:l.type,resourceUri:l.uri,command:await this.providerService.getChangeStore(l.uri).resolveDiffCommand(l.uri,B.getProviderUri(l.uri),_e("diff title index","{0} (Index)",V(l.uri)))}))),s=await Promise.all(i.working.map(async l=>({type:l.type,resourceUri:l.uri,decorations:{strikeThrough:l.type===q.Deleted},command:await this.providerService.getChangeStore(l.uri).resolveDiffCommand(l.uri,B.getProviderUri(l.uri),_e("diff title working","{0} (Working Tree)",V(l.uri)))})));return this.ensureMergeConflictsGroup(n).resourceStates=o,this.ensureStagedChangesGroup(n).resourceStates=this.staging.enabled?a:[],this.ensureWorkingChangesGroup(n).resourceStates=this.staging.enabled?s:[...a,...s],n}async createOrUpdateScmProvider(e,r){const n=await this.providerService.getMetadata(e),i=this.providerService.isReadonly(e);let o;const a=n.HEAD.branch?n.HEAD.name:void 0;let s=this.getScmProvider(e);if(s===void 0){r=n.name,o=h.scm.createSourceControl(`remoteHub:${n.provider.id}`,r,e),o.quickDiffProvider={provideOriginalResource:u=>B.getProviderUri(u)};const l=this.providerService.createIGitRepository(e,o,n);s={id:n.provider.id,name:n.provider.name,sourceControl:o,groups:[],repository:l,isReadonly:i},this.ensureMergeConflictsGroup(s),this.ensureStagedChangesGroup(s),this.ensureWorkingChangesGroup(s),this._scmProviders.push(s)}else o=s.sourceControl;return n.accessLevel>=ie.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:_e("scm input accept command title commit","Commit"),arguments:[o]},a?o.inputBox.placeholder=_e("scm input placeholder commit","Message (Ctrl+Enter to commit directly to '{0}' on {1})",a,n.provider.name):o.inputBox.placeholder=_e("scm input placeholder commit","Message (Ctrl+Enter to commit directly to {0})",n.provider.name),fe.get("commitDirectlyWarning")===Ge.Off?o.inputBox.validateInput=void 0:o.inputBox.validateInput=l=>{if(fe.get("commitDirectlyWarning")===Ge.Auto&&Ny(qo.HasCommitted))return;const u=new h.MarkdownString(a?_e("scm input validation commit branch directly","Your changes will be committed directly to the '{0}' branch on {1}.",a,n.provider.name):_e("scm input validation commit directly","Your changes will be committed directly to {0}.",n.provider.name));return u.isTrusted=!0,u.appendMarkdown(`&nbsp; [${_e("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${_e("scm input validation action tip","Hide")}')`),{message:u,type:h.SourceControlInputBoxValidationType.Information}}):i?(o.acceptInputCommand=void 0,o.inputBox.placeholder=_e("scm input readonly placeholder","Committing is not available for readonly repositories.")):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:_e("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=_e("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}'",r)),await this.updateStatusBarCommands(s,{syncing:!1},n),s}async updateStatusBarCommands(e,r,n){var i,o,a;const s=e.sourceControl.rootUri;n=n!=null?n:await this.providerService.getMetadata(s);const{HEAD:l}=n,u=await this.providerService.getIndexMetadata(s),d=(u==null?void 0:u.type)===Ft.Active,f=(u==null?void 0:u.type)===Ft.Active,p=Ft.hasIndex(u==null?void 0:u.type),g=await this.providerService.getChangeStore(s).hasChanges(s),_=Qh(l.type),b=[];if(b.push(Fn({command:"remoteHub.switchToBranch",title:`${_} ${l.name}${g?"*":""}`,tooltip:`${W(l.sha)}`,arguments:[{uri:s,commands:!0}]})),l.detached||((r==null?void 0:r.syncing)?b.push(Fn({command:"",title:"$(sync~spin)",tooltip:_e("sync command syncing","Syncing Changes..."),arguments:[]})):b.push(Fn({command:"remoteHub.sync",title:`$(sync)${((o=(i=n.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(a=n.state)==null?void 0:a.behind}\u2193`:""}`,tooltip:d||f?_e("sync index","Sync to latest indexed commit"):_e("sync command","Sync (Pull & Push)"),arguments:[{uri:s}]}))),n.pullRequest&&b.push(Fn({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${n.pullRequest.id}`,tooltip:_e("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,n.pullRequest.id,n.provider.name,n.pullRequest.title),arguments:[{provider:n.provider,repo:n.repo,pullRequest:{id:n.pullRequest.id}}]})),p){const y=this.providerService.getIndexProvider(s);y&&b.push(...await y.getStatusBarContributions(s))}e.sourceControl.statusBarCommands=b}ensureMergeConflictsGroup(e){const r="conflicts";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,_e("scm group conflicts","Merge Conflicts")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureStagedChangesGroup(e){const r="staged";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,_e("scm group staged","Staged Changes")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureWorkingChangesGroup(e){const r="changes";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,_e("scm group changes","Changes")),e.groups.push(n)),n}getScmProvider(e){const r=E(e);return this._scmProviders.find(n=>E(n.sourceControl.rootUri)===r)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let r;if(zE(e))r=e;else if(xy(e)){const n=e,i=this._scmProviders.find(o=>o.groups.includes(n));r=i==null?void 0:i.sourceControl}else if(sp(e)){const n=e,i=this._scmProviders.find(o=>o.groups.some(a=>a.resourceStates.includes(n)));r=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;r=this._scmProviders[0].sourceControl}return r}}c(_y,"VirtualSourceControl");function zE(t){return"rootUri"in t&&"inputBox"in t}c(zE,"isSourceControl");function xy(t){return t!==void 0&&"id"in t&&"label"in t&&"resourceStates"in t&&Array.isArray(t.resourceStates)}c(xy,"isSourceControlResourceGroup");function sp(t){return t!==void 0&&"resourceUri"in t&&t.resourceUri instanceof h.Uri}c(sp,"isSourceControlResourceState");function wc(t){return"type"in t}c(wc,"isTrackedChange");async function cp(t){var e,r,n;if(t.length===0)return!0;let i,o=_e("discard","Discard Changes");if(t.length===1){const s=t[0];s.type===q.Created?(i=_e("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,V((e=s.resourceUri)!=null?e:s.uri)),o=_e("delete file","Delete file")):s.type===q.Deleted?(o=_e("restore file","Restore file"),i=_e("confirm restore","Are you sure you want to restore {0}?",V((r=s.resourceUri)!=null?r:s.uri))):i=_e("confirm discard","Are you sure you want to discard changes in {0}?",V((n=s.resourceUri)!=null?n:s.uri))}else t.every(s=>s.type===q.Created)?i=_e("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,t.length):t.every(s=>s.type===q.Deleted)?(o=_e("restore files","Restore files"),i=_e("confirm restore multiple","Are you sure you want to restore {0} files?",t.length)):i=_e("confirm discard multiple","Are you sure you want to discard changes in {0} files?",t.length);return await h.window.showWarningMessage(i,{modal:!0,useCustom:!0},o)===o}c(cp,"confirmDiscard");async function yc(t,e,r){if(t.length===0)return;if(t.length===1)return t[0].sourceControl.rootUri;const n=await h.window.showQuickPick(t.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:r});if(!!n)return n.uri}c(yc,"getOrPickRootUri");async function _u(t,e,r,n,i,o,a,s){const l=new Set;let u;const d=h.window.createInputBox();d.ignoreFocusOut=!0;try{return await new Promise((f,p)=>{u=h.Disposable.from(d.onDidHide(()=>f(void 0)),d.onDidChangeValue(g=>{if(g=g.trim(),!g){d.validationMessage=_e("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(l.has(g)){d.validationMessage=_e("scm create branch prompt validation already exists","Branch '{0}' already exists",g);return}if(!re(g)){d.validationMessage=_e("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",g);return}d.validationMessage=void 0}),d.onDidAccept(async()=>{const g=d.value;try{d.enabled=!1,d.busy=!0;const _=await t.createBranch(e,g,r,a);f(_)}catch(_){if(Z.asVirtualProviderErrorCode(_)===Ve.InvalidBranchNameError){d.enabled=!0,d.busy=!1,d.validationMessage=_.message,l.add(g);return}p(_)}})),d.prompt=n,d.placeholder=i,d.title=o,s&&(d.value=s),d.show()})}finally{d.dispose(),u==null||u.dispose()}}c(_u,"createBranchWithPrompt");const Gt=(0,m.loadMessageBundle)();class ui extends h.TimelineItem{static is(e){return e instanceof ui}constructor(e,r,n,i,{dateType:o,showAuthor:a,dateFormatter:s}){var l;const u=n.message.indexOf(`
`),d=u!==-1?`${n.message.substring(0,u)} \u2026`:n.message,f=o==="authored"?n.authorDate:n.commitDate;super(d,(l=f==null?void 0:f.getTime())!=null?l:0);this.id=n.hash,this.contextValue=`${B.scheme}:${r}:file:commit`,this.command=i,a&&(this.description=n.authorName),this.detail=Gt("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,n.authorName,n.authorEmail,W(n.hash),s.format(f),n.message),this.iconPath=new h.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=r,this.hash=n.hash,this.parents=n.parents,this.message=n.message}}c(ui,"CommitTimelineItem");class zo extends h.TimelineItem{static is(e){return e instanceof zo}constructor(e,r,n,i,o,{dateFormatter:a,staged:s}){const l=s?Gt("timeline staged changes","Staged Changes"):Gt("timeline uncommitted changes","Uncommitted Changes");super(l,n.timestamp);this.id=s?"index":"working",this.contextValue=`${B.scheme}:${r}:file:${this.id}`,this.command=o,this.iconPath=new h.ThemeIcon("git-commit"),s?this.detail=Gt("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,Gt("timeline you","You"),Gt("timeline index","Index"),a.format(new Date(n.timestamp)),Ip(n.type)):this.detail=Gt("timeline working detail",`{0}  \u2014 {1}
{2}

{3}`,Gt("timeline you","You"),Gt("timeline working","Working Tree"),a.format(new Date(n.timestamp)),Ip(n.type)),this.rootUri=e,this.providerId=r,this.hash=s?"~":"",this.parents=i,this.message=l}}c(zo,"ChangeOperationTimelineItem");class Sy{constructor(e){this.providerService=e,this._onDidChange=new h.EventEmitter,this.id="github-file-history",this.label=Gt("timeline.source","GitHub File History"),this.debouncer=new Ll(500),this.disposable=h.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),e.onDidChangeChangeStore(this.onUrisChanged,this),fe.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const r=E(this.rootUri);!e.some(n=>E(n)===r)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const r=E(this.rootUri);(e.added.some(n=>E(n.uri)===r)||e.removed.some(n=>E(n.uri)===r))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||E(this.rootUri)!==E(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const r=E(this.rootUri);e.some(n=>E(n.rootUri)===r)&&this.fireChanged()}async provideTimeline(e,r,n){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const _ of this.providerService.repositories)if(_.uri.path===this.rootUri.path){this.rootUri=_.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),a=await this.providerService.getMetadata(this.rootUri);if(!a||n.isCancellationRequested)return{items:[]};const s=await this.providerService.getCommits(this.rootUri,{ref:a.HEAD.sha,path:o||void 0,cursor:r.cursor,limit:typeof r.limit=="number"?r.limit:void 0});if(s===void 0||s.commits.length===0||n.isCancellationRequested)return{items:[]};const l=((i=s.paging)==null?void 0:i.more)?{cursor:s.paging.cursor}:void 0,u=new Intl.DateTimeFormat(h.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),d=fe.getAny("git.timeline.date",void 0,"committed"),f=fe.getAny("git.timeline.showAuthor",void 0,!0),p=s.commits.map(_=>new ui(this.rootUri,a.provider.id,_,this.resolveDiffCommand(_,a,e,o),{dateType:d,showAuthor:f,dateFormatter:u})),g=r.cursor===void 0?await this.providerService.changeStoreGetChange(e):void 0;if(g){const _=Boolean(g.staged&&fe.get("staging.enabled")),b=new zo(this.rootUri,a.provider.id,g,[s.commits[0].hash],await this.providerService.changeStoreResolveDiffCommand(g.uri,B.getProviderUri(g.uri),_?Gt("diff title index","{0} (Index)",V(g.uri)):Gt("diff title working","{0} (Working Tree)",V(g.uri))),{dateFormatter:u,staged:_});p.splice(0,0,b)}return{items:p,paging:l}}catch(o){return te.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=h.workspace.registerTimelineProvider([Nr.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[h.commands.registerCommand("remoteHub.timeline.copyCommitId",(r,n,i)=>{!ui.is(r)||h.env.clipboard.writeText(r.hash)}),h.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(r,n,i)=>{!ui.is(r)||h.env.clipboard.writeText(r.message)}),h.commands.registerCommand("remoteHub.timeline.openDiff",async(r,n,i)=>{var o;!ui.is(r)&&!zo.is(r)||r.command!==void 0&&await h.commands.executeCommand(r.command.command,...(o=r.command.arguments)!=null?o:[])}),h.commands.registerCommand("remoteHub.timeline.openOnGitHub",async r=>{await this.openOnRemote(r)}),h.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async r=>{await this.openOnRemote(r)}),h.commands.registerCommand("remoteHub.timeline.selectForCompare",async(r,n,i)=>{!n||!ui.is(r)&&!zo.is(r)||(e={uri:n,left:r},await h.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),h.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(r,n,i)=>{if(!n||!e||!ui.is(r)&&!zo.is(r)||E(n)!==E(e.uri))return;const{left:o}=e,a=this.providerService.getRelativeFilePath(r.rootUri,n),s=await this.providerService.getMetadata(r.rootUri),l=V(n),u=o.parents[0];let d;u===void 0?d=Gt("timeline diff title ref","{0} ({1})",l,W(r.hash)):o.hash===""?d=Gt("timeline diff title working","{0} (Working Tree)",l):o.hash==="~"?d=Gt("timeline diff title index","{0} (Index)",l):d=Gt("timeline diff title ref","{0} ({1})",l,W(o.hash));let f=o.hash===""||o.hash==="~"?n:this.providerService.createProviderUri(n,{repo:s.repo,ref:{type:De.Commit,id:u!=null?u:"0000000000000000000000000000000000000000"}},a);u===void 0&&(f=f.with({query:"~"}));const p=r.parents[0];let g;p===void 0?g=Gt("timeline diff title ref","{0} ({1})",l,W(r.hash)):p==="~"&&r.hash===""?g=Gt("timeline diff title working","{0} (Working Tree)",l):r.hash==="~"?g=Gt("timeline diff title index","{0} (Index)",l):g=Gt("timeline diff title ref","{0} ({1})",l,W(r.hash));const _=Gt("timeline diff title","{0} \u27F7 {1}",d,g),b=r.hash===""||r.hash==="~"?n:this.providerService.createProviderUri(n,{repo:s.repo,ref:{type:De.Commit,id:r.hash}},a);await h.commands.executeCommand("vscode.diff",f,b,_)})]}resolveDiffCommand(e,r,n,i,o){const a=V(n),s=e.parents[0];let l;s===void 0?l=Gt("timeline diff title ref","{0} ({1})",a,W(e.hash)):e.hash===""?l=Gt("timeline diff title working","{0} (Working Tree)",a):e.hash==="~"?l=Gt("timeline diff title index","{0} (Index)",a):l=Gt("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",a,W(s),W(e.hash));let u=this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:De.Commit,id:s!=null?s:"0000000000000000000000000000000000000000"}},i);s===void 0&&(u=u.with({query:"~"}));const d=e.hash===""||e.hash==="~"?n:this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:De.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[u,d,l,o]}}async openOnRemote(e){if(!ui.is(e))return;const r=await this.providerService.getMetadata(e.rootUri);await D0("remoteHub.openOnRemote",{provider:r.provider,repo:r.repo,sha:e.hash})}}c(Sy,"VirtualTimelineProvider");class Cy{constructor(e,r){this.providerService=e,this.telemetryService=r,this.disposable=h.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var r;const n=new Fe(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);try{switch(e.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let i,o;for(const s of e.query.split("&")){const[l,u]=s.split("=");switch(l){case"url":i=decodeURIComponent(u);break;case"location":o=u===ve.CurrentWindow?ve.CurrentWindow:ve.NewWindow;break}}if(!i){n.log({message:": Unable to find url parameter"}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:ve.NewWindow;const a=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!a){n.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}n.log({message:`: Opening ${i} in ${o}`}),dn(a);break}case"/open-files":{let i;for(const a of e.query.split("&")){const[s,l]=a.split("=");if(s==="url"){i=decodeURIComponent(l);break}}if(!i){n.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){n.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(n.log({message:`: Opening files/folders for ${i}`}),await((r=Cu())==null?void 0:r.openPendingFiles(o.uri,o.filesToOpen))):n.log({message:`: No files/folders found to open for ${i}`});break}default:{n.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{n.stop()}}}c(Cy,"RemoteUriHandler");var qE=Object.defineProperty,jE=Object.getOwnPropertyDescriptor,VE=c((t,e,r,n)=>{for(var i=n>1?void 0:n?jE(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&qE(e,r,i),i},"view_decorateClass"),qa;(function(t){t.Change="remoteHub:viewItem:change",t.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",t.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",t.Message="remoteHub:viewItem:message"})(qa||(qa={}));const Ey=c(class{constructor(t,e){this.view=t,this.parent=e,this.splatted=!1}static is(t){return t instanceof Ey}get id(){}toString(){return`${te.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var t,e;return((t=this.parent)==null?void 0:t.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(t=!1,e=!1,r){return this.splatted&&this.parent!==void 0&&this.parent!==r?this.parent.triggerChange(t,e):this.view.refreshNode(this,t,e)}},"_ViewNode");let ja=Ey;VE([le((t=!1,e=!1,r)=>JSON.stringify([t,e,r==null?void 0:r.toString()]))],ja.prototype,"triggerChange",1);class Ry{constructor(e,r,n,i){this.id=e,this.name=r,this.providerService=n,this.telemetryService=i,this._onDidChangeTreeData=new h.EventEmitter,this.disposables=[];const o=!1;if(te.isDebugging&&o){const a=this.getTreeItem;this.getTreeItem=async function(s){var l;const u=await a.apply(this,[s]),d=s.getParent();return u.tooltip===void 0&&(u.tooltip=new h.MarkdownString(u.label!==void 0&&typeof u.label!="string"?u.label.label:(l=u.label)!=null?l:"")),typeof u.tooltip=="string"?u.tooltip=`${u.tooltip}

---
context: ${u.contextValue}
node: ${s.toString()}${d!==void 0?`
parent: ${d.toString()}`:""}`:u.tooltip.appendMarkdown(`

---

context: \`${u.contextValue}\`\\
node: \`${s.toString()}\`${d!==void 0?`\\
parent: \`${d.toString()}\``:""}`),u}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!fe.changed(e,`views.${this.configKey}`)}dispose(){h.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=h.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(fe.onDidChange(r=>{!this.filterConfigurationChanged(r)||(this._config=void 0,this.onConfigurationChanged(r))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}getChildren(e){return e!==void 0?e.getChildren():this.ensureRoot().getChildren()}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:[...this.tree.selection]}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var r,n;await((n=(r=this.root)==null?void 0:r.refresh)==null?void 0:n.call(r,e)),this.triggerNodeChange()}async refreshNode(e,r=!1,n=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,r));!n&&o===!0||this.triggerNodeChange(e)}async reveal(e,r){if(this.tree!==void 0)try{await this.tree.reveal(e,r)}catch(n){te.error(n)}}async show(){try{await h.commands.executeCommand(`${this.id}.focus`)}catch(e){te.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=fe.get("views")[this.configKey]),this._config}}c(Ry,"View");class Ay extends ja{constructor(e,r,n,i,o,a,s){super(e,r);this._message=n,this._description=i,this._tooltip=o,this._iconPath=a,this._contextValue=s}getChildren(){return[]}getTreeItem(){var e;const r=new h.TreeItem(this._message,h.TreeItemCollapsibleState.None);return r.contextValue=(e=this._contextValue)!=null?e:qa.Message,r.description=this._description,r.tooltip=this._tooltip,r.iconPath=this._iconPath,r}}c(Ay,"MessageNode");var GE=Object.defineProperty,KE=Object.getOwnPropertyDescriptor,lp=c((t,e,r,n)=>{for(var i=n>1?void 0:n?KE(e,r):e,o=t.length-1,a;o>=0;o--)(a=t[o])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&GE(e,r,i),i},"workspaceRepositoriesView_decorateClass");const mr=(0,m.loadMessageBundle)(),Iy=c(class extends ja{constructor(t,e,r,n,i,o,a){super(t,e);this.changeStore=r,this.canonical=n,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=a}static getId(t,e,r){return`${bc.getId(t,e)}:${this.key}(${r.uri.toString()})`}get id(){return Iy.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const t=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new h.TreeItem(t,h.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${qa.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.providerService.getChangeStore(this.operation.uri).getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(t,!0),e}async getDiffCommand(t,e=!1){if(e||this._command===void 0){const r=Boolean(this.operation.staged&&fe.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const n=B.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,n,r?mr("diff title index","{0} (Index)",V(this.operation.uri),this.workspaceRepository.ref.name):mr("diff title working","{0} (Working Tree)",V(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:n}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:n,ref:{type:De.Commit,id:this.operation.revision}},t);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,r?mr("diff title changeset index","{0} (Index of {1})",V(this.operation.uri),this.workspaceRepository.ref.name):mr("diff title changeset working","{0} (Working Tree of {1})",V(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var t;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await h.commands.executeCommand(e.command,...(t=e.arguments)!=null?t:[])}async openFile(){const t=this.view.providerService.getChangeStore(this.operation.uri).getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await h.window.showTextDocument(t)}async applyChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.providerService.getChangeStore(t.uri).applyChangeset(t.uri,this.workspaceRepository,this.operation)}catch(e){h.window.showErrorMessage(String(e))}}},"_FileChangeNode");let ky=Iy;ky.key=":changes";const Ty=c(class extends ja{constructor(t,e,r,n,i){super(t,e);this.canonical=r,this.workspaceRepository=n,this.root=i}static getId(t,e){return`${xu.getId(t)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return Ty.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||h.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const t=this.view.providerService.getChangeStore(this.workspaceRepository.uri).getScopedChangeStore(this.workspaceRepository),e=await t.getChanges(this.workspaceRepository.uri);this._children=e.map(r=>new ky(this.view,this,t,this.canonical,this.workspaceRepository,r,this.canApplyChanges()))}return this._children}getTreeItem(){const t=this.workspaceRepository.workspaceId===this.view.workspaceId,e=ax(this.workspaceRepository),r=Nr.isCanonicalUri(this.workspaceRepository.uri)?mr("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,n=new h.TreeItem(this.root?this.canonical.name:r,e?h.TreeItemCollapsibleState.Collapsed:h.TreeItemCollapsibleState.None);return n.id=this.id,n.contextValue=`${qa.WorkspaceRepository}${t?"+active":""}${this.canApplyChanges()?"+apply":""}`,n.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${Bs(this.workspaceRepository.timestamp,{ago:!0})}`,n.iconPath=t?new h.ThemeIcon("check"):this.root?Py(this.canonical.provider.id):Sx(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),n.tooltip=new h.MarkdownString(void 0,!0).appendMarkdown(mr("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?mr("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",QE(this.workspaceRepository.ref.type),Qh(this.workspaceRepository.ref.type),r,t?` \u2014 _${mr("repositories view repository tooltip active","Active")}_ `:"",Bs(this.workspaceRepository.timestamp,{ago:!0}),y0(this.workspaceRepository.changes,{preamble:`${mr("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(n.resourceUri=h.Uri.parse("remotehub-view://wsrepo/changes")),n}refresh(t=!1){t&&(this._children=void 0)}async applyAllChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.providerService.getChangeStore(t.uri).applyChangeset(t.uri,this.workspaceRepository)}catch(e){h.window.showErrorMessage(String(e))}}remove(){return this.view.providerService.workspaceRepositoriesRemoveRepository(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let bc=Ty;bc.key=":wsrepo",lp([le()],bc.prototype,"refresh",1);const Dy=c(class extends ja{constructor(t,e,r,n){super(t,e);this.canonical=r,this.workspaceRepositories=n}static getId(t){return`remoteHub${this.key}(${t.toString()})`}get id(){return Dy.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const t=this.workspaceRepositories;if(t.length===0)return this.view.message=void 0,[new Ay(this.view,this,mr("repositories view message empty","No remote repositories could be found."))];this.view.message=void 0,this.children=t.map(e=>new bc(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const t=this.workspaceRepositories.some(r=>r.workspaceId===this.view.workspaceId),e=new h.TreeItem(this.canonical.name,t?h.TreeItemCollapsibleState.Expanded:h.TreeItemCollapsibleState.Collapsed);return e.contextValue=qa.WorkspaceRepositories,e.iconPath=Py(this.canonical.provider.id),e}refresh(t=!1){t&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let xu=Dy;xu.key=":wsrepos",lp([le()],xu.prototype,"refresh",1);class up extends ja{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.providerService.workspaceRepositoriesGetRepositoriesByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const r=[];for(const[n,i]of e){const o=h.Uri.parse(n);try{const{name:a,provider:s}=this.view.providerService.getVirtualUriMetadata(o),l={uri:o,name:a,provider:s,hasActive:i.some(u=>u.workspaceId===this.view.workspaceId)};i.length===1?r.push(new bc(this.view,this,l,i[0],!0)):r.push(new xu(this.view,this,l,i))}catch(a){if(a instanceof qr)continue;te.error(a)}}this.children=r}return this.children}getTreeItem(){return new h.TreeItem("Repositories",h.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}c(up,"WorkspaceRepositoriesViewNode"),lp([le()],up.prototype,"refresh",1);class Fy extends Ry{constructor(e,r,n){super("remoteHub.views.workspaceRepositories",mr("remote view title","Remote Repositories"),e,n);this.workspaceId=r,this.configKey="workspaceRepositories",this.disposables.push(this.providerService.onDidChangeWorkspaceRepositories(this.onRepositoriesChanged,this),h.window.registerFileDecorationProvider({provideFileDecoration:(i,o)=>{if(!(i.scheme!=="remotehub-view"||i.authority!=="wsrepo"||!i.path.includes("/changes")))return{badge:"\u25CF",color:new h.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:mr("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new up(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[h.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.providerService.workspaceRepositoriesRefresh(),void this.refresh(!0)),this),h.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),dn({name:e.name,uri:e.uri,location:ve.CurrentWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),dn({name:e.name,uri:e.uri,location:ve.NewWindow})),this),h.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.remove"),e.remove()),this),h.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),h.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),e.openFile()),this),h.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const r=E(this.providerService.getVirtualCanonicalRootUri(e.uri)),n=this.providerService.repositories.filter(o=>E(o.canonicalUri)===r);return await ZE(n,mr("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}c(Fy,"WorkspaceRepositoriesView");function QE(t,e){switch(t){case Q.Branch:return e?mr("type pr branch","Pull Request #{0}",e.id):mr("type branch","Branch");case Q.RemoteBranch:return e?mr("type pr remote branch","Pull Request #{0}",e.id):mr("type remote branch","Remote Branch");case Q.Tag:return mr("type tag","Tag");case Q.Commit:return mr("type commit","Commit")}}c(QE,"headTypeToString");function Py(t){switch(t){case"github":return new h.ThemeIcon("github");case"azurerepos":return new h.ThemeIcon("azure-devops");default:return new h.ThemeIcon("vm")}}c(Py,"providerToIconPath");async function ZE(t,e){if(t.length!==0){if(t.length>1){const r=await h.window.showQuickPick(t.map(n=>({label:n.name,description:n.provider.name,repository:n})),{placeHolder:e});return r?r.repository:void 0}return t[0]}}c(ZE,"getRepository");let Su;function Cu(){return Su}c(Cu,"getOpenActionsService");var qo;(function(t){t.HasCommitted="has:committed",t.Version="version"})(qo||(qo={}));let dp;function Ny(t){return dp.globalState.get(t)}c(Ny,"getState");async function hp(t,e){return dp.globalState.update(t,e)}c(hp,"updateState");async function XE(t){dp=t,yn.configure("remoteHub",t),te.configure(t,"GitHub Repositories",fe.get("logLevel")),Fe.start("Time to root directory",{log:!1});const e=ju.configure(t),r=new Ns(t),n=t.extension.packageJSON.version;await hp(qo.Version,n),await t.workspaceState.update(qo.Version,n);try{const i=new Mc(t.globalState),o=i.with(e),a=new Lc(t.globalStorageUri,e),s=new Nc(o),l=new Nr(r),u=new ss(l,o,a,r,e);u.getWorkspacesWithChanges(),Su=new yy(l);const d=new _y(l,Su,r),f=new Qw(t.globalStorageUri,l),p=new _v(l,f),g=new Hh(l,i,u,e);return t.subscriptions.push(fe.onDidChange(_=>{!fe.changed(_,"logLevel")||(te.logLevel=fe.get("logLevel"))}),l.onDidChangeRepositories(async _=>{for(const b of _.added)try{const y=await b.getMetadata(),{HEAD:x,defaultBranch:C,name:k,provider:T,pullRequest:O}=y,ne=x.name.replace(/\//g,"\u2009\u2215\u2009");let ae=" ";if(O!==void 0)ae=` (PR ${O.id}) `;else if(x.type===Q.Tag)ae=` (${ne}) `;else if(x.type===Q.Commit)ae=` (${ne}) `;else if(x.type===Q.Branch||x.type===Q.RemoteBranch){const me=x.branch.name.replace(/\//g,"\u2009\u2215\u2009");x.branch.name!==C.name&&(ae=` (${me})`)}const Y={uri:b.uri,type:"folder",label:`${k}${ae}[${T.name}]`};h.commands.executeCommand("_workbench.addToRecentlyOpened",Y)}catch(y){te.error(y,"Failed to add repository to recently opened")}}),new by(l),new Gs(l),new Cy(l,r),..._x(l,t.extension.id,r),...tR(l,r),...await YE(l,i,u,s,g,d,f,t,r),new Sy(l),new Fy(l,e,r),f,g,d,Su,u,l,r),r.sendEvent("activate"),Promise.resolve(p)}catch(i){throw te.error(i),i}}c(XE,"activate");async function YE(t,e,r,n,i,o,a,s,l){const u=[];if(My()){const d=new vv(t,l);t.registerVirtualIndexProvider("github",d),t.registerVirtualIndexProvider("azurerepos",d),u.push(d)}return u.push(JE(t,e,r,n,i,o,a,l)),await eR(t),u}c(YE,"registerProviders");function JE(t,e,r,n,i,o,a,s){const l=new yu(t,a),u=new hc(t,l,r,a,s);async function d(){var p;try{let g=(p=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?p:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");g||(te.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(k=>{const T=h.extensions.onDidChange(()=>{var O;g=(O=h.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?O:h.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),g&&(T.dispose(),k())})})),te.log("[ GHPR] Registering..."),hi(Un.HasPullRequestExtension,!0);const _=await g.activate();if(!_)throw new Error("Unable to get registration api");const b=_.registerGitProvider(o),y=t.onDidChangeRepositories(k=>x(k));async function x(k){const T=k.added.filter(O=>O.provider.id==="github");if(T.length!==0){te.log("[ GHPR] Checking for opened PRs...");for(const O of T){const ne=await t.getBestRemoteUri(O.uri,tn.PullRequest);if(!!ne){y.dispose(),te.log("[ GHPR] Opened PR found; preloading"),h.commands.executeCommand("github.api.preloadPullRequest",ne.toString());return}}te.log("[ GHPR] No opened PRs found")}}c(x,"onRepositoriesChanged"),te.log("[ GHPR] Registration complete");const C=t.repositories;return C.length&&x({added:C,removed:[]}),h.Disposable.from(b,y)}catch(g){return te.error(g,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}c(d,"registerWithGHPR");const f=d();return h.Disposable.from(t.register("github","GitHub",l,u,e,r,n,i),l,u,new I(l),{dispose:async()=>{var p;return void((p=await f)==null?void 0:p.dispose())}})}c(JE,"registerGitHub");async function eR(t){async function e(i){te.log("[ AzureRepos] Registering...");const o=await i.activate();if(!o)throw new Error("Unable to get registration api");return o.registerVirtualProviderService(t)}c(e,"activate2");async function r(){try{let i=h.extensions.getExtension("ms-vscode.azure-repos");if(!i){te.log("[ AzureRepos] Not currently installed or enabled.");const o=h.extensions.onDidChange(async()=>{if(i=h.extensions.getExtension("ms-vscode.azure-repos"),i)return o.dispose(),e(i)});return}return e(i)}catch(i){return te.error(i,"[ AzureRepos] Registration failed;"),{dispose:()=>{}}}}c(r,"registerWithAzureRepos");const n=await r();return{dispose:async()=>void(n==null?void 0:n.dispose())}}c(eR,"registerAzDO");function tR(t,e){if(!My())return[];e.publicLog2("codex.enableRichNav",{});const r=new b0(t);return[r,r.register(new lf(e)),...lf.createStatus()]}c(tR,"registerNavigationServiceProviders");function My(){return h.env.uiKind===h.UIKind.Desktop||fe.get("richNavigation.enabled")===!0}c(My,"isRichNavEnabled")})(),module.exports=__webpack_exports__})();
